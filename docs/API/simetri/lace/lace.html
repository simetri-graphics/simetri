<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>simetri.lace.lace API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../lace.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simetri.lace</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#array">array</a>
            </li>
            <li>
                    <a class="class" href="#Intersection">Intersection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Intersection.__init__">Intersection</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.division1">division1</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.division2">division2</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.overlap">overlap</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.endpoint">endpoint</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.division">division</a>
                        </li>
                        <li>
                                <a class="function" href="#Intersection.copy">copy</a>
                        </li>
                        <li>
                                <a class="variable" href="#Intersection.point">point</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Partition">Partition</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Partition.__init__">Partition</a>
                        </li>
                        <li>
                                <a class="variable" href="#Partition.subtype">subtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Partition.area">area</a>
                        </li>
                        <li>
                                <a class="variable" href="#Partition.CG">CG</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Fragment">Fragment</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Fragment.__init__">Fragment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.subtype">subtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.area">area</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.sections">sections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.intersections">intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.inner_lines">inner_lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.CG">CG</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.divisions">divisions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Fragment.center">center</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Section">Section</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Section.__init__">Section</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.start">start</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.end">end</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.is_overlap">is_overlap</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.overlap">overlap</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.is_over">is_over</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.twin">twin</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.fragment">fragment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.length">length</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.mid_point">mid_point</a>
                        </li>
                        <li>
                                <a class="function" href="#Section.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Section.end_point">end_point</a>
                        </li>
                        <li>
                                <a class="variable" href="#Section.is_endpoint">is_endpoint</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Overlap">Overlap</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Overlap.__init__">Overlap</a>
                        </li>
                        <li>
                                <a class="variable" href="#Overlap.intersections">intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Overlap.sections">sections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Overlap.subtype">subtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Overlap.visited">visited</a>
                        </li>
                        <li>
                                <a class="variable" href="#Overlap.drawable">drawable</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Division">Division</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Division.__init__">Division</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.p1">p1</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.p2">p2</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.intersections">intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.twin">twin</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.section">section</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.fragment">fragment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.next">next</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.prev">prev</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.sections">sections</a>
                        </li>
                        <li>
                                <a class="function" href="#Division.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Division.is_connected">is_connected</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.end_points">end_points</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.start">start</a>
                        </li>
                        <li>
                                <a class="variable" href="#Division.end">end</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Polyline">Polyline</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Polyline.__init__">Polyline</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polyline.closed">closed</a>
                        </li>
                        <li>
                                <a class="function" href="#Polyline.iter_sections">iter_sections</a>
                        </li>
                        <li>
                                <a class="function" href="#Polyline.iter_intersections">iter_intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polyline.intersections">intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polyline.area">area</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polyline.sections">sections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polyline.divisions">divisions</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ParallelPolyline">ParallelPolyline</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ParallelPolyline.__init__">ParallelPolyline</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.polyline">polyline</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.offset">offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.dist_tol">dist_tol</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.dist_tol2">dist_tol2</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.closed">closed</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.polyline_list">polyline_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.subtype">subtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.overlaps">overlaps</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.under">under</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParallelPolyline.sections">sections</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Lace">Lace</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Lace.__init__">Lace</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.polyline_shapes">polyline_shapes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.offset">offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.main_intersections">main_intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.offset_intersections">offset_intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.xform_matrix">xform_matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.rtol">rtol</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.swatch">swatch</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.breakpoints">breakpoints</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.plait_color">plait_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.draw_fragments">draw_fragments</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.palette">palette</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.color_step">color_step</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.with_plaits">with_plaits</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.d_intersections">d_intersections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.d_connections">d_connections</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.plaits">plaits</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.overlaps">overlaps</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.area_threshold">area_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.radius_threshold">radius_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.subtype">subtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.center">center</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.fragment_groups">fragment_groups</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.set_fragment_groups">set_fragment_groups</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.get_sketch">get_sketch</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.group_fragments">group_fragments</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.get_fragment_cycles">get_fragment_cycles</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.set_plait_lines">set_plait_lines</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.set_fragment_lines">set_fragment_lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.all_divisions">all_divisions</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_main_intersections">iter_main_intersections</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_offset_intersections">iter_offset_intersections</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_offset_sections">iter_offset_sections</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_main_sections">iter_main_sections</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_offset_divisions">iter_offset_divisions</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.iter_main_divisions">iter_main_divisions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.main_divisions">main_divisions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.offset_divisions">offset_divisions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Lace.intersections">intersections</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.set_plaits">set_plaits</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.fragment_edge_graph">fragment_edge_graph</a>
                        </li>
                        <li>
                                <a class="function" href="#Lace.fragment_vertex_graph">fragment_vertex_graph</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#all_intersections">all_intersections</a>
            </li>
            <li>
                    <a class="function" href="#merge_nodes">merge_nodes</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../simetri.html">simetri</a><wbr>.<a href="./../lace.html">lace</a><wbr>.lace    </h1>

                        <div class="docstring"><p>Simetri library's interlace objects.</p>
</div>

                        <input id="mod-lace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-lace-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Simetri library&#39;s interlace objects.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">isclose</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">..graphics.shape</span> <span class="kn">import</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">custom_attributes</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span> <span class="nn">..graphics.batch</span> <span class="kn">import</span> <span class="n">Batch</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span> <span class="nn">..colors</span> <span class="kn">import</span> <span class="n">colors</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">..geometry.geometry</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>    <span class="n">connected_pairs</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>    <span class="n">polygon_area</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>    <span class="n">distance</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>    <span class="n">double_offset_polygons</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>    <span class="n">get_polygons</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>    <span class="n">double_offset_polylines</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>    <span class="n">intersection2</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>    <span class="n">right_handed</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>    <span class="n">polygon_cg</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>    <span class="n">round_point</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>    <span class="n">offset_polygon</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="n">offset_polygon_points</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>    <span class="n">convex_hull</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">close_points2</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">polygon_center</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span> <span class="nn">..helpers.graph</span> <span class="kn">import</span> <span class="n">get_cycles</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">from</span> <span class="nn">..graphics.common</span> <span class="kn">import</span> <span class="n">get_defaults</span><span class="p">,</span> <span class="n">common_properties</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="kn">from</span> <span class="nn">..graphics.all_enums</span> <span class="kn">import</span> <span class="n">Types</span><span class="p">,</span> <span class="n">Connection</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">from</span> <span class="nn">..canvas.style_map</span> <span class="kn">import</span> <span class="n">shape_style_map</span><span class="p">,</span> <span class="n">ShapeStyle</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">from</span> <span class="nn">..canvas.canvas</span> <span class="kn">import</span> <span class="n">Canvas</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">from</span> <span class="nn">..settings.settings</span> <span class="kn">import</span> <span class="n">defaults</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">from</span> <span class="nn">..helpers.utilities</span> <span class="kn">import</span> <span class="n">flatten</span><span class="p">,</span> <span class="n">group_into_bins</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">from</span> <span class="nn">..helpers.validation</span> <span class="kn">import</span> <span class="n">validate_args</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="k">def</span> <span class="nf">_set_style</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">attribs</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">],</span> <span class="n">attr</span><span class="p">))</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="c1"># Lace (Batch)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="c1">#     parallel_polyline_list (list)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="c1">#         parallel_polyline1 (ParallelPolyline-Batch-PARALLELPOLYLINE)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="c1">#             polyline_list (list)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="c1">#             |    polyline1 (Polyline-Shape)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="c1">#             |        divisions (list)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="c1">#             |            division1 (Division-Shape)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="c1">#             |                p1 (tuple)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="c1">#             |                p2 (tuple)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="c1">#             |                sections (list)</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="c1">#             |                    section1(Section-Shape)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="c1">#             |                        p1 (tuple)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="c1">#             |                        p2</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="c1">#             |                        is_overlap (bool)</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="c1">#             |                        overlap (Overlap-Batch)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="c1">#             |overlaps (list)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="c1">#             |   overlap1(Overlap-Batch)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="c1">#             |       divisions (list)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="c1">#             |           division1(Division-Shape)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="c1">#             |               p1 (tuple)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="c1">#             |               p2 (tuple)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="c1">#             |               sections (list)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="c1">#             |                   section1(Section-Shape)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="c1">#             |                       start (Intersection-Shape)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="c1">#             |                       end (Intersection-Shape)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="c1">#             |                       overlap</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="c1">#             |</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="c1">#             |</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="c1">#             |fragments</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="c1">#                 fragment1(Shape)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="c1">#                     divisions</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="c1">#                         division1(Shape)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="c1">#                             p1</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="c1">#                             p2</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="c1">#                             sections</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="c1">#                                 section1</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="c1">#             plaits (list)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="c1">#                 plait1 (Plait-Shape)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="c1"># All objects in this module is a subclass of the Shape or Batch class.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="c1"># They are used to compute the interlacing patterns.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="c1">#  Example of a Lace object.</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="c1">#     /\</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="c1">#    //\\ /\</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="c1">#   //  \//\\</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="c1">#  //   /\\ \\</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="c1"># //   // \\ \\</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="c1"># \\   \\ //  //</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="c1">#  \\   \//  //</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="c1">#   \\  //\\//</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="c1">#    \\//  \/</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="c1">#     \/</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="c1"># Example of a ParallelPolylines object. The lace object above has two</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="c1"># ParallelPolylines objects. Main polylines are not shown, they are</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="c1"># located in the middle of the offset polylines.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="c1">#         /\</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="c1">#        //\\</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="c1">#       //  \\</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="c1">#      //    \\</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="c1">#      \\    //</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="c1">#       \\  //</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="c1">#        \\//</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="c1">#         \/</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="c1"># Example of a Fragment object.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="c1"># They are polygons or polylines.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="c1"># The lace object above has three fragments.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="c1"># This is the middle fragment.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="c1">#         /\</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="c1">#        /  \</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="c1">#        \  /</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="c1">#         \/</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="c1"># Example of a plait object. They are polylines.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="c1"># Used for drawing under/over interlacing.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="c1">#         /\</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="c1">#         \ \</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="c1">#          \ \</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="c1">#          / /</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="c1">#         / /</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="c1">#         \/</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="c1"># Example of an Overlap object.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="c1"># The lace object above has two overlap regions.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="c1">#         /\</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="c1">#         \/</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="c1"># Example of a Polyline object.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="c1">#          /\</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="c1">#         /  \</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="c1">#        /    \</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="c1">#       /      \</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="c1">#      /        \</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="c1">#      \        /</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="c1">#       \      /</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="c1">#        \    /</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="c1">#         \  /</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="c1">#          \/</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="c1"># Example of an Division object.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="c1"># Each polyline is made up of one or more &quot;Division&quot; objects.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="c1"># Each division is divided into sections</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="c1"># Maybe &quot;Divisions&quot; would be a better name instead of &quot;Division&quot;?</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="c1">#            *</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="c1">#             \</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="c1">#              *</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="c1">#               \</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="c1">#                *</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="c1">#                 \</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="c1">#                  *</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="c1"># Example of a Section object.</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="c1"># Each division is made up of one or more sections.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="c1"># Sections have intersection points at their ends.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="c1">#                 *</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="c1">#                  \</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="c1">#                   *</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="c1"># * intersections have a point, division1, division2 attributes.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="c1"># &quot;&quot;&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="k">class</span> <span class="nc">Intersection</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Intersection of two divisions. They are at the endpoints of Section</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">    objects. A division can have multiple sections and multiple</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">    intersections. They can be located at the end of a division.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">    Args:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        point (tuple): (x, y) coordinates of the intersection point.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        division1 (Division): First division.</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">        division2 (Division, optional): Second division. Defaults to None.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">        endpoint (bool, optional): If the intersection is at the end of a division, then endpoint is True. Defaults to False.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">division1</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">,</span> <span class="n">division2</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">point</span><span class="p">],</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">INTERSECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division1</span> <span class="o">=</span> <span class="n">division1</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division2</span> <span class="o">=</span> <span class="n">division2</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions&#39; DCEL structure</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">:</span> <span class="n">array</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the intersection.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        Args:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        Returns:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">            Any: Updated intersection or list of updated intersections.</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the intersection.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        Returns:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">            Intersection: A copy of the intersection.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="n">intersection</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division2</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>        <span class="n">custom_attribs</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attribs</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="k">return</span> <span class="n">intersection</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>    <span class="nd">@property</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersection point.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        Returns:</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">            list: Intersection point coordinates.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_point</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the intersection.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">        Returns:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>            <span class="sa">f</span><span class="s2">&quot;Intersection(</span><span class="si">{</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;n_round&#39;</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">division1</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">division2</span><span class="p">]))</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the intersection.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">        Returns:</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two intersections are equal.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">        Args:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">            other (Intersection): Another intersection.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        Returns:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">            bool: True if equal, False otherwise.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="k">return</span> <span class="n">close_points2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="k">class</span> <span class="nc">Partition</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;These are the polygons of the non-interlaced geometry.</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">    Fragments and partitions are scaled versions of each other.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">    Args:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">        points (list): List of points defining the partition.</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PART</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the partition.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">        Returns:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Part(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the partition.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">        Returns:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="k">class</span> <span class="nc">Fragment</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Fragment is a collection of section objects that are connected</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">    to each other. These sections are already defined. They belong to</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">    the polyline objects in a lace. Fragments can be open or closed.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">    They are created by the lace object.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">    Args:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        points (list): List of points defining the fragment.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the fragment.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">        Returns:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Fragment(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the fragment.</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        Returns:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>    <span class="nd">@property</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the fragment.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        Returns:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>    <span class="nd">@property</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the fragment.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">        Returns:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CG</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>    <span class="k">def</span> <span class="nf">_set_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>        <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>  <span class="c1"># squared distance tolerance</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="n">d_points__section</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>            <span class="n">d_points__section</span><span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>            <span class="n">d_points__section</span><span class="p">[(</span><span class="n">end</span><span class="p">,</span> <span class="n">start</span><span class="p">)]</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="n">coord_pairs</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">coord_pairs</span><span class="p">:</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="n">division</span> <span class="o">=</span> <span class="n">Division</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">d_points__section</span><span class="p">[((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>            <span class="n">start_point</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>            <span class="n">end_point</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>            <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>            <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Division does not match section&quot;</span><span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">):</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>    <span class="k">def</span> <span class="nf">_set_twin_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>            <span class="n">section</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span> <span class="ow">and</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span><span class="p">:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>                <span class="n">twin_fragment</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>                <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">division2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twin_fragment</span><span class="o">.</span><span class="n">divisions</span><span class="p">):</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>                    <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>                        <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">mid_point</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">mid_point</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>                    <span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>                    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">dist</span><span class="p">,</span> <span class="n">division2</span><span class="p">))</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>                <span class="n">distances</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A section is a line segment between two intersections.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">    A division can have multiple sections. Sections are used to</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">    draw the over/under plaits.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">    Args:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">        start (Intersection): Start intersection.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">        end (Intersection): End intersection.</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">        is_overlap (bool, optional): If the section is an overlap. Defaults to False.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">        overlap (Overlap, optional): Overlap object. Defaults to None.</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        is_over (bool, optional): If the section is over. Defaults to False.</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        twin (Section, optional): Twin section. Defaults to None.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">        fragment (Fragment, optional): Fragment object. Defaults to None.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="n">start</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="n">end</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="n">is_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="n">overlap</span><span class="p">:</span> <span class="s2">&quot;Overlap&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="n">is_over</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="s2">&quot;Section&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">fragment</span><span class="p">:</span> <span class="s2">&quot;Fragment&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>    <span class="p">):</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="n">is_overlap</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="n">is_over</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid_point</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="p">]</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the section.</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a><span class="sd">        Returns:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">            Section: A copy of the section.</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">return</span> <span class="n">section</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>    <span class="k">def</span> <span class="nf">end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end point of the section.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        Returns:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the section.</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="sd">        Returns:</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Section(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the section.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="sd">        Returns:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>    <span class="nd">@property</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>    <span class="k">def</span> <span class="nf">is_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the section is an endpoint.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        Returns:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">            bool: True if endpoint, False otherwise.</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="k">class</span> <span class="nc">Overlap</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An overlap is a collection of four connected sections.</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">    Args:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">        intersections (list[Intersection], optional): List of intersections. Defaults to None.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">        sections (list[Section], optional): List of sections. Defaults to None.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">        visited (bool, optional): If the overlap is visited. Defaults to False.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        drawable (bool, optional): If the overlap is drawable. Defaults to True.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="n">intersections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="n">sections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Section</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="n">visited</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="n">drawable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>    <span class="p">):</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">OVERLAP</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="n">visited</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawable</span> <span class="o">=</span> <span class="n">drawable</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the overlap.</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">        Returns:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Overlap(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the overlap.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">        Returns:</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Overlap(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="k">class</span> <span class="nc">Division</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A division is a line segment between two intersections.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">    Args:</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        p1 (tuple): Start point.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        p2 (tuple): End point.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        xform_matrix (array, optional): Transformation matrix. Defaults to None.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the division.</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">        Args:</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">        Returns:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a><span class="sd">            Any: Updated division or list of updated divisions.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the division.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        Returns:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>            <span class="sa">f</span><span class="s2">&quot;Division((</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">), &quot;</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="p">)</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the division.</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">        Returns:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="sa">f</span><span class="s2">&quot;Division((</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">), &quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="n">section</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>    <span class="p">):</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the division.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">        Args:</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">            section (Section, optional): Section object. Defaults to None.</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">            twin (Section, optional): Twin section. Defaults to None.</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">        Returns:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">            Division: A copy of the division.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>        <span class="n">division</span> <span class="o">=</span> <span class="n">Division</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[:],</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">))</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">]</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>        <span class="n">custom_attributes_</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attributes_</span><span class="p">:</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="k">return</span> <span class="n">division</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>    <span class="k">def</span> <span class="nf">_merged_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge sections of the division.</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        Returns:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">            list: List of merged sections.</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>        <span class="n">chains</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>        <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="n">sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[:]</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">is_over</span><span class="p">:</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">chain</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>                    <span class="n">chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>                    <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>                    <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">if</span> <span class="n">chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="k">return</span> <span class="n">chains</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>    <span class="k">def</span> <span class="nf">_sort_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort intersections of the division.&quot;&quot;&quot;</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">point</span><span class="p">))</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the division is connected to another division.</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">        Args:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">            other (Division): Another division.</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        Returns:</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">            bool: True if connected, False otherwise.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>    <span class="nd">@property</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>    <span class="k">def</span> <span class="nf">end_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end points of the division.</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">        Returns:</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">            list: List of end points.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>    <span class="nd">@property</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the start intersection of the division.</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">        Returns:</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">            Intersection: Start intersection.</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>    <span class="nd">@property</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end intersection of the division.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">        Returns:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="k">class</span> <span class="nc">Polyline</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">    Connected points, similar to Shape objects.</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="sd">    They can be closed or open.</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">    They are defined by a sequence of points.</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">    They have divisions, sections, and intersections.</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">    Args:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">        points (list): List of points defining the polyline.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">        closed (bool, optional): If the polyline is closed. Defaults to True.</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">        xform_matrix (array, optional): Transformation matrix. Defaults to None.</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ShapeStyle</span><span class="p">()</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_style_map&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_style_map</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_aliases</span><span class="p">()</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">POLYLINE</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_divisions</span><span class="p">()</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the polyline.</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">        Args:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">        Returns:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">            Any: Updated polyline or list of updated polylines.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">reps</span><span class="p">)</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the polyline.</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        Returns:</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Polyline(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_coords</span><span class="p">[:,</span><span class="w"> </span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the polyline.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">        Returns:</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">            str: String representation.</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>    <span class="k">def</span> <span class="nf">iter_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the sections of the polyline.</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">        Yields:</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">            Section: Section object.</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>    <span class="k">def</span> <span class="nf">iter_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the intersections of the polyline.</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">        Yields:</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>    <span class="nd">@property</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersections of the polyline.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">        Returns:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>    <span class="nd">@property</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the area of the polygon.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        Returns:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">            float: Area of the polygon.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>        <span class="k">return</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="nd">@property</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the polyline.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        Returns:</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">            list: List of sections.</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            <span class="n">sections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="k">return</span> <span class="n">sections</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="nd">@property</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the polyline.</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">        Returns:</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;divisions&quot;</span><span class="p">]</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>    <span class="k">def</span> <span class="nf">_set_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>        <span class="n">pairs</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">Division</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;divisions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divisions</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>    <span class="k">def</span> <span class="nf">_set_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fake intersections for open lines.&quot;&quot;&quot;</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>        <span class="n">division1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="n">division2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">division1</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>        <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">]</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">division2</span><span class="o">.</span><span class="n">p2</span><span class="p">,</span> <span class="n">division2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>        <span class="k">if</span> <span class="n">division1</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>            <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>            <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x2</span><span class="p">]</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="k">class</span> <span class="nc">ParallelPolyline</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A ParallelPolylines is a collection of parallel Polylines.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">    They are defined by a main polyline and a list of offset</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">    values (that can be negative or positive).</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">    Args:</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">        polyline (Polyline): Main polyline.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        offset (float): Offset value.</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">        lace (Lace): Lace object.</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        under (bool, optional): If the polyline is under. Defaults to False.</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        closed (bool, optional): If the polyline is closed. Defaults to True.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="n">polyline</span><span class="p">,</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="n">offset</span><span class="p">,</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="n">lace</span><span class="p">,</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>        <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>        <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>    <span class="p">):</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>        <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span> <span class="o">=</span> <span class="n">polyline</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol</span> <span class="o">=</span> <span class="n">dist_tol</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol2</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_offset_polylines</span><span class="p">()</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PARALLEL_POLYLINE</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">under</span> <span class="o">=</span> <span class="n">under</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="nd">@property</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Section</span><span class="p">]:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the parallel polyline.</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">        Returns:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">            list: List of sections.</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="n">sects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>            <span class="n">sects</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">return</span> <span class="n">sects</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>    <span class="k">def</span> <span class="nf">_set_offset_polylines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">polyline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>            <span class="n">offset_polygons</span> <span class="o">=</span> <span class="n">double_offset_polygons</span><span class="p">(</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                <span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_tol</span><span class="p">)</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>            <span class="n">offset_polylines</span> <span class="o">=</span> <span class="n">double_offset_polylines</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">polylines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">offset_polygons</span><span class="p">:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>                <span class="n">polylines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">))</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">offset_polylines</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                <span class="n">polylines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polyline</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">))</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_poly_list</span> <span class="o">=</span> <span class="n">polylines</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="k">class</span> <span class="nc">Lace</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">    A Lace is a collection of ParallelPolylines objects.</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">    They are used to create interlace patterns.</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">    Args:</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">        polygon_shapes (Union[Batch, list[Shape]], optional): List of polygon shapes. Defaults to None.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">        polyline_shapes (Union[Batch, list[Shape]], optional): List of polyline shapes. Defaults to None.</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        offset (float, optional): Offset value. Defaults to 2.</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">        swatch (list, optional): Swatch list. Defaults to None.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        breakpoints (list, optional): Breakpoints list. Defaults to None.</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">        plait_color (colors.Color, optional): Plait color. Defaults to None.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        draw_fragments (bool, optional): If fragments should be drawn. Defaults to True.</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">        palette (list, optional): Palette list. Defaults to None.</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">        color_step (int, optional): Color step. Defaults to 1.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">        with_plaits (bool, optional): If plaits should be included. Defaults to True.</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        area_threshold (float, optional): Area threshold. Defaults to None.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        radius_threshold (float, optional): Radius threshold. Defaults to None.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>    <span class="c1"># @timing</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="n">polygon_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="n">polyline_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="n">swatch</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="n">breakpoints</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>        <span class="n">plait_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="n">draw_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="n">palette</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>        <span class="n">color_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="n">with_plaits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="n">area_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="n">radius_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="n">validate_args</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">shape_style_map</span><span class="p">)</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="p">(</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>            <span class="n">rtol</span><span class="p">,</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>            <span class="n">swatch</span><span class="p">,</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>            <span class="n">plait_color</span><span class="p">,</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>            <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>            <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>            <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="p">[</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                <span class="s2">&quot;rtol&quot;</span><span class="p">,</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>                <span class="s2">&quot;swatch&quot;</span><span class="p">,</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>                <span class="s2">&quot;plait_color&quot;</span><span class="p">,</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>                <span class="s2">&quot;draw_fragments&quot;</span><span class="p">,</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>                <span class="s2">&quot;area_threshold&quot;</span><span class="p">,</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>                <span class="s2">&quot;radius_threshold&quot;</span><span class="p">,</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>            <span class="p">],</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>            <span class="p">[</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>                <span class="n">rtol</span><span class="p">,</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>                <span class="n">swatch</span><span class="p">,</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>                <span class="n">plait_color</span><span class="p">,</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>                <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>                <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>                <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="p">],</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>        <span class="p">)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="k">if</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="n">polygon_shapes</span> <span class="o">=</span> <span class="n">polygon_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polygons</span><span class="p">(</span><span class="n">polygon_shapes</span><span class="p">)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="k">if</span> <span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>            <span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polylines</span><span class="p">(</span><span class="n">polyline_shapes</span><span class="p">)</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ : No polygons or polylines found.&quot;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span> <span class="o">=</span> <span class="n">rtol</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swatch</span> <span class="o">=</span> <span class="n">swatch</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span> <span class="o">=</span> <span class="n">breakpoints</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plait_color</span> <span class="o">=</span> <span class="n">plait_color</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="n">draw_fragments</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">color_step</span> <span class="o">=</span> <span class="n">color_step</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span> <span class="o">=</span> <span class="n">with_plaits</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># key, value:intersection.id, intersection</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span> <span class="o">=</span> <span class="n">area_threshold</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span> <span class="o">=</span> <span class="n">radius_threshold</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>            <span class="c1"># pass the pre-computed values</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;_copy&quot;</span><span class="p">:</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>                    <span class="k">continue</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_polyline_list</span><span class="p">()</span>  <span class="c1"># main divisions are set here along with polylines</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="c1"># polyline.divisions is the list of Division objects</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_parallel_poly_list</span><span class="p">()</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>            <span class="c1"># start_time2 = time.perf_counter()</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>            <span class="c1"># end_time2 = time.perf_counter()</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>            <span class="c1"># print(</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>            <span class="c1">#     f&quot;Lace.__init__ intersections computed in {end_time2 - start_time2:0.4f} seconds&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="c1"># )</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_overlaps</span><span class="p">()</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_twin_sections</span><span class="p">()</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_fragments</span><span class="p">()</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_set_outline</span><span class="p">()</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>            <span class="c1"># self._set_partitions()</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_over_under</span><span class="p">()</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span><span class="p">:</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_plaits</span><span class="p">()</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>            <span class="c1"># self._set_convex_hull()</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>            <span class="c1"># self._set_concave_hull()</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>            <span class="c1"># self._set_fragment_groups()</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>            <span class="c1"># self._set_partition_groups()</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_b_box</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">polyline</span> <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="k">if</span> <span class="s2">&quot;debug&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># todo: we should check for valid values here</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">. Invalid attribute!&quot;</span><span class="p">)</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">LACE</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>    <span class="nd">@property</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the lace.</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        Returns:</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">CG</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>    <span class="nd">@property</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="k">def</span> <span class="nf">fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the fragment groups of the lace.</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">        Returns:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a><span class="sd">            dict: Dictionary of fragment groups.</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">radius_frag</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">))</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="k">for</span> <span class="n">rad</span><span class="p">,</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">radius_frag</span><span class="p">:</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span> <span class="o">-</span> <span class="n">rad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">rad</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>                    <span class="k">break</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">radius_frag</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">))</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">radius_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="n">d_groups</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radius_frag</span><span class="p">):</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">d_groups</span><span class="p">:</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>        <span class="k">return</span> <span class="n">d_groups</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>    <span class="k">def</span> <span class="nf">_check_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon_shapes</span><span class="p">):</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polygon_shapes</span><span class="p">,</span> <span class="n">Batch</span><span class="p">):</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>            <span class="n">polygon_shapes</span> <span class="o">=</span> <span class="n">polygon_shapes</span><span class="o">.</span><span class="n">all_shapes</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ found polygon with less than 3 points.&quot;</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">polygon</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ : Invalid polygons&quot;</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>            <span class="k">if</span> <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>        <span class="c1"># check if the polygons are clockwise</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">):</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="k">return</span> <span class="n">polygon_shapes</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>    <span class="k">def</span> <span class="nf">_check_polylines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polyline_shapes</span><span class="p">):</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polyline_shapes</span><span class="p">,</span> <span class="n">Batch</span><span class="p">):</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>            <span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span><span class="o">.</span><span class="n">all_shapes</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">primary_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ found polyline with less than 2 points.&quot;</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="k">return</span> <span class="n">polyline_shapes</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the lace.</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">        Args:</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">        Returns:</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">            Any: Updated lace or list of updated laces.</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>                <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                    <span class="n">polyline</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>                <span class="n">polyline</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>            <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>                <span class="n">fragment</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span><span class="p">:</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>                <span class="n">intersection</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span><span class="p">:</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>                <span class="n">intersection</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>            <span class="k">for</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="p">:</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>                <span class="n">overlap</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>            <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>                <span class="n">plait</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>    <span class="k">def</span> <span class="nf">_set_twin_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="k">for</span> <span class="n">par_poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>            <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">par_poly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">iter_sections</span><span class="p">()):</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>                <span class="n">sec1</span> <span class="o">=</span> <span class="n">sec</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>                <span class="n">sec2</span> <span class="o">=</span> <span class="n">poly2</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>                <span class="n">sec1</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">sec2</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>                <span class="n">sec2</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">sec1</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>    <span class="k">def</span> <span class="nf">_set_partitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>            <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>                <span class="n">partition</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_polygon</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>    <span class="c1"># To do: This doesn&#39;t work if we have polyline shapes!</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>    <span class="k">def</span> <span class="nf">_set_outline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="c1"># outline is a special fragment that covers the whole lace</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fragment</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">fragment</span><span class="p">))</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="p">)</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="c1"># perimenter is the outline of the partitions</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">perimeter</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>        <span class="c1"># skeleton is the input polylines that the lace is based on</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>    <span class="k">def</span> <span class="nf">set_fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>        <span class="c1"># to do : handle repeated code. same in _set_partition_groups</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fragment</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span><span class="p">)</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="n">area_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>                <span class="k">if</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">area_values</span><span class="p">:</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>            <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="n">radii</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span><span class="p">)</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>            <span class="n">radius_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>            <span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radius_values</span><span class="p">:</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>    <span class="k">def</span> <span class="nf">_set_partition_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="c1"># to do : handle repeated code. same in set_fragment_groups</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">partition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">):</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">partition</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span><span class="p">)</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_area</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bin_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>            <span class="n">area_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">]</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_</span><span class="p">)</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>            <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>                <span class="k">if</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">area_values</span><span class="p">:</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>                    <span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_area</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitions</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">partition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">):</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>            <span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_center</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>            <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">CG</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>        <span class="n">radii</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_radius</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bin_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>            <span class="n">radius_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">]</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_</span><span class="p">)</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>            <span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radius_values</span><span class="p">:</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>                    <span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_radius</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitions</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>    <span class="k">def</span> <span class="nf">_set_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>                <span class="k">continue</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="n">d_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>            <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="n">cycle</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>            <span class="n">edges</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>            <span class="n">s_intersections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s_intersections</span><span class="p">]</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_x</span><span class="p">[</span><span class="n">x_id</span><span class="p">]</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x_id</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>            <span class="n">fragment</span> <span class="o">=</span> <span class="n">Fragment</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">_set_divisions</span><span class="p">()</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">_set_twin_divisions</span><span class="p">()</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>    <span class="k">def</span> <span class="nf">_set_concave_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">concave_hull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>    <span class="k">def</span> <span class="nf">_set_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">convex_hull</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>        <span class="k">class</span> <span class="nc">Dummy</span><span class="p">(</span><span class="n">Lace</span><span class="p">):</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>            <span class="k">pass</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="c1"># we need to copy the polyline_list and parallel_poly_list</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>            <span class="n">polyline</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>    <span class="k">def</span> <span class="nf">get_sketch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="sd">        Create and return a Sketch object. Sketch is a Batch object</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">        with Shape elements corresponding to the vertices of the plaits</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">        and fragments of the Lace instance. They have &#39;plaits&#39; and</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a><span class="sd">        &#39;fragments&#39; attributes to hold lists of Shape objects populated</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">        with plait and fragment vertices of the Lace instance</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a><span class="sd">        respectively. They are used for drawing multiple copies of the</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="sd">        original lace pattern. They are light-weight compared to the</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a><span class="sd">        Lace objects since they only contain sufficient data to draw the</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a><span class="sd">        lace objects. Hundreds of these objects can be used to create</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">        wallpaper patterns or other patterns without having to contain</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a><span class="sd">        unnecessary data. They do not share points with the original</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="sd">        Lace object.</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">        ----------</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">            None</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a><span class="sd">        --------------</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a><span class="sd">            * A lace object to be copied.</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a><span class="sd">        Side effects:</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a><span class="sd">        -------------</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a><span class="sd">            None</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="sd">        Return:</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">        --------</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="sd">            A Sketch object.</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">plait</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>        <span class="n">sketch</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">((</span><span class="n">fragments</span> <span class="o">+</span> <span class="n">plaits</span><span class="p">))</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="n">plaits</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">SKETCH</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_plaits</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="k">return</span> <span class="n">sketch</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>    <span class="k">def</span> <span class="nf">group_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Group the fragments by the number of vertices and the area.</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">        Args:</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">            tol (float, optional): Tolerance value. Defaults to None.</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">        Returns:</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="sd">            list: List of grouped fragments.</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="k">if</span> <span class="n">tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>            <span class="n">tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;tol&quot;</span><span class="p">]</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>        <span class="n">frags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>        <span class="n">vert_groups</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>            <span class="p">[</span><span class="n">frag</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">]</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">])</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>        <span class="p">]</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">vert_groups</span><span class="p">:</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>            <span class="n">areas</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>                <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">group</span> <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)]</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>                <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">frag</span><span class="o">.</span><span class="n">area</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">group</span><span class="p">])</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>            <span class="p">]</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>        <span class="n">groups</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>    <span class="k">def</span> <span class="nf">get_fragment_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">        Iterate over the offset sections and create a graph of the</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">        intersections (start and end of the sections). Then find the</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        cycles in the graph. self.d_intersections is used to map</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">        the graph nodes to the actual intersection points.</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        Returns:</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">            list: List of fragment cycles.</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>                <span class="k">continue</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>            <span class="n">graph_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>        <span class="k">return</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>    <span class="k">def</span> <span class="nf">_set_inner_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>            <span class="n">offset_poly</span> <span class="o">=</span> <span class="n">offset_polygon_points</span><span class="p">(</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>                <span class="n">vertices</span><span class="p">,</span> <span class="n">offset</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dist_tol</span><span class="o">=</span><span class="n">dist_tol</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>            <span class="p">)</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_poly</span><span class="p">)</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">line_width</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">line_color</span> <span class="o">=</span> <span class="n">line_color</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">inner_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>    <span class="k">def</span> <span class="nf">set_plait_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create offset lines inside the plaits of the lace.</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">        Args:</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>            <span class="n">plait</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">plait</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>    <span class="k">def</span> <span class="nf">set_fragment_lines</span><span class="p">(</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>        <span class="n">line_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>        <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="sd">        Create offset lines inside the fragments of the lace.</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">        Args:</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>    <span class="nd">@property</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>    <span class="k">def</span> <span class="nf">all_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">        Return a list of all the divisions (both main and offset) in the lace.</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">        Returns:</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">            list: List of all divisions.</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>    <span class="k">def</span> <span class="nf">iter_main_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main intersections.</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">        Yields:</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>    <span class="k">def</span> <span class="nf">iter_offset_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a><span class="sd">        Iterate over the offset intersections.</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a><span class="sd">        Yields:</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>    <span class="k">def</span> <span class="nf">iter_offset_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a><span class="sd">        Iterate over the offset sections.</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a><span class="sd">        Yields:</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="sd">            Section: Section object.</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>    <span class="k">def</span> <span class="nf">iter_main_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main sections.</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a><span class="sd">        Yields:</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">            Section: Section object.</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>    <span class="k">def</span> <span class="nf">iter_offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">        Iterate over the offset divisions.</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">        Yields:</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="sd">            Division: Division object.</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>                <span class="k">yield from</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>    <span class="k">def</span> <span class="nf">iter_main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        Iterate over the main divisions.</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">        Yields:</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">            Division: Division object.</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>            <span class="k">yield from</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>    <span class="nd">@property</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>    <span class="k">def</span> <span class="nf">main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Main divisions are the divisions of the main polyline.</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a><span class="sd">        Returns:</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a><span class="sd">            list: List of main divisions.</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>    <span class="nd">@property</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>    <span class="k">def</span> <span class="nf">offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Offset divisions are the divisions of the offset polylines.</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">        Returns:</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a><span class="sd">            list: List of offset divisions.</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>    <span class="nd">@property</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all the intersections in the parallel_poly_list.</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="sd">        Returns:</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>    <span class="k">def</span> <span class="nf">_set_polyline_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">        Populate the self.polyline_list list with Polyline objects.</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a><span class="sd">        * Internal use only.</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a><span class="sd">        ----------</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a><span class="sd">            None</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">        Return:</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">        --------</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">            None</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">        --------------</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">            * self.polygon_shapes and/or self.polyline_shapes must be</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="sd">              established.</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>    <span class="k">def</span> <span class="nf">_set_parallel_poly_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">        Populate the self.parallel_poly_list list with ParallelPolyline</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a><span class="sd">        objects.</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">        ----------</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">            None</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a><span class="sd">        Return:</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">        --------</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a><span class="sd">            None</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a><span class="sd">        --------------</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a><span class="sd">            * self.polygon_shapes and/or self.polyline_shapes must be</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a><span class="sd">              established prior to this.</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a><span class="sd">            * Parallel polylines are created by offsetting the original</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a><span class="sd">              polygon and polyline shapes in two directions using the</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a><span class="sd">              self.offset value.</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a><span class="sd">        Notes:</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a><span class="sd">        ------</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a><span class="sd">            object cannot be created.</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">):</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>                    <span class="n">ParallelPolyline</span><span class="p">(</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>                        <span class="n">polyline</span><span class="p">,</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>                        <span class="n">lace</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>                        <span class="n">closed</span><span class="o">=</span><span class="n">polyline</span><span class="o">.</span><span class="n">closed</span><span class="p">,</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>                        <span class="n">dist_tol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>                    <span class="p">)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>                <span class="p">)</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>    <span class="k">def</span> <span class="nf">_set_overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a><span class="sd">        Populate the self.overlaps list with Overlap objects. Side</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a><span class="sd">        effects listed below.</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a><span class="sd">        ----------</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a><span class="sd">            None</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a><span class="sd">        Return:</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a><span class="sd">        --------</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a><span class="sd">            None</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">        Side Effects:</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">        -------------</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">            * self.overlaps is populated with Overlap objects.</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">            * Section objects&#39; overlap attribute is populated with the</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">              corresponding Overlap object that they are a part of. Not</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a><span class="sd">              all sections will have an overlap.</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a><span class="sd">        --------------</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a><span class="sd">            self.polyline and self.parallel_poly_list must be populated.</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a><span class="sd">            self.main_intersections, self.offset_sections and</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a><span class="sd">            self.d_intersections must be populated prior to creating</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a><span class="sd">            the overlaps.</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a><span class="sd">        Notes:</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a><span class="sd">        ------</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a><span class="sd">            for users to call directly.</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="sd">            Without this method, the Lace object cannot be created.</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>                <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>            <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>            <span class="n">edges</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>            <span class="n">s_intersections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s_intersections</span><span class="p">]</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">Overlap</span><span class="p">(</span><span class="n">intersections</span><span class="o">=</span><span class="n">intersections</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="n">sections</span><span class="p">)</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>        <span class="k">for</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="p">:</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">overlap</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_over</span><span class="p">:</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>                    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>                    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>                    <span class="p">[</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">line_width</span><span class="o">=</span><span class="n">line_width</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>                <span class="p">)</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_divisions</span><span class="p">:</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>            <span class="n">p1</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>            <span class="n">p2</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>    <span class="k">def</span> <span class="nf">set_plaits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a><span class="sd">        Populate the self.plaits list with Plait objects. Plaits are</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a><span class="sd">        optional for drawing. They form the under/over interlacing. They</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a><span class="sd">        are created if the &quot;with_plaits&quot; argument is set to be True in</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a><span class="sd">        the constructor. with_plaits is True by default but this can be</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a><span class="sd">        changed by setting the auto_plaits value to False in the</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a><span class="sd">        settings.py This method can be called by the user to create the</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a><span class="sd">        plaits after the creation of the Lace object if they were not</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="sd">        created initally.</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">        * Can be called by users.</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a><span class="sd">        ----------</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a><span class="sd">            None</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a><span class="sd">        Return:</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a><span class="sd">        --------</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a><span class="sd">            None</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a><span class="sd">        Side Effects:</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a><span class="sd">        -------------</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a><span class="sd">            * self.plaits is populated with Plait objects.</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">        --------------</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a><span class="sd">            self.polyline and self.parallel_poly_list must be populated.</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a><span class="sd">            self.divisions and self.intersections must be populated.</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">            self.overlaps must be populated.</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">        Where used:</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">        -----------</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a><span class="sd">            Lace.__init__</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">        Notes:</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">        ------</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">            object cannot be created.</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>            <span class="k">return</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>        <span class="n">plait_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_divisions</span><span class="p">():</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>            <span class="n">merged_sections</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">_merged_sections</span><span class="p">()</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>            <span class="k">for</span> <span class="n">merged</span> <span class="ow">in</span> <span class="n">merged_sections</span><span class="p">:</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">merged</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>        <span class="c1"># connect the open ends of the polyline_shapes</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>                <span class="n">polyline1</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>                <span class="n">polyline2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>                <span class="n">p1_start_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>                <span class="n">p1_end_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>                <span class="n">p2_start_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>                <span class="n">p2_end_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_start_x</span><span class="p">,</span> <span class="n">p2_start_x</span><span class="p">))</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_end_x</span><span class="p">,</span> <span class="n">p2_end_x</span><span class="p">))</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_over</span> <span class="ow">and</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sec</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">sec</span><span class="o">.</span><span class="n">end</span><span class="p">))</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">plait_sections</span><span class="p">]</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>            <span class="n">cycle</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>            <span class="n">dup</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>            <span class="n">plait</span> <span class="o">=</span> <span class="p">[</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>                <span class="n">last</span> <span class="o">=</span> <span class="n">plait</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>                <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">dup</span><span class="p">:</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>                        <span class="k">break</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>                        <span class="k">break</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plait</span><span class="p">)</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>        <span class="n">d_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="n">plaits</span><span class="p">:</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_x</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plait</span><span class="p">]</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intersections</span><span class="p">]</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>                <span class="n">vertices</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>                <span class="n">plait</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">gold</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>    <span class="k">def</span> <span class="nf">_set_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a><span class="sd">        Compute all intersection points (by calling all_intersections)</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a><span class="sd">        among the divisions of the polylines (both main and offset).</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a><span class="sd">        Populate the self.main_intersections and</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a><span class="sd">        self.offset_intersections lists with Intersection objects. This</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a><span class="sd">        method is called by the Lace constructor and customized to be</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a><span class="sd">        used with Lace objects only. Without this method, the Lace</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a><span class="sd">        object cannot be created.</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a><span class="sd">        * Internal use only!</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a><span class="sd">        Arguments:</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a><span class="sd">        ----------</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">            None</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a><span class="sd">        Return:</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a><span class="sd">        --------</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a><span class="sd">            None</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a><span class="sd">        Side Effects:</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="sd">        -------------</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a><span class="sd">            * self.main_intersections are populated.</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">            * self.offset_intersections are populated.</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">            * &quot;sections&quot; attribute of the divisions are populated.</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a><span class="sd">            * &quot;is_overlap&quot; attribute of the sections are populated.</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="sd">            * &quot;intersections&quot; attribute of the divisions are populated.</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">            * &quot;endpoint&quot; attribute of the intersections are populated.</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a><span class="sd">        Where used:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">        -----------</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a><span class="sd">            Lace.__init__</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a><span class="sd">        Prerequisites:</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a><span class="sd">        --------------</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a><span class="sd">            * self.main_divisions must be populated.</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="sd">            * self.offset_divisions must be populated.</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a><span class="sd">            * Two endpoint intersections of the divisions must be set.</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a><span class="sd">        Notes:</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a><span class="sd">        ------</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a><span class="sd">            object cannot be created.</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">            Works only for regular under/over interlacing.</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>        <span class="c1"># set intersections for the main polylines</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>        <span class="n">main_divisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_divisions</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>        <span class="n">offset_divisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_divisions</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">(</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>            <span class="n">main_divisions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>        <span class="p">)</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>        <span class="c1"># set sections for the main divisions</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">main_divisions</span><span class="p">:</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>            <span class="n">segments</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">segment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">segments</span><span class="p">):</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">)</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>                    <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>        <span class="c1"># set intersections for the offset polylines</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">(</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>            <span class="n">offset_divisions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>        <span class="p">)</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>        <span class="c1"># set sections for the offset divisions</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">offset_divisions</span><span class="p">):</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>                <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>                    <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">offset_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>    <span class="k">def</span> <span class="nf">_all_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polylines</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of polygons from a list of lists of points.</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a><span class="sd">        polylines: [[(x1, y1), (x2, y2)], [(x3, y3), (x4, y4)], ...]</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a><span class="sd">        return [[(x1, y1), (x2, y2), (x3, y3), ...], ...]</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a><span class="sd">        Args:</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a><span class="sd">            polylines (list): List of lists of points.</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a><span class="sd">            rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a><span class="sd">        Returns:</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a><span class="sd">            list: List of polygons.</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="k">if</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>            <span class="n">rtol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>        <span class="k">return</span> <span class="n">get_polygons</span><span class="p">(</span><span class="n">polylines</span><span class="p">,</span> <span class="n">rtol</span><span class="p">)</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>    <span class="c1"># @timing</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>    <span class="k">def</span> <span class="nf">_set_over_under</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>        <span class="k">def</span> <span class="nf">next_poly</span><span class="p">(</span><span class="n">exclude</span><span class="p">):</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>            <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>                <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>                <span class="k">if</span> <span class="n">poly1</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">:</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>                    <span class="k">continue</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>                <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">poly1</span><span class="o">.</span><span class="n">iter_sections</span><span class="p">():</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>                    <span class="k">if</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>                        <span class="k">if</span> <span class="n">sec</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span> <span class="ow">and</span> <span class="n">sec</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">visited</span><span class="p">:</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>                            <span class="n">even_odd</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>                            <span class="k">return</span> <span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">,</span> <span class="n">even_odd</span><span class="p">)</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>                        <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>            <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a>            <span class="n">exclude</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a>            <span class="n">even_odd</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a>            <span class="k">while</span> <span class="n">poly1</span><span class="p">:</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">divisions</span><span class="p">):</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>                        <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>                            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">overlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>                                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a>                                    <span class="s2">&quot;Overlap section in the lace has no &quot;</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>                                    <span class="s2">&quot;overlap object.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>                                    <span class="s2">&quot;Try different offset value and/or &quot;</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>                                    <span class="s2">&quot;tolerance.&quot;</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>                                <span class="p">)</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>                                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>                            <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>                            <span class="k">if</span> <span class="n">ind</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">even_odd</span><span class="p">:</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>                                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span><span class="p">:</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>                                    <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>                                    <span class="n">section</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>                                    <span class="n">section2</span> <span class="o">=</span> <span class="n">poly2</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>                                    <span class="n">section2</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>                <span class="n">exclude</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">])</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>                <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">,</span> <span class="n">even_odd</span> <span class="o">=</span> <span class="n">next_poly</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>    <span class="k">def</span> <span class="nf">fragment_edge_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a><span class="sd">        If two fragments have a &quot;common&quot; division then they are connected.</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="sd">        Returns:</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">]</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>        <span class="n">fragments</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="ow">and</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span><span class="p">:</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>                    <span class="n">fragment2</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment2</span><span class="p">)</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">division</span><span class="p">)</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>        <span class="k">return</span> <span class="n">G</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>    <span class="k">def</span> <span class="nf">fragment_vertex_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a><span class="sd">        If two fragments have a &quot;common&quot; vertex then they are connected.</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">        Returns:</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>        <span class="k">def</span> <span class="nf">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">):</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>            <span class="n">division</span> <span class="o">=</span> <span class="n">intersection</span><span class="o">.</span><span class="n">division</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>            <span class="n">start_division_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>            <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>                <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>            <span class="k">while</span> <span class="n">twin_id</span> <span class="o">!=</span> <span class="n">start_division_id</span><span class="p">:</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>                    <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>                    <span class="n">division</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>                    <span class="k">break</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>            <span class="k">return</span> <span class="n">fragments</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>        <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>                <span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_edge_graph</span><span class="p">()</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>        <span class="n">G2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>            <span class="k">if</span> <span class="n">n</span><span class="p">:</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>                    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>                        <span class="n">ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">])</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>                        <span class="k">if</span> <span class="n">ids</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">ids</span><span class="p">)</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>        <span class="k">return</span> <span class="n">G2</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="k">def</span> <span class="nf">all_intersections</span><span class="p">(</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a>    <span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Division</span><span class="p">],</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>    <span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>    <span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>    <span class="n">loom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a><span class="sd">    Find all intersections of the given divisions. Sweep-line algorithm</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a><span class="sd">    without a self-balancing tree. Instead of a self-balancing tree,</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a><span class="sd">    it uses a numpy array to sort and filter the divisions. For the</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a><span class="sd">    number of divisions that are commonly needed in a lace, this is</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a><span class="sd">    sufficiently fast. It is also more robust and much easier to</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a><span class="sd">    understand and debug. Tested with tens of thousands of divisions but</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a><span class="sd">    not millions. The book has a section on this algorithm.</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a><span class="sd">    simetri.geometry.py has another version (called</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="sd">    all_intersections) for finding intersections among a given</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a><span class="sd">    list of divisions.</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a><span class="sd">    Arguments:</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a><span class="sd">    ----------</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a><span class="sd">        division_list: list of Division objects.</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a><span class="sd">    Side Effects:</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a><span class="sd">    -------------</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a><span class="sd">        * Modifies the given division objects (in the division_list) in place</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a><span class="sd">            by adding the intersections to the divisions&#39; &quot;intersections&quot;</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a><span class="sd">            attribute.</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a><span class="sd">        * Updates the d_intersections</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a><span class="sd">        * Updates the d_connections</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a><span class="sd">    Return:</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a><span class="sd">    --------</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a><span class="sd">        A list of all intersection objects among the given division</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a><span class="sd">        list.</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>    <span class="c1"># register fake intersections at the endpoints of the open lines</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>        <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>                <span class="n">d_intersections</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>    <span class="c1"># All objects are assigned an integer id attribute when they are created</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>        <span class="p">[</span><span class="n">flatten</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">]</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>    <span class="p">)</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>    <span class="n">n_divisions</span> <span class="o">=</span> <span class="n">division_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of divisions</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>    <span class="c1"># precompute the min and max x and y values for each division</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>    <span class="c1"># these will be used with the sweep line algorithm</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>    <span class="p">)</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>    <span class="p">)</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>    <span class="p">)</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>    <span class="p">)</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">division_array</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>    <span class="n">d_divisions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>        <span class="n">d_divisions</span><span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>    <span class="c1"># sort by xmin values</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">division_array</span><span class="p">[:,</span> <span class="n">i_xmin</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_divisions</span><span class="p">):</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>        <span class="n">division1_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># search should start from the next division</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>        <span class="c1"># filter the array by checking if the divisions&#39; bounding-boxes are</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>        <span class="c1"># overlapping with the bounding-box of the current division</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>            <span class="p">(</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>                <span class="p">(</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>                <span class="p">)</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>                <span class="p">)</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>            <span class="p">)</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>        <span class="p">]</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>        <span class="k">for</span> <span class="n">candid</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[</span><span class="n">i_id</span><span class="p">]</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>            <span class="n">division2_vertices</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>            <span class="k">if</span> <span class="n">loom</span><span class="p">:</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">division1_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>                <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">division2_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>                <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>                    <span class="k">continue</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>            <span class="n">connection_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>                <span class="o">*</span><span class="n">division1_vertices</span><span class="p">,</span> <span class="o">*</span><span class="n">division2_vertices</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>            <span class="p">)</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>            <span class="k">if</span> <span class="n">connection_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>            <span class="p">]:</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>                <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span> <span class="o">=</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id2</span><span class="p">)]</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>                <span class="n">x_point__e1_2</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">division1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>                <span class="k">if</span> <span class="n">x_point__e1_2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="p">:</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>                    <span class="n">inters_obj</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">x_point</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span><span class="p">)</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>                    <span class="n">d_intersections</span><span class="p">[</span><span class="n">inters_obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>                    <span class="n">d_connections</span><span class="p">[</span><span class="n">x_point__e1_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a>                    <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a>                    <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>                    <span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">_sort_intersections</span><span class="p">()</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a><span class="k">def</span> <span class="nf">merge_nodes</span><span class="p">(</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>    <span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Division</span><span class="p">],</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>    <span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>    <span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>    <span class="n">loom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a><span class="sd">    Find all intersections of the given divisions. Sweep-line algorithm</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a><span class="sd">    without a self-balancing tree. Instead of a self-balancing tree,</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a><span class="sd">    it uses a numpy array to sort and filter the divisions. For the</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a><span class="sd">    number of divisions that are commonly needed in a lace, this is</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a><span class="sd">    sufficiently fast. It is also more robust and much easier to</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a><span class="sd">    understand and debug. Tested with tens of thousands of divisions but</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a><span class="sd">    not millions. The book has a section on this algorithm.</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a><span class="sd">    simetri.geometry.py has another version (called</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a><span class="sd">    all_intersections) for finding intersections among a given</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a><span class="sd">    list of divisions.</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a><span class="sd">    Arguments:</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a><span class="sd">    ----------</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a><span class="sd">        division_list: list of division objects.</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a><span class="sd">    Side Effects:</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a><span class="sd">    -------------</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a><span class="sd">        * Modifies the given division objects (in the division_list) in place</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a><span class="sd">            by adding the intersections to the divisions&#39; &quot;intersections&quot;</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a><span class="sd">            attribute.</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a><span class="sd">        * Updates the d_intersections</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a><span class="sd">        * Updates the d_connections</span>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a><span class="sd">    Return:</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a><span class="sd">    --------</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a><span class="sd">        A list of all intersection objects among the given division</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a><span class="sd">        list.</span>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a>    <span class="c1"># register fake intersections at the endpoints of the open lines</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a>        <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a>                <span class="n">d_intersections</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>    <span class="c1"># All objects are assigned an integer id attribute when they are created</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a>        <span class="p">[</span><span class="n">flatten</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">]</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>    <span class="p">)</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>    <span class="n">n_divisions</span> <span class="o">=</span> <span class="n">division_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of divisions</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>    <span class="c1"># precompute the min and max x and y values for each division</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>    <span class="c1"># these will be used with the sweep line algorithm</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>    <span class="p">)</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>    <span class="p">)</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a>    <span class="p">)</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a>    <span class="p">)</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">division_array</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a>    <span class="n">d_divisions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a>        <span class="n">d_divisions</span><span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>    <span class="c1"># sort by xmin values</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">division_array</span><span class="p">[:,</span> <span class="n">i_xmin</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_divisions</span><span class="p">):</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>        <span class="n">division1_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># search should start from the next division</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a>        <span class="c1"># filter the array by checking if the divisions&#39; bounding-boxes are</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a>        <span class="c1"># overlapping with the bounding-box of the current division</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a>            <span class="p">(</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a>                <span class="p">(</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a>                <span class="p">)</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>                <span class="p">)</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a>            <span class="p">)</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>        <span class="p">]</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a>        <span class="k">for</span> <span class="n">candid</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[</span><span class="n">i_id</span><span class="p">]</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>            <span class="n">division2_vertices</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a>            <span class="k">if</span> <span class="n">loom</span><span class="p">:</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">division1_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a>                <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">division2_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a>                <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a>                    <span class="k">continue</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a>            <span class="n">connection_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a>                <span class="o">*</span><span class="n">division1_vertices</span><span class="p">,</span> <span class="o">*</span><span class="n">division2_vertices</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a>            <span class="p">)</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a>            <span class="k">if</span> <span class="n">connection_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a>            <span class="p">]:</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a>                <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span> <span class="o">=</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id2</span><span class="p">)]</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a>                <span class="n">x_point__e1_2</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">division1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>                <span class="k">if</span> <span class="n">x_point__e1_2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="p">:</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>                    <span class="n">inters_obj</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">x_point</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span><span class="p">)</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>                    <span class="n">d_intersections</span><span class="p">[</span><span class="n">inters_obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>                    <span class="n">d_connections</span><span class="p">[</span><span class="n">x_point__e1_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>                    <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a>                    <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a>                    <span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">_sort_intersections</span><span class="p">()</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span></pre></div>


            </section>
                <section id="array">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">array</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#array"></a>
    
            <div class="docstring"><p>array(object, dtype=None, *, copy=True, order='K', subok=False, ndmin=0,
      like=None)</p>

<p>Create an array.</p>

<h2 id="parameters">Parameters</h2>

<p>object : array_like
    An array, any object exposing the array interface, an object whose
    <code>__array__</code> method returns an array, or any (nested) sequence.
    If object is a scalar, a 0-dimensional array containing object is
    returned.
dtype : data-type, optional
    The desired data-type for the array. If not given, NumPy will try to use
    a default <code>dtype</code> that can represent the values (by applying promotion
    rules when necessary.)
copy : bool, optional
    If <code>True</code> (default), then the array data is copied. If <code>None</code>,
    a copy will only be made if <code>__array__</code> returns a copy, if obj is
    a nested sequence, or if a copy is needed to satisfy any of the other
    requirements (<code>dtype</code>, <code>order</code>, etc.). Note that any copy of
    the data is shallow, i.e., for arrays with object dtype, the new
    array will point to the same objects. See Examples for <code>ndarray.copy</code>.
    For <code>False</code> it raises a <code>ValueError</code> if a copy cannot be avoided.
    Default: <code>True</code>.
order : {'K', 'A', 'C', 'F'}, optional
    Specify the memory layout of the array. If object is not an array, the
    newly created array will be in C order (row major) unless 'F' is
    specified, in which case it will be in Fortran order (column major).
    If object is an array the following holds.</p>

<pre><code>===== ========= ===================================================
order  no copy                     copy=True
===== ========= ===================================================
'K'   unchanged F &amp; C order preserved, otherwise most similar order
'A'   unchanged F order if input is F and not C, otherwise C order
'C'   C order   C order
'F'   F order   F order
===== ========= ===================================================

When ``copy=None`` and a copy is made for other reasons, the result is
the same as if ``copy=True``, with some exceptions for 'A', see the
Notes section. The default order is 'K'.
</code></pre>

<p>subok : bool, optional
    If True, then sub-classes will be passed-through, otherwise
    the returned array will be forced to be a base-class array (default).
ndmin : int, optional
    Specifies the minimum number of dimensions that the resulting
    array should have.  Ones will be prepended to the shape as
    needed to meet this requirement.
like : array_like, optional
    Reference object to allow the creation of arrays which are not
    NumPy arrays. If an array-like passed in as <code>like</code> supports
    the <code>__array_function__</code> protocol, the result will be defined
    by it. In this case, it ensures the creation of an array object
    compatible with that passed in via this argument.</p>

<pre><code>*New in version 1.20.0.*
</code></pre>

<h2 id="returns">Returns</h2>

<p>out : ndarray
    An array object satisfying the specified requirements.</p>

<h2 id="see-also">See Also</h2>

<p>empty_like : Return an empty array with shape and type of input.
ones_like : Return an array of ones with shape and type of input.
zeros_like : Return an array of zeros with shape and type of input.
full_like : Return a new array with shape of input filled with value.
empty : Return a new uninitialized array.
ones : Return a new array setting values to one.
zeros : Return a new array setting values to zero.
full : Return a new array of given shape filled with value.
copy: Return an array copy of the given object.</p>

<h2 id="notes">Notes</h2>

<p>When order is 'A' and <code>object</code> is an array in neither 'C' nor 'F' order,
and a copy is forced by a change in dtype, then the order of the result is
not necessarily 'C' as expected. This is likely a bug.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">array([1, 2, 3])</span>
</code></pre>
</div>

<p>Upcasting:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">array([ 1.,  2.,  3.])</span>
</code></pre>
</div>

<p>More than one dimension:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>
</code></pre>
</div>

<p>Minimum dimensions 2:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[1, 2, 3]])</span>
</code></pre>
</div>

<p>Type provided:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="go">array([ 1.+0.j,  2.+0.j,  3.+0.j])</span>
</code></pre>
</div>

<p>Data-type consisting of more than one element:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">array([1, 3])</span>
</code></pre>
</div>

<p>Creating an array from sub-classes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">))</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">matrix([[1, 2],</span>
<span class="go">        [3, 4]])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="Intersection">
                            <input id="Intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Intersection</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Intersection-180"><a href="#Intersection-180"><span class="linenos">180</span></a><span class="k">class</span> <span class="nc">Intersection</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Intersection-181"><a href="#Intersection-181"><span class="linenos">181</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Intersection of two divisions. They are at the endpoints of Section</span>
</span><span id="Intersection-182"><a href="#Intersection-182"><span class="linenos">182</span></a><span class="sd">    objects. A division can have multiple sections and multiple</span>
</span><span id="Intersection-183"><a href="#Intersection-183"><span class="linenos">183</span></a><span class="sd">    intersections. They can be located at the end of a division.</span>
</span><span id="Intersection-184"><a href="#Intersection-184"><span class="linenos">184</span></a>
</span><span id="Intersection-185"><a href="#Intersection-185"><span class="linenos">185</span></a><span class="sd">    Args:</span>
</span><span id="Intersection-186"><a href="#Intersection-186"><span class="linenos">186</span></a><span class="sd">        point (tuple): (x, y) coordinates of the intersection point.</span>
</span><span id="Intersection-187"><a href="#Intersection-187"><span class="linenos">187</span></a><span class="sd">        division1 (Division): First division.</span>
</span><span id="Intersection-188"><a href="#Intersection-188"><span class="linenos">188</span></a><span class="sd">        division2 (Division, optional): Second division. Defaults to None.</span>
</span><span id="Intersection-189"><a href="#Intersection-189"><span class="linenos">189</span></a><span class="sd">        endpoint (bool, optional): If the intersection is at the end of a division, then endpoint is True. Defaults to False.</span>
</span><span id="Intersection-190"><a href="#Intersection-190"><span class="linenos">190</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Intersection-191"><a href="#Intersection-191"><span class="linenos">191</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Intersection-192"><a href="#Intersection-192"><span class="linenos">192</span></a>
</span><span id="Intersection-193"><a href="#Intersection-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">division1</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">,</span> <span class="n">division2</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Intersection-194"><a href="#Intersection-194"><span class="linenos">194</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">point</span><span class="p">],</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">INTERSECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Intersection-195"><a href="#Intersection-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Intersection-196"><a href="#Intersection-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division1</span> <span class="o">=</span> <span class="n">division1</span>
</span><span id="Intersection-197"><a href="#Intersection-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division2</span> <span class="o">=</span> <span class="n">division2</span>
</span><span id="Intersection-198"><a href="#Intersection-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Intersection-199"><a href="#Intersection-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
</span><span id="Intersection-200"><a href="#Intersection-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions&#39; DCEL structure</span>
</span><span id="Intersection-201"><a href="#Intersection-201"><span class="linenos">201</span></a>
</span><span id="Intersection-202"><a href="#Intersection-202"><span class="linenos">202</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Intersection-203"><a href="#Intersection-203"><span class="linenos">203</span></a>
</span><span id="Intersection-204"><a href="#Intersection-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">:</span> <span class="n">array</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Intersection-205"><a href="#Intersection-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the intersection.</span>
</span><span id="Intersection-206"><a href="#Intersection-206"><span class="linenos">206</span></a>
</span><span id="Intersection-207"><a href="#Intersection-207"><span class="linenos">207</span></a><span class="sd">        Args:</span>
</span><span id="Intersection-208"><a href="#Intersection-208"><span class="linenos">208</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="Intersection-209"><a href="#Intersection-209"><span class="linenos">209</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="Intersection-210"><a href="#Intersection-210"><span class="linenos">210</span></a>
</span><span id="Intersection-211"><a href="#Intersection-211"><span class="linenos">211</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-212"><a href="#Intersection-212"><span class="linenos">212</span></a><span class="sd">            Any: Updated intersection or list of updated intersections.</span>
</span><span id="Intersection-213"><a href="#Intersection-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-214"><a href="#Intersection-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Intersection-215"><a href="#Intersection-215"><span class="linenos">215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="Intersection-216"><a href="#Intersection-216"><span class="linenos">216</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Intersection-217"><a href="#Intersection-217"><span class="linenos">217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Intersection-218"><a href="#Intersection-218"><span class="linenos">218</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Intersection-219"><a href="#Intersection-219"><span class="linenos">219</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="Intersection-220"><a href="#Intersection-220"><span class="linenos">220</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Intersection-221"><a href="#Intersection-221"><span class="linenos">221</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Intersection-222"><a href="#Intersection-222"><span class="linenos">222</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Intersection-223"><a href="#Intersection-223"><span class="linenos">223</span></a>
</span><span id="Intersection-224"><a href="#Intersection-224"><span class="linenos">224</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Intersection-225"><a href="#Intersection-225"><span class="linenos">225</span></a>
</span><span id="Intersection-226"><a href="#Intersection-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection-227"><a href="#Intersection-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the intersection.</span>
</span><span id="Intersection-228"><a href="#Intersection-228"><span class="linenos">228</span></a>
</span><span id="Intersection-229"><a href="#Intersection-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-230"><a href="#Intersection-230"><span class="linenos">230</span></a><span class="sd">            Intersection: A copy of the intersection.</span>
</span><span id="Intersection-231"><a href="#Intersection-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-232"><a href="#Intersection-232"><span class="linenos">232</span></a>        <span class="n">intersection</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division2</span><span class="p">)</span>
</span><span id="Intersection-233"><a href="#Intersection-233"><span class="linenos">233</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Intersection-234"><a href="#Intersection-234"><span class="linenos">234</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Intersection-235"><a href="#Intersection-235"><span class="linenos">235</span></a>        <span class="n">custom_attribs</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Intersection-236"><a href="#Intersection-236"><span class="linenos">236</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attribs</span><span class="p">:</span>
</span><span id="Intersection-237"><a href="#Intersection-237"><span class="linenos">237</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Intersection-238"><a href="#Intersection-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">intersection</span>
</span><span id="Intersection-239"><a href="#Intersection-239"><span class="linenos">239</span></a>
</span><span id="Intersection-240"><a href="#Intersection-240"><span class="linenos">240</span></a>    <span class="nd">@property</span>
</span><span id="Intersection-241"><a href="#Intersection-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection-242"><a href="#Intersection-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersection point.</span>
</span><span id="Intersection-243"><a href="#Intersection-243"><span class="linenos">243</span></a>
</span><span id="Intersection-244"><a href="#Intersection-244"><span class="linenos">244</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-245"><a href="#Intersection-245"><span class="linenos">245</span></a><span class="sd">            list: Intersection point coordinates.</span>
</span><span id="Intersection-246"><a href="#Intersection-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-247"><a href="#Intersection-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_point</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Intersection-248"><a href="#Intersection-248"><span class="linenos">248</span></a>
</span><span id="Intersection-249"><a href="#Intersection-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection-250"><a href="#Intersection-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the intersection.</span>
</span><span id="Intersection-251"><a href="#Intersection-251"><span class="linenos">251</span></a>
</span><span id="Intersection-252"><a href="#Intersection-252"><span class="linenos">252</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-253"><a href="#Intersection-253"><span class="linenos">253</span></a><span class="sd">            str: String representation.</span>
</span><span id="Intersection-254"><a href="#Intersection-254"><span class="linenos">254</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-255"><a href="#Intersection-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Intersection-256"><a href="#Intersection-256"><span class="linenos">256</span></a>            <span class="sa">f</span><span class="s2">&quot;Intersection(</span><span class="si">{</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;n_round&#39;</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Intersection-257"><a href="#Intersection-257"><span class="linenos">257</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">division1</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">division2</span><span class="p">]))</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Intersection-258"><a href="#Intersection-258"><span class="linenos">258</span></a>        <span class="p">)</span>
</span><span id="Intersection-259"><a href="#Intersection-259"><span class="linenos">259</span></a>
</span><span id="Intersection-260"><a href="#Intersection-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection-261"><a href="#Intersection-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the intersection.</span>
</span><span id="Intersection-262"><a href="#Intersection-262"><span class="linenos">262</span></a>
</span><span id="Intersection-263"><a href="#Intersection-263"><span class="linenos">263</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-264"><a href="#Intersection-264"><span class="linenos">264</span></a><span class="sd">            str: String representation.</span>
</span><span id="Intersection-265"><a href="#Intersection-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-266"><a href="#Intersection-266"><span class="linenos">266</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Intersection-267"><a href="#Intersection-267"><span class="linenos">267</span></a>
</span><span id="Intersection-268"><a href="#Intersection-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Intersection-269"><a href="#Intersection-269"><span class="linenos">269</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two intersections are equal.</span>
</span><span id="Intersection-270"><a href="#Intersection-270"><span class="linenos">270</span></a>
</span><span id="Intersection-271"><a href="#Intersection-271"><span class="linenos">271</span></a><span class="sd">        Args:</span>
</span><span id="Intersection-272"><a href="#Intersection-272"><span class="linenos">272</span></a><span class="sd">            other (Intersection): Another intersection.</span>
</span><span id="Intersection-273"><a href="#Intersection-273"><span class="linenos">273</span></a>
</span><span id="Intersection-274"><a href="#Intersection-274"><span class="linenos">274</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection-275"><a href="#Intersection-275"><span class="linenos">275</span></a><span class="sd">            bool: True if equal, False otherwise.</span>
</span><span id="Intersection-276"><a href="#Intersection-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection-277"><a href="#Intersection-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="n">close_points2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Intersection of two divisions. They are at the endpoints of Section
objects. A division can have multiple sections and multiple
intersections. They can be located at the end of a division.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>point (tuple):</strong>  (x, y) coordinates of the intersection point.</li>
<li><strong>division1 (Division):</strong>  First division.</li>
<li><strong>division2 (Division, optional):</strong>  Second division. Defaults to None.</li>
<li><strong>endpoint (bool, optional):</strong>  If the intersection is at the end of a division, then endpoint is True. Defaults to False.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Intersection.__init__" class="classattr">
                                        <input id="Intersection.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Intersection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="nb">tuple</span>,</span><span class="param">	<span class="n">division1</span><span class="p">:</span> <span class="n"><a href="#Division">Division</a></span>,</span><span class="param">	<span class="n">division2</span><span class="p">:</span> <span class="n"><a href="#Division">Division</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">endpoint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Intersection.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Intersection.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Intersection.__init__-193"><a href="#Intersection.__init__-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">division1</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">,</span> <span class="n">division2</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Intersection.__init__-194"><a href="#Intersection.__init__-194"><span class="linenos">194</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">point</span><span class="p">],</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">INTERSECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Intersection.__init__-195"><a href="#Intersection.__init__-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Intersection.__init__-196"><a href="#Intersection.__init__-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division1</span> <span class="o">=</span> <span class="n">division1</span>
</span><span id="Intersection.__init__-197"><a href="#Intersection.__init__-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division2</span> <span class="o">=</span> <span class="n">division2</span>
</span><span id="Intersection.__init__-198"><a href="#Intersection.__init__-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Intersection.__init__-199"><a href="#Intersection.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
</span><span id="Intersection.__init__-200"><a href="#Intersection.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions&#39; DCEL structure</span>
</span><span id="Intersection.__init__-201"><a href="#Intersection.__init__-201"><span class="linenos">201</span></a>
</span><span id="Intersection.__init__-202"><a href="#Intersection.__init__-202"><span class="linenos">202</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Intersection.division1" class="classattr">
                                <div class="attr variable">
            <span class="name">division1</span>

        
    </div>
    <a class="headerlink" href="#Intersection.division1"></a>
    
    

                            </div>
                            <div id="Intersection.division2" class="classattr">
                                <div class="attr variable">
            <span class="name">division2</span>

        
    </div>
    <a class="headerlink" href="#Intersection.division2"></a>
    
    

                            </div>
                            <div id="Intersection.overlap" class="classattr">
                                <div class="attr variable">
            <span class="name">overlap</span>

        
    </div>
    <a class="headerlink" href="#Intersection.overlap"></a>
    
    

                            </div>
                            <div id="Intersection.endpoint" class="classattr">
                                <div class="attr variable">
            <span class="name">endpoint</span>

        
    </div>
    <a class="headerlink" href="#Intersection.endpoint"></a>
    
    

                            </div>
                            <div id="Intersection.division" class="classattr">
                                <div class="attr variable">
            <span class="name">division</span>

        
    </div>
    <a class="headerlink" href="#Intersection.division"></a>
    
    

                            </div>
                            <div id="Intersection.copy" class="classattr">
                                        <input id="Intersection.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Intersection.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Intersection.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Intersection.copy-226"><a href="#Intersection.copy-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection.copy-227"><a href="#Intersection.copy-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the intersection.</span>
</span><span id="Intersection.copy-228"><a href="#Intersection.copy-228"><span class="linenos">228</span></a>
</span><span id="Intersection.copy-229"><a href="#Intersection.copy-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection.copy-230"><a href="#Intersection.copy-230"><span class="linenos">230</span></a><span class="sd">            Intersection: A copy of the intersection.</span>
</span><span id="Intersection.copy-231"><a href="#Intersection.copy-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection.copy-232"><a href="#Intersection.copy-232"><span class="linenos">232</span></a>        <span class="n">intersection</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">division2</span><span class="p">)</span>
</span><span id="Intersection.copy-233"><a href="#Intersection.copy-233"><span class="linenos">233</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Intersection.copy-234"><a href="#Intersection.copy-234"><span class="linenos">234</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Intersection.copy-235"><a href="#Intersection.copy-235"><span class="linenos">235</span></a>        <span class="n">custom_attribs</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Intersection.copy-236"><a href="#Intersection.copy-236"><span class="linenos">236</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attribs</span><span class="p">:</span>
</span><span id="Intersection.copy-237"><a href="#Intersection.copy-237"><span class="linenos">237</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Intersection.copy-238"><a href="#Intersection.copy-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">intersection</span>
</span></pre></div>


            <div class="docstring"><p>Create a copy of the intersection.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Intersection: A copy of the intersection.</p>
</blockquote>
</div>


                            </div>
                            <div id="Intersection.point" class="classattr">
                                        <input id="Intersection.point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">point</span>

                <label class="view-source-button" for="Intersection.point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Intersection.point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Intersection.point-240"><a href="#Intersection.point-240"><span class="linenos">240</span></a>    <span class="nd">@property</span>
</span><span id="Intersection.point-241"><a href="#Intersection.point-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Intersection.point-242"><a href="#Intersection.point-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersection point.</span>
</span><span id="Intersection.point-243"><a href="#Intersection.point-243"><span class="linenos">243</span></a>
</span><span id="Intersection.point-244"><a href="#Intersection.point-244"><span class="linenos">244</span></a><span class="sd">        Returns:</span>
</span><span id="Intersection.point-245"><a href="#Intersection.point-245"><span class="linenos">245</span></a><span class="sd">            list: Intersection point coordinates.</span>
</span><span id="Intersection.point-246"><a href="#Intersection.point-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Intersection.point-247"><a href="#Intersection.point-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_point</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection point.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Intersection point coordinates.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Intersection.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Intersection.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Intersection.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Intersection.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Intersection.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Intersection.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Intersection.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Intersection.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Intersection.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Intersection.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Intersection.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Intersection.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Intersection.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Intersection.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Intersection.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Intersection.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Intersection.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Intersection.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Intersection.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Intersection.area" class="variable"><a href="../graphics/shape.html#Shape.area">area</a></dd>
                <dd id="Intersection.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Intersection.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Intersection.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Intersection.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Intersection.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Intersection.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Intersection.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Intersection.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Intersection.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Intersection.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Intersection.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Intersection.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Intersection.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Intersection.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Intersection.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Intersection.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Intersection.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Intersection.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Intersection.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Partition">
                            <input id="Partition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Partition</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Partition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Partition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Partition-280"><a href="#Partition-280"><span class="linenos">280</span></a><span class="k">class</span> <span class="nc">Partition</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Partition-281"><a href="#Partition-281"><span class="linenos">281</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;These are the polygons of the non-interlaced geometry.</span>
</span><span id="Partition-282"><a href="#Partition-282"><span class="linenos">282</span></a><span class="sd">    Fragments and partitions are scaled versions of each other.</span>
</span><span id="Partition-283"><a href="#Partition-283"><span class="linenos">283</span></a>
</span><span id="Partition-284"><a href="#Partition-284"><span class="linenos">284</span></a><span class="sd">    Args:</span>
</span><span id="Partition-285"><a href="#Partition-285"><span class="linenos">285</span></a><span class="sd">        points (list): List of points defining the partition.</span>
</span><span id="Partition-286"><a href="#Partition-286"><span class="linenos">286</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Partition-287"><a href="#Partition-287"><span class="linenos">287</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Partition-288"><a href="#Partition-288"><span class="linenos">288</span></a>
</span><span id="Partition-289"><a href="#Partition-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Partition-290"><a href="#Partition-290"><span class="linenos">290</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Partition-291"><a href="#Partition-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PART</span>
</span><span id="Partition-292"><a href="#Partition-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Partition-293"><a href="#Partition-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Partition-294"><a href="#Partition-294"><span class="linenos">294</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Partition-295"><a href="#Partition-295"><span class="linenos">295</span></a>
</span><span id="Partition-296"><a href="#Partition-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Partition-297"><a href="#Partition-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the partition.</span>
</span><span id="Partition-298"><a href="#Partition-298"><span class="linenos">298</span></a>
</span><span id="Partition-299"><a href="#Partition-299"><span class="linenos">299</span></a><span class="sd">        Returns:</span>
</span><span id="Partition-300"><a href="#Partition-300"><span class="linenos">300</span></a><span class="sd">            str: String representation.</span>
</span><span id="Partition-301"><a href="#Partition-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Partition-302"><a href="#Partition-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Part(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Partition-303"><a href="#Partition-303"><span class="linenos">303</span></a>
</span><span id="Partition-304"><a href="#Partition-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Partition-305"><a href="#Partition-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the partition.</span>
</span><span id="Partition-306"><a href="#Partition-306"><span class="linenos">306</span></a>
</span><span id="Partition-307"><a href="#Partition-307"><span class="linenos">307</span></a><span class="sd">        Returns:</span>
</span><span id="Partition-308"><a href="#Partition-308"><span class="linenos">308</span></a><span class="sd">            str: String representation.</span>
</span><span id="Partition-309"><a href="#Partition-309"><span class="linenos">309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Partition-310"><a href="#Partition-310"><span class="linenos">310</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>These are the polygons of the non-interlaced geometry.
Fragments and partitions are scaled versions of each other.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (list):</strong>  List of points defining the partition.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Partition.__init__" class="classattr">
                                        <input id="Partition.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Partition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Partition.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Partition.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Partition.__init__-289"><a href="#Partition.__init__-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Partition.__init__-290"><a href="#Partition.__init__-290"><span class="linenos">290</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Partition.__init__-291"><a href="#Partition.__init__-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PART</span>
</span><span id="Partition.__init__-292"><a href="#Partition.__init__-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Partition.__init__-293"><a href="#Partition.__init__-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Partition.__init__-294"><a href="#Partition.__init__-294"><span class="linenos">294</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Partition.subtype" class="classattr">
                                <div class="attr variable">
            <span class="name">subtype</span>

        
    </div>
    <a class="headerlink" href="#Partition.subtype"></a>
    
    

                            </div>
                            <div id="Partition.area" class="classattr">
                                        <input id="Partition.area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">area</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Partition.area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Partition.area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Partition.area-672"><a href="#Partition.area-672"><span class="linenos">672</span></a>    <span class="nd">@property</span>
</span><span id="Partition.area-673"><a href="#Partition.area-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Partition.area-674"><a href="#Partition.area-674"><span class="linenos">674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the area of the shape.</span>
</span><span id="Partition.area-675"><a href="#Partition.area-675"><span class="linenos">675</span></a>
</span><span id="Partition.area-676"><a href="#Partition.area-676"><span class="linenos">676</span></a><span class="sd">        Returns:</span>
</span><span id="Partition.area-677"><a href="#Partition.area-677"><span class="linenos">677</span></a><span class="sd">            float: The area of the shape.</span>
</span><span id="Partition.area-678"><a href="#Partition.area-678"><span class="linenos">678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Partition.area-679"><a href="#Partition.area-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Partition.area-680"><a href="#Partition.area-680"><span class="linenos">680</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:]</span>
</span><span id="Partition.area-681"><a href="#Partition.area-681"><span class="linenos">681</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="Partition.area-682"><a href="#Partition.area-682"><span class="linenos">682</span></a>                <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Partition.area-683"><a href="#Partition.area-683"><span class="linenos">683</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Partition.area-684"><a href="#Partition.area-684"><span class="linenos">684</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Partition.area-685"><a href="#Partition.area-685"><span class="linenos">685</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Partition.area-686"><a href="#Partition.area-686"><span class="linenos">686</span></a>
</span><span id="Partition.area-687"><a href="#Partition.area-687"><span class="linenos">687</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the area of the shape.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>float: The area of the shape.</p>
</blockquote>
</div>


                            </div>
                            <div id="Partition.CG" class="classattr">
                                <div class="attr variable">
            <span class="name">CG</span>

        
    </div>
    <a class="headerlink" href="#Partition.CG"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Partition.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Partition.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Partition.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Partition.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Partition.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Partition.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Partition.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Partition.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Partition.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Partition.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Partition.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Partition.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Partition.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Partition.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Partition.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Partition.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Partition.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Partition.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Partition.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Partition.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Partition.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Partition.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Partition.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Partition.copy" class="function"><a href="../graphics/shape.html#Shape.copy">copy</a></dd>
                <dd id="Partition.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Partition.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Partition.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Partition.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Partition.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Partition.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Partition.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Partition.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Partition.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Partition.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Partition.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Partition.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Partition.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Partition.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Partition.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Fragment">
                            <input id="Fragment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Fragment</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Fragment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Fragment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Fragment-313"><a href="#Fragment-313"><span class="linenos">313</span></a><span class="k">class</span> <span class="nc">Fragment</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Fragment-314"><a href="#Fragment-314"><span class="linenos">314</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Fragment is a collection of section objects that are connected</span>
</span><span id="Fragment-315"><a href="#Fragment-315"><span class="linenos">315</span></a><span class="sd">    to each other. These sections are already defined. They belong to</span>
</span><span id="Fragment-316"><a href="#Fragment-316"><span class="linenos">316</span></a><span class="sd">    the polyline objects in a lace. Fragments can be open or closed.</span>
</span><span id="Fragment-317"><a href="#Fragment-317"><span class="linenos">317</span></a><span class="sd">    They are created by the lace object.</span>
</span><span id="Fragment-318"><a href="#Fragment-318"><span class="linenos">318</span></a>
</span><span id="Fragment-319"><a href="#Fragment-319"><span class="linenos">319</span></a><span class="sd">    Args:</span>
</span><span id="Fragment-320"><a href="#Fragment-320"><span class="linenos">320</span></a><span class="sd">        points (list): List of points defining the fragment.</span>
</span><span id="Fragment-321"><a href="#Fragment-321"><span class="linenos">321</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Fragment-322"><a href="#Fragment-322"><span class="linenos">322</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Fragment-323"><a href="#Fragment-323"><span class="linenos">323</span></a>
</span><span id="Fragment-324"><a href="#Fragment-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Fragment-325"><a href="#Fragment-325"><span class="linenos">325</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Fragment-326"><a href="#Fragment-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="Fragment-327"><a href="#Fragment-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment-328"><a href="#Fragment-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-329"><a href="#Fragment-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-330"><a href="#Fragment-330"><span class="linenos">330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-331"><a href="#Fragment-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-332"><a href="#Fragment-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment-333"><a href="#Fragment-333"><span class="linenos">333</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Fragment-334"><a href="#Fragment-334"><span class="linenos">334</span></a>
</span><span id="Fragment-335"><a href="#Fragment-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment-336"><a href="#Fragment-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the fragment.</span>
</span><span id="Fragment-337"><a href="#Fragment-337"><span class="linenos">337</span></a>
</span><span id="Fragment-338"><a href="#Fragment-338"><span class="linenos">338</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment-339"><a href="#Fragment-339"><span class="linenos">339</span></a><span class="sd">            str: String representation.</span>
</span><span id="Fragment-340"><a href="#Fragment-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment-341"><a href="#Fragment-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Fragment(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Fragment-342"><a href="#Fragment-342"><span class="linenos">342</span></a>
</span><span id="Fragment-343"><a href="#Fragment-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment-344"><a href="#Fragment-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the fragment.</span>
</span><span id="Fragment-345"><a href="#Fragment-345"><span class="linenos">345</span></a>
</span><span id="Fragment-346"><a href="#Fragment-346"><span class="linenos">346</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment-347"><a href="#Fragment-347"><span class="linenos">347</span></a><span class="sd">            str: String representation.</span>
</span><span id="Fragment-348"><a href="#Fragment-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment-349"><a href="#Fragment-349"><span class="linenos">349</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="Fragment-350"><a href="#Fragment-350"><span class="linenos">350</span></a>
</span><span id="Fragment-351"><a href="#Fragment-351"><span class="linenos">351</span></a>    <span class="nd">@property</span>
</span><span id="Fragment-352"><a href="#Fragment-352"><span class="linenos">352</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment-353"><a href="#Fragment-353"><span class="linenos">353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the fragment.</span>
</span><span id="Fragment-354"><a href="#Fragment-354"><span class="linenos">354</span></a>
</span><span id="Fragment-355"><a href="#Fragment-355"><span class="linenos">355</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment-356"><a href="#Fragment-356"><span class="linenos">356</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="Fragment-357"><a href="#Fragment-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment-358"><a href="#Fragment-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span>
</span><span id="Fragment-359"><a href="#Fragment-359"><span class="linenos">359</span></a>
</span><span id="Fragment-360"><a href="#Fragment-360"><span class="linenos">360</span></a>    <span class="nd">@property</span>
</span><span id="Fragment-361"><a href="#Fragment-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment-362"><a href="#Fragment-362"><span class="linenos">362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the fragment.</span>
</span><span id="Fragment-363"><a href="#Fragment-363"><span class="linenos">363</span></a>
</span><span id="Fragment-364"><a href="#Fragment-364"><span class="linenos">364</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment-365"><a href="#Fragment-365"><span class="linenos">365</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="Fragment-366"><a href="#Fragment-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment-367"><a href="#Fragment-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CG</span>
</span><span id="Fragment-368"><a href="#Fragment-368"><span class="linenos">368</span></a>
</span><span id="Fragment-369"><a href="#Fragment-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">_set_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Fragment-370"><a href="#Fragment-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Fragment-371"><a href="#Fragment-371"><span class="linenos">371</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="Fragment-372"><a href="#Fragment-372"><span class="linenos">372</span></a>        <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>  <span class="c1"># squared distance tolerance</span>
</span><span id="Fragment-373"><a href="#Fragment-373"><span class="linenos">373</span></a>        <span class="n">d_points__section</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Fragment-374"><a href="#Fragment-374"><span class="linenos">374</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="Fragment-375"><a href="#Fragment-375"><span class="linenos">375</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="Fragment-376"><a href="#Fragment-376"><span class="linenos">376</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="Fragment-377"><a href="#Fragment-377"><span class="linenos">377</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Fragment-378"><a href="#Fragment-378"><span class="linenos">378</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Fragment-379"><a href="#Fragment-379"><span class="linenos">379</span></a>            <span class="n">d_points__section</span><span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="Fragment-380"><a href="#Fragment-380"><span class="linenos">380</span></a>            <span class="n">d_points__section</span><span class="p">[(</span><span class="n">end</span><span class="p">,</span> <span class="n">start</span><span class="p">)]</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="Fragment-381"><a href="#Fragment-381"><span class="linenos">381</span></a>
</span><span id="Fragment-382"><a href="#Fragment-382"><span class="linenos">382</span></a>        <span class="n">coord_pairs</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment-383"><a href="#Fragment-383"><span class="linenos">383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-384"><a href="#Fragment-384"><span class="linenos">384</span></a>        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">coord_pairs</span><span class="p">:</span>
</span><span id="Fragment-385"><a href="#Fragment-385"><span class="linenos">385</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Fragment-386"><a href="#Fragment-386"><span class="linenos">386</span></a>            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Fragment-387"><a href="#Fragment-387"><span class="linenos">387</span></a>            <span class="n">division</span> <span class="o">=</span> <span class="n">Division</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="Fragment-388"><a href="#Fragment-388"><span class="linenos">388</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">d_points__section</span><span class="p">[((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))]</span>
</span><span id="Fragment-389"><a href="#Fragment-389"><span class="linenos">389</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Fragment-390"><a href="#Fragment-390"><span class="linenos">390</span></a>            <span class="n">start_point</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Fragment-391"><a href="#Fragment-391"><span class="linenos">391</span></a>            <span class="n">end_point</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Fragment-392"><a href="#Fragment-392"><span class="linenos">392</span></a>            <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="Fragment-393"><a href="#Fragment-393"><span class="linenos">393</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="Fragment-394"><a href="#Fragment-394"><span class="linenos">394</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="Fragment-395"><a href="#Fragment-395"><span class="linenos">395</span></a>            <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="Fragment-396"><a href="#Fragment-396"><span class="linenos">396</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
</span><span id="Fragment-397"><a href="#Fragment-397"><span class="linenos">397</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">division</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="Fragment-398"><a href="#Fragment-398"><span class="linenos">398</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Fragment-399"><a href="#Fragment-399"><span class="linenos">399</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Division does not match section&quot;</span><span class="p">)</span>
</span><span id="Fragment-400"><a href="#Fragment-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
</span><span id="Fragment-401"><a href="#Fragment-401"><span class="linenos">401</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">)</span>
</span><span id="Fragment-402"><a href="#Fragment-402"><span class="linenos">402</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">):</span>
</span><span id="Fragment-403"><a href="#Fragment-403"><span class="linenos">403</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Fragment-404"><a href="#Fragment-404"><span class="linenos">404</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span>
</span><span id="Fragment-405"><a href="#Fragment-405"><span class="linenos">405</span></a>
</span><span id="Fragment-406"><a href="#Fragment-406"><span class="linenos">406</span></a>    <span class="k">def</span> <span class="nf">_set_twin_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment-407"><a href="#Fragment-407"><span class="linenos">407</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Fragment-408"><a href="#Fragment-408"><span class="linenos">408</span></a>            <span class="n">section</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">section</span>
</span><span id="Fragment-409"><a href="#Fragment-409"><span class="linenos">409</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span> <span class="ow">and</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span><span class="p">:</span>
</span><span id="Fragment-410"><a href="#Fragment-410"><span class="linenos">410</span></a>                <span class="n">twin_fragment</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="Fragment-411"><a href="#Fragment-411"><span class="linenos">411</span></a>                <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment-412"><a href="#Fragment-412"><span class="linenos">412</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">division2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twin_fragment</span><span class="o">.</span><span class="n">divisions</span><span class="p">):</span>
</span><span id="Fragment-413"><a href="#Fragment-413"><span class="linenos">413</span></a>                    <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span>
</span><span id="Fragment-414"><a href="#Fragment-414"><span class="linenos">414</span></a>                        <span class="n">division</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">mid_point</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">mid_point</span>
</span><span id="Fragment-415"><a href="#Fragment-415"><span class="linenos">415</span></a>                    <span class="p">)</span>
</span><span id="Fragment-416"><a href="#Fragment-416"><span class="linenos">416</span></a>                    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">dist</span><span class="p">,</span> <span class="n">division2</span><span class="p">))</span>
</span><span id="Fragment-417"><a href="#Fragment-417"><span class="linenos">417</span></a>                <span class="n">distances</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Fragment-418"><a href="#Fragment-418"><span class="linenos">418</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A Fragment is a collection of section objects that are connected
to each other. These sections are already defined. They belong to
the polyline objects in a lace. Fragments can be open or closed.
They are created by the lace object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (list):</strong>  List of points defining the fragment.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Fragment.__init__" class="classattr">
                                        <input id="Fragment.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Fragment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Fragment.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Fragment.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Fragment.__init__-324"><a href="#Fragment.__init__-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Fragment.__init__-325"><a href="#Fragment.__init__-325"><span class="linenos">325</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Fragment.__init__-326"><a href="#Fragment.__init__-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="Fragment.__init__-327"><a href="#Fragment.__init__-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment.__init__-328"><a href="#Fragment.__init__-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment.__init__-329"><a href="#Fragment.__init__-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment.__init__-330"><a href="#Fragment.__init__-330"><span class="linenos">330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment.__init__-331"><a href="#Fragment.__init__-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Fragment.__init__-332"><a href="#Fragment.__init__-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment.__init__-333"><a href="#Fragment.__init__-333"><span class="linenos">333</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Fragment.subtype" class="classattr">
                                <div class="attr variable">
            <span class="name">subtype</span>

        
    </div>
    <a class="headerlink" href="#Fragment.subtype"></a>
    
    

                            </div>
                            <div id="Fragment.area" class="classattr">
                                        <input id="Fragment.area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">area</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Fragment.area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Fragment.area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Fragment.area-672"><a href="#Fragment.area-672"><span class="linenos">672</span></a>    <span class="nd">@property</span>
</span><span id="Fragment.area-673"><a href="#Fragment.area-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Fragment.area-674"><a href="#Fragment.area-674"><span class="linenos">674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the area of the shape.</span>
</span><span id="Fragment.area-675"><a href="#Fragment.area-675"><span class="linenos">675</span></a>
</span><span id="Fragment.area-676"><a href="#Fragment.area-676"><span class="linenos">676</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment.area-677"><a href="#Fragment.area-677"><span class="linenos">677</span></a><span class="sd">            float: The area of the shape.</span>
</span><span id="Fragment.area-678"><a href="#Fragment.area-678"><span class="linenos">678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment.area-679"><a href="#Fragment.area-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Fragment.area-680"><a href="#Fragment.area-680"><span class="linenos">680</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:]</span>
</span><span id="Fragment.area-681"><a href="#Fragment.area-681"><span class="linenos">681</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="Fragment.area-682"><a href="#Fragment.area-682"><span class="linenos">682</span></a>                <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Fragment.area-683"><a href="#Fragment.area-683"><span class="linenos">683</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Fragment.area-684"><a href="#Fragment.area-684"><span class="linenos">684</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Fragment.area-685"><a href="#Fragment.area-685"><span class="linenos">685</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Fragment.area-686"><a href="#Fragment.area-686"><span class="linenos">686</span></a>
</span><span id="Fragment.area-687"><a href="#Fragment.area-687"><span class="linenos">687</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the area of the shape.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>float: The area of the shape.</p>
</blockquote>
</div>


                            </div>
                            <div id="Fragment.sections" class="classattr">
                                <div class="attr variable">
            <span class="name">sections</span>

        
    </div>
    <a class="headerlink" href="#Fragment.sections"></a>
    
    

                            </div>
                            <div id="Fragment.intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">intersections</span>

        
    </div>
    <a class="headerlink" href="#Fragment.intersections"></a>
    
    

                            </div>
                            <div id="Fragment.inner_lines" class="classattr">
                                <div class="attr variable">
            <span class="name">inner_lines</span>

        
    </div>
    <a class="headerlink" href="#Fragment.inner_lines"></a>
    
    

                            </div>
                            <div id="Fragment.CG" class="classattr">
                                <div class="attr variable">
            <span class="name">CG</span>

        
    </div>
    <a class="headerlink" href="#Fragment.CG"></a>
    
    

                            </div>
                            <div id="Fragment.divisions" class="classattr">
                                        <input id="Fragment.divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">divisions</span>

                <label class="view-source-button" for="Fragment.divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Fragment.divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Fragment.divisions-351"><a href="#Fragment.divisions-351"><span class="linenos">351</span></a>    <span class="nd">@property</span>
</span><span id="Fragment.divisions-352"><a href="#Fragment.divisions-352"><span class="linenos">352</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment.divisions-353"><a href="#Fragment.divisions-353"><span class="linenos">353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the fragment.</span>
</span><span id="Fragment.divisions-354"><a href="#Fragment.divisions-354"><span class="linenos">354</span></a>
</span><span id="Fragment.divisions-355"><a href="#Fragment.divisions-355"><span class="linenos">355</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment.divisions-356"><a href="#Fragment.divisions-356"><span class="linenos">356</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="Fragment.divisions-357"><a href="#Fragment.divisions-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment.divisions-358"><a href="#Fragment.divisions-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_divisions</span>
</span></pre></div>


            <div class="docstring"><p>Return the divisions of the fragment.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of divisions.</p>
</blockquote>
</div>


                            </div>
                            <div id="Fragment.center" class="classattr">
                                        <input id="Fragment.center-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">center</span>

                <label class="view-source-button" for="Fragment.center-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Fragment.center"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Fragment.center-360"><a href="#Fragment.center-360"><span class="linenos">360</span></a>    <span class="nd">@property</span>
</span><span id="Fragment.center-361"><a href="#Fragment.center-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Fragment.center-362"><a href="#Fragment.center-362"><span class="linenos">362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the fragment.</span>
</span><span id="Fragment.center-363"><a href="#Fragment.center-363"><span class="linenos">363</span></a>
</span><span id="Fragment.center-364"><a href="#Fragment.center-364"><span class="linenos">364</span></a><span class="sd">        Returns:</span>
</span><span id="Fragment.center-365"><a href="#Fragment.center-365"><span class="linenos">365</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="Fragment.center-366"><a href="#Fragment.center-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Fragment.center-367"><a href="#Fragment.center-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CG</span>
</span></pre></div>


            <div class="docstring"><p>Return the center of the fragment.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Center coordinates.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Fragment.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Fragment.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Fragment.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Fragment.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Fragment.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Fragment.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Fragment.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Fragment.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Fragment.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Fragment.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Fragment.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Fragment.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Fragment.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Fragment.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Fragment.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Fragment.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Fragment.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Fragment.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Fragment.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Fragment.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Fragment.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Fragment.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Fragment.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Fragment.copy" class="function"><a href="../graphics/shape.html#Shape.copy">copy</a></dd>
                <dd id="Fragment.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Fragment.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Fragment.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Fragment.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Fragment.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Fragment.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Fragment.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Fragment.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Fragment.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Fragment.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Fragment.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Fragment.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Fragment.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Fragment.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Fragment.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Section">
                            <input id="Section-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Section</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Section-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Section"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Section-421"><a href="#Section-421"><span class="linenos">421</span></a><span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Section-422"><a href="#Section-422"><span class="linenos">422</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A section is a line segment between two intersections.</span>
</span><span id="Section-423"><a href="#Section-423"><span class="linenos">423</span></a><span class="sd">    A division can have multiple sections. Sections are used to</span>
</span><span id="Section-424"><a href="#Section-424"><span class="linenos">424</span></a><span class="sd">    draw the over/under plaits.</span>
</span><span id="Section-425"><a href="#Section-425"><span class="linenos">425</span></a>
</span><span id="Section-426"><a href="#Section-426"><span class="linenos">426</span></a><span class="sd">    Args:</span>
</span><span id="Section-427"><a href="#Section-427"><span class="linenos">427</span></a><span class="sd">        start (Intersection): Start intersection.</span>
</span><span id="Section-428"><a href="#Section-428"><span class="linenos">428</span></a><span class="sd">        end (Intersection): End intersection.</span>
</span><span id="Section-429"><a href="#Section-429"><span class="linenos">429</span></a><span class="sd">        is_overlap (bool, optional): If the section is an overlap. Defaults to False.</span>
</span><span id="Section-430"><a href="#Section-430"><span class="linenos">430</span></a><span class="sd">        overlap (Overlap, optional): Overlap object. Defaults to None.</span>
</span><span id="Section-431"><a href="#Section-431"><span class="linenos">431</span></a><span class="sd">        is_over (bool, optional): If the section is over. Defaults to False.</span>
</span><span id="Section-432"><a href="#Section-432"><span class="linenos">432</span></a><span class="sd">        twin (Section, optional): Twin section. Defaults to None.</span>
</span><span id="Section-433"><a href="#Section-433"><span class="linenos">433</span></a><span class="sd">        fragment (Fragment, optional): Fragment object. Defaults to None.</span>
</span><span id="Section-434"><a href="#Section-434"><span class="linenos">434</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Section-435"><a href="#Section-435"><span class="linenos">435</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Section-436"><a href="#Section-436"><span class="linenos">436</span></a>
</span><span id="Section-437"><a href="#Section-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Section-438"><a href="#Section-438"><span class="linenos">438</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Section-439"><a href="#Section-439"><span class="linenos">439</span></a>        <span class="n">start</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section-440"><a href="#Section-440"><span class="linenos">440</span></a>        <span class="n">end</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section-441"><a href="#Section-441"><span class="linenos">441</span></a>        <span class="n">is_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Section-442"><a href="#Section-442"><span class="linenos">442</span></a>        <span class="n">overlap</span><span class="p">:</span> <span class="s2">&quot;Overlap&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section-443"><a href="#Section-443"><span class="linenos">443</span></a>        <span class="n">is_over</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Section-444"><a href="#Section-444"><span class="linenos">444</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="s2">&quot;Section&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section-445"><a href="#Section-445"><span class="linenos">445</span></a>        <span class="n">fragment</span><span class="p">:</span> <span class="s2">&quot;Fragment&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section-446"><a href="#Section-446"><span class="linenos">446</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Section-447"><a href="#Section-447"><span class="linenos">447</span></a>    <span class="p">):</span>
</span><span id="Section-448"><a href="#Section-448"><span class="linenos">448</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Section-449"><a href="#Section-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="Section-450"><a href="#Section-450"><span class="linenos">450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="Section-451"><a href="#Section-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="n">is_overlap</span>
</span><span id="Section-452"><a href="#Section-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="Section-453"><a href="#Section-453"><span class="linenos">453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="n">is_over</span>
</span><span id="Section-454"><a href="#Section-454"><span class="linenos">454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="Section-455"><a href="#Section-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span>
</span><span id="Section-456"><a href="#Section-456"><span class="linenos">456</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Section-457"><a href="#Section-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Section-458"><a href="#Section-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid_point</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Section-459"><a href="#Section-459"><span class="linenos">459</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Section-460"><a href="#Section-460"><span class="linenos">460</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Section-461"><a href="#Section-461"><span class="linenos">461</span></a>        <span class="p">]</span>
</span><span id="Section-462"><a href="#Section-462"><span class="linenos">462</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Section-463"><a href="#Section-463"><span class="linenos">463</span></a>
</span><span id="Section-464"><a href="#Section-464"><span class="linenos">464</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section-465"><a href="#Section-465"><span class="linenos">465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the section.</span>
</span><span id="Section-466"><a href="#Section-466"><span class="linenos">466</span></a>
</span><span id="Section-467"><a href="#Section-467"><span class="linenos">467</span></a><span class="sd">        Returns:</span>
</span><span id="Section-468"><a href="#Section-468"><span class="linenos">468</span></a><span class="sd">            Section: A copy of the section.</span>
</span><span id="Section-469"><a href="#Section-469"><span class="linenos">469</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section-470"><a href="#Section-470"><span class="linenos">470</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Section-471"><a href="#Section-471"><span class="linenos">471</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Section-472"><a href="#Section-472"><span class="linenos">472</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Section-473"><a href="#Section-473"><span class="linenos">473</span></a>        <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span><span class="p">)</span>
</span><span id="Section-474"><a href="#Section-474"><span class="linenos">474</span></a>
</span><span id="Section-475"><a href="#Section-475"><span class="linenos">475</span></a>        <span class="k">return</span> <span class="n">section</span>
</span><span id="Section-476"><a href="#Section-476"><span class="linenos">476</span></a>
</span><span id="Section-477"><a href="#Section-477"><span class="linenos">477</span></a>    <span class="k">def</span> <span class="nf">end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section-478"><a href="#Section-478"><span class="linenos">478</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end point of the section.</span>
</span><span id="Section-479"><a href="#Section-479"><span class="linenos">479</span></a>
</span><span id="Section-480"><a href="#Section-480"><span class="linenos">480</span></a><span class="sd">        Returns:</span>
</span><span id="Section-481"><a href="#Section-481"><span class="linenos">481</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="Section-482"><a href="#Section-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section-483"><a href="#Section-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="Section-484"><a href="#Section-484"><span class="linenos">484</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
</span><span id="Section-485"><a href="#Section-485"><span class="linenos">485</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="Section-486"><a href="#Section-486"><span class="linenos">486</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
</span><span id="Section-487"><a href="#Section-487"><span class="linenos">487</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Section-488"><a href="#Section-488"><span class="linenos">488</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Section-489"><a href="#Section-489"><span class="linenos">489</span></a>
</span><span id="Section-490"><a href="#Section-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Section-491"><a href="#Section-491"><span class="linenos">491</span></a>
</span><span id="Section-492"><a href="#Section-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section-493"><a href="#Section-493"><span class="linenos">493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the section.</span>
</span><span id="Section-494"><a href="#Section-494"><span class="linenos">494</span></a>
</span><span id="Section-495"><a href="#Section-495"><span class="linenos">495</span></a><span class="sd">        Returns:</span>
</span><span id="Section-496"><a href="#Section-496"><span class="linenos">496</span></a><span class="sd">            str: String representation.</span>
</span><span id="Section-497"><a href="#Section-497"><span class="linenos">497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section-498"><a href="#Section-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Section(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Section-499"><a href="#Section-499"><span class="linenos">499</span></a>
</span><span id="Section-500"><a href="#Section-500"><span class="linenos">500</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section-501"><a href="#Section-501"><span class="linenos">501</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the section.</span>
</span><span id="Section-502"><a href="#Section-502"><span class="linenos">502</span></a>
</span><span id="Section-503"><a href="#Section-503"><span class="linenos">503</span></a><span class="sd">        Returns:</span>
</span><span id="Section-504"><a href="#Section-504"><span class="linenos">504</span></a><span class="sd">            str: String representation.</span>
</span><span id="Section-505"><a href="#Section-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section-506"><a href="#Section-506"><span class="linenos">506</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="Section-507"><a href="#Section-507"><span class="linenos">507</span></a>
</span><span id="Section-508"><a href="#Section-508"><span class="linenos">508</span></a>    <span class="nd">@property</span>
</span><span id="Section-509"><a href="#Section-509"><span class="linenos">509</span></a>    <span class="k">def</span> <span class="nf">is_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section-510"><a href="#Section-510"><span class="linenos">510</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the section is an endpoint.</span>
</span><span id="Section-511"><a href="#Section-511"><span class="linenos">511</span></a>
</span><span id="Section-512"><a href="#Section-512"><span class="linenos">512</span></a><span class="sd">        Returns:</span>
</span><span id="Section-513"><a href="#Section-513"><span class="linenos">513</span></a><span class="sd">            bool: True if endpoint, False otherwise.</span>
</span><span id="Section-514"><a href="#Section-514"><span class="linenos">514</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section-515"><a href="#Section-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span>
</span></pre></div>


            <div class="docstring"><p>A section is a line segment between two intersections.
A division can have multiple sections. Sections are used to
draw the over/under plaits.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>start (Intersection):</strong>  Start intersection.</li>
<li><strong>end (Intersection):</strong>  End intersection.</li>
<li><strong>is_overlap (bool, optional):</strong>  If the section is an overlap. Defaults to False.</li>
<li><strong>overlap (Overlap, optional):</strong>  Overlap object. Defaults to None.</li>
<li><strong>is_over (bool, optional):</strong>  If the section is over. Defaults to False.</li>
<li><strong>twin (Section, optional):</strong>  Twin section. Defaults to None.</li>
<li><strong>fragment (Fragment, optional):</strong>  Fragment object. Defaults to None.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Section.__init__" class="classattr">
                                        <input id="Section.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Section</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start</span><span class="p">:</span> <span class="n"><a href="#Intersection">Intersection</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">end</span><span class="p">:</span> <span class="n"><a href="#Intersection">Intersection</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">is_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">overlap</span><span class="p">:</span> <span class="n"><a href="#Overlap">Overlap</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">is_over</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">twin</span><span class="p">:</span> <span class="n"><a href="#Section">Section</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fragment</span><span class="p">:</span> <span class="n"><a href="#Fragment">Fragment</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Section.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Section.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Section.__init__-437"><a href="#Section.__init__-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Section.__init__-438"><a href="#Section.__init__-438"><span class="linenos">438</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Section.__init__-439"><a href="#Section.__init__-439"><span class="linenos">439</span></a>        <span class="n">start</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section.__init__-440"><a href="#Section.__init__-440"><span class="linenos">440</span></a>        <span class="n">end</span><span class="p">:</span> <span class="n">Intersection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section.__init__-441"><a href="#Section.__init__-441"><span class="linenos">441</span></a>        <span class="n">is_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Section.__init__-442"><a href="#Section.__init__-442"><span class="linenos">442</span></a>        <span class="n">overlap</span><span class="p">:</span> <span class="s2">&quot;Overlap&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section.__init__-443"><a href="#Section.__init__-443"><span class="linenos">443</span></a>        <span class="n">is_over</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Section.__init__-444"><a href="#Section.__init__-444"><span class="linenos">444</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="s2">&quot;Section&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section.__init__-445"><a href="#Section.__init__-445"><span class="linenos">445</span></a>        <span class="n">fragment</span><span class="p">:</span> <span class="s2">&quot;Fragment&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Section.__init__-446"><a href="#Section.__init__-446"><span class="linenos">446</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Section.__init__-447"><a href="#Section.__init__-447"><span class="linenos">447</span></a>    <span class="p">):</span>
</span><span id="Section.__init__-448"><a href="#Section.__init__-448"><span class="linenos">448</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Section.__init__-449"><a href="#Section.__init__-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="Section.__init__-450"><a href="#Section.__init__-450"><span class="linenos">450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="Section.__init__-451"><a href="#Section.__init__-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="n">is_overlap</span>
</span><span id="Section.__init__-452"><a href="#Section.__init__-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="Section.__init__-453"><a href="#Section.__init__-453"><span class="linenos">453</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="n">is_over</span>
</span><span id="Section.__init__-454"><a href="#Section.__init__-454"><span class="linenos">454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="Section.__init__-455"><a href="#Section.__init__-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span>
</span><span id="Section.__init__-456"><a href="#Section.__init__-456"><span class="linenos">456</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">SECTION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Section.__init__-457"><a href="#Section.__init__-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Section.__init__-458"><a href="#Section.__init__-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid_point</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Section.__init__-459"><a href="#Section.__init__-459"><span class="linenos">459</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Section.__init__-460"><a href="#Section.__init__-460"><span class="linenos">460</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Section.__init__-461"><a href="#Section.__init__-461"><span class="linenos">461</span></a>        <span class="p">]</span>
</span><span id="Section.__init__-462"><a href="#Section.__init__-462"><span class="linenos">462</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Section.start" class="classattr">
                                <div class="attr variable">
            <span class="name">start</span>

        
    </div>
    <a class="headerlink" href="#Section.start"></a>
    
    

                            </div>
                            <div id="Section.end" class="classattr">
                                <div class="attr variable">
            <span class="name">end</span>

        
    </div>
    <a class="headerlink" href="#Section.end"></a>
    
    

                            </div>
                            <div id="Section.is_overlap" class="classattr">
                                <div class="attr variable">
            <span class="name">is_overlap</span>

        
    </div>
    <a class="headerlink" href="#Section.is_overlap"></a>
    
    

                            </div>
                            <div id="Section.overlap" class="classattr">
                                <div class="attr variable">
            <span class="name">overlap</span>

        
    </div>
    <a class="headerlink" href="#Section.overlap"></a>
    
    

                            </div>
                            <div id="Section.is_over" class="classattr">
                                <div class="attr variable">
            <span class="name">is_over</span>

        
    </div>
    <a class="headerlink" href="#Section.is_over"></a>
    
    

                            </div>
                            <div id="Section.twin" class="classattr">
                                <div class="attr variable">
            <span class="name">twin</span>

        
    </div>
    <a class="headerlink" href="#Section.twin"></a>
    
    

                            </div>
                            <div id="Section.fragment" class="classattr">
                                <div class="attr variable">
            <span class="name">fragment</span>

        
    </div>
    <a class="headerlink" href="#Section.fragment"></a>
    
    

                            </div>
                            <div id="Section.length" class="classattr">
                                <div class="attr variable">
            <span class="name">length</span>

        
    </div>
    <a class="headerlink" href="#Section.length"></a>
    
    

                            </div>
                            <div id="Section.mid_point" class="classattr">
                                <div class="attr variable">
            <span class="name">mid_point</span>

        
    </div>
    <a class="headerlink" href="#Section.mid_point"></a>
    
    

                            </div>
                            <div id="Section.copy" class="classattr">
                                        <input id="Section.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Section.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Section.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Section.copy-464"><a href="#Section.copy-464"><span class="linenos">464</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section.copy-465"><a href="#Section.copy-465"><span class="linenos">465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the section.</span>
</span><span id="Section.copy-466"><a href="#Section.copy-466"><span class="linenos">466</span></a>
</span><span id="Section.copy-467"><a href="#Section.copy-467"><span class="linenos">467</span></a><span class="sd">        Returns:</span>
</span><span id="Section.copy-468"><a href="#Section.copy-468"><span class="linenos">468</span></a><span class="sd">            Section: A copy of the section.</span>
</span><span id="Section.copy-469"><a href="#Section.copy-469"><span class="linenos">469</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section.copy-470"><a href="#Section.copy-470"><span class="linenos">470</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Section.copy-471"><a href="#Section.copy-471"><span class="linenos">471</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Section.copy-472"><a href="#Section.copy-472"><span class="linenos">472</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Section.copy-473"><a href="#Section.copy-473"><span class="linenos">473</span></a>        <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span><span class="p">)</span>
</span><span id="Section.copy-474"><a href="#Section.copy-474"><span class="linenos">474</span></a>
</span><span id="Section.copy-475"><a href="#Section.copy-475"><span class="linenos">475</span></a>        <span class="k">return</span> <span class="n">section</span>
</span></pre></div>


            <div class="docstring"><p>Create a copy of the section.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Section: A copy of the section.</p>
</blockquote>
</div>


                            </div>
                            <div id="Section.end_point" class="classattr">
                                        <input id="Section.end_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">end_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Section.end_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Section.end_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Section.end_point-477"><a href="#Section.end_point-477"><span class="linenos">477</span></a>    <span class="k">def</span> <span class="nf">end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section.end_point-478"><a href="#Section.end_point-478"><span class="linenos">478</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end point of the section.</span>
</span><span id="Section.end_point-479"><a href="#Section.end_point-479"><span class="linenos">479</span></a>
</span><span id="Section.end_point-480"><a href="#Section.end_point-480"><span class="linenos">480</span></a><span class="sd">        Returns:</span>
</span><span id="Section.end_point-481"><a href="#Section.end_point-481"><span class="linenos">481</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="Section.end_point-482"><a href="#Section.end_point-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section.end_point-483"><a href="#Section.end_point-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="Section.end_point-484"><a href="#Section.end_point-484"><span class="linenos">484</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
</span><span id="Section.end_point-485"><a href="#Section.end_point-485"><span class="linenos">485</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
</span><span id="Section.end_point-486"><a href="#Section.end_point-486"><span class="linenos">486</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
</span><span id="Section.end_point-487"><a href="#Section.end_point-487"><span class="linenos">487</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Section.end_point-488"><a href="#Section.end_point-488"><span class="linenos">488</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Section.end_point-489"><a href="#Section.end_point-489"><span class="linenos">489</span></a>
</span><span id="Section.end_point-490"><a href="#Section.end_point-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the end point of the section.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Intersection: End intersection.</p>
</blockquote>
</div>


                            </div>
                            <div id="Section.is_endpoint" class="classattr">
                                        <input id="Section.is_endpoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_endpoint</span>

                <label class="view-source-button" for="Section.is_endpoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Section.is_endpoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Section.is_endpoint-508"><a href="#Section.is_endpoint-508"><span class="linenos">508</span></a>    <span class="nd">@property</span>
</span><span id="Section.is_endpoint-509"><a href="#Section.is_endpoint-509"><span class="linenos">509</span></a>    <span class="k">def</span> <span class="nf">is_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Section.is_endpoint-510"><a href="#Section.is_endpoint-510"><span class="linenos">510</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the section is an endpoint.</span>
</span><span id="Section.is_endpoint-511"><a href="#Section.is_endpoint-511"><span class="linenos">511</span></a>
</span><span id="Section.is_endpoint-512"><a href="#Section.is_endpoint-512"><span class="linenos">512</span></a><span class="sd">        Returns:</span>
</span><span id="Section.is_endpoint-513"><a href="#Section.is_endpoint-513"><span class="linenos">513</span></a><span class="sd">            bool: True if endpoint, False otherwise.</span>
</span><span id="Section.is_endpoint-514"><a href="#Section.is_endpoint-514"><span class="linenos">514</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Section.is_endpoint-515"><a href="#Section.is_endpoint-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">endpoint</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the section is an endpoint.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if endpoint, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Section.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Section.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Section.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Section.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Section.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Section.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Section.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Section.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Section.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Section.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Section.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Section.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Section.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Section.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Section.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Section.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Section.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Section.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Section.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Section.area" class="variable"><a href="../graphics/shape.html#Shape.area">area</a></dd>
                <dd id="Section.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Section.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Section.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Section.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Section.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Section.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Section.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Section.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Section.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Section.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Section.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Section.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Section.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Section.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Section.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Section.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Section.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Section.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Section.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Overlap">
                            <input id="Overlap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Overlap</span><wbr>(<span class="base"><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></span>):

                <label class="view-source-button" for="Overlap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Overlap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Overlap-518"><a href="#Overlap-518"><span class="linenos">518</span></a><span class="k">class</span> <span class="nc">Overlap</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="Overlap-519"><a href="#Overlap-519"><span class="linenos">519</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An overlap is a collection of four connected sections.</span>
</span><span id="Overlap-520"><a href="#Overlap-520"><span class="linenos">520</span></a>
</span><span id="Overlap-521"><a href="#Overlap-521"><span class="linenos">521</span></a><span class="sd">    Args:</span>
</span><span id="Overlap-522"><a href="#Overlap-522"><span class="linenos">522</span></a><span class="sd">        intersections (list[Intersection], optional): List of intersections. Defaults to None.</span>
</span><span id="Overlap-523"><a href="#Overlap-523"><span class="linenos">523</span></a><span class="sd">        sections (list[Section], optional): List of sections. Defaults to None.</span>
</span><span id="Overlap-524"><a href="#Overlap-524"><span class="linenos">524</span></a><span class="sd">        visited (bool, optional): If the overlap is visited. Defaults to False.</span>
</span><span id="Overlap-525"><a href="#Overlap-525"><span class="linenos">525</span></a><span class="sd">        drawable (bool, optional): If the overlap is drawable. Defaults to True.</span>
</span><span id="Overlap-526"><a href="#Overlap-526"><span class="linenos">526</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Overlap-527"><a href="#Overlap-527"><span class="linenos">527</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Overlap-528"><a href="#Overlap-528"><span class="linenos">528</span></a>
</span><span id="Overlap-529"><a href="#Overlap-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Overlap-530"><a href="#Overlap-530"><span class="linenos">530</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Overlap-531"><a href="#Overlap-531"><span class="linenos">531</span></a>        <span class="n">intersections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Overlap-532"><a href="#Overlap-532"><span class="linenos">532</span></a>        <span class="n">sections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Section</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Overlap-533"><a href="#Overlap-533"><span class="linenos">533</span></a>        <span class="n">visited</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Overlap-534"><a href="#Overlap-534"><span class="linenos">534</span></a>        <span class="n">drawable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Overlap-535"><a href="#Overlap-535"><span class="linenos">535</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Overlap-536"><a href="#Overlap-536"><span class="linenos">536</span></a>    <span class="p">):</span>
</span><span id="Overlap-537"><a href="#Overlap-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="Overlap-538"><a href="#Overlap-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
</span><span id="Overlap-539"><a href="#Overlap-539"><span class="linenos">539</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Overlap-540"><a href="#Overlap-540"><span class="linenos">540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">OVERLAP</span>
</span><span id="Overlap-541"><a href="#Overlap-541"><span class="linenos">541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="n">visited</span>
</span><span id="Overlap-542"><a href="#Overlap-542"><span class="linenos">542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawable</span> <span class="o">=</span> <span class="n">drawable</span>
</span><span id="Overlap-543"><a href="#Overlap-543"><span class="linenos">543</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Overlap-544"><a href="#Overlap-544"><span class="linenos">544</span></a>
</span><span id="Overlap-545"><a href="#Overlap-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Overlap-546"><a href="#Overlap-546"><span class="linenos">546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the overlap.</span>
</span><span id="Overlap-547"><a href="#Overlap-547"><span class="linenos">547</span></a>
</span><span id="Overlap-548"><a href="#Overlap-548"><span class="linenos">548</span></a><span class="sd">        Returns:</span>
</span><span id="Overlap-549"><a href="#Overlap-549"><span class="linenos">549</span></a><span class="sd">            str: String representation.</span>
</span><span id="Overlap-550"><a href="#Overlap-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Overlap-551"><a href="#Overlap-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Overlap(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Overlap-552"><a href="#Overlap-552"><span class="linenos">552</span></a>
</span><span id="Overlap-553"><a href="#Overlap-553"><span class="linenos">553</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Overlap-554"><a href="#Overlap-554"><span class="linenos">554</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the overlap.</span>
</span><span id="Overlap-555"><a href="#Overlap-555"><span class="linenos">555</span></a>
</span><span id="Overlap-556"><a href="#Overlap-556"><span class="linenos">556</span></a><span class="sd">        Returns:</span>
</span><span id="Overlap-557"><a href="#Overlap-557"><span class="linenos">557</span></a><span class="sd">            str: String representation.</span>
</span><span id="Overlap-558"><a href="#Overlap-558"><span class="linenos">558</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Overlap-559"><a href="#Overlap-559"><span class="linenos">559</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Overlap(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>An overlap is a collection of four connected sections.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>intersections (list[Intersection], optional):</strong>  List of intersections. Defaults to None.</li>
<li><strong>sections (list[Section], optional):</strong>  List of sections. Defaults to None.</li>
<li><strong>visited (bool, optional):</strong>  If the overlap is visited. Defaults to False.</li>
<li><strong>drawable (bool, optional):</strong>  If the overlap is drawable. Defaults to True.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Overlap.__init__" class="classattr">
                                        <input id="Overlap.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Overlap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">intersections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Section">Section</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">visited</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">drawable</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Overlap.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Overlap.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Overlap.__init__-529"><a href="#Overlap.__init__-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Overlap.__init__-530"><a href="#Overlap.__init__-530"><span class="linenos">530</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Overlap.__init__-531"><a href="#Overlap.__init__-531"><span class="linenos">531</span></a>        <span class="n">intersections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Overlap.__init__-532"><a href="#Overlap.__init__-532"><span class="linenos">532</span></a>        <span class="n">sections</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Section</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Overlap.__init__-533"><a href="#Overlap.__init__-533"><span class="linenos">533</span></a>        <span class="n">visited</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Overlap.__init__-534"><a href="#Overlap.__init__-534"><span class="linenos">534</span></a>        <span class="n">drawable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Overlap.__init__-535"><a href="#Overlap.__init__-535"><span class="linenos">535</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Overlap.__init__-536"><a href="#Overlap.__init__-536"><span class="linenos">536</span></a>    <span class="p">):</span>
</span><span id="Overlap.__init__-537"><a href="#Overlap.__init__-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="Overlap.__init__-538"><a href="#Overlap.__init__-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
</span><span id="Overlap.__init__-539"><a href="#Overlap.__init__-539"><span class="linenos">539</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Overlap.__init__-540"><a href="#Overlap.__init__-540"><span class="linenos">540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">OVERLAP</span>
</span><span id="Overlap.__init__-541"><a href="#Overlap.__init__-541"><span class="linenos">541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="n">visited</span>
</span><span id="Overlap.__init__-542"><a href="#Overlap.__init__-542"><span class="linenos">542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">drawable</span> <span class="o">=</span> <span class="n">drawable</span>
</span><span id="Overlap.__init__-543"><a href="#Overlap.__init__-543"><span class="linenos">543</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Batch object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>elements (Sequence[Any], optional):</strong>  The elements to include in the batch.</li>
<li><strong>modifiers (Sequence[Modifier], optional):</strong>  The modifiers to apply to the batch.</li>
<li><strong>subtype (Types, optional):</strong>  The subtype of the batch.</li>
<li><strong>kwargs (dict):</strong>  Additional keyword arguments.</li>
</ul>
</div>


                            </div>
                            <div id="Overlap.intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">intersections</span>

        
    </div>
    <a class="headerlink" href="#Overlap.intersections"></a>
    
    

                            </div>
                            <div id="Overlap.sections" class="classattr">
                                <div class="attr variable">
            <span class="name">sections</span>

        
    </div>
    <a class="headerlink" href="#Overlap.sections"></a>
    
    

                            </div>
                            <div id="Overlap.subtype" class="classattr">
                                <div class="attr variable">
            <span class="name">subtype</span>

        
    </div>
    <a class="headerlink" href="#Overlap.subtype"></a>
    
    

                            </div>
                            <div id="Overlap.visited" class="classattr">
                                <div class="attr variable">
            <span class="name">visited</span>

        
    </div>
    <a class="headerlink" href="#Overlap.visited"></a>
    
    

                            </div>
                            <div id="Overlap.drawable" class="classattr">
                                <div class="attr variable">
            <span class="name">drawable</span>

        
    </div>
    <a class="headerlink" href="#Overlap.drawable"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></dt>
                                <dd id="Overlap.type" class="variable"><a href="../graphics/batch.html#Batch.type">type</a></dd>
                <dd id="Overlap.modifiers" class="variable"><a href="../graphics/batch.html#Batch.modifiers">modifiers</a></dd>
                <dd id="Overlap.blend_mode" class="variable"><a href="../graphics/batch.html#Batch.blend_mode">blend_mode</a></dd>
                <dd id="Overlap.alpha" class="variable"><a href="../graphics/batch.html#Batch.alpha">alpha</a></dd>
                <dd id="Overlap.line_alpha" class="variable"><a href="../graphics/batch.html#Batch.line_alpha">line_alpha</a></dd>
                <dd id="Overlap.fill_alpha" class="variable"><a href="../graphics/batch.html#Batch.fill_alpha">fill_alpha</a></dd>
                <dd id="Overlap.text_alpha" class="variable"><a href="../graphics/batch.html#Batch.text_alpha">text_alpha</a></dd>
                <dd id="Overlap.clip" class="variable"><a href="../graphics/batch.html#Batch.clip">clip</a></dd>
                <dd id="Overlap.mask" class="variable"><a href="../graphics/batch.html#Batch.mask">mask</a></dd>
                <dd id="Overlap.even_odd_rule" class="variable"><a href="../graphics/batch.html#Batch.even_odd_rule">even_odd_rule</a></dd>
                <dd id="Overlap.blend_group" class="variable"><a href="../graphics/batch.html#Batch.blend_group">blend_group</a></dd>
                <dd id="Overlap.transparency_group" class="variable"><a href="../graphics/batch.html#Batch.transparency_group">transparency_group</a></dd>
                <dd id="Overlap.set_attribs" class="function"><a href="../graphics/batch.html#Batch.set_attribs">set_attribs</a></dd>
                <dd id="Overlap.set_batch_attr" class="function"><a href="../graphics/batch.html#Batch.set_batch_attr">set_batch_attr</a></dd>
                <dd id="Overlap.proximity" class="function"><a href="../graphics/batch.html#Batch.proximity">proximity</a></dd>
                <dd id="Overlap.append" class="function"><a href="../graphics/batch.html#Batch.append">append</a></dd>
                <dd id="Overlap.reverse" class="function"><a href="../graphics/batch.html#Batch.reverse">reverse</a></dd>
                <dd id="Overlap.insert" class="function"><a href="../graphics/batch.html#Batch.insert">insert</a></dd>
                <dd id="Overlap.remove" class="function"><a href="../graphics/batch.html#Batch.remove">remove</a></dd>
                <dd id="Overlap.pop" class="function"><a href="../graphics/batch.html#Batch.pop">pop</a></dd>
                <dd id="Overlap.clear" class="function"><a href="../graphics/batch.html#Batch.clear">clear</a></dd>
                <dd id="Overlap.extend" class="function"><a href="../graphics/batch.html#Batch.extend">extend</a></dd>
                <dd id="Overlap.iter_elements" class="function"><a href="../graphics/batch.html#Batch.iter_elements">iter_elements</a></dd>
                <dd id="Overlap.all_elements" class="variable"><a href="../graphics/batch.html#Batch.all_elements">all_elements</a></dd>
                <dd id="Overlap.all_shapes" class="variable"><a href="../graphics/batch.html#Batch.all_shapes">all_shapes</a></dd>
                <dd id="Overlap.all_vertices" class="variable"><a href="../graphics/batch.html#Batch.all_vertices">all_vertices</a></dd>
                <dd id="Overlap.all_segments" class="variable"><a href="../graphics/batch.html#Batch.all_segments">all_segments</a></dd>
                <dd id="Overlap.as_graph" class="function"><a href="../graphics/batch.html#Batch.as_graph">as_graph</a></dd>
                <dd id="Overlap.graph_summary" class="function"><a href="../graphics/batch.html#Batch.graph_summary">graph_summary</a></dd>
                <dd id="Overlap.merge_shapes" class="function"><a href="../graphics/batch.html#Batch.merge_shapes">merge_shapes</a></dd>
                <dd id="Overlap.all_polygons" class="function"><a href="../graphics/batch.html#Batch.all_polygons">all_polygons</a></dd>
                <dd id="Overlap.copy" class="function"><a href="../graphics/batch.html#Batch.copy">copy</a></dd>
                <dd id="Overlap.b_box" class="variable"><a href="../graphics/batch.html#Batch.b_box">b_box</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Overlap.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Overlap.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Overlap.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Overlap.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Overlap.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Overlap.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Overlap.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Overlap.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Overlap.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Overlap.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Overlap.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Overlap.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Division">
                            <input id="Division-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Division</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Division-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division-562"><a href="#Division-562"><span class="linenos">562</span></a><span class="k">class</span> <span class="nc">Division</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Division-563"><a href="#Division-563"><span class="linenos">563</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A division is a line segment between two intersections.</span>
</span><span id="Division-564"><a href="#Division-564"><span class="linenos">564</span></a>
</span><span id="Division-565"><a href="#Division-565"><span class="linenos">565</span></a><span class="sd">    Args:</span>
</span><span id="Division-566"><a href="#Division-566"><span class="linenos">566</span></a><span class="sd">        p1 (tuple): Start point.</span>
</span><span id="Division-567"><a href="#Division-567"><span class="linenos">567</span></a><span class="sd">        p2 (tuple): End point.</span>
</span><span id="Division-568"><a href="#Division-568"><span class="linenos">568</span></a><span class="sd">        xform_matrix (array, optional): Transformation matrix. Defaults to None.</span>
</span><span id="Division-569"><a href="#Division-569"><span class="linenos">569</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Division-570"><a href="#Division-570"><span class="linenos">570</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Division-571"><a href="#Division-571"><span class="linenos">571</span></a>
</span><span id="Division-572"><a href="#Division-572"><span class="linenos">572</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Division-573"><a href="#Division-573"><span class="linenos">573</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Division-574"><a href="#Division-574"><span class="linenos">574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="Division-575"><a href="#Division-575"><span class="linenos">575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="Division-576"><a href="#Division-576"><span class="linenos">576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division-577"><a href="#Division-577"><span class="linenos">577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division-578"><a href="#Division-578"><span class="linenos">578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division-579"><a href="#Division-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division-580"><a href="#Division-580"><span class="linenos">580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division-581"><a href="#Division-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division-582"><a href="#Division-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division-583"><a href="#Division-583"><span class="linenos">583</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Division-584"><a href="#Division-584"><span class="linenos">584</span></a>            <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Division-585"><a href="#Division-585"><span class="linenos">585</span></a>        <span class="p">)</span>
</span><span id="Division-586"><a href="#Division-586"><span class="linenos">586</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Division-587"><a href="#Division-587"><span class="linenos">587</span></a>
</span><span id="Division-588"><a href="#Division-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Division-589"><a href="#Division-589"><span class="linenos">589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the division.</span>
</span><span id="Division-590"><a href="#Division-590"><span class="linenos">590</span></a>
</span><span id="Division-591"><a href="#Division-591"><span class="linenos">591</span></a><span class="sd">        Args:</span>
</span><span id="Division-592"><a href="#Division-592"><span class="linenos">592</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="Division-593"><a href="#Division-593"><span class="linenos">593</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="Division-594"><a href="#Division-594"><span class="linenos">594</span></a>
</span><span id="Division-595"><a href="#Division-595"><span class="linenos">595</span></a><span class="sd">        Returns:</span>
</span><span id="Division-596"><a href="#Division-596"><span class="linenos">596</span></a><span class="sd">            Any: Updated division or list of updated divisions.</span>
</span><span id="Division-597"><a href="#Division-597"><span class="linenos">597</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-598"><a href="#Division-598"><span class="linenos">598</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Division-599"><a href="#Division-599"><span class="linenos">599</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="Division-600"><a href="#Division-600"><span class="linenos">600</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Division-601"><a href="#Division-601"><span class="linenos">601</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Division-602"><a href="#Division-602"><span class="linenos">602</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division-603"><a href="#Division-603"><span class="linenos">603</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="Division-604"><a href="#Division-604"><span class="linenos">604</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Division-605"><a href="#Division-605"><span class="linenos">605</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Division-606"><a href="#Division-606"><span class="linenos">606</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Division-607"><a href="#Division-607"><span class="linenos">607</span></a>
</span><span id="Division-608"><a href="#Division-608"><span class="linenos">608</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Division-609"><a href="#Division-609"><span class="linenos">609</span></a>
</span><span id="Division-610"><a href="#Division-610"><span class="linenos">610</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Division-611"><a href="#Division-611"><span class="linenos">611</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the division.</span>
</span><span id="Division-612"><a href="#Division-612"><span class="linenos">612</span></a>
</span><span id="Division-613"><a href="#Division-613"><span class="linenos">613</span></a><span class="sd">        Returns:</span>
</span><span id="Division-614"><a href="#Division-614"><span class="linenos">614</span></a><span class="sd">            str: String representation.</span>
</span><span id="Division-615"><a href="#Division-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-616"><a href="#Division-616"><span class="linenos">616</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Division-617"><a href="#Division-617"><span class="linenos">617</span></a>            <span class="sa">f</span><span class="s2">&quot;Division((</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">), &quot;</span>
</span><span id="Division-618"><a href="#Division-618"><span class="linenos">618</span></a>            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="Division-619"><a href="#Division-619"><span class="linenos">619</span></a>        <span class="p">)</span>
</span><span id="Division-620"><a href="#Division-620"><span class="linenos">620</span></a>
</span><span id="Division-621"><a href="#Division-621"><span class="linenos">621</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Division-622"><a href="#Division-622"><span class="linenos">622</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the division.</span>
</span><span id="Division-623"><a href="#Division-623"><span class="linenos">623</span></a>
</span><span id="Division-624"><a href="#Division-624"><span class="linenos">624</span></a><span class="sd">        Returns:</span>
</span><span id="Division-625"><a href="#Division-625"><span class="linenos">625</span></a><span class="sd">            str: String representation.</span>
</span><span id="Division-626"><a href="#Division-626"><span class="linenos">626</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-627"><a href="#Division-627"><span class="linenos">627</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Division-628"><a href="#Division-628"><span class="linenos">628</span></a>            <span class="sa">f</span><span class="s2">&quot;Division((</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">), &quot;</span>
</span><span id="Division-629"><a href="#Division-629"><span class="linenos">629</span></a>            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="Division-630"><a href="#Division-630"><span class="linenos">630</span></a>        <span class="p">)</span>
</span><span id="Division-631"><a href="#Division-631"><span class="linenos">631</span></a>
</span><span id="Division-632"><a href="#Division-632"><span class="linenos">632</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
</span><span id="Division-633"><a href="#Division-633"><span class="linenos">633</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Division-634"><a href="#Division-634"><span class="linenos">634</span></a>        <span class="n">section</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Division-635"><a href="#Division-635"><span class="linenos">635</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Division-636"><a href="#Division-636"><span class="linenos">636</span></a>    <span class="p">):</span>
</span><span id="Division-637"><a href="#Division-637"><span class="linenos">637</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the division.</span>
</span><span id="Division-638"><a href="#Division-638"><span class="linenos">638</span></a>
</span><span id="Division-639"><a href="#Division-639"><span class="linenos">639</span></a><span class="sd">        Args:</span>
</span><span id="Division-640"><a href="#Division-640"><span class="linenos">640</span></a><span class="sd">            section (Section, optional): Section object. Defaults to None.</span>
</span><span id="Division-641"><a href="#Division-641"><span class="linenos">641</span></a><span class="sd">            twin (Section, optional): Twin section. Defaults to None.</span>
</span><span id="Division-642"><a href="#Division-642"><span class="linenos">642</span></a>
</span><span id="Division-643"><a href="#Division-643"><span class="linenos">643</span></a><span class="sd">        Returns:</span>
</span><span id="Division-644"><a href="#Division-644"><span class="linenos">644</span></a><span class="sd">            Division: A copy of the division.</span>
</span><span id="Division-645"><a href="#Division-645"><span class="linenos">645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-646"><a href="#Division-646"><span class="linenos">646</span></a>        <span class="n">division</span> <span class="o">=</span> <span class="n">Division</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[:],</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">))</span>
</span><span id="Division-647"><a href="#Division-647"><span class="linenos">647</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Division-648"><a href="#Division-648"><span class="linenos">648</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Division-649"><a href="#Division-649"><span class="linenos">649</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="Division-650"><a href="#Division-650"><span class="linenos">650</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="Division-651"><a href="#Division-651"><span class="linenos">651</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="Division-652"><a href="#Division-652"><span class="linenos">652</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span>
</span><span id="Division-653"><a href="#Division-653"><span class="linenos">653</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev</span>
</span><span id="Division-654"><a href="#Division-654"><span class="linenos">654</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">]</span>
</span><span id="Division-655"><a href="#Division-655"><span class="linenos">655</span></a>        <span class="n">custom_attributes_</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Division-656"><a href="#Division-656"><span class="linenos">656</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attributes_</span><span class="p">:</span>
</span><span id="Division-657"><a href="#Division-657"><span class="linenos">657</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Division-658"><a href="#Division-658"><span class="linenos">658</span></a>        <span class="k">return</span> <span class="n">division</span>
</span><span id="Division-659"><a href="#Division-659"><span class="linenos">659</span></a>
</span><span id="Division-660"><a href="#Division-660"><span class="linenos">660</span></a>    <span class="k">def</span> <span class="nf">_merged_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Division-661"><a href="#Division-661"><span class="linenos">661</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge sections of the division.</span>
</span><span id="Division-662"><a href="#Division-662"><span class="linenos">662</span></a>
</span><span id="Division-663"><a href="#Division-663"><span class="linenos">663</span></a><span class="sd">        Returns:</span>
</span><span id="Division-664"><a href="#Division-664"><span class="linenos">664</span></a><span class="sd">            list: List of merged sections.</span>
</span><span id="Division-665"><a href="#Division-665"><span class="linenos">665</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-666"><a href="#Division-666"><span class="linenos">666</span></a>        <span class="n">chains</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division-667"><a href="#Division-667"><span class="linenos">667</span></a>        <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Division-668"><a href="#Division-668"><span class="linenos">668</span></a>        <span class="n">sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[:]</span>
</span><span id="Division-669"><a href="#Division-669"><span class="linenos">669</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="Division-670"><a href="#Division-670"><span class="linenos">670</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">section</span><span class="o">.</span><span class="n">is_over</span><span class="p">:</span>
</span><span id="Division-671"><a href="#Division-671"><span class="linenos">671</span></a>                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">chain</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
</span><span id="Division-672"><a href="#Division-672"><span class="linenos">672</span></a>                    <span class="n">chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
</span><span id="Division-673"><a href="#Division-673"><span class="linenos">673</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Division-674"><a href="#Division-674"><span class="linenos">674</span></a>                    <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span><span id="Division-675"><a href="#Division-675"><span class="linenos">675</span></a>                    <span class="n">chain</span> <span class="o">=</span> <span class="p">[</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="Division-676"><a href="#Division-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="n">chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
</span><span id="Division-677"><a href="#Division-677"><span class="linenos">677</span></a>            <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span><span id="Division-678"><a href="#Division-678"><span class="linenos">678</span></a>        <span class="k">return</span> <span class="n">chains</span>
</span><span id="Division-679"><a href="#Division-679"><span class="linenos">679</span></a>
</span><span id="Division-680"><a href="#Division-680"><span class="linenos">680</span></a>    <span class="k">def</span> <span class="nf">_sort_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Division-681"><a href="#Division-681"><span class="linenos">681</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort intersections of the division.&quot;&quot;&quot;</span>
</span><span id="Division-682"><a href="#Division-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">point</span><span class="p">))</span>
</span><span id="Division-683"><a href="#Division-683"><span class="linenos">683</span></a>
</span><span id="Division-684"><a href="#Division-684"><span class="linenos">684</span></a>    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Division-685"><a href="#Division-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the division is connected to another division.</span>
</span><span id="Division-686"><a href="#Division-686"><span class="linenos">686</span></a>
</span><span id="Division-687"><a href="#Division-687"><span class="linenos">687</span></a><span class="sd">        Args:</span>
</span><span id="Division-688"><a href="#Division-688"><span class="linenos">688</span></a><span class="sd">            other (Division): Another division.</span>
</span><span id="Division-689"><a href="#Division-689"><span class="linenos">689</span></a>
</span><span id="Division-690"><a href="#Division-690"><span class="linenos">690</span></a><span class="sd">        Returns:</span>
</span><span id="Division-691"><a href="#Division-691"><span class="linenos">691</span></a><span class="sd">            bool: True if connected, False otherwise.</span>
</span><span id="Division-692"><a href="#Division-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-693"><a href="#Division-693"><span class="linenos">693</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span>
</span><span id="Division-694"><a href="#Division-694"><span class="linenos">694</span></a>
</span><span id="Division-695"><a href="#Division-695"><span class="linenos">695</span></a>    <span class="nd">@property</span>
</span><span id="Division-696"><a href="#Division-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">end_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Division-697"><a href="#Division-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end points of the division.</span>
</span><span id="Division-698"><a href="#Division-698"><span class="linenos">698</span></a>
</span><span id="Division-699"><a href="#Division-699"><span class="linenos">699</span></a><span class="sd">        Returns:</span>
</span><span id="Division-700"><a href="#Division-700"><span class="linenos">700</span></a><span class="sd">            list: List of end points.</span>
</span><span id="Division-701"><a href="#Division-701"><span class="linenos">701</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-702"><a href="#Division-702"><span class="linenos">702</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span>
</span><span id="Division-703"><a href="#Division-703"><span class="linenos">703</span></a>
</span><span id="Division-704"><a href="#Division-704"><span class="linenos">704</span></a>    <span class="nd">@property</span>
</span><span id="Division-705"><a href="#Division-705"><span class="linenos">705</span></a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="Division-706"><a href="#Division-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the start intersection of the division.</span>
</span><span id="Division-707"><a href="#Division-707"><span class="linenos">707</span></a>
</span><span id="Division-708"><a href="#Division-708"><span class="linenos">708</span></a><span class="sd">        Returns:</span>
</span><span id="Division-709"><a href="#Division-709"><span class="linenos">709</span></a><span class="sd">            Intersection: Start intersection.</span>
</span><span id="Division-710"><a href="#Division-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-711"><a href="#Division-711"><span class="linenos">711</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Division-712"><a href="#Division-712"><span class="linenos">712</span></a>
</span><span id="Division-713"><a href="#Division-713"><span class="linenos">713</span></a>    <span class="nd">@property</span>
</span><span id="Division-714"><a href="#Division-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="Division-715"><a href="#Division-715"><span class="linenos">715</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end intersection of the division.</span>
</span><span id="Division-716"><a href="#Division-716"><span class="linenos">716</span></a>
</span><span id="Division-717"><a href="#Division-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="Division-718"><a href="#Division-718"><span class="linenos">718</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="Division-719"><a href="#Division-719"><span class="linenos">719</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division-720"><a href="#Division-720"><span class="linenos">720</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A division is a line segment between two intersections.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>p1 (tuple):</strong>  Start point.</li>
<li><strong>p2 (tuple):</strong>  End point.</li>
<li><strong>xform_matrix (array, optional):</strong>  Transformation matrix. Defaults to None.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Division.__init__" class="classattr">
                                        <input id="Division.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Division</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span>, </span><span class="param"><span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Division.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.__init__-572"><a href="#Division.__init__-572"><span class="linenos">572</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Division.__init__-573"><a href="#Division.__init__-573"><span class="linenos">573</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Division.__init__-574"><a href="#Division.__init__-574"><span class="linenos">574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="Division.__init__-575"><a href="#Division.__init__-575"><span class="linenos">575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="Division.__init__-576"><a href="#Division.__init__-576"><span class="linenos">576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division.__init__-577"><a href="#Division.__init__-577"><span class="linenos">577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division.__init__-578"><a href="#Division.__init__-578"><span class="linenos">578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division.__init__-579"><a href="#Division.__init__-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division.__init__-580"><a href="#Division.__init__-580"><span class="linenos">580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division.__init__-581"><a href="#Division.__init__-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># used for fragment divisions only</span>
</span><span id="Division.__init__-582"><a href="#Division.__init__-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Division.__init__-583"><a href="#Division.__init__-583"><span class="linenos">583</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Division.__init__-584"><a href="#Division.__init__-584"><span class="linenos">584</span></a>            <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">subtype</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">DIVISION</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Division.__init__-585"><a href="#Division.__init__-585"><span class="linenos">585</span></a>        <span class="p">)</span>
</span><span id="Division.__init__-586"><a href="#Division.__init__-586"><span class="linenos">586</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Division.p1" class="classattr">
                                <div class="attr variable">
            <span class="name">p1</span>

        
    </div>
    <a class="headerlink" href="#Division.p1"></a>
    
    

                            </div>
                            <div id="Division.p2" class="classattr">
                                <div class="attr variable">
            <span class="name">p2</span>

        
    </div>
    <a class="headerlink" href="#Division.p2"></a>
    
    

                            </div>
                            <div id="Division.intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">intersections</span>

        
    </div>
    <a class="headerlink" href="#Division.intersections"></a>
    
    

                            </div>
                            <div id="Division.twin" class="classattr">
                                <div class="attr variable">
            <span class="name">twin</span>

        
    </div>
    <a class="headerlink" href="#Division.twin"></a>
    
    

                            </div>
                            <div id="Division.section" class="classattr">
                                <div class="attr variable">
            <span class="name">section</span>

        
    </div>
    <a class="headerlink" href="#Division.section"></a>
    
    

                            </div>
                            <div id="Division.fragment" class="classattr">
                                <div class="attr variable">
            <span class="name">fragment</span>

        
    </div>
    <a class="headerlink" href="#Division.fragment"></a>
    
    

                            </div>
                            <div id="Division.next" class="classattr">
                                <div class="attr variable">
            <span class="name">next</span>

        
    </div>
    <a class="headerlink" href="#Division.next"></a>
    
    

                            </div>
                            <div id="Division.prev" class="classattr">
                                <div class="attr variable">
            <span class="name">prev</span>

        
    </div>
    <a class="headerlink" href="#Division.prev"></a>
    
    

                            </div>
                            <div id="Division.sections" class="classattr">
                                <div class="attr variable">
            <span class="name">sections</span>

        
    </div>
    <a class="headerlink" href="#Division.sections"></a>
    
    

                            </div>
                            <div id="Division.copy" class="classattr">
                                        <input id="Division.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">section</span><span class="p">:</span> <span class="n"><a href="#Section">Section</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">twin</span><span class="p">:</span> <span class="n"><a href="#Section">Section</a></span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Division.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.copy-632"><a href="#Division.copy-632"><span class="linenos">632</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
</span><span id="Division.copy-633"><a href="#Division.copy-633"><span class="linenos">633</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Division.copy-634"><a href="#Division.copy-634"><span class="linenos">634</span></a>        <span class="n">section</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Division.copy-635"><a href="#Division.copy-635"><span class="linenos">635</span></a>        <span class="n">twin</span><span class="p">:</span> <span class="n">Section</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Division.copy-636"><a href="#Division.copy-636"><span class="linenos">636</span></a>    <span class="p">):</span>
</span><span id="Division.copy-637"><a href="#Division.copy-637"><span class="linenos">637</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of the division.</span>
</span><span id="Division.copy-638"><a href="#Division.copy-638"><span class="linenos">638</span></a>
</span><span id="Division.copy-639"><a href="#Division.copy-639"><span class="linenos">639</span></a><span class="sd">        Args:</span>
</span><span id="Division.copy-640"><a href="#Division.copy-640"><span class="linenos">640</span></a><span class="sd">            section (Section, optional): Section object. Defaults to None.</span>
</span><span id="Division.copy-641"><a href="#Division.copy-641"><span class="linenos">641</span></a><span class="sd">            twin (Section, optional): Twin section. Defaults to None.</span>
</span><span id="Division.copy-642"><a href="#Division.copy-642"><span class="linenos">642</span></a>
</span><span id="Division.copy-643"><a href="#Division.copy-643"><span class="linenos">643</span></a><span class="sd">        Returns:</span>
</span><span id="Division.copy-644"><a href="#Division.copy-644"><span class="linenos">644</span></a><span class="sd">            Division: A copy of the division.</span>
</span><span id="Division.copy-645"><a href="#Division.copy-645"><span class="linenos">645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division.copy-646"><a href="#Division.copy-646"><span class="linenos">646</span></a>        <span class="n">division</span> <span class="o">=</span> <span class="n">Division</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">[:],</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">))</span>
</span><span id="Division.copy-647"><a href="#Division.copy-647"><span class="linenos">647</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Division.copy-648"><a href="#Division.copy-648"><span class="linenos">648</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Division.copy-649"><a href="#Division.copy-649"><span class="linenos">649</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">twin</span>
</span><span id="Division.copy-650"><a href="#Division.copy-650"><span class="linenos">650</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>
</span><span id="Division.copy-651"><a href="#Division.copy-651"><span class="linenos">651</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="Division.copy-652"><a href="#Division.copy-652"><span class="linenos">652</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span>
</span><span id="Division.copy-653"><a href="#Division.copy-653"><span class="linenos">653</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev</span>
</span><span id="Division.copy-654"><a href="#Division.copy-654"><span class="linenos">654</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">]</span>
</span><span id="Division.copy-655"><a href="#Division.copy-655"><span class="linenos">655</span></a>        <span class="n">custom_attributes_</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Division.copy-656"><a href="#Division.copy-656"><span class="linenos">656</span></a>        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attributes_</span><span class="p">:</span>
</span><span id="Division.copy-657"><a href="#Division.copy-657"><span class="linenos">657</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
</span><span id="Division.copy-658"><a href="#Division.copy-658"><span class="linenos">658</span></a>        <span class="k">return</span> <span class="n">division</span>
</span></pre></div>


            <div class="docstring"><p>Create a copy of the division.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>section (Section, optional):</strong>  Section object. Defaults to None.</li>
<li><strong>twin (Section, optional):</strong>  Twin section. Defaults to None.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Division: A copy of the division.</p>
</blockquote>
</div>


                            </div>
                            <div id="Division.is_connected" class="classattr">
                                        <input id="Division.is_connected-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_connected</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n"><a href="#Division">Division</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Division.is_connected-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.is_connected"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.is_connected-684"><a href="#Division.is_connected-684"><span class="linenos">684</span></a>    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Division&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Division.is_connected-685"><a href="#Division.is_connected-685"><span class="linenos">685</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the division is connected to another division.</span>
</span><span id="Division.is_connected-686"><a href="#Division.is_connected-686"><span class="linenos">686</span></a>
</span><span id="Division.is_connected-687"><a href="#Division.is_connected-687"><span class="linenos">687</span></a><span class="sd">        Args:</span>
</span><span id="Division.is_connected-688"><a href="#Division.is_connected-688"><span class="linenos">688</span></a><span class="sd">            other (Division): Another division.</span>
</span><span id="Division.is_connected-689"><a href="#Division.is_connected-689"><span class="linenos">689</span></a>
</span><span id="Division.is_connected-690"><a href="#Division.is_connected-690"><span class="linenos">690</span></a><span class="sd">        Returns:</span>
</span><span id="Division.is_connected-691"><a href="#Division.is_connected-691"><span class="linenos">691</span></a><span class="sd">            bool: True if connected, False otherwise.</span>
</span><span id="Division.is_connected-692"><a href="#Division.is_connected-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division.is_connected-693"><a href="#Division.is_connected-693"><span class="linenos">693</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">end_points</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the division is connected to another division.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>other (Division):</strong>  Another division.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if connected, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="Division.end_points" class="classattr">
                                        <input id="Division.end_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end_points</span>

                <label class="view-source-button" for="Division.end_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.end_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.end_points-695"><a href="#Division.end_points-695"><span class="linenos">695</span></a>    <span class="nd">@property</span>
</span><span id="Division.end_points-696"><a href="#Division.end_points-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">end_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Division.end_points-697"><a href="#Division.end_points-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end points of the division.</span>
</span><span id="Division.end_points-698"><a href="#Division.end_points-698"><span class="linenos">698</span></a>
</span><span id="Division.end_points-699"><a href="#Division.end_points-699"><span class="linenos">699</span></a><span class="sd">        Returns:</span>
</span><span id="Division.end_points-700"><a href="#Division.end_points-700"><span class="linenos">700</span></a><span class="sd">            list: List of end points.</span>
</span><span id="Division.end_points-701"><a href="#Division.end_points-701"><span class="linenos">701</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division.end_points-702"><a href="#Division.end_points-702"><span class="linenos">702</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the end points of the division.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of end points.</p>
</blockquote>
</div>


                            </div>
                            <div id="Division.start" class="classattr">
                                        <input id="Division.start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">start</span><span class="annotation">: <a href="#Intersection">Intersection</a></span>

                <label class="view-source-button" for="Division.start-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.start-704"><a href="#Division.start-704"><span class="linenos">704</span></a>    <span class="nd">@property</span>
</span><span id="Division.start-705"><a href="#Division.start-705"><span class="linenos">705</span></a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="Division.start-706"><a href="#Division.start-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the start intersection of the division.</span>
</span><span id="Division.start-707"><a href="#Division.start-707"><span class="linenos">707</span></a>
</span><span id="Division.start-708"><a href="#Division.start-708"><span class="linenos">708</span></a><span class="sd">        Returns:</span>
</span><span id="Division.start-709"><a href="#Division.start-709"><span class="linenos">709</span></a><span class="sd">            Intersection: Start intersection.</span>
</span><span id="Division.start-710"><a href="#Division.start-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division.start-711"><a href="#Division.start-711"><span class="linenos">711</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the start intersection of the division.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Intersection: Start intersection.</p>
</blockquote>
</div>


                            </div>
                            <div id="Division.end" class="classattr">
                                        <input id="Division.end-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">end</span><span class="annotation">: <a href="#Intersection">Intersection</a></span>

                <label class="view-source-button" for="Division.end-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Division.end"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Division.end-713"><a href="#Division.end-713"><span class="linenos">713</span></a>    <span class="nd">@property</span>
</span><span id="Division.end-714"><a href="#Division.end-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Intersection</span><span class="p">:</span>
</span><span id="Division.end-715"><a href="#Division.end-715"><span class="linenos">715</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the end intersection of the division.</span>
</span><span id="Division.end-716"><a href="#Division.end-716"><span class="linenos">716</span></a>
</span><span id="Division.end-717"><a href="#Division.end-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="Division.end-718"><a href="#Division.end-718"><span class="linenos">718</span></a><span class="sd">            Intersection: End intersection.</span>
</span><span id="Division.end-719"><a href="#Division.end-719"><span class="linenos">719</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Division.end-720"><a href="#Division.end-720"><span class="linenos">720</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the end intersection of the division.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Intersection: End intersection.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Division.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Division.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Division.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Division.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Division.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Division.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Division.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Division.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Division.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Division.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Division.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Division.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Division.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Division.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Division.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Division.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Division.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Division.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Division.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Division.area" class="variable"><a href="../graphics/shape.html#Shape.area">area</a></dd>
                <dd id="Division.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Division.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Division.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Division.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Division.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Division.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Division.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Division.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Division.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Division.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Division.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Division.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Division.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Division.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Division.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Division.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Division.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Division.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Division.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Polyline">
                            <input id="Polyline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Polyline</span><wbr>(<span class="base"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span>):

                <label class="view-source-button" for="Polyline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline-723"><a href="#Polyline-723"><span class="linenos">723</span></a><span class="k">class</span> <span class="nc">Polyline</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
</span><span id="Polyline-724"><a href="#Polyline-724"><span class="linenos">724</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Polyline-725"><a href="#Polyline-725"><span class="linenos">725</span></a><span class="sd">    Connected points, similar to Shape objects.</span>
</span><span id="Polyline-726"><a href="#Polyline-726"><span class="linenos">726</span></a><span class="sd">    They can be closed or open.</span>
</span><span id="Polyline-727"><a href="#Polyline-727"><span class="linenos">727</span></a><span class="sd">    They are defined by a sequence of points.</span>
</span><span id="Polyline-728"><a href="#Polyline-728"><span class="linenos">728</span></a><span class="sd">    They have divisions, sections, and intersections.</span>
</span><span id="Polyline-729"><a href="#Polyline-729"><span class="linenos">729</span></a>
</span><span id="Polyline-730"><a href="#Polyline-730"><span class="linenos">730</span></a><span class="sd">    Args:</span>
</span><span id="Polyline-731"><a href="#Polyline-731"><span class="linenos">731</span></a><span class="sd">        points (list): List of points defining the polyline.</span>
</span><span id="Polyline-732"><a href="#Polyline-732"><span class="linenos">732</span></a><span class="sd">        closed (bool, optional): If the polyline is closed. Defaults to True.</span>
</span><span id="Polyline-733"><a href="#Polyline-733"><span class="linenos">733</span></a><span class="sd">        xform_matrix (array, optional): Transformation matrix. Defaults to None.</span>
</span><span id="Polyline-734"><a href="#Polyline-734"><span class="linenos">734</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Polyline-735"><a href="#Polyline-735"><span class="linenos">735</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Polyline-736"><a href="#Polyline-736"><span class="linenos">736</span></a>
</span><span id="Polyline-737"><a href="#Polyline-737"><span class="linenos">737</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polyline-738"><a href="#Polyline-738"><span class="linenos">738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ShapeStyle</span><span class="p">()</span>
</span><span id="Polyline-739"><a href="#Polyline-739"><span class="linenos">739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_style_map&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_style_map</span>
</span><span id="Polyline-740"><a href="#Polyline-740"><span class="linenos">740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_aliases</span><span class="p">()</span>
</span><span id="Polyline-741"><a href="#Polyline-741"><span class="linenos">741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="Polyline-742"><a href="#Polyline-742"><span class="linenos">742</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">POLYLINE</span>
</span><span id="Polyline-743"><a href="#Polyline-743"><span class="linenos">743</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polyline-744"><a href="#Polyline-744"><span class="linenos">744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_divisions</span><span class="p">()</span>
</span><span id="Polyline-745"><a href="#Polyline-745"><span class="linenos">745</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Polyline-746"><a href="#Polyline-746"><span class="linenos">746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="Polyline-747"><a href="#Polyline-747"><span class="linenos">747</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Polyline-748"><a href="#Polyline-748"><span class="linenos">748</span></a>
</span><span id="Polyline-749"><a href="#Polyline-749"><span class="linenos">749</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Polyline-750"><a href="#Polyline-750"><span class="linenos">750</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the polyline.</span>
</span><span id="Polyline-751"><a href="#Polyline-751"><span class="linenos">751</span></a>
</span><span id="Polyline-752"><a href="#Polyline-752"><span class="linenos">752</span></a><span class="sd">        Args:</span>
</span><span id="Polyline-753"><a href="#Polyline-753"><span class="linenos">753</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="Polyline-754"><a href="#Polyline-754"><span class="linenos">754</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="Polyline-755"><a href="#Polyline-755"><span class="linenos">755</span></a>
</span><span id="Polyline-756"><a href="#Polyline-756"><span class="linenos">756</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-757"><a href="#Polyline-757"><span class="linenos">757</span></a><span class="sd">            Any: Updated polyline or list of updated polylines.</span>
</span><span id="Polyline-758"><a href="#Polyline-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-759"><a href="#Polyline-759"><span class="linenos">759</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Polyline-760"><a href="#Polyline-760"><span class="linenos">760</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="Polyline-761"><a href="#Polyline-761"><span class="linenos">761</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline-762"><a href="#Polyline-762"><span class="linenos">762</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">reps</span><span class="p">)</span>
</span><span id="Polyline-763"><a href="#Polyline-763"><span class="linenos">763</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Polyline-764"><a href="#Polyline-764"><span class="linenos">764</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Polyline-765"><a href="#Polyline-765"><span class="linenos">765</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Polyline-766"><a href="#Polyline-766"><span class="linenos">766</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="Polyline-767"><a href="#Polyline-767"><span class="linenos">767</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Polyline-768"><a href="#Polyline-768"><span class="linenos">768</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Polyline-769"><a href="#Polyline-769"><span class="linenos">769</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Polyline-770"><a href="#Polyline-770"><span class="linenos">770</span></a>
</span><span id="Polyline-771"><a href="#Polyline-771"><span class="linenos">771</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Polyline-772"><a href="#Polyline-772"><span class="linenos">772</span></a>
</span><span id="Polyline-773"><a href="#Polyline-773"><span class="linenos">773</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-774"><a href="#Polyline-774"><span class="linenos">774</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the polyline.</span>
</span><span id="Polyline-775"><a href="#Polyline-775"><span class="linenos">775</span></a>
</span><span id="Polyline-776"><a href="#Polyline-776"><span class="linenos">776</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-777"><a href="#Polyline-777"><span class="linenos">777</span></a><span class="sd">            str: String representation.</span>
</span><span id="Polyline-778"><a href="#Polyline-778"><span class="linenos">778</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-779"><a href="#Polyline-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Polyline(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_coords</span><span class="p">[:,</span><span class="w"> </span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Polyline-780"><a href="#Polyline-780"><span class="linenos">780</span></a>
</span><span id="Polyline-781"><a href="#Polyline-781"><span class="linenos">781</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-782"><a href="#Polyline-782"><span class="linenos">782</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the polyline.</span>
</span><span id="Polyline-783"><a href="#Polyline-783"><span class="linenos">783</span></a>
</span><span id="Polyline-784"><a href="#Polyline-784"><span class="linenos">784</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-785"><a href="#Polyline-785"><span class="linenos">785</span></a><span class="sd">            str: String representation.</span>
</span><span id="Polyline-786"><a href="#Polyline-786"><span class="linenos">786</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-787"><a href="#Polyline-787"><span class="linenos">787</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="Polyline-788"><a href="#Polyline-788"><span class="linenos">788</span></a>
</span><span id="Polyline-789"><a href="#Polyline-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="nf">iter_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Polyline-790"><a href="#Polyline-790"><span class="linenos">790</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the sections of the polyline.</span>
</span><span id="Polyline-791"><a href="#Polyline-791"><span class="linenos">791</span></a>
</span><span id="Polyline-792"><a href="#Polyline-792"><span class="linenos">792</span></a><span class="sd">        Yields:</span>
</span><span id="Polyline-793"><a href="#Polyline-793"><span class="linenos">793</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Polyline-794"><a href="#Polyline-794"><span class="linenos">794</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-795"><a href="#Polyline-795"><span class="linenos">795</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline-796"><a href="#Polyline-796"><span class="linenos">796</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="Polyline-797"><a href="#Polyline-797"><span class="linenos">797</span></a>
</span><span id="Polyline-798"><a href="#Polyline-798"><span class="linenos">798</span></a>    <span class="k">def</span> <span class="nf">iter_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-799"><a href="#Polyline-799"><span class="linenos">799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the intersections of the polyline.</span>
</span><span id="Polyline-800"><a href="#Polyline-800"><span class="linenos">800</span></a>
</span><span id="Polyline-801"><a href="#Polyline-801"><span class="linenos">801</span></a><span class="sd">        Yields:</span>
</span><span id="Polyline-802"><a href="#Polyline-802"><span class="linenos">802</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Polyline-803"><a href="#Polyline-803"><span class="linenos">803</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-804"><a href="#Polyline-804"><span class="linenos">804</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline-805"><a href="#Polyline-805"><span class="linenos">805</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="Polyline-806"><a href="#Polyline-806"><span class="linenos">806</span></a>
</span><span id="Polyline-807"><a href="#Polyline-807"><span class="linenos">807</span></a>    <span class="nd">@property</span>
</span><span id="Polyline-808"><a href="#Polyline-808"><span class="linenos">808</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-809"><a href="#Polyline-809"><span class="linenos">809</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersections of the polyline.</span>
</span><span id="Polyline-810"><a href="#Polyline-810"><span class="linenos">810</span></a>
</span><span id="Polyline-811"><a href="#Polyline-811"><span class="linenos">811</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-812"><a href="#Polyline-812"><span class="linenos">812</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="Polyline-813"><a href="#Polyline-813"><span class="linenos">813</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-814"><a href="#Polyline-814"><span class="linenos">814</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Polyline-815"><a href="#Polyline-815"><span class="linenos">815</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline-816"><a href="#Polyline-816"><span class="linenos">816</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Polyline-817"><a href="#Polyline-817"><span class="linenos">817</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Polyline-818"><a href="#Polyline-818"><span class="linenos">818</span></a>
</span><span id="Polyline-819"><a href="#Polyline-819"><span class="linenos">819</span></a>    <span class="nd">@property</span>
</span><span id="Polyline-820"><a href="#Polyline-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-821"><a href="#Polyline-821"><span class="linenos">821</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the area of the polygon.</span>
</span><span id="Polyline-822"><a href="#Polyline-822"><span class="linenos">822</span></a>
</span><span id="Polyline-823"><a href="#Polyline-823"><span class="linenos">823</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-824"><a href="#Polyline-824"><span class="linenos">824</span></a><span class="sd">            float: Area of the polygon.</span>
</span><span id="Polyline-825"><a href="#Polyline-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-826"><a href="#Polyline-826"><span class="linenos">826</span></a>        <span class="k">return</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Polyline-827"><a href="#Polyline-827"><span class="linenos">827</span></a>
</span><span id="Polyline-828"><a href="#Polyline-828"><span class="linenos">828</span></a>    <span class="nd">@property</span>
</span><span id="Polyline-829"><a href="#Polyline-829"><span class="linenos">829</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-830"><a href="#Polyline-830"><span class="linenos">830</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the polyline.</span>
</span><span id="Polyline-831"><a href="#Polyline-831"><span class="linenos">831</span></a>
</span><span id="Polyline-832"><a href="#Polyline-832"><span class="linenos">832</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-833"><a href="#Polyline-833"><span class="linenos">833</span></a><span class="sd">            list: List of sections.</span>
</span><span id="Polyline-834"><a href="#Polyline-834"><span class="linenos">834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-835"><a href="#Polyline-835"><span class="linenos">835</span></a>        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Polyline-836"><a href="#Polyline-836"><span class="linenos">836</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline-837"><a href="#Polyline-837"><span class="linenos">837</span></a>            <span class="n">sections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="Polyline-838"><a href="#Polyline-838"><span class="linenos">838</span></a>        <span class="k">return</span> <span class="n">sections</span>
</span><span id="Polyline-839"><a href="#Polyline-839"><span class="linenos">839</span></a>
</span><span id="Polyline-840"><a href="#Polyline-840"><span class="linenos">840</span></a>    <span class="nd">@property</span>
</span><span id="Polyline-841"><a href="#Polyline-841"><span class="linenos">841</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-842"><a href="#Polyline-842"><span class="linenos">842</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the polyline.</span>
</span><span id="Polyline-843"><a href="#Polyline-843"><span class="linenos">843</span></a>
</span><span id="Polyline-844"><a href="#Polyline-844"><span class="linenos">844</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline-845"><a href="#Polyline-845"><span class="linenos">845</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="Polyline-846"><a href="#Polyline-846"><span class="linenos">846</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline-847"><a href="#Polyline-847"><span class="linenos">847</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;divisions&quot;</span><span class="p">]</span>
</span><span id="Polyline-848"><a href="#Polyline-848"><span class="linenos">848</span></a>
</span><span id="Polyline-849"><a href="#Polyline-849"><span class="linenos">849</span></a>    <span class="k">def</span> <span class="nf">_set_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-850"><a href="#Polyline-850"><span class="linenos">850</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Polyline-851"><a href="#Polyline-851"><span class="linenos">851</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Polyline-852"><a href="#Polyline-852"><span class="linenos">852</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Polyline-853"><a href="#Polyline-853"><span class="linenos">853</span></a>        <span class="n">pairs</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Polyline-854"><a href="#Polyline-854"><span class="linenos">854</span></a>        <span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">Division</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
</span><span id="Polyline-855"><a href="#Polyline-855"><span class="linenos">855</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;divisions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divisions</span>
</span><span id="Polyline-856"><a href="#Polyline-856"><span class="linenos">856</span></a>
</span><span id="Polyline-857"><a href="#Polyline-857"><span class="linenos">857</span></a>    <span class="k">def</span> <span class="nf">_set_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline-858"><a href="#Polyline-858"><span class="linenos">858</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fake intersections for open lines.&quot;&quot;&quot;</span>
</span><span id="Polyline-859"><a href="#Polyline-859"><span class="linenos">859</span></a>        <span class="n">division1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Polyline-860"><a href="#Polyline-860"><span class="linenos">860</span></a>        <span class="n">division2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Polyline-861"><a href="#Polyline-861"><span class="linenos">861</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">division1</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Polyline-862"><a href="#Polyline-862"><span class="linenos">862</span></a>        <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">]</span>
</span><span id="Polyline-863"><a href="#Polyline-863"><span class="linenos">863</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">division2</span><span class="o">.</span><span class="n">p2</span><span class="p">,</span> <span class="n">division2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Polyline-864"><a href="#Polyline-864"><span class="linenos">864</span></a>        <span class="k">if</span> <span class="n">division1</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
</span><span id="Polyline-865"><a href="#Polyline-865"><span class="linenos">865</span></a>            <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</span><span id="Polyline-866"><a href="#Polyline-866"><span class="linenos">866</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Polyline-867"><a href="#Polyline-867"><span class="linenos">867</span></a>            <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">x2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Connected points, similar to Shape objects.
They can be closed or open.
They are defined by a sequence of points.
They have divisions, sections, and intersections.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (list):</strong>  List of points defining the polyline.</li>
<li><strong>closed (bool, optional):</strong>  If the polyline is closed. Defaults to True.</li>
<li><strong>xform_matrix (array, optional):</strong>  Transformation matrix. Defaults to None.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Polyline.__init__" class="classattr">
                                        <input id="Polyline.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Polyline</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">closed</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Polyline.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.__init__-737"><a href="#Polyline.__init__-737"><span class="linenos">737</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polyline.__init__-738"><a href="#Polyline.__init__-738"><span class="linenos">738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ShapeStyle</span><span class="p">()</span>
</span><span id="Polyline.__init__-739"><a href="#Polyline.__init__-739"><span class="linenos">739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_style_map&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_style_map</span>
</span><span id="Polyline.__init__-740"><a href="#Polyline.__init__-740"><span class="linenos">740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_aliases</span><span class="p">()</span>
</span><span id="Polyline.__init__-741"><a href="#Polyline.__init__-741"><span class="linenos">741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="Polyline.__init__-742"><a href="#Polyline.__init__-742"><span class="linenos">742</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">POLYLINE</span>
</span><span id="Polyline.__init__-743"><a href="#Polyline.__init__-743"><span class="linenos">743</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polyline.__init__-744"><a href="#Polyline.__init__-744"><span class="linenos">744</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_divisions</span><span class="p">()</span>
</span><span id="Polyline.__init__-745"><a href="#Polyline.__init__-745"><span class="linenos">745</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Polyline.__init__-746"><a href="#Polyline.__init__-746"><span class="linenos">746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="Polyline.__init__-747"><a href="#Polyline.__init__-747"><span class="linenos">747</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Shape object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>points (Sequence[Point], optional):</strong>  The points that make up the shape.</li>
<li><strong>closed (bool, optional):</strong>  Whether the shape is closed. Defaults to False.</li>
<li><strong>xform_matrix (np.array, optional):</strong>  The transformation matrix. Defaults to None.</li>
<li><strong>**kwargs (dict):</strong>  Additional attributes for the shape.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided subtype is not valid.</li>
</ul>
</div>


                            </div>
                            <div id="Polyline.closed" class="classattr">
                                <div class="attr variable">
            <span class="name">closed</span>

        
    </div>
    <a class="headerlink" href="#Polyline.closed"></a>
    
    

                            </div>
                            <div id="Polyline.iter_sections" class="classattr">
                                        <input id="Polyline.iter_sections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_sections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Polyline.iter_sections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.iter_sections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.iter_sections-789"><a href="#Polyline.iter_sections-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="nf">iter_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Polyline.iter_sections-790"><a href="#Polyline.iter_sections-790"><span class="linenos">790</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the sections of the polyline.</span>
</span><span id="Polyline.iter_sections-791"><a href="#Polyline.iter_sections-791"><span class="linenos">791</span></a>
</span><span id="Polyline.iter_sections-792"><a href="#Polyline.iter_sections-792"><span class="linenos">792</span></a><span class="sd">        Yields:</span>
</span><span id="Polyline.iter_sections-793"><a href="#Polyline.iter_sections-793"><span class="linenos">793</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Polyline.iter_sections-794"><a href="#Polyline.iter_sections-794"><span class="linenos">794</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.iter_sections-795"><a href="#Polyline.iter_sections-795"><span class="linenos">795</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline.iter_sections-796"><a href="#Polyline.iter_sections-796"><span class="linenos">796</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the sections of the polyline.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Section: Section object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Polyline.iter_intersections" class="classattr">
                                        <input id="Polyline.iter_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_intersections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polyline.iter_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.iter_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.iter_intersections-798"><a href="#Polyline.iter_intersections-798"><span class="linenos">798</span></a>    <span class="k">def</span> <span class="nf">iter_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline.iter_intersections-799"><a href="#Polyline.iter_intersections-799"><span class="linenos">799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the intersections of the polyline.</span>
</span><span id="Polyline.iter_intersections-800"><a href="#Polyline.iter_intersections-800"><span class="linenos">800</span></a>
</span><span id="Polyline.iter_intersections-801"><a href="#Polyline.iter_intersections-801"><span class="linenos">801</span></a><span class="sd">        Yields:</span>
</span><span id="Polyline.iter_intersections-802"><a href="#Polyline.iter_intersections-802"><span class="linenos">802</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Polyline.iter_intersections-803"><a href="#Polyline.iter_intersections-803"><span class="linenos">803</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.iter_intersections-804"><a href="#Polyline.iter_intersections-804"><span class="linenos">804</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline.iter_intersections-805"><a href="#Polyline.iter_intersections-805"><span class="linenos">805</span></a>            <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the intersections of the polyline.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Intersection: Intersection object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Polyline.intersections" class="classattr">
                                        <input id="Polyline.intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">intersections</span>

                <label class="view-source-button" for="Polyline.intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.intersections-807"><a href="#Polyline.intersections-807"><span class="linenos">807</span></a>    <span class="nd">@property</span>
</span><span id="Polyline.intersections-808"><a href="#Polyline.intersections-808"><span class="linenos">808</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline.intersections-809"><a href="#Polyline.intersections-809"><span class="linenos">809</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the intersections of the polyline.</span>
</span><span id="Polyline.intersections-810"><a href="#Polyline.intersections-810"><span class="linenos">810</span></a>
</span><span id="Polyline.intersections-811"><a href="#Polyline.intersections-811"><span class="linenos">811</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline.intersections-812"><a href="#Polyline.intersections-812"><span class="linenos">812</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="Polyline.intersections-813"><a href="#Polyline.intersections-813"><span class="linenos">813</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.intersections-814"><a href="#Polyline.intersections-814"><span class="linenos">814</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Polyline.intersections-815"><a href="#Polyline.intersections-815"><span class="linenos">815</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline.intersections-816"><a href="#Polyline.intersections-816"><span class="linenos">816</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Polyline.intersections-817"><a href="#Polyline.intersections-817"><span class="linenos">817</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersections of the polyline.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of intersections.</p>
</blockquote>
</div>


                            </div>
                            <div id="Polyline.area" class="classattr">
                                        <input id="Polyline.area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">area</span>

                <label class="view-source-button" for="Polyline.area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.area-819"><a href="#Polyline.area-819"><span class="linenos">819</span></a>    <span class="nd">@property</span>
</span><span id="Polyline.area-820"><a href="#Polyline.area-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline.area-821"><a href="#Polyline.area-821"><span class="linenos">821</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the area of the polygon.</span>
</span><span id="Polyline.area-822"><a href="#Polyline.area-822"><span class="linenos">822</span></a>
</span><span id="Polyline.area-823"><a href="#Polyline.area-823"><span class="linenos">823</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline.area-824"><a href="#Polyline.area-824"><span class="linenos">824</span></a><span class="sd">            float: Area of the polygon.</span>
</span><span id="Polyline.area-825"><a href="#Polyline.area-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.area-826"><a href="#Polyline.area-826"><span class="linenos">826</span></a>        <span class="k">return</span> <span class="n">polygon_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the area of the polygon.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>float: Area of the polygon.</p>
</blockquote>
</div>


                            </div>
                            <div id="Polyline.sections" class="classattr">
                                        <input id="Polyline.sections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">sections</span>

                <label class="view-source-button" for="Polyline.sections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.sections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.sections-828"><a href="#Polyline.sections-828"><span class="linenos">828</span></a>    <span class="nd">@property</span>
</span><span id="Polyline.sections-829"><a href="#Polyline.sections-829"><span class="linenos">829</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline.sections-830"><a href="#Polyline.sections-830"><span class="linenos">830</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the polyline.</span>
</span><span id="Polyline.sections-831"><a href="#Polyline.sections-831"><span class="linenos">831</span></a>
</span><span id="Polyline.sections-832"><a href="#Polyline.sections-832"><span class="linenos">832</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline.sections-833"><a href="#Polyline.sections-833"><span class="linenos">833</span></a><span class="sd">            list: List of sections.</span>
</span><span id="Polyline.sections-834"><a href="#Polyline.sections-834"><span class="linenos">834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.sections-835"><a href="#Polyline.sections-835"><span class="linenos">835</span></a>        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Polyline.sections-836"><a href="#Polyline.sections-836"><span class="linenos">836</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Polyline.sections-837"><a href="#Polyline.sections-837"><span class="linenos">837</span></a>            <span class="n">sections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="Polyline.sections-838"><a href="#Polyline.sections-838"><span class="linenos">838</span></a>        <span class="k">return</span> <span class="n">sections</span>
</span></pre></div>


            <div class="docstring"><p>Return the sections of the polyline.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of sections.</p>
</blockquote>
</div>


                            </div>
                            <div id="Polyline.divisions" class="classattr">
                                        <input id="Polyline.divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">divisions</span>

                <label class="view-source-button" for="Polyline.divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polyline.divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polyline.divisions-840"><a href="#Polyline.divisions-840"><span class="linenos">840</span></a>    <span class="nd">@property</span>
</span><span id="Polyline.divisions-841"><a href="#Polyline.divisions-841"><span class="linenos">841</span></a>    <span class="k">def</span> <span class="nf">divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polyline.divisions-842"><a href="#Polyline.divisions-842"><span class="linenos">842</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the divisions of the polyline.</span>
</span><span id="Polyline.divisions-843"><a href="#Polyline.divisions-843"><span class="linenos">843</span></a>
</span><span id="Polyline.divisions-844"><a href="#Polyline.divisions-844"><span class="linenos">844</span></a><span class="sd">        Returns:</span>
</span><span id="Polyline.divisions-845"><a href="#Polyline.divisions-845"><span class="linenos">845</span></a><span class="sd">            list: List of divisions.</span>
</span><span id="Polyline.divisions-846"><a href="#Polyline.divisions-846"><span class="linenos">846</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polyline.divisions-847"><a href="#Polyline.divisions-847"><span class="linenos">847</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;divisions&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the divisions of the polyline.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of divisions.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></dt>
                                <dd id="Polyline.xform_matrix" class="variable"><a href="../graphics/shape.html#Shape.xform_matrix">xform_matrix</a></dd>
                <dd id="Polyline.type" class="variable"><a href="../graphics/shape.html#Shape.type">type</a></dd>
                <dd id="Polyline.index" class="function"><a href="../graphics/shape.html#Shape.index">index</a></dd>
                <dd id="Polyline.remove" class="function"><a href="../graphics/shape.html#Shape.remove">remove</a></dd>
                <dd id="Polyline.append" class="function"><a href="../graphics/shape.html#Shape.append">append</a></dd>
                <dd id="Polyline.insert" class="function"><a href="../graphics/shape.html#Shape.insert">insert</a></dd>
                <dd id="Polyline.extend" class="function"><a href="../graphics/shape.html#Shape.extend">extend</a></dd>
                <dd id="Polyline.pop" class="function"><a href="../graphics/shape.html#Shape.pop">pop</a></dd>
                <dd id="Polyline.topology" class="function"><a href="../graphics/shape.html#Shape.topology">topology</a></dd>
                <dd id="Polyline.merge" class="function"><a href="../graphics/shape.html#Shape.merge">merge</a></dd>
                <dd id="Polyline.connect" class="function"><a href="../graphics/shape.html#Shape.connect">connect</a></dd>
                <dd id="Polyline.as_graph" class="function"><a href="../graphics/shape.html#Shape.as_graph">as_graph</a></dd>
                <dd id="Polyline.as_array" class="function"><a href="../graphics/shape.html#Shape.as_array">as_array</a></dd>
                <dd id="Polyline.as_list" class="function"><a href="../graphics/shape.html#Shape.as_list">as_list</a></dd>
                <dd id="Polyline.final_coords" class="variable"><a href="../graphics/shape.html#Shape.final_coords">final_coords</a></dd>
                <dd id="Polyline.vertices" class="variable"><a href="../graphics/shape.html#Shape.vertices">vertices</a></dd>
                <dd id="Polyline.vertex_pairs" class="variable"><a href="../graphics/shape.html#Shape.vertex_pairs">vertex_pairs</a></dd>
                <dd id="Polyline.orig_coords" class="variable"><a href="../graphics/shape.html#Shape.orig_coords">orig_coords</a></dd>
                <dd id="Polyline.b_box" class="variable"><a href="../graphics/shape.html#Shape.b_box">b_box</a></dd>
                <dd id="Polyline.total_length" class="variable"><a href="../graphics/shape.html#Shape.total_length">total_length</a></dd>
                <dd id="Polyline.is_polygon" class="variable"><a href="../graphics/shape.html#Shape.is_polygon">is_polygon</a></dd>
                <dd id="Polyline.clear" class="function"><a href="../graphics/shape.html#Shape.clear">clear</a></dd>
                <dd id="Polyline.count" class="function"><a href="../graphics/shape.html#Shape.count">count</a></dd>
                <dd id="Polyline.copy" class="function"><a href="../graphics/shape.html#Shape.copy">copy</a></dd>
                <dd id="Polyline.edges" class="variable"><a href="../graphics/shape.html#Shape.edges">edges</a></dd>
                <dd id="Polyline.segments" class="variable"><a href="../graphics/shape.html#Shape.segments">segments</a></dd>
                <dd id="Polyline.reverse" class="function"><a href="../graphics/shape.html#Shape.reverse">reverse</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Polyline.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Polyline.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Polyline.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Polyline.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Polyline.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Polyline.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Polyline.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Polyline.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Polyline.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Polyline.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Polyline.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Polyline.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ParallelPolyline">
                            <input id="ParallelPolyline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ParallelPolyline</span><wbr>(<span class="base"><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></span>):

                <label class="view-source-button" for="ParallelPolyline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ParallelPolyline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ParallelPolyline-870"><a href="#ParallelPolyline-870"><span class="linenos">870</span></a><span class="k">class</span> <span class="nc">ParallelPolyline</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="ParallelPolyline-871"><a href="#ParallelPolyline-871"><span class="linenos">871</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A ParallelPolylines is a collection of parallel Polylines.</span>
</span><span id="ParallelPolyline-872"><a href="#ParallelPolyline-872"><span class="linenos">872</span></a><span class="sd">    They are defined by a main polyline and a list of offset</span>
</span><span id="ParallelPolyline-873"><a href="#ParallelPolyline-873"><span class="linenos">873</span></a><span class="sd">    values (that can be negative or positive).</span>
</span><span id="ParallelPolyline-874"><a href="#ParallelPolyline-874"><span class="linenos">874</span></a>
</span><span id="ParallelPolyline-875"><a href="#ParallelPolyline-875"><span class="linenos">875</span></a><span class="sd">    Args:</span>
</span><span id="ParallelPolyline-876"><a href="#ParallelPolyline-876"><span class="linenos">876</span></a><span class="sd">        polyline (Polyline): Main polyline.</span>
</span><span id="ParallelPolyline-877"><a href="#ParallelPolyline-877"><span class="linenos">877</span></a><span class="sd">        offset (float): Offset value.</span>
</span><span id="ParallelPolyline-878"><a href="#ParallelPolyline-878"><span class="linenos">878</span></a><span class="sd">        lace (Lace): Lace object.</span>
</span><span id="ParallelPolyline-879"><a href="#ParallelPolyline-879"><span class="linenos">879</span></a><span class="sd">        under (bool, optional): If the polyline is under. Defaults to False.</span>
</span><span id="ParallelPolyline-880"><a href="#ParallelPolyline-880"><span class="linenos">880</span></a><span class="sd">        closed (bool, optional): If the polyline is closed. Defaults to True.</span>
</span><span id="ParallelPolyline-881"><a href="#ParallelPolyline-881"><span class="linenos">881</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="ParallelPolyline-882"><a href="#ParallelPolyline-882"><span class="linenos">882</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="ParallelPolyline-883"><a href="#ParallelPolyline-883"><span class="linenos">883</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ParallelPolyline-884"><a href="#ParallelPolyline-884"><span class="linenos">884</span></a>
</span><span id="ParallelPolyline-885"><a href="#ParallelPolyline-885"><span class="linenos">885</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ParallelPolyline-886"><a href="#ParallelPolyline-886"><span class="linenos">886</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ParallelPolyline-887"><a href="#ParallelPolyline-887"><span class="linenos">887</span></a>        <span class="n">polyline</span><span class="p">,</span>
</span><span id="ParallelPolyline-888"><a href="#ParallelPolyline-888"><span class="linenos">888</span></a>        <span class="n">offset</span><span class="p">,</span>
</span><span id="ParallelPolyline-889"><a href="#ParallelPolyline-889"><span class="linenos">889</span></a>        <span class="n">lace</span><span class="p">,</span>
</span><span id="ParallelPolyline-890"><a href="#ParallelPolyline-890"><span class="linenos">890</span></a>        <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ParallelPolyline-891"><a href="#ParallelPolyline-891"><span class="linenos">891</span></a>        <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="ParallelPolyline-892"><a href="#ParallelPolyline-892"><span class="linenos">892</span></a>        <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ParallelPolyline-893"><a href="#ParallelPolyline-893"><span class="linenos">893</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ParallelPolyline-894"><a href="#ParallelPolyline-894"><span class="linenos">894</span></a>    <span class="p">):</span>
</span><span id="ParallelPolyline-895"><a href="#ParallelPolyline-895"><span class="linenos">895</span></a>        <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ParallelPolyline-896"><a href="#ParallelPolyline-896"><span class="linenos">896</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="ParallelPolyline-897"><a href="#ParallelPolyline-897"><span class="linenos">897</span></a>        <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="ParallelPolyline-898"><a href="#ParallelPolyline-898"><span class="linenos">898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span> <span class="o">=</span> <span class="n">polyline</span>
</span><span id="ParallelPolyline-899"><a href="#ParallelPolyline-899"><span class="linenos">899</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="ParallelPolyline-900"><a href="#ParallelPolyline-900"><span class="linenos">900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol</span> <span class="o">=</span> <span class="n">dist_tol</span>
</span><span id="ParallelPolyline-901"><a href="#ParallelPolyline-901"><span class="linenos">901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol2</span>
</span><span id="ParallelPolyline-902"><a href="#ParallelPolyline-902"><span class="linenos">902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="ParallelPolyline-903"><a href="#ParallelPolyline-903"><span class="linenos">903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_offset_polylines</span><span class="p">()</span>
</span><span id="ParallelPolyline-904"><a href="#ParallelPolyline-904"><span class="linenos">904</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="ParallelPolyline-905"><a href="#ParallelPolyline-905"><span class="linenos">905</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ParallelPolyline-906"><a href="#ParallelPolyline-906"><span class="linenos">906</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PARALLEL_POLYLINE</span>
</span><span id="ParallelPolyline-907"><a href="#ParallelPolyline-907"><span class="linenos">907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ParallelPolyline-908"><a href="#ParallelPolyline-908"><span class="linenos">908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">under</span> <span class="o">=</span> <span class="n">under</span>
</span><span id="ParallelPolyline-909"><a href="#ParallelPolyline-909"><span class="linenos">909</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ParallelPolyline-910"><a href="#ParallelPolyline-910"><span class="linenos">910</span></a>
</span><span id="ParallelPolyline-911"><a href="#ParallelPolyline-911"><span class="linenos">911</span></a>    <span class="nd">@property</span>
</span><span id="ParallelPolyline-912"><a href="#ParallelPolyline-912"><span class="linenos">912</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Section</span><span class="p">]:</span>
</span><span id="ParallelPolyline-913"><a href="#ParallelPolyline-913"><span class="linenos">913</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the parallel polyline.</span>
</span><span id="ParallelPolyline-914"><a href="#ParallelPolyline-914"><span class="linenos">914</span></a>
</span><span id="ParallelPolyline-915"><a href="#ParallelPolyline-915"><span class="linenos">915</span></a><span class="sd">        Returns:</span>
</span><span id="ParallelPolyline-916"><a href="#ParallelPolyline-916"><span class="linenos">916</span></a><span class="sd">            list: List of sections.</span>
</span><span id="ParallelPolyline-917"><a href="#ParallelPolyline-917"><span class="linenos">917</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ParallelPolyline-918"><a href="#ParallelPolyline-918"><span class="linenos">918</span></a>        <span class="n">sects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ParallelPolyline-919"><a href="#ParallelPolyline-919"><span class="linenos">919</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="ParallelPolyline-920"><a href="#ParallelPolyline-920"><span class="linenos">920</span></a>            <span class="n">sects</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="ParallelPolyline-921"><a href="#ParallelPolyline-921"><span class="linenos">921</span></a>        <span class="k">return</span> <span class="n">sects</span>
</span><span id="ParallelPolyline-922"><a href="#ParallelPolyline-922"><span class="linenos">922</span></a>
</span><span id="ParallelPolyline-923"><a href="#ParallelPolyline-923"><span class="linenos">923</span></a>    <span class="k">def</span> <span class="nf">_set_offset_polylines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ParallelPolyline-924"><a href="#ParallelPolyline-924"><span class="linenos">924</span></a>        <span class="n">polyline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span>
</span><span id="ParallelPolyline-925"><a href="#ParallelPolyline-925"><span class="linenos">925</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="ParallelPolyline-926"><a href="#ParallelPolyline-926"><span class="linenos">926</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="ParallelPolyline-927"><a href="#ParallelPolyline-927"><span class="linenos">927</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">+</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="ParallelPolyline-928"><a href="#ParallelPolyline-928"><span class="linenos">928</span></a>            <span class="n">offset_polygons</span> <span class="o">=</span> <span class="n">double_offset_polygons</span><span class="p">(</span>
</span><span id="ParallelPolyline-929"><a href="#ParallelPolyline-929"><span class="linenos">929</span></a>                <span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dist_tol</span><span class="p">)</span>
</span><span id="ParallelPolyline-930"><a href="#ParallelPolyline-930"><span class="linenos">930</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ParallelPolyline-931"><a href="#ParallelPolyline-931"><span class="linenos">931</span></a>            <span class="n">offset_polylines</span> <span class="o">=</span> <span class="n">double_offset_polylines</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
</span><span id="ParallelPolyline-932"><a href="#ParallelPolyline-932"><span class="linenos">932</span></a>        <span class="n">polylines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ParallelPolyline-933"><a href="#ParallelPolyline-933"><span class="linenos">933</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="ParallelPolyline-934"><a href="#ParallelPolyline-934"><span class="linenos">934</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">offset_polygons</span><span class="p">:</span>
</span><span id="ParallelPolyline-935"><a href="#ParallelPolyline-935"><span class="linenos">935</span></a>                <span class="n">polylines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">))</span>
</span><span id="ParallelPolyline-936"><a href="#ParallelPolyline-936"><span class="linenos">936</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ParallelPolyline-937"><a href="#ParallelPolyline-937"><span class="linenos">937</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">offset_polylines</span><span class="p">:</span>
</span><span id="ParallelPolyline-938"><a href="#ParallelPolyline-938"><span class="linenos">938</span></a>                <span class="n">polylines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polyline</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">))</span>
</span><span id="ParallelPolyline-939"><a href="#ParallelPolyline-939"><span class="linenos">939</span></a>
</span><span id="ParallelPolyline-940"><a href="#ParallelPolyline-940"><span class="linenos">940</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_poly_list</span> <span class="o">=</span> <span class="n">polylines</span>
</span></pre></div>


            <div class="docstring"><p>A ParallelPolylines is a collection of parallel Polylines.
They are defined by a main polyline and a list of offset
values (that can be negative or positive).</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>polyline (Polyline):</strong>  Main polyline.</li>
<li><strong>offset (float):</strong>  Offset value.</li>
<li><strong>lace (Lace):</strong>  Lace object.</li>
<li><strong>under (bool, optional):</strong>  If the polyline is under. Defaults to False.</li>
<li><strong>closed (bool, optional):</strong>  If the polyline is closed. Defaults to True.</li>
<li><strong>dist_tol (float, optional):</strong>  Distance tolerance. Defaults to None.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="ParallelPolyline.__init__" class="classattr">
                                        <input id="ParallelPolyline.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ParallelPolyline</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polyline</span>,</span><span class="param">	<span class="n">offset</span>,</span><span class="param">	<span class="n">lace</span>,</span><span class="param">	<span class="n">under</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">closed</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="ParallelPolyline.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ParallelPolyline.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ParallelPolyline.__init__-885"><a href="#ParallelPolyline.__init__-885"><span class="linenos">885</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ParallelPolyline.__init__-886"><a href="#ParallelPolyline.__init__-886"><span class="linenos">886</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-887"><a href="#ParallelPolyline.__init__-887"><span class="linenos">887</span></a>        <span class="n">polyline</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-888"><a href="#ParallelPolyline.__init__-888"><span class="linenos">888</span></a>        <span class="n">offset</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-889"><a href="#ParallelPolyline.__init__-889"><span class="linenos">889</span></a>        <span class="n">lace</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-890"><a href="#ParallelPolyline.__init__-890"><span class="linenos">890</span></a>        <span class="n">under</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-891"><a href="#ParallelPolyline.__init__-891"><span class="linenos">891</span></a>        <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-892"><a href="#ParallelPolyline.__init__-892"><span class="linenos">892</span></a>        <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-893"><a href="#ParallelPolyline.__init__-893"><span class="linenos">893</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ParallelPolyline.__init__-894"><a href="#ParallelPolyline.__init__-894"><span class="linenos">894</span></a>    <span class="p">):</span>
</span><span id="ParallelPolyline.__init__-895"><a href="#ParallelPolyline.__init__-895"><span class="linenos">895</span></a>        <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ParallelPolyline.__init__-896"><a href="#ParallelPolyline.__init__-896"><span class="linenos">896</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="ParallelPolyline.__init__-897"><a href="#ParallelPolyline.__init__-897"><span class="linenos">897</span></a>        <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="ParallelPolyline.__init__-898"><a href="#ParallelPolyline.__init__-898"><span class="linenos">898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span> <span class="o">=</span> <span class="n">polyline</span>
</span><span id="ParallelPolyline.__init__-899"><a href="#ParallelPolyline.__init__-899"><span class="linenos">899</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="ParallelPolyline.__init__-900"><a href="#ParallelPolyline.__init__-900"><span class="linenos">900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol</span> <span class="o">=</span> <span class="n">dist_tol</span>
</span><span id="ParallelPolyline.__init__-901"><a href="#ParallelPolyline.__init__-901"><span class="linenos">901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol2</span>
</span><span id="ParallelPolyline.__init__-902"><a href="#ParallelPolyline.__init__-902"><span class="linenos">902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="n">closed</span>
</span><span id="ParallelPolyline.__init__-903"><a href="#ParallelPolyline.__init__-903"><span class="linenos">903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_offset_polylines</span><span class="p">()</span>
</span><span id="ParallelPolyline.__init__-904"><a href="#ParallelPolyline.__init__-904"><span class="linenos">904</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="ParallelPolyline.__init__-905"><a href="#ParallelPolyline.__init__-905"><span class="linenos">905</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ParallelPolyline.__init__-906"><a href="#ParallelPolyline.__init__-906"><span class="linenos">906</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PARALLEL_POLYLINE</span>
</span><span id="ParallelPolyline.__init__-907"><a href="#ParallelPolyline.__init__-907"><span class="linenos">907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ParallelPolyline.__init__-908"><a href="#ParallelPolyline.__init__-908"><span class="linenos">908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">under</span> <span class="o">=</span> <span class="n">under</span>
</span><span id="ParallelPolyline.__init__-909"><a href="#ParallelPolyline.__init__-909"><span class="linenos">909</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Batch object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>elements (Sequence[Any], optional):</strong>  The elements to include in the batch.</li>
<li><strong>modifiers (Sequence[Modifier], optional):</strong>  The modifiers to apply to the batch.</li>
<li><strong>subtype (Types, optional):</strong>  The subtype of the batch.</li>
<li><strong>kwargs (dict):</strong>  Additional keyword arguments.</li>
</ul>
</div>


                            </div>
                            <div id="ParallelPolyline.polyline" class="classattr">
                                <div class="attr variable">
            <span class="name">polyline</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.polyline"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.offset" class="classattr">
                                <div class="attr variable">
            <span class="name">offset</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.offset"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.dist_tol" class="classattr">
                                <div class="attr variable">
            <span class="name">dist_tol</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.dist_tol"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.dist_tol2" class="classattr">
                                <div class="attr variable">
            <span class="name">dist_tol2</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.dist_tol2"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.closed" class="classattr">
                                <div class="attr variable">
            <span class="name">closed</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.closed"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.polyline_list" class="classattr">
                                <div class="attr variable">
            <span class="name">polyline_list</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.polyline_list"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.subtype" class="classattr">
                                <div class="attr variable">
            <span class="name">subtype</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.subtype"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.overlaps" class="classattr">
                                <div class="attr variable">
            <span class="name">overlaps</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.overlaps"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.under" class="classattr">
                                <div class="attr variable">
            <span class="name">under</span>

        
    </div>
    <a class="headerlink" href="#ParallelPolyline.under"></a>
    
    

                            </div>
                            <div id="ParallelPolyline.sections" class="classattr">
                                        <input id="ParallelPolyline.sections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">sections</span><span class="annotation">: List[<a href="#Section">Section</a>]</span>

                <label class="view-source-button" for="ParallelPolyline.sections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ParallelPolyline.sections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ParallelPolyline.sections-911"><a href="#ParallelPolyline.sections-911"><span class="linenos">911</span></a>    <span class="nd">@property</span>
</span><span id="ParallelPolyline.sections-912"><a href="#ParallelPolyline.sections-912"><span class="linenos">912</span></a>    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Section</span><span class="p">]:</span>
</span><span id="ParallelPolyline.sections-913"><a href="#ParallelPolyline.sections-913"><span class="linenos">913</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sections of the parallel polyline.</span>
</span><span id="ParallelPolyline.sections-914"><a href="#ParallelPolyline.sections-914"><span class="linenos">914</span></a>
</span><span id="ParallelPolyline.sections-915"><a href="#ParallelPolyline.sections-915"><span class="linenos">915</span></a><span class="sd">        Returns:</span>
</span><span id="ParallelPolyline.sections-916"><a href="#ParallelPolyline.sections-916"><span class="linenos">916</span></a><span class="sd">            list: List of sections.</span>
</span><span id="ParallelPolyline.sections-917"><a href="#ParallelPolyline.sections-917"><span class="linenos">917</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ParallelPolyline.sections-918"><a href="#ParallelPolyline.sections-918"><span class="linenos">918</span></a>        <span class="n">sects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ParallelPolyline.sections-919"><a href="#ParallelPolyline.sections-919"><span class="linenos">919</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="ParallelPolyline.sections-920"><a href="#ParallelPolyline.sections-920"><span class="linenos">920</span></a>            <span class="n">sects</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>
</span><span id="ParallelPolyline.sections-921"><a href="#ParallelPolyline.sections-921"><span class="linenos">921</span></a>        <span class="k">return</span> <span class="n">sects</span>
</span></pre></div>


            <div class="docstring"><p>Return the sections of the parallel polyline.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of sections.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></dt>
                                <dd id="ParallelPolyline.type" class="variable"><a href="../graphics/batch.html#Batch.type">type</a></dd>
                <dd id="ParallelPolyline.modifiers" class="variable"><a href="../graphics/batch.html#Batch.modifiers">modifiers</a></dd>
                <dd id="ParallelPolyline.blend_mode" class="variable"><a href="../graphics/batch.html#Batch.blend_mode">blend_mode</a></dd>
                <dd id="ParallelPolyline.alpha" class="variable"><a href="../graphics/batch.html#Batch.alpha">alpha</a></dd>
                <dd id="ParallelPolyline.line_alpha" class="variable"><a href="../graphics/batch.html#Batch.line_alpha">line_alpha</a></dd>
                <dd id="ParallelPolyline.fill_alpha" class="variable"><a href="../graphics/batch.html#Batch.fill_alpha">fill_alpha</a></dd>
                <dd id="ParallelPolyline.text_alpha" class="variable"><a href="../graphics/batch.html#Batch.text_alpha">text_alpha</a></dd>
                <dd id="ParallelPolyline.clip" class="variable"><a href="../graphics/batch.html#Batch.clip">clip</a></dd>
                <dd id="ParallelPolyline.mask" class="variable"><a href="../graphics/batch.html#Batch.mask">mask</a></dd>
                <dd id="ParallelPolyline.even_odd_rule" class="variable"><a href="../graphics/batch.html#Batch.even_odd_rule">even_odd_rule</a></dd>
                <dd id="ParallelPolyline.blend_group" class="variable"><a href="../graphics/batch.html#Batch.blend_group">blend_group</a></dd>
                <dd id="ParallelPolyline.transparency_group" class="variable"><a href="../graphics/batch.html#Batch.transparency_group">transparency_group</a></dd>
                <dd id="ParallelPolyline.set_attribs" class="function"><a href="../graphics/batch.html#Batch.set_attribs">set_attribs</a></dd>
                <dd id="ParallelPolyline.set_batch_attr" class="function"><a href="../graphics/batch.html#Batch.set_batch_attr">set_batch_attr</a></dd>
                <dd id="ParallelPolyline.proximity" class="function"><a href="../graphics/batch.html#Batch.proximity">proximity</a></dd>
                <dd id="ParallelPolyline.append" class="function"><a href="../graphics/batch.html#Batch.append">append</a></dd>
                <dd id="ParallelPolyline.reverse" class="function"><a href="../graphics/batch.html#Batch.reverse">reverse</a></dd>
                <dd id="ParallelPolyline.insert" class="function"><a href="../graphics/batch.html#Batch.insert">insert</a></dd>
                <dd id="ParallelPolyline.remove" class="function"><a href="../graphics/batch.html#Batch.remove">remove</a></dd>
                <dd id="ParallelPolyline.pop" class="function"><a href="../graphics/batch.html#Batch.pop">pop</a></dd>
                <dd id="ParallelPolyline.clear" class="function"><a href="../graphics/batch.html#Batch.clear">clear</a></dd>
                <dd id="ParallelPolyline.extend" class="function"><a href="../graphics/batch.html#Batch.extend">extend</a></dd>
                <dd id="ParallelPolyline.iter_elements" class="function"><a href="../graphics/batch.html#Batch.iter_elements">iter_elements</a></dd>
                <dd id="ParallelPolyline.all_elements" class="variable"><a href="../graphics/batch.html#Batch.all_elements">all_elements</a></dd>
                <dd id="ParallelPolyline.all_shapes" class="variable"><a href="../graphics/batch.html#Batch.all_shapes">all_shapes</a></dd>
                <dd id="ParallelPolyline.all_vertices" class="variable"><a href="../graphics/batch.html#Batch.all_vertices">all_vertices</a></dd>
                <dd id="ParallelPolyline.all_segments" class="variable"><a href="../graphics/batch.html#Batch.all_segments">all_segments</a></dd>
                <dd id="ParallelPolyline.as_graph" class="function"><a href="../graphics/batch.html#Batch.as_graph">as_graph</a></dd>
                <dd id="ParallelPolyline.graph_summary" class="function"><a href="../graphics/batch.html#Batch.graph_summary">graph_summary</a></dd>
                <dd id="ParallelPolyline.merge_shapes" class="function"><a href="../graphics/batch.html#Batch.merge_shapes">merge_shapes</a></dd>
                <dd id="ParallelPolyline.all_polygons" class="function"><a href="../graphics/batch.html#Batch.all_polygons">all_polygons</a></dd>
                <dd id="ParallelPolyline.copy" class="function"><a href="../graphics/batch.html#Batch.copy">copy</a></dd>
                <dd id="ParallelPolyline.b_box" class="variable"><a href="../graphics/batch.html#Batch.b_box">b_box</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="ParallelPolyline.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="ParallelPolyline.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="ParallelPolyline.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="ParallelPolyline.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="ParallelPolyline.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="ParallelPolyline.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="ParallelPolyline.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="ParallelPolyline.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="ParallelPolyline.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="ParallelPolyline.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="ParallelPolyline.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="ParallelPolyline.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Lace">
                            <input id="Lace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Lace</span><wbr>(<span class="base"><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></span>):

                <label class="view-source-button" for="Lace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace-943"><a href="#Lace-943"><span class="linenos"> 943</span></a><span class="k">class</span> <span class="nc">Lace</span><span class="p">(</span><span class="n">Batch</span><span class="p">):</span>
</span><span id="Lace-944"><a href="#Lace-944"><span class="linenos"> 944</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-945"><a href="#Lace-945"><span class="linenos"> 945</span></a><span class="sd">    A Lace is a collection of ParallelPolylines objects.</span>
</span><span id="Lace-946"><a href="#Lace-946"><span class="linenos"> 946</span></a><span class="sd">    They are used to create interlace patterns.</span>
</span><span id="Lace-947"><a href="#Lace-947"><span class="linenos"> 947</span></a>
</span><span id="Lace-948"><a href="#Lace-948"><span class="linenos"> 948</span></a><span class="sd">    Args:</span>
</span><span id="Lace-949"><a href="#Lace-949"><span class="linenos"> 949</span></a><span class="sd">        polygon_shapes (Union[Batch, list[Shape]], optional): List of polygon shapes. Defaults to None.</span>
</span><span id="Lace-950"><a href="#Lace-950"><span class="linenos"> 950</span></a><span class="sd">        polyline_shapes (Union[Batch, list[Shape]], optional): List of polyline shapes. Defaults to None.</span>
</span><span id="Lace-951"><a href="#Lace-951"><span class="linenos"> 951</span></a><span class="sd">        offset (float, optional): Offset value. Defaults to 2.</span>
</span><span id="Lace-952"><a href="#Lace-952"><span class="linenos"> 952</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="Lace-953"><a href="#Lace-953"><span class="linenos"> 953</span></a><span class="sd">        swatch (list, optional): Swatch list. Defaults to None.</span>
</span><span id="Lace-954"><a href="#Lace-954"><span class="linenos"> 954</span></a><span class="sd">        breakpoints (list, optional): Breakpoints list. Defaults to None.</span>
</span><span id="Lace-955"><a href="#Lace-955"><span class="linenos"> 955</span></a><span class="sd">        plait_color (colors.Color, optional): Plait color. Defaults to None.</span>
</span><span id="Lace-956"><a href="#Lace-956"><span class="linenos"> 956</span></a><span class="sd">        draw_fragments (bool, optional): If fragments should be drawn. Defaults to True.</span>
</span><span id="Lace-957"><a href="#Lace-957"><span class="linenos"> 957</span></a><span class="sd">        palette (list, optional): Palette list. Defaults to None.</span>
</span><span id="Lace-958"><a href="#Lace-958"><span class="linenos"> 958</span></a><span class="sd">        color_step (int, optional): Color step. Defaults to 1.</span>
</span><span id="Lace-959"><a href="#Lace-959"><span class="linenos"> 959</span></a><span class="sd">        with_plaits (bool, optional): If plaits should be included. Defaults to True.</span>
</span><span id="Lace-960"><a href="#Lace-960"><span class="linenos"> 960</span></a><span class="sd">        area_threshold (float, optional): Area threshold. Defaults to None.</span>
</span><span id="Lace-961"><a href="#Lace-961"><span class="linenos"> 961</span></a><span class="sd">        radius_threshold (float, optional): Radius threshold. Defaults to None.</span>
</span><span id="Lace-962"><a href="#Lace-962"><span class="linenos"> 962</span></a><span class="sd">        **kwargs: Additional attributes for cosmetic/drawing purposes.</span>
</span><span id="Lace-963"><a href="#Lace-963"><span class="linenos"> 963</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Lace-964"><a href="#Lace-964"><span class="linenos"> 964</span></a>
</span><span id="Lace-965"><a href="#Lace-965"><span class="linenos"> 965</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-966"><a href="#Lace-966"><span class="linenos"> 966</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Lace-967"><a href="#Lace-967"><span class="linenos"> 967</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Lace-968"><a href="#Lace-968"><span class="linenos"> 968</span></a>        <span class="n">polygon_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-969"><a href="#Lace-969"><span class="linenos"> 969</span></a>        <span class="n">polyline_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-970"><a href="#Lace-970"><span class="linenos"> 970</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Lace-971"><a href="#Lace-971"><span class="linenos"> 971</span></a>        <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-972"><a href="#Lace-972"><span class="linenos"> 972</span></a>        <span class="n">swatch</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-973"><a href="#Lace-973"><span class="linenos"> 973</span></a>        <span class="n">breakpoints</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-974"><a href="#Lace-974"><span class="linenos"> 974</span></a>        <span class="n">plait_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-975"><a href="#Lace-975"><span class="linenos"> 975</span></a>        <span class="n">draw_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Lace-976"><a href="#Lace-976"><span class="linenos"> 976</span></a>        <span class="n">palette</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-977"><a href="#Lace-977"><span class="linenos"> 977</span></a>        <span class="n">color_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Lace-978"><a href="#Lace-978"><span class="linenos"> 978</span></a>        <span class="n">with_plaits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Lace-979"><a href="#Lace-979"><span class="linenos"> 979</span></a>        <span class="n">area_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-980"><a href="#Lace-980"><span class="linenos"> 980</span></a>        <span class="n">radius_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace-981"><a href="#Lace-981"><span class="linenos"> 981</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Lace-982"><a href="#Lace-982"><span class="linenos"> 982</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace-983"><a href="#Lace-983"><span class="linenos"> 983</span></a>        <span class="n">validate_args</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">shape_style_map</span><span class="p">)</span>
</span><span id="Lace-984"><a href="#Lace-984"><span class="linenos"> 984</span></a>        <span class="p">(</span>
</span><span id="Lace-985"><a href="#Lace-985"><span class="linenos"> 985</span></a>            <span class="n">rtol</span><span class="p">,</span>
</span><span id="Lace-986"><a href="#Lace-986"><span class="linenos"> 986</span></a>            <span class="n">swatch</span><span class="p">,</span>
</span><span id="Lace-987"><a href="#Lace-987"><span class="linenos"> 987</span></a>            <span class="n">plait_color</span><span class="p">,</span>
</span><span id="Lace-988"><a href="#Lace-988"><span class="linenos"> 988</span></a>            <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="Lace-989"><a href="#Lace-989"><span class="linenos"> 989</span></a>            <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="Lace-990"><a href="#Lace-990"><span class="linenos"> 990</span></a>            <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="Lace-991"><a href="#Lace-991"><span class="linenos"> 991</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="Lace-992"><a href="#Lace-992"><span class="linenos"> 992</span></a>            <span class="p">[</span>
</span><span id="Lace-993"><a href="#Lace-993"><span class="linenos"> 993</span></a>                <span class="s2">&quot;rtol&quot;</span><span class="p">,</span>
</span><span id="Lace-994"><a href="#Lace-994"><span class="linenos"> 994</span></a>                <span class="s2">&quot;swatch&quot;</span><span class="p">,</span>
</span><span id="Lace-995"><a href="#Lace-995"><span class="linenos"> 995</span></a>                <span class="s2">&quot;plait_color&quot;</span><span class="p">,</span>
</span><span id="Lace-996"><a href="#Lace-996"><span class="linenos"> 996</span></a>                <span class="s2">&quot;draw_fragments&quot;</span><span class="p">,</span>
</span><span id="Lace-997"><a href="#Lace-997"><span class="linenos"> 997</span></a>                <span class="s2">&quot;area_threshold&quot;</span><span class="p">,</span>
</span><span id="Lace-998"><a href="#Lace-998"><span class="linenos"> 998</span></a>                <span class="s2">&quot;radius_threshold&quot;</span><span class="p">,</span>
</span><span id="Lace-999"><a href="#Lace-999"><span class="linenos"> 999</span></a>            <span class="p">],</span>
</span><span id="Lace-1000"><a href="#Lace-1000"><span class="linenos">1000</span></a>            <span class="p">[</span>
</span><span id="Lace-1001"><a href="#Lace-1001"><span class="linenos">1001</span></a>                <span class="n">rtol</span><span class="p">,</span>
</span><span id="Lace-1002"><a href="#Lace-1002"><span class="linenos">1002</span></a>                <span class="n">swatch</span><span class="p">,</span>
</span><span id="Lace-1003"><a href="#Lace-1003"><span class="linenos">1003</span></a>                <span class="n">plait_color</span><span class="p">,</span>
</span><span id="Lace-1004"><a href="#Lace-1004"><span class="linenos">1004</span></a>                <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="Lace-1005"><a href="#Lace-1005"><span class="linenos">1005</span></a>                <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="Lace-1006"><a href="#Lace-1006"><span class="linenos">1006</span></a>                <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="Lace-1007"><a href="#Lace-1007"><span class="linenos">1007</span></a>            <span class="p">],</span>
</span><span id="Lace-1008"><a href="#Lace-1008"><span class="linenos">1008</span></a>        <span class="p">)</span>
</span><span id="Lace-1009"><a href="#Lace-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1010"><a href="#Lace-1010"><span class="linenos">1010</span></a>            <span class="n">polygon_shapes</span> <span class="o">=</span> <span class="n">polygon_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="Lace-1011"><a href="#Lace-1011"><span class="linenos">1011</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polygons</span><span class="p">(</span><span class="n">polygon_shapes</span><span class="p">)</span>
</span><span id="Lace-1012"><a href="#Lace-1012"><span class="linenos">1012</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1013"><a href="#Lace-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1014"><a href="#Lace-1014"><span class="linenos">1014</span></a>        <span class="k">if</span> <span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1015"><a href="#Lace-1015"><span class="linenos">1015</span></a>            <span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="Lace-1016"><a href="#Lace-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polylines</span><span class="p">(</span><span class="n">polyline_shapes</span><span class="p">)</span>
</span><span id="Lace-1017"><a href="#Lace-1017"><span class="linenos">1017</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1018"><a href="#Lace-1018"><span class="linenos">1018</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1019"><a href="#Lace-1019"><span class="linenos">1019</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1020"><a href="#Lace-1020"><span class="linenos">1020</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ : No polygons or polylines found.&quot;</span>
</span><span id="Lace-1021"><a href="#Lace-1021"><span class="linenos">1021</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace-1022"><a href="#Lace-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span>
</span><span id="Lace-1023"><a href="#Lace-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="Lace-1024"><a href="#Lace-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace-1025"><a href="#Lace-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace-1026"><a href="#Lace-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Lace-1027"><a href="#Lace-1027"><span class="linenos">1027</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span> <span class="o">=</span> <span class="n">rtol</span>
</span><span id="Lace-1028"><a href="#Lace-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swatch</span> <span class="o">=</span> <span class="n">swatch</span>
</span><span id="Lace-1029"><a href="#Lace-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span> <span class="o">=</span> <span class="n">breakpoints</span>
</span><span id="Lace-1030"><a href="#Lace-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plait_color</span> <span class="o">=</span> <span class="n">plait_color</span>
</span><span id="Lace-1031"><a href="#Lace-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="n">draw_fragments</span>
</span><span id="Lace-1032"><a href="#Lace-1032"><span class="linenos">1032</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span>
</span><span id="Lace-1033"><a href="#Lace-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">color_step</span> <span class="o">=</span> <span class="n">color_step</span>
</span><span id="Lace-1034"><a href="#Lace-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span> <span class="o">=</span> <span class="n">with_plaits</span>
</span><span id="Lace-1035"><a href="#Lace-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># key, value:intersection.id, intersection</span>
</span><span id="Lace-1036"><a href="#Lace-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Lace-1037"><a href="#Lace-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1038"><a href="#Lace-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1039"><a href="#Lace-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace-1040"><a href="#Lace-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span> <span class="o">=</span> <span class="n">area_threshold</span>
</span><span id="Lace-1041"><a href="#Lace-1041"><span class="linenos">1041</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span> <span class="o">=</span> <span class="n">radius_threshold</span>
</span><span id="Lace-1042"><a href="#Lace-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace-1043"><a href="#Lace-1043"><span class="linenos">1043</span></a>            <span class="c1"># pass the pre-computed values</span>
</span><span id="Lace-1044"><a href="#Lace-1044"><span class="linenos">1044</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace-1045"><a href="#Lace-1045"><span class="linenos">1045</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;_copy&quot;</span><span class="p">:</span>
</span><span id="Lace-1046"><a href="#Lace-1046"><span class="linenos">1046</span></a>                    <span class="k">continue</span>
</span><span id="Lace-1047"><a href="#Lace-1047"><span class="linenos">1047</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1048"><a href="#Lace-1048"><span class="linenos">1048</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Lace-1049"><a href="#Lace-1049"><span class="linenos">1049</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1050"><a href="#Lace-1050"><span class="linenos">1050</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_polyline_list</span><span class="p">()</span>  <span class="c1"># main divisions are set here along with polylines</span>
</span><span id="Lace-1051"><a href="#Lace-1051"><span class="linenos">1051</span></a>            <span class="c1"># polyline.divisions is the list of Division objects</span>
</span><span id="Lace-1052"><a href="#Lace-1052"><span class="linenos">1052</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_parallel_poly_list</span><span class="p">()</span>
</span><span id="Lace-1053"><a href="#Lace-1053"><span class="linenos">1053</span></a>            <span class="c1"># start_time2 = time.perf_counter()</span>
</span><span id="Lace-1054"><a href="#Lace-1054"><span class="linenos">1054</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="Lace-1055"><a href="#Lace-1055"><span class="linenos">1055</span></a>            <span class="c1"># end_time2 = time.perf_counter()</span>
</span><span id="Lace-1056"><a href="#Lace-1056"><span class="linenos">1056</span></a>            <span class="c1"># print(</span>
</span><span id="Lace-1057"><a href="#Lace-1057"><span class="linenos">1057</span></a>            <span class="c1">#     f&quot;Lace.__init__ intersections computed in {end_time2 - start_time2:0.4f} seconds&quot;</span>
</span><span id="Lace-1058"><a href="#Lace-1058"><span class="linenos">1058</span></a>            <span class="c1"># )</span>
</span><span id="Lace-1059"><a href="#Lace-1059"><span class="linenos">1059</span></a>
</span><span id="Lace-1060"><a href="#Lace-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_overlaps</span><span class="p">()</span>
</span><span id="Lace-1061"><a href="#Lace-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_twin_sections</span><span class="p">()</span>
</span><span id="Lace-1062"><a href="#Lace-1062"><span class="linenos">1062</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_fragments</span><span class="p">()</span>
</span><span id="Lace-1063"><a href="#Lace-1063"><span class="linenos">1063</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1064"><a href="#Lace-1064"><span class="linenos">1064</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_set_outline</span><span class="p">()</span>
</span><span id="Lace-1065"><a href="#Lace-1065"><span class="linenos">1065</span></a>            <span class="c1"># self._set_partitions()</span>
</span><span id="Lace-1066"><a href="#Lace-1066"><span class="linenos">1066</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_over_under</span><span class="p">()</span>
</span><span id="Lace-1067"><a href="#Lace-1067"><span class="linenos">1067</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span><span class="p">:</span>
</span><span id="Lace-1068"><a href="#Lace-1068"><span class="linenos">1068</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_plaits</span><span class="p">()</span>
</span><span id="Lace-1069"><a href="#Lace-1069"><span class="linenos">1069</span></a>            <span class="c1"># self._set_convex_hull()</span>
</span><span id="Lace-1070"><a href="#Lace-1070"><span class="linenos">1070</span></a>            <span class="c1"># self._set_concave_hull()</span>
</span><span id="Lace-1071"><a href="#Lace-1071"><span class="linenos">1071</span></a>            <span class="c1"># self._set_fragment_groups()</span>
</span><span id="Lace-1072"><a href="#Lace-1072"><span class="linenos">1072</span></a>            <span class="c1"># self._set_partition_groups()</span>
</span><span id="Lace-1073"><a href="#Lace-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_b_box</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace-1074"><a href="#Lace-1074"><span class="linenos">1074</span></a>        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">polyline</span> <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="Lace-1075"><a href="#Lace-1075"><span class="linenos">1075</span></a>
</span><span id="Lace-1076"><a href="#Lace-1076"><span class="linenos">1076</span></a>        <span class="k">if</span> <span class="s2">&quot;debug&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace-1077"><a href="#Lace-1077"><span class="linenos">1077</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span>
</span><span id="Lace-1078"><a href="#Lace-1078"><span class="linenos">1078</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Lace-1079"><a href="#Lace-1079"><span class="linenos">1079</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace-1080"><a href="#Lace-1080"><span class="linenos">1080</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Lace-1081"><a href="#Lace-1081"><span class="linenos">1081</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Lace-1082"><a href="#Lace-1082"><span class="linenos">1082</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># todo: we should check for valid values here</span>
</span><span id="Lace-1083"><a href="#Lace-1083"><span class="linenos">1083</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1084"><a href="#Lace-1084"><span class="linenos">1084</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">. Invalid attribute!&quot;</span><span class="p">)</span>
</span><span id="Lace-1085"><a href="#Lace-1085"><span class="linenos">1085</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">LACE</span>
</span><span id="Lace-1086"><a href="#Lace-1086"><span class="linenos">1086</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Lace-1087"><a href="#Lace-1087"><span class="linenos">1087</span></a>
</span><span id="Lace-1088"><a href="#Lace-1088"><span class="linenos">1088</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1089"><a href="#Lace-1089"><span class="linenos">1089</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1090"><a href="#Lace-1090"><span class="linenos">1090</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the lace.</span>
</span><span id="Lace-1091"><a href="#Lace-1091"><span class="linenos">1091</span></a>
</span><span id="Lace-1092"><a href="#Lace-1092"><span class="linenos">1092</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1093"><a href="#Lace-1093"><span class="linenos">1093</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="Lace-1094"><a href="#Lace-1094"><span class="linenos">1094</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1095"><a href="#Lace-1095"><span class="linenos">1095</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">CG</span>
</span><span id="Lace-1096"><a href="#Lace-1096"><span class="linenos">1096</span></a>
</span><span id="Lace-1097"><a href="#Lace-1097"><span class="linenos">1097</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1098"><a href="#Lace-1098"><span class="linenos">1098</span></a>    <span class="k">def</span> <span class="nf">fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1099"><a href="#Lace-1099"><span class="linenos">1099</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the fragment groups of the lace.</span>
</span><span id="Lace-1100"><a href="#Lace-1100"><span class="linenos">1100</span></a>
</span><span id="Lace-1101"><a href="#Lace-1101"><span class="linenos">1101</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1102"><a href="#Lace-1102"><span class="linenos">1102</span></a><span class="sd">            dict: Dictionary of fragment groups.</span>
</span><span id="Lace-1103"><a href="#Lace-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1104"><a href="#Lace-1104"><span class="linenos">1104</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
</span><span id="Lace-1105"><a href="#Lace-1105"><span class="linenos">1105</span></a>        <span class="n">radius_frag</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1106"><a href="#Lace-1106"><span class="linenos">1106</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1107"><a href="#Lace-1107"><span class="linenos">1107</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">))</span>
</span><span id="Lace-1108"><a href="#Lace-1108"><span class="linenos">1108</span></a>            <span class="k">for</span> <span class="n">rad</span><span class="p">,</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">radius_frag</span><span class="p">:</span>
</span><span id="Lace-1109"><a href="#Lace-1109"><span class="linenos">1109</span></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span> <span class="o">-</span> <span class="n">rad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Lace-1110"><a href="#Lace-1110"><span class="linenos">1110</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">rad</span>
</span><span id="Lace-1111"><a href="#Lace-1111"><span class="linenos">1111</span></a>                    <span class="k">break</span>
</span><span id="Lace-1112"><a href="#Lace-1112"><span class="linenos">1112</span></a>            <span class="n">radius_frag</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">))</span>
</span><span id="Lace-1113"><a href="#Lace-1113"><span class="linenos">1113</span></a>
</span><span id="Lace-1114"><a href="#Lace-1114"><span class="linenos">1114</span></a>        <span class="n">radius_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1115"><a href="#Lace-1115"><span class="linenos">1115</span></a>
</span><span id="Lace-1116"><a href="#Lace-1116"><span class="linenos">1116</span></a>        <span class="n">d_groups</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Lace-1117"><a href="#Lace-1117"><span class="linenos">1117</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radius_frag</span><span class="p">):</span>
</span><span id="Lace-1118"><a href="#Lace-1118"><span class="linenos">1118</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Lace-1119"><a href="#Lace-1119"><span class="linenos">1119</span></a>                <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace-1120"><a href="#Lace-1120"><span class="linenos">1120</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1121"><a href="#Lace-1121"><span class="linenos">1121</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">d_groups</span><span class="p">:</span>
</span><span id="Lace-1122"><a href="#Lace-1122"><span class="linenos">1122</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace-1123"><a href="#Lace-1123"><span class="linenos">1123</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1124"><a href="#Lace-1124"><span class="linenos">1124</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace-1125"><a href="#Lace-1125"><span class="linenos">1125</span></a>
</span><span id="Lace-1126"><a href="#Lace-1126"><span class="linenos">1126</span></a>        <span class="k">return</span> <span class="n">d_groups</span>
</span><span id="Lace-1127"><a href="#Lace-1127"><span class="linenos">1127</span></a>
</span><span id="Lace-1128"><a href="#Lace-1128"><span class="linenos">1128</span></a>    <span class="k">def</span> <span class="nf">_check_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon_shapes</span><span class="p">):</span>
</span><span id="Lace-1129"><a href="#Lace-1129"><span class="linenos">1129</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polygon_shapes</span><span class="p">,</span> <span class="n">Batch</span><span class="p">):</span>
</span><span id="Lace-1130"><a href="#Lace-1130"><span class="linenos">1130</span></a>            <span class="n">polygon_shapes</span> <span class="o">=</span> <span class="n">polygon_shapes</span><span class="o">.</span><span class="n">all_shapes</span>
</span><span id="Lace-1131"><a href="#Lace-1131"><span class="linenos">1131</span></a>        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1132"><a href="#Lace-1132"><span class="linenos">1132</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Lace-1133"><a href="#Lace-1133"><span class="linenos">1133</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ found polygon with less than 3 points.&quot;</span>
</span><span id="Lace-1134"><a href="#Lace-1134"><span class="linenos">1134</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace-1135"><a href="#Lace-1135"><span class="linenos">1135</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">polygon</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Lace-1136"><a href="#Lace-1136"><span class="linenos">1136</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ : Invalid polygons&quot;</span>
</span><span id="Lace-1137"><a href="#Lace-1137"><span class="linenos">1137</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace-1138"><a href="#Lace-1138"><span class="linenos">1138</span></a>            <span class="k">if</span> <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Lace-1139"><a href="#Lace-1139"><span class="linenos">1139</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1140"><a href="#Lace-1140"><span class="linenos">1140</span></a>        <span class="c1"># check if the polygons are clockwise</span>
</span><span id="Lace-1141"><a href="#Lace-1141"><span class="linenos">1141</span></a>        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1142"><a href="#Lace-1142"><span class="linenos">1142</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">):</span>
</span><span id="Lace-1143"><a href="#Lace-1143"><span class="linenos">1143</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace-1144"><a href="#Lace-1144"><span class="linenos">1144</span></a>
</span><span id="Lace-1145"><a href="#Lace-1145"><span class="linenos">1145</span></a>        <span class="k">return</span> <span class="n">polygon_shapes</span>
</span><span id="Lace-1146"><a href="#Lace-1146"><span class="linenos">1146</span></a>
</span><span id="Lace-1147"><a href="#Lace-1147"><span class="linenos">1147</span></a>    <span class="k">def</span> <span class="nf">_check_polylines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polyline_shapes</span><span class="p">):</span>
</span><span id="Lace-1148"><a href="#Lace-1148"><span class="linenos">1148</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polyline_shapes</span><span class="p">,</span> <span class="n">Batch</span><span class="p">):</span>
</span><span id="Lace-1149"><a href="#Lace-1149"><span class="linenos">1149</span></a>            <span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span><span class="o">.</span><span class="n">all_shapes</span>
</span><span id="Lace-1150"><a href="#Lace-1150"><span class="linenos">1150</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1151"><a href="#Lace-1151"><span class="linenos">1151</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">primary_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Lace-1152"><a href="#Lace-1152"><span class="linenos">1152</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ found polyline with less than 2 points.&quot;</span>
</span><span id="Lace-1153"><a href="#Lace-1153"><span class="linenos">1153</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace-1154"><a href="#Lace-1154"><span class="linenos">1154</span></a>
</span><span id="Lace-1155"><a href="#Lace-1155"><span class="linenos">1155</span></a>        <span class="k">return</span> <span class="n">polyline_shapes</span>
</span><span id="Lace-1156"><a href="#Lace-1156"><span class="linenos">1156</span></a>
</span><span id="Lace-1157"><a href="#Lace-1157"><span class="linenos">1157</span></a>    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Lace-1158"><a href="#Lace-1158"><span class="linenos">1158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the transformation matrix of the lace.</span>
</span><span id="Lace-1159"><a href="#Lace-1159"><span class="linenos">1159</span></a>
</span><span id="Lace-1160"><a href="#Lace-1160"><span class="linenos">1160</span></a><span class="sd">        Args:</span>
</span><span id="Lace-1161"><a href="#Lace-1161"><span class="linenos">1161</span></a><span class="sd">            xform_matrix (array): Transformation matrix.</span>
</span><span id="Lace-1162"><a href="#Lace-1162"><span class="linenos">1162</span></a><span class="sd">            reps (int, optional): Number of repetitions. Defaults to 0.</span>
</span><span id="Lace-1163"><a href="#Lace-1163"><span class="linenos">1163</span></a>
</span><span id="Lace-1164"><a href="#Lace-1164"><span class="linenos">1164</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1165"><a href="#Lace-1165"><span class="linenos">1165</span></a><span class="sd">            Any: Updated lace or list of updated laces.</span>
</span><span id="Lace-1166"><a href="#Lace-1166"><span class="linenos">1166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1167"><a href="#Lace-1167"><span class="linenos">1167</span></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Lace-1168"><a href="#Lace-1168"><span class="linenos">1168</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">@</span> <span class="n">xform_matrix</span>
</span><span id="Lace-1169"><a href="#Lace-1169"><span class="linenos">1169</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1170"><a href="#Lace-1170"><span class="linenos">1170</span></a>                <span class="n">polygon</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1171"><a href="#Lace-1171"><span class="linenos">1171</span></a>
</span><span id="Lace-1172"><a href="#Lace-1172"><span class="linenos">1172</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1173"><a href="#Lace-1173"><span class="linenos">1173</span></a>                <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1174"><a href="#Lace-1174"><span class="linenos">1174</span></a>                    <span class="n">polyline</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1175"><a href="#Lace-1175"><span class="linenos">1175</span></a>
</span><span id="Lace-1176"><a href="#Lace-1176"><span class="linenos">1176</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1177"><a href="#Lace-1177"><span class="linenos">1177</span></a>                <span class="n">polyline</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1178"><a href="#Lace-1178"><span class="linenos">1178</span></a>
</span><span id="Lace-1179"><a href="#Lace-1179"><span class="linenos">1179</span></a>            <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1180"><a href="#Lace-1180"><span class="linenos">1180</span></a>                <span class="n">fragment</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1181"><a href="#Lace-1181"><span class="linenos">1181</span></a>
</span><span id="Lace-1182"><a href="#Lace-1182"><span class="linenos">1182</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span><span class="p">:</span>
</span><span id="Lace-1183"><a href="#Lace-1183"><span class="linenos">1183</span></a>                <span class="n">intersection</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1184"><a href="#Lace-1184"><span class="linenos">1184</span></a>
</span><span id="Lace-1185"><a href="#Lace-1185"><span class="linenos">1185</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span><span class="p">:</span>
</span><span id="Lace-1186"><a href="#Lace-1186"><span class="linenos">1186</span></a>                <span class="n">intersection</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1187"><a href="#Lace-1187"><span class="linenos">1187</span></a>
</span><span id="Lace-1188"><a href="#Lace-1188"><span class="linenos">1188</span></a>            <span class="k">for</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="p">:</span>
</span><span id="Lace-1189"><a href="#Lace-1189"><span class="linenos">1189</span></a>                <span class="n">overlap</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1190"><a href="#Lace-1190"><span class="linenos">1190</span></a>
</span><span id="Lace-1191"><a href="#Lace-1191"><span class="linenos">1191</span></a>            <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace-1192"><a href="#Lace-1192"><span class="linenos">1192</span></a>                <span class="n">plait</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1193"><a href="#Lace-1193"><span class="linenos">1193</span></a>
</span><span id="Lace-1194"><a href="#Lace-1194"><span class="linenos">1194</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Lace-1195"><a href="#Lace-1195"><span class="linenos">1195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1196"><a href="#Lace-1196"><span class="linenos">1196</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1197"><a href="#Lace-1197"><span class="linenos">1197</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
</span><span id="Lace-1198"><a href="#Lace-1198"><span class="linenos">1198</span></a>                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Lace-1199"><a href="#Lace-1199"><span class="linenos">1199</span></a>                <span class="n">shape</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">)</span>
</span><span id="Lace-1200"><a href="#Lace-1200"><span class="linenos">1200</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Lace-1201"><a href="#Lace-1201"><span class="linenos">1201</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="Lace-1202"><a href="#Lace-1202"><span class="linenos">1202</span></a>
</span><span id="Lace-1203"><a href="#Lace-1203"><span class="linenos">1203</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1204"><a href="#Lace-1204"><span class="linenos">1204</span></a>    <span class="k">def</span> <span class="nf">_set_twin_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1205"><a href="#Lace-1205"><span class="linenos">1205</span></a>        <span class="k">for</span> <span class="n">par_poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1206"><a href="#Lace-1206"><span class="linenos">1206</span></a>            <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">par_poly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="Lace-1207"><a href="#Lace-1207"><span class="linenos">1207</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">iter_sections</span><span class="p">()):</span>
</span><span id="Lace-1208"><a href="#Lace-1208"><span class="linenos">1208</span></a>                <span class="n">sec1</span> <span class="o">=</span> <span class="n">sec</span>
</span><span id="Lace-1209"><a href="#Lace-1209"><span class="linenos">1209</span></a>                <span class="n">sec2</span> <span class="o">=</span> <span class="n">poly2</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Lace-1210"><a href="#Lace-1210"><span class="linenos">1210</span></a>                <span class="n">sec1</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">sec2</span>
</span><span id="Lace-1211"><a href="#Lace-1211"><span class="linenos">1211</span></a>                <span class="n">sec2</span><span class="o">.</span><span class="n">twin</span> <span class="o">=</span> <span class="n">sec1</span>
</span><span id="Lace-1212"><a href="#Lace-1212"><span class="linenos">1212</span></a>
</span><span id="Lace-1213"><a href="#Lace-1213"><span class="linenos">1213</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1214"><a href="#Lace-1214"><span class="linenos">1214</span></a>    <span class="k">def</span> <span class="nf">_set_partitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1215"><a href="#Lace-1215"><span class="linenos">1215</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1216"><a href="#Lace-1216"><span class="linenos">1216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1217"><a href="#Lace-1217"><span class="linenos">1217</span></a>            <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1218"><a href="#Lace-1218"><span class="linenos">1218</span></a>                <span class="n">partition</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_polygon</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
</span><span id="Lace-1219"><a href="#Lace-1219"><span class="linenos">1219</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
</span><span id="Lace-1220"><a href="#Lace-1220"><span class="linenos">1220</span></a>
</span><span id="Lace-1221"><a href="#Lace-1221"><span class="linenos">1221</span></a>    <span class="c1"># To do: This doesn&#39;t work if we have polyline shapes!</span>
</span><span id="Lace-1222"><a href="#Lace-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="nf">_set_outline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1223"><a href="#Lace-1223"><span class="linenos">1223</span></a>        <span class="c1"># outline is a special fragment that covers the whole lace</span>
</span><span id="Lace-1224"><a href="#Lace-1224"><span class="linenos">1224</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1225"><a href="#Lace-1225"><span class="linenos">1225</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1226"><a href="#Lace-1226"><span class="linenos">1226</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fragment</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">fragment</span><span class="p">))</span>
</span><span id="Lace-1227"><a href="#Lace-1227"><span class="linenos">1227</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1228"><a href="#Lace-1228"><span class="linenos">1228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace-1229"><a href="#Lace-1229"><span class="linenos">1229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="p">)</span>
</span><span id="Lace-1230"><a href="#Lace-1230"><span class="linenos">1230</span></a>        <span class="c1"># perimenter is the outline of the partitions</span>
</span><span id="Lace-1231"><a href="#Lace-1231"><span class="linenos">1231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">perimeter</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
</span><span id="Lace-1232"><a href="#Lace-1232"><span class="linenos">1232</span></a>        <span class="c1"># skeleton is the input polylines that the lace is based on</span>
</span><span id="Lace-1233"><a href="#Lace-1233"><span class="linenos">1233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">)</span>
</span><span id="Lace-1234"><a href="#Lace-1234"><span class="linenos">1234</span></a>
</span><span id="Lace-1235"><a href="#Lace-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="nf">set_fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1236"><a href="#Lace-1236"><span class="linenos">1236</span></a>        <span class="c1"># to do : handle repeated code. same in _set_partition_groups</span>
</span><span id="Lace-1237"><a href="#Lace-1237"><span class="linenos">1237</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1238"><a href="#Lace-1238"><span class="linenos">1238</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="Lace-1239"><a href="#Lace-1239"><span class="linenos">1239</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fragment</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace-1240"><a href="#Lace-1240"><span class="linenos">1240</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace-1241"><a href="#Lace-1241"><span class="linenos">1241</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span><span class="p">)</span>
</span><span id="Lace-1242"><a href="#Lace-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace-1243"><a href="#Lace-1243"><span class="linenos">1243</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace-1244"><a href="#Lace-1244"><span class="linenos">1244</span></a>            <span class="n">area_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="Lace-1245"><a href="#Lace-1245"><span class="linenos">1245</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="Lace-1246"><a href="#Lace-1246"><span class="linenos">1246</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1247"><a href="#Lace-1247"><span class="linenos">1247</span></a>            <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
</span><span id="Lace-1248"><a href="#Lace-1248"><span class="linenos">1248</span></a>                <span class="k">if</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">area_values</span><span class="p">:</span>
</span><span id="Lace-1249"><a href="#Lace-1249"><span class="linenos">1249</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace-1250"><a href="#Lace-1250"><span class="linenos">1250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace-1251"><a href="#Lace-1251"><span class="linenos">1251</span></a>
</span><span id="Lace-1252"><a href="#Lace-1252"><span class="linenos">1252</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1253"><a href="#Lace-1253"><span class="linenos">1253</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="Lace-1254"><a href="#Lace-1254"><span class="linenos">1254</span></a>            <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace-1255"><a href="#Lace-1255"><span class="linenos">1255</span></a>        <span class="n">radii</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace-1256"><a href="#Lace-1256"><span class="linenos">1256</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span><span class="p">)</span>
</span><span id="Lace-1257"><a href="#Lace-1257"><span class="linenos">1257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace-1258"><a href="#Lace-1258"><span class="linenos">1258</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace-1259"><a href="#Lace-1259"><span class="linenos">1259</span></a>            <span class="n">radius_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="Lace-1260"><a href="#Lace-1260"><span class="linenos">1260</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="Lace-1261"><a href="#Lace-1261"><span class="linenos">1261</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1262"><a href="#Lace-1262"><span class="linenos">1262</span></a>            <span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Lace-1263"><a href="#Lace-1263"><span class="linenos">1263</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radius_values</span><span class="p">:</span>
</span><span id="Lace-1264"><a href="#Lace-1264"><span class="linenos">1264</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace-1265"><a href="#Lace-1265"><span class="linenos">1265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace-1266"><a href="#Lace-1266"><span class="linenos">1266</span></a>
</span><span id="Lace-1267"><a href="#Lace-1267"><span class="linenos">1267</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1268"><a href="#Lace-1268"><span class="linenos">1268</span></a>    <span class="k">def</span> <span class="nf">_set_partition_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1269"><a href="#Lace-1269"><span class="linenos">1269</span></a>        <span class="c1"># to do : handle repeated code. same in set_fragment_groups</span>
</span><span id="Lace-1270"><a href="#Lace-1270"><span class="linenos">1270</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1271"><a href="#Lace-1271"><span class="linenos">1271</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">partition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">):</span>
</span><span id="Lace-1272"><a href="#Lace-1272"><span class="linenos">1272</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">partition</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace-1273"><a href="#Lace-1273"><span class="linenos">1273</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace-1274"><a href="#Lace-1274"><span class="linenos">1274</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span><span class="p">)</span>
</span><span id="Lace-1275"><a href="#Lace-1275"><span class="linenos">1275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_area</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace-1276"><a href="#Lace-1276"><span class="linenos">1276</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bin_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace-1277"><a href="#Lace-1277"><span class="linenos">1277</span></a>            <span class="n">area_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">]</span>
</span><span id="Lace-1278"><a href="#Lace-1278"><span class="linenos">1278</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_</span><span class="p">)</span>
</span><span id="Lace-1279"><a href="#Lace-1279"><span class="linenos">1279</span></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1280"><a href="#Lace-1280"><span class="linenos">1280</span></a>            <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
</span><span id="Lace-1281"><a href="#Lace-1281"><span class="linenos">1281</span></a>                <span class="k">if</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">area_values</span><span class="p">:</span>
</span><span id="Lace-1282"><a href="#Lace-1282"><span class="linenos">1282</span></a>                    <span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace-1283"><a href="#Lace-1283"><span class="linenos">1283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_area</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitions</span>
</span><span id="Lace-1284"><a href="#Lace-1284"><span class="linenos">1284</span></a>
</span><span id="Lace-1285"><a href="#Lace-1285"><span class="linenos">1285</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1286"><a href="#Lace-1286"><span class="linenos">1286</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">partition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">):</span>
</span><span id="Lace-1287"><a href="#Lace-1287"><span class="linenos">1287</span></a>            <span class="n">CG</span> <span class="o">=</span> <span class="n">polygon_center</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace-1288"><a href="#Lace-1288"><span class="linenos">1288</span></a>            <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">CG</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace-1289"><a href="#Lace-1289"><span class="linenos">1289</span></a>        <span class="n">radii</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace-1290"><a href="#Lace-1290"><span class="linenos">1290</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span><span class="p">)</span>
</span><span id="Lace-1291"><a href="#Lace-1291"><span class="linenos">1291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_radius</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace-1292"><a href="#Lace-1292"><span class="linenos">1292</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bin_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace-1293"><a href="#Lace-1293"><span class="linenos">1293</span></a>            <span class="n">radius_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">]</span>
</span><span id="Lace-1294"><a href="#Lace-1294"><span class="linenos">1294</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_</span><span class="p">)</span>
</span><span id="Lace-1295"><a href="#Lace-1295"><span class="linenos">1295</span></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1296"><a href="#Lace-1296"><span class="linenos">1296</span></a>            <span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Lace-1297"><a href="#Lace-1297"><span class="linenos">1297</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radius_values</span><span class="p">:</span>
</span><span id="Lace-1298"><a href="#Lace-1298"><span class="linenos">1298</span></a>                    <span class="n">partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partitions</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace-1299"><a href="#Lace-1299"><span class="linenos">1299</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">partitions_by_radius</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitions</span>
</span><span id="Lace-1300"><a href="#Lace-1300"><span class="linenos">1300</span></a>
</span><span id="Lace-1301"><a href="#Lace-1301"><span class="linenos">1301</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1302"><a href="#Lace-1302"><span class="linenos">1302</span></a>    <span class="k">def</span> <span class="nf">_set_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1303"><a href="#Lace-1303"><span class="linenos">1303</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace-1304"><a href="#Lace-1304"><span class="linenos">1304</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace-1305"><a href="#Lace-1305"><span class="linenos">1305</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1306"><a href="#Lace-1306"><span class="linenos">1306</span></a>                <span class="k">continue</span>
</span><span id="Lace-1307"><a href="#Lace-1307"><span class="linenos">1307</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1308"><a href="#Lace-1308"><span class="linenos">1308</span></a>
</span><span id="Lace-1309"><a href="#Lace-1309"><span class="linenos">1309</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span><span id="Lace-1310"><a href="#Lace-1310"><span class="linenos">1310</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1311"><a href="#Lace-1311"><span class="linenos">1311</span></a>        <span class="n">d_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span>
</span><span id="Lace-1312"><a href="#Lace-1312"><span class="linenos">1312</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="Lace-1313"><a href="#Lace-1313"><span class="linenos">1313</span></a>            <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1314"><a href="#Lace-1314"><span class="linenos">1314</span></a>            <span class="n">nodes</span> <span class="o">=</span> <span class="n">cycle</span>
</span><span id="Lace-1315"><a href="#Lace-1315"><span class="linenos">1315</span></a>            <span class="n">edges</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="Lace-1316"><a href="#Lace-1316"><span class="linenos">1316</span></a>            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
</span><span id="Lace-1317"><a href="#Lace-1317"><span class="linenos">1317</span></a>            <span class="n">s_intersections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Lace-1318"><a href="#Lace-1318"><span class="linenos">1318</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="Lace-1319"><a href="#Lace-1319"><span class="linenos">1319</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="Lace-1320"><a href="#Lace-1320"><span class="linenos">1320</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="Lace-1321"><a href="#Lace-1321"><span class="linenos">1321</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s_intersections</span><span class="p">]</span>
</span><span id="Lace-1322"><a href="#Lace-1322"><span class="linenos">1322</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_x</span><span class="p">[</span><span class="n">x_id</span><span class="p">]</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x_id</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
</span><span id="Lace-1323"><a href="#Lace-1323"><span class="linenos">1323</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="Lace-1324"><a href="#Lace-1324"><span class="linenos">1324</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace-1325"><a href="#Lace-1325"><span class="linenos">1325</span></a>            <span class="n">fragment</span> <span class="o">=</span> <span class="n">Fragment</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="Lace-1326"><a href="#Lace-1326"><span class="linenos">1326</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
</span><span id="Lace-1327"><a href="#Lace-1327"><span class="linenos">1327</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="Lace-1328"><a href="#Lace-1328"><span class="linenos">1328</span></a>            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace-1329"><a href="#Lace-1329"><span class="linenos">1329</span></a>
</span><span id="Lace-1330"><a href="#Lace-1330"><span class="linenos">1330</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1331"><a href="#Lace-1331"><span class="linenos">1331</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="Lace-1332"><a href="#Lace-1332"><span class="linenos">1332</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span>
</span><span id="Lace-1333"><a href="#Lace-1333"><span class="linenos">1333</span></a>
</span><span id="Lace-1334"><a href="#Lace-1334"><span class="linenos">1334</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1335"><a href="#Lace-1335"><span class="linenos">1335</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">_set_divisions</span><span class="p">()</span>
</span><span id="Lace-1336"><a href="#Lace-1336"><span class="linenos">1336</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1337"><a href="#Lace-1337"><span class="linenos">1337</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">_set_twin_divisions</span><span class="p">()</span>
</span><span id="Lace-1338"><a href="#Lace-1338"><span class="linenos">1338</span></a>
</span><span id="Lace-1339"><a href="#Lace-1339"><span class="linenos">1339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace-1340"><a href="#Lace-1340"><span class="linenos">1340</span></a>
</span><span id="Lace-1341"><a href="#Lace-1341"><span class="linenos">1341</span></a>    <span class="k">def</span> <span class="nf">_set_concave_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1342"><a href="#Lace-1342"><span class="linenos">1342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">concave_hull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Lace-1343"><a href="#Lace-1343"><span class="linenos">1343</span></a>
</span><span id="Lace-1344"><a href="#Lace-1344"><span class="linenos">1344</span></a>    <span class="k">def</span> <span class="nf">_set_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1345"><a href="#Lace-1345"><span class="linenos">1345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">convex_hull</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace-1346"><a href="#Lace-1346"><span class="linenos">1346</span></a>
</span><span id="Lace-1347"><a href="#Lace-1347"><span class="linenos">1347</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1348"><a href="#Lace-1348"><span class="linenos">1348</span></a>        <span class="k">class</span> <span class="nc">Dummy</span><span class="p">(</span><span class="n">Lace</span><span class="p">):</span>
</span><span id="Lace-1349"><a href="#Lace-1349"><span class="linenos">1349</span></a>            <span class="k">pass</span>
</span><span id="Lace-1350"><a href="#Lace-1350"><span class="linenos">1350</span></a>
</span><span id="Lace-1351"><a href="#Lace-1351"><span class="linenos">1351</span></a>        <span class="c1"># we need to copy the polyline_list and parallel_poly_list</span>
</span><span id="Lace-1352"><a href="#Lace-1352"><span class="linenos">1352</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace-1353"><a href="#Lace-1353"><span class="linenos">1353</span></a>            <span class="n">polyline</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Lace-1354"><a href="#Lace-1354"><span class="linenos">1354</span></a>
</span><span id="Lace-1355"><a href="#Lace-1355"><span class="linenos">1355</span></a>    <span class="k">def</span> <span class="nf">get_sketch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1356"><a href="#Lace-1356"><span class="linenos">1356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1357"><a href="#Lace-1357"><span class="linenos">1357</span></a><span class="sd">        Create and return a Sketch object. Sketch is a Batch object</span>
</span><span id="Lace-1358"><a href="#Lace-1358"><span class="linenos">1358</span></a><span class="sd">        with Shape elements corresponding to the vertices of the plaits</span>
</span><span id="Lace-1359"><a href="#Lace-1359"><span class="linenos">1359</span></a><span class="sd">        and fragments of the Lace instance. They have &#39;plaits&#39; and</span>
</span><span id="Lace-1360"><a href="#Lace-1360"><span class="linenos">1360</span></a><span class="sd">        &#39;fragments&#39; attributes to hold lists of Shape objects populated</span>
</span><span id="Lace-1361"><a href="#Lace-1361"><span class="linenos">1361</span></a><span class="sd">        with plait and fragment vertices of the Lace instance</span>
</span><span id="Lace-1362"><a href="#Lace-1362"><span class="linenos">1362</span></a><span class="sd">        respectively. They are used for drawing multiple copies of the</span>
</span><span id="Lace-1363"><a href="#Lace-1363"><span class="linenos">1363</span></a><span class="sd">        original lace pattern. They are light-weight compared to the</span>
</span><span id="Lace-1364"><a href="#Lace-1364"><span class="linenos">1364</span></a><span class="sd">        Lace objects since they only contain sufficient data to draw the</span>
</span><span id="Lace-1365"><a href="#Lace-1365"><span class="linenos">1365</span></a><span class="sd">        lace objects. Hundreds of these objects can be used to create</span>
</span><span id="Lace-1366"><a href="#Lace-1366"><span class="linenos">1366</span></a><span class="sd">        wallpaper patterns or other patterns without having to contain</span>
</span><span id="Lace-1367"><a href="#Lace-1367"><span class="linenos">1367</span></a><span class="sd">        unnecessary data. They do not share points with the original</span>
</span><span id="Lace-1368"><a href="#Lace-1368"><span class="linenos">1368</span></a><span class="sd">        Lace object.</span>
</span><span id="Lace-1369"><a href="#Lace-1369"><span class="linenos">1369</span></a>
</span><span id="Lace-1370"><a href="#Lace-1370"><span class="linenos">1370</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1371"><a href="#Lace-1371"><span class="linenos">1371</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1372"><a href="#Lace-1372"><span class="linenos">1372</span></a><span class="sd">            None</span>
</span><span id="Lace-1373"><a href="#Lace-1373"><span class="linenos">1373</span></a>
</span><span id="Lace-1374"><a href="#Lace-1374"><span class="linenos">1374</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1375"><a href="#Lace-1375"><span class="linenos">1375</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1376"><a href="#Lace-1376"><span class="linenos">1376</span></a><span class="sd">            * A lace object to be copied.</span>
</span><span id="Lace-1377"><a href="#Lace-1377"><span class="linenos">1377</span></a>
</span><span id="Lace-1378"><a href="#Lace-1378"><span class="linenos">1378</span></a><span class="sd">        Side effects:</span>
</span><span id="Lace-1379"><a href="#Lace-1379"><span class="linenos">1379</span></a><span class="sd">        -------------</span>
</span><span id="Lace-1380"><a href="#Lace-1380"><span class="linenos">1380</span></a><span class="sd">            None</span>
</span><span id="Lace-1381"><a href="#Lace-1381"><span class="linenos">1381</span></a>
</span><span id="Lace-1382"><a href="#Lace-1382"><span class="linenos">1382</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1383"><a href="#Lace-1383"><span class="linenos">1383</span></a><span class="sd">        --------</span>
</span><span id="Lace-1384"><a href="#Lace-1384"><span class="linenos">1384</span></a><span class="sd">            A Sketch object.</span>
</span><span id="Lace-1385"><a href="#Lace-1385"><span class="linenos">1385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1386"><a href="#Lace-1386"><span class="linenos">1386</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1387"><a href="#Lace-1387"><span class="linenos">1387</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1388"><a href="#Lace-1388"><span class="linenos">1388</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace-1389"><a href="#Lace-1389"><span class="linenos">1389</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1390"><a href="#Lace-1390"><span class="linenos">1390</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="Lace-1391"><a href="#Lace-1391"><span class="linenos">1391</span></a>            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Lace-1392"><a href="#Lace-1392"><span class="linenos">1392</span></a>
</span><span id="Lace-1393"><a href="#Lace-1393"><span class="linenos">1393</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1394"><a href="#Lace-1394"><span class="linenos">1394</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace-1395"><a href="#Lace-1395"><span class="linenos">1395</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">plait</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace-1396"><a href="#Lace-1396"><span class="linenos">1396</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1397"><a href="#Lace-1397"><span class="linenos">1397</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="Lace-1398"><a href="#Lace-1398"><span class="linenos">1398</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Lace-1399"><a href="#Lace-1399"><span class="linenos">1399</span></a>
</span><span id="Lace-1400"><a href="#Lace-1400"><span class="linenos">1400</span></a>        <span class="n">sketch</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">((</span><span class="n">fragments</span> <span class="o">+</span> <span class="n">plaits</span><span class="p">))</span>
</span><span id="Lace-1401"><a href="#Lace-1401"><span class="linenos">1401</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace-1402"><a href="#Lace-1402"><span class="linenos">1402</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="n">plaits</span>
</span><span id="Lace-1403"><a href="#Lace-1403"><span class="linenos">1403</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span>
</span><span id="Lace-1404"><a href="#Lace-1404"><span class="linenos">1404</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">SKETCH</span>
</span><span id="Lace-1405"><a href="#Lace-1405"><span class="linenos">1405</span></a>
</span><span id="Lace-1406"><a href="#Lace-1406"><span class="linenos">1406</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_plaits</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1407"><a href="#Lace-1407"><span class="linenos">1407</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1408"><a href="#Lace-1408"><span class="linenos">1408</span></a>        <span class="k">return</span> <span class="n">sketch</span>
</span><span id="Lace-1409"><a href="#Lace-1409"><span class="linenos">1409</span></a>
</span><span id="Lace-1410"><a href="#Lace-1410"><span class="linenos">1410</span></a>    <span class="k">def</span> <span class="nf">group_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Lace-1411"><a href="#Lace-1411"><span class="linenos">1411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Group the fragments by the number of vertices and the area.</span>
</span><span id="Lace-1412"><a href="#Lace-1412"><span class="linenos">1412</span></a>
</span><span id="Lace-1413"><a href="#Lace-1413"><span class="linenos">1413</span></a><span class="sd">        Args:</span>
</span><span id="Lace-1414"><a href="#Lace-1414"><span class="linenos">1414</span></a><span class="sd">            tol (float, optional): Tolerance value. Defaults to None.</span>
</span><span id="Lace-1415"><a href="#Lace-1415"><span class="linenos">1415</span></a>
</span><span id="Lace-1416"><a href="#Lace-1416"><span class="linenos">1416</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1417"><a href="#Lace-1417"><span class="linenos">1417</span></a><span class="sd">            list: List of grouped fragments.</span>
</span><span id="Lace-1418"><a href="#Lace-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1419"><a href="#Lace-1419"><span class="linenos">1419</span></a>        <span class="k">if</span> <span class="n">tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace-1420"><a href="#Lace-1420"><span class="linenos">1420</span></a>            <span class="n">tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;tol&quot;</span><span class="p">]</span>
</span><span id="Lace-1421"><a href="#Lace-1421"><span class="linenos">1421</span></a>        <span class="n">frags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="Lace-1422"><a href="#Lace-1422"><span class="linenos">1422</span></a>        <span class="n">vert_groups</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Lace-1423"><a href="#Lace-1423"><span class="linenos">1423</span></a>            <span class="p">[</span><span class="n">frag</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">]</span>
</span><span id="Lace-1424"><a href="#Lace-1424"><span class="linenos">1424</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">])</span>
</span><span id="Lace-1425"><a href="#Lace-1425"><span class="linenos">1425</span></a>        <span class="p">]</span>
</span><span id="Lace-1426"><a href="#Lace-1426"><span class="linenos">1426</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1427"><a href="#Lace-1427"><span class="linenos">1427</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">vert_groups</span><span class="p">:</span>
</span><span id="Lace-1428"><a href="#Lace-1428"><span class="linenos">1428</span></a>            <span class="n">areas</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Lace-1429"><a href="#Lace-1429"><span class="linenos">1429</span></a>                <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">group</span> <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)]</span>
</span><span id="Lace-1430"><a href="#Lace-1430"><span class="linenos">1430</span></a>                <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">frag</span><span class="o">.</span><span class="n">area</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">group</span><span class="p">])</span>
</span><span id="Lace-1431"><a href="#Lace-1431"><span class="linenos">1431</span></a>            <span class="p">]</span>
</span><span id="Lace-1432"><a href="#Lace-1432"><span class="linenos">1432</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace-1433"><a href="#Lace-1433"><span class="linenos">1433</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
</span><span id="Lace-1434"><a href="#Lace-1434"><span class="linenos">1434</span></a>        <span class="n">groups</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace-1435"><a href="#Lace-1435"><span class="linenos">1435</span></a>
</span><span id="Lace-1436"><a href="#Lace-1436"><span class="linenos">1436</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span><span id="Lace-1437"><a href="#Lace-1437"><span class="linenos">1437</span></a>
</span><span id="Lace-1438"><a href="#Lace-1438"><span class="linenos">1438</span></a>    <span class="k">def</span> <span class="nf">get_fragment_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1439"><a href="#Lace-1439"><span class="linenos">1439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1440"><a href="#Lace-1440"><span class="linenos">1440</span></a><span class="sd">        Iterate over the offset sections and create a graph of the</span>
</span><span id="Lace-1441"><a href="#Lace-1441"><span class="linenos">1441</span></a><span class="sd">        intersections (start and end of the sections). Then find the</span>
</span><span id="Lace-1442"><a href="#Lace-1442"><span class="linenos">1442</span></a><span class="sd">        cycles in the graph. self.d_intersections is used to map</span>
</span><span id="Lace-1443"><a href="#Lace-1443"><span class="linenos">1443</span></a><span class="sd">        the graph nodes to the actual intersection points.</span>
</span><span id="Lace-1444"><a href="#Lace-1444"><span class="linenos">1444</span></a>
</span><span id="Lace-1445"><a href="#Lace-1445"><span class="linenos">1445</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1446"><a href="#Lace-1446"><span class="linenos">1446</span></a><span class="sd">            list: List of fragment cycles.</span>
</span><span id="Lace-1447"><a href="#Lace-1447"><span class="linenos">1447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1448"><a href="#Lace-1448"><span class="linenos">1448</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1449"><a href="#Lace-1449"><span class="linenos">1449</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace-1450"><a href="#Lace-1450"><span class="linenos">1450</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1451"><a href="#Lace-1451"><span class="linenos">1451</span></a>                <span class="k">continue</span>
</span><span id="Lace-1452"><a href="#Lace-1452"><span class="linenos">1452</span></a>            <span class="n">graph_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="Lace-1453"><a href="#Lace-1453"><span class="linenos">1453</span></a>
</span><span id="Lace-1454"><a href="#Lace-1454"><span class="linenos">1454</span></a>        <span class="k">return</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="Lace-1455"><a href="#Lace-1455"><span class="linenos">1455</span></a>
</span><span id="Lace-1456"><a href="#Lace-1456"><span class="linenos">1456</span></a>    <span class="k">def</span> <span class="nf">_set_inner_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Lace-1457"><a href="#Lace-1457"><span class="linenos">1457</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="Lace-1458"><a href="#Lace-1458"><span class="linenos">1458</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Lace-1459"><a href="#Lace-1459"><span class="linenos">1459</span></a>            <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="Lace-1460"><a href="#Lace-1460"><span class="linenos">1460</span></a>            <span class="n">offset_poly</span> <span class="o">=</span> <span class="n">offset_polygon_points</span><span class="p">(</span>
</span><span id="Lace-1461"><a href="#Lace-1461"><span class="linenos">1461</span></a>                <span class="n">vertices</span><span class="p">,</span> <span class="n">offset</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dist_tol</span><span class="o">=</span><span class="n">dist_tol</span>
</span><span id="Lace-1462"><a href="#Lace-1462"><span class="linenos">1462</span></a>            <span class="p">)</span>
</span><span id="Lace-1463"><a href="#Lace-1463"><span class="linenos">1463</span></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">offset_poly</span><span class="p">)</span>
</span><span id="Lace-1464"><a href="#Lace-1464"><span class="linenos">1464</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Lace-1465"><a href="#Lace-1465"><span class="linenos">1465</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">line_width</span>
</span><span id="Lace-1466"><a href="#Lace-1466"><span class="linenos">1466</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">line_color</span> <span class="o">=</span> <span class="n">line_color</span>
</span><span id="Lace-1467"><a href="#Lace-1467"><span class="linenos">1467</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">inner_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Lace-1468"><a href="#Lace-1468"><span class="linenos">1468</span></a>
</span><span id="Lace-1469"><a href="#Lace-1469"><span class="linenos">1469</span></a>    <span class="k">def</span> <span class="nf">set_plait_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Lace-1470"><a href="#Lace-1470"><span class="linenos">1470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create offset lines inside the plaits of the lace.</span>
</span><span id="Lace-1471"><a href="#Lace-1471"><span class="linenos">1471</span></a>
</span><span id="Lace-1472"><a href="#Lace-1472"><span class="linenos">1472</span></a><span class="sd">        Args:</span>
</span><span id="Lace-1473"><a href="#Lace-1473"><span class="linenos">1473</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="Lace-1474"><a href="#Lace-1474"><span class="linenos">1474</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="Lace-1475"><a href="#Lace-1475"><span class="linenos">1475</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="Lace-1476"><a href="#Lace-1476"><span class="linenos">1476</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="Lace-1477"><a href="#Lace-1477"><span class="linenos">1477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1478"><a href="#Lace-1478"><span class="linenos">1478</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace-1479"><a href="#Lace-1479"><span class="linenos">1479</span></a>            <span class="n">plait</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1480"><a href="#Lace-1480"><span class="linenos">1480</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">plait</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span><span id="Lace-1481"><a href="#Lace-1481"><span class="linenos">1481</span></a>
</span><span id="Lace-1482"><a href="#Lace-1482"><span class="linenos">1482</span></a>    <span class="k">def</span> <span class="nf">set_fragment_lines</span><span class="p">(</span>
</span><span id="Lace-1483"><a href="#Lace-1483"><span class="linenos">1483</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Lace-1484"><a href="#Lace-1484"><span class="linenos">1484</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Lace-1485"><a href="#Lace-1485"><span class="linenos">1485</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="Lace-1486"><a href="#Lace-1486"><span class="linenos">1486</span></a>        <span class="n">line_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
</span><span id="Lace-1487"><a href="#Lace-1487"><span class="linenos">1487</span></a>        <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Lace-1488"><a href="#Lace-1488"><span class="linenos">1488</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace-1489"><a href="#Lace-1489"><span class="linenos">1489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1490"><a href="#Lace-1490"><span class="linenos">1490</span></a><span class="sd">        Create offset lines inside the fragments of the lace.</span>
</span><span id="Lace-1491"><a href="#Lace-1491"><span class="linenos">1491</span></a>
</span><span id="Lace-1492"><a href="#Lace-1492"><span class="linenos">1492</span></a><span class="sd">        Args:</span>
</span><span id="Lace-1493"><a href="#Lace-1493"><span class="linenos">1493</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="Lace-1494"><a href="#Lace-1494"><span class="linenos">1494</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="Lace-1495"><a href="#Lace-1495"><span class="linenos">1495</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="Lace-1496"><a href="#Lace-1496"><span class="linenos">1496</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="Lace-1497"><a href="#Lace-1497"><span class="linenos">1497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1498"><a href="#Lace-1498"><span class="linenos">1498</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-1499"><a href="#Lace-1499"><span class="linenos">1499</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1500"><a href="#Lace-1500"><span class="linenos">1500</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span><span id="Lace-1501"><a href="#Lace-1501"><span class="linenos">1501</span></a>
</span><span id="Lace-1502"><a href="#Lace-1502"><span class="linenos">1502</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1503"><a href="#Lace-1503"><span class="linenos">1503</span></a>    <span class="k">def</span> <span class="nf">all_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
</span><span id="Lace-1504"><a href="#Lace-1504"><span class="linenos">1504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1505"><a href="#Lace-1505"><span class="linenos">1505</span></a><span class="sd">        Return a list of all the divisions (both main and offset) in the lace.</span>
</span><span id="Lace-1506"><a href="#Lace-1506"><span class="linenos">1506</span></a>
</span><span id="Lace-1507"><a href="#Lace-1507"><span class="linenos">1507</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1508"><a href="#Lace-1508"><span class="linenos">1508</span></a><span class="sd">            list: List of all divisions.</span>
</span><span id="Lace-1509"><a href="#Lace-1509"><span class="linenos">1509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1510"><a href="#Lace-1510"><span class="linenos">1510</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1511"><a href="#Lace-1511"><span class="linenos">1511</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1512"><a href="#Lace-1512"><span class="linenos">1512</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace-1513"><a href="#Lace-1513"><span class="linenos">1513</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace-1514"><a href="#Lace-1514"><span class="linenos">1514</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Lace-1515"><a href="#Lace-1515"><span class="linenos">1515</span></a>
</span><span id="Lace-1516"><a href="#Lace-1516"><span class="linenos">1516</span></a>    <span class="k">def</span> <span class="nf">iter_main_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1517"><a href="#Lace-1517"><span class="linenos">1517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main intersections.</span>
</span><span id="Lace-1518"><a href="#Lace-1518"><span class="linenos">1518</span></a>
</span><span id="Lace-1519"><a href="#Lace-1519"><span class="linenos">1519</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1520"><a href="#Lace-1520"><span class="linenos">1520</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Lace-1521"><a href="#Lace-1521"><span class="linenos">1521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1522"><a href="#Lace-1522"><span class="linenos">1522</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1523"><a href="#Lace-1523"><span class="linenos">1523</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace-1524"><a href="#Lace-1524"><span class="linenos">1524</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="Lace-1525"><a href="#Lace-1525"><span class="linenos">1525</span></a>
</span><span id="Lace-1526"><a href="#Lace-1526"><span class="linenos">1526</span></a>    <span class="k">def</span> <span class="nf">iter_offset_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1527"><a href="#Lace-1527"><span class="linenos">1527</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1528"><a href="#Lace-1528"><span class="linenos">1528</span></a><span class="sd">        Iterate over the offset intersections.</span>
</span><span id="Lace-1529"><a href="#Lace-1529"><span class="linenos">1529</span></a>
</span><span id="Lace-1530"><a href="#Lace-1530"><span class="linenos">1530</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1531"><a href="#Lace-1531"><span class="linenos">1531</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Lace-1532"><a href="#Lace-1532"><span class="linenos">1532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1533"><a href="#Lace-1533"><span class="linenos">1533</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1534"><a href="#Lace-1534"><span class="linenos">1534</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace-1535"><a href="#Lace-1535"><span class="linenos">1535</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace-1536"><a href="#Lace-1536"><span class="linenos">1536</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="Lace-1537"><a href="#Lace-1537"><span class="linenos">1537</span></a>
</span><span id="Lace-1538"><a href="#Lace-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">iter_offset_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1539"><a href="#Lace-1539"><span class="linenos">1539</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1540"><a href="#Lace-1540"><span class="linenos">1540</span></a><span class="sd">        Iterate over the offset sections.</span>
</span><span id="Lace-1541"><a href="#Lace-1541"><span class="linenos">1541</span></a>
</span><span id="Lace-1542"><a href="#Lace-1542"><span class="linenos">1542</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1543"><a href="#Lace-1543"><span class="linenos">1543</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Lace-1544"><a href="#Lace-1544"><span class="linenos">1544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1545"><a href="#Lace-1545"><span class="linenos">1545</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1546"><a href="#Lace-1546"><span class="linenos">1546</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace-1547"><a href="#Lace-1547"><span class="linenos">1547</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace-1548"><a href="#Lace-1548"><span class="linenos">1548</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="Lace-1549"><a href="#Lace-1549"><span class="linenos">1549</span></a>
</span><span id="Lace-1550"><a href="#Lace-1550"><span class="linenos">1550</span></a>    <span class="k">def</span> <span class="nf">iter_main_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1551"><a href="#Lace-1551"><span class="linenos">1551</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main sections.</span>
</span><span id="Lace-1552"><a href="#Lace-1552"><span class="linenos">1552</span></a>
</span><span id="Lace-1553"><a href="#Lace-1553"><span class="linenos">1553</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1554"><a href="#Lace-1554"><span class="linenos">1554</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Lace-1555"><a href="#Lace-1555"><span class="linenos">1555</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1556"><a href="#Lace-1556"><span class="linenos">1556</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1557"><a href="#Lace-1557"><span class="linenos">1557</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace-1558"><a href="#Lace-1558"><span class="linenos">1558</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span><span id="Lace-1559"><a href="#Lace-1559"><span class="linenos">1559</span></a>
</span><span id="Lace-1560"><a href="#Lace-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">iter_offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1561"><a href="#Lace-1561"><span class="linenos">1561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1562"><a href="#Lace-1562"><span class="linenos">1562</span></a><span class="sd">        Iterate over the offset divisions.</span>
</span><span id="Lace-1563"><a href="#Lace-1563"><span class="linenos">1563</span></a>
</span><span id="Lace-1564"><a href="#Lace-1564"><span class="linenos">1564</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1565"><a href="#Lace-1565"><span class="linenos">1565</span></a><span class="sd">            Division: Division object.</span>
</span><span id="Lace-1566"><a href="#Lace-1566"><span class="linenos">1566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1567"><a href="#Lace-1567"><span class="linenos">1567</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1568"><a href="#Lace-1568"><span class="linenos">1568</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace-1569"><a href="#Lace-1569"><span class="linenos">1569</span></a>                <span class="k">yield from</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span>
</span><span id="Lace-1570"><a href="#Lace-1570"><span class="linenos">1570</span></a>
</span><span id="Lace-1571"><a href="#Lace-1571"><span class="linenos">1571</span></a>    <span class="k">def</span> <span class="nf">iter_main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace-1572"><a href="#Lace-1572"><span class="linenos">1572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1573"><a href="#Lace-1573"><span class="linenos">1573</span></a><span class="sd">        Iterate over the main divisions.</span>
</span><span id="Lace-1574"><a href="#Lace-1574"><span class="linenos">1574</span></a>
</span><span id="Lace-1575"><a href="#Lace-1575"><span class="linenos">1575</span></a><span class="sd">        Yields:</span>
</span><span id="Lace-1576"><a href="#Lace-1576"><span class="linenos">1576</span></a><span class="sd">            Division: Division object.</span>
</span><span id="Lace-1577"><a href="#Lace-1577"><span class="linenos">1577</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1578"><a href="#Lace-1578"><span class="linenos">1578</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1579"><a href="#Lace-1579"><span class="linenos">1579</span></a>            <span class="k">yield from</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span>
</span><span id="Lace-1580"><a href="#Lace-1580"><span class="linenos">1580</span></a>
</span><span id="Lace-1581"><a href="#Lace-1581"><span class="linenos">1581</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1582"><a href="#Lace-1582"><span class="linenos">1582</span></a>    <span class="k">def</span> <span class="nf">main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="Lace-1583"><a href="#Lace-1583"><span class="linenos">1583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Main divisions are the divisions of the main polyline.</span>
</span><span id="Lace-1584"><a href="#Lace-1584"><span class="linenos">1584</span></a>
</span><span id="Lace-1585"><a href="#Lace-1585"><span class="linenos">1585</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1586"><a href="#Lace-1586"><span class="linenos">1586</span></a><span class="sd">            list: List of main divisions.</span>
</span><span id="Lace-1587"><a href="#Lace-1587"><span class="linenos">1587</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1588"><a href="#Lace-1588"><span class="linenos">1588</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1589"><a href="#Lace-1589"><span class="linenos">1589</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1590"><a href="#Lace-1590"><span class="linenos">1590</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace-1591"><a href="#Lace-1591"><span class="linenos">1591</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Lace-1592"><a href="#Lace-1592"><span class="linenos">1592</span></a>
</span><span id="Lace-1593"><a href="#Lace-1593"><span class="linenos">1593</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1594"><a href="#Lace-1594"><span class="linenos">1594</span></a>    <span class="k">def</span> <span class="nf">offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="Lace-1595"><a href="#Lace-1595"><span class="linenos">1595</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Offset divisions are the divisions of the offset polylines.</span>
</span><span id="Lace-1596"><a href="#Lace-1596"><span class="linenos">1596</span></a>
</span><span id="Lace-1597"><a href="#Lace-1597"><span class="linenos">1597</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1598"><a href="#Lace-1598"><span class="linenos">1598</span></a><span class="sd">            list: List of offset divisions.</span>
</span><span id="Lace-1599"><a href="#Lace-1599"><span class="linenos">1599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1600"><a href="#Lace-1600"><span class="linenos">1600</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1601"><a href="#Lace-1601"><span class="linenos">1601</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1602"><a href="#Lace-1602"><span class="linenos">1602</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace-1603"><a href="#Lace-1603"><span class="linenos">1603</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace-1604"><a href="#Lace-1604"><span class="linenos">1604</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Lace-1605"><a href="#Lace-1605"><span class="linenos">1605</span></a>
</span><span id="Lace-1606"><a href="#Lace-1606"><span class="linenos">1606</span></a>    <span class="nd">@property</span>
</span><span id="Lace-1607"><a href="#Lace-1607"><span class="linenos">1607</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="Lace-1608"><a href="#Lace-1608"><span class="linenos">1608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all the intersections in the parallel_poly_list.</span>
</span><span id="Lace-1609"><a href="#Lace-1609"><span class="linenos">1609</span></a>
</span><span id="Lace-1610"><a href="#Lace-1610"><span class="linenos">1610</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1611"><a href="#Lace-1611"><span class="linenos">1611</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="Lace-1612"><a href="#Lace-1612"><span class="linenos">1612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1613"><a href="#Lace-1613"><span class="linenos">1613</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1614"><a href="#Lace-1614"><span class="linenos">1614</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1615"><a href="#Lace-1615"><span class="linenos">1615</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace-1616"><a href="#Lace-1616"><span class="linenos">1616</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Lace-1617"><a href="#Lace-1617"><span class="linenos">1617</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Lace-1618"><a href="#Lace-1618"><span class="linenos">1618</span></a>
</span><span id="Lace-1619"><a href="#Lace-1619"><span class="linenos">1619</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1620"><a href="#Lace-1620"><span class="linenos">1620</span></a>    <span class="k">def</span> <span class="nf">_set_polyline_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1621"><a href="#Lace-1621"><span class="linenos">1621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1622"><a href="#Lace-1622"><span class="linenos">1622</span></a><span class="sd">        Populate the self.polyline_list list with Polyline objects.</span>
</span><span id="Lace-1623"><a href="#Lace-1623"><span class="linenos">1623</span></a>
</span><span id="Lace-1624"><a href="#Lace-1624"><span class="linenos">1624</span></a><span class="sd">        * Internal use only.</span>
</span><span id="Lace-1625"><a href="#Lace-1625"><span class="linenos">1625</span></a>
</span><span id="Lace-1626"><a href="#Lace-1626"><span class="linenos">1626</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1627"><a href="#Lace-1627"><span class="linenos">1627</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1628"><a href="#Lace-1628"><span class="linenos">1628</span></a><span class="sd">            None</span>
</span><span id="Lace-1629"><a href="#Lace-1629"><span class="linenos">1629</span></a>
</span><span id="Lace-1630"><a href="#Lace-1630"><span class="linenos">1630</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1631"><a href="#Lace-1631"><span class="linenos">1631</span></a><span class="sd">        --------</span>
</span><span id="Lace-1632"><a href="#Lace-1632"><span class="linenos">1632</span></a><span class="sd">            None</span>
</span><span id="Lace-1633"><a href="#Lace-1633"><span class="linenos">1633</span></a>
</span><span id="Lace-1634"><a href="#Lace-1634"><span class="linenos">1634</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1635"><a href="#Lace-1635"><span class="linenos">1635</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1636"><a href="#Lace-1636"><span class="linenos">1636</span></a>
</span><span id="Lace-1637"><a href="#Lace-1637"><span class="linenos">1637</span></a><span class="sd">            * self.polygon_shapes and/or self.polyline_shapes must be</span>
</span><span id="Lace-1638"><a href="#Lace-1638"><span class="linenos">1638</span></a><span class="sd">              established.</span>
</span><span id="Lace-1639"><a href="#Lace-1639"><span class="linenos">1639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1640"><a href="#Lace-1640"><span class="linenos">1640</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1641"><a href="#Lace-1641"><span class="linenos">1641</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1642"><a href="#Lace-1642"><span class="linenos">1642</span></a>            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace-1643"><a href="#Lace-1643"><span class="linenos">1643</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Lace-1644"><a href="#Lace-1644"><span class="linenos">1644</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1645"><a href="#Lace-1645"><span class="linenos">1645</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace-1646"><a href="#Lace-1646"><span class="linenos">1646</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polyline</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span><span id="Lace-1647"><a href="#Lace-1647"><span class="linenos">1647</span></a>
</span><span id="Lace-1648"><a href="#Lace-1648"><span class="linenos">1648</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1649"><a href="#Lace-1649"><span class="linenos">1649</span></a>    <span class="k">def</span> <span class="nf">_set_parallel_poly_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1650"><a href="#Lace-1650"><span class="linenos">1650</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1651"><a href="#Lace-1651"><span class="linenos">1651</span></a><span class="sd">        Populate the self.parallel_poly_list list with ParallelPolyline</span>
</span><span id="Lace-1652"><a href="#Lace-1652"><span class="linenos">1652</span></a><span class="sd">        objects.</span>
</span><span id="Lace-1653"><a href="#Lace-1653"><span class="linenos">1653</span></a>
</span><span id="Lace-1654"><a href="#Lace-1654"><span class="linenos">1654</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1655"><a href="#Lace-1655"><span class="linenos">1655</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1656"><a href="#Lace-1656"><span class="linenos">1656</span></a><span class="sd">            None</span>
</span><span id="Lace-1657"><a href="#Lace-1657"><span class="linenos">1657</span></a>
</span><span id="Lace-1658"><a href="#Lace-1658"><span class="linenos">1658</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1659"><a href="#Lace-1659"><span class="linenos">1659</span></a><span class="sd">        --------</span>
</span><span id="Lace-1660"><a href="#Lace-1660"><span class="linenos">1660</span></a><span class="sd">            None</span>
</span><span id="Lace-1661"><a href="#Lace-1661"><span class="linenos">1661</span></a>
</span><span id="Lace-1662"><a href="#Lace-1662"><span class="linenos">1662</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1663"><a href="#Lace-1663"><span class="linenos">1663</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1664"><a href="#Lace-1664"><span class="linenos">1664</span></a><span class="sd">            * self.polygon_shapes and/or self.polyline_shapes must be</span>
</span><span id="Lace-1665"><a href="#Lace-1665"><span class="linenos">1665</span></a><span class="sd">              established prior to this.</span>
</span><span id="Lace-1666"><a href="#Lace-1666"><span class="linenos">1666</span></a><span class="sd">            * Parallel polylines are created by offsetting the original</span>
</span><span id="Lace-1667"><a href="#Lace-1667"><span class="linenos">1667</span></a><span class="sd">              polygon and polyline shapes in two directions using the</span>
</span><span id="Lace-1668"><a href="#Lace-1668"><span class="linenos">1668</span></a><span class="sd">              self.offset value.</span>
</span><span id="Lace-1669"><a href="#Lace-1669"><span class="linenos">1669</span></a>
</span><span id="Lace-1670"><a href="#Lace-1670"><span class="linenos">1670</span></a><span class="sd">        Notes:</span>
</span><span id="Lace-1671"><a href="#Lace-1671"><span class="linenos">1671</span></a><span class="sd">        ------</span>
</span><span id="Lace-1672"><a href="#Lace-1672"><span class="linenos">1672</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="Lace-1673"><a href="#Lace-1673"><span class="linenos">1673</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="Lace-1674"><a href="#Lace-1674"><span class="linenos">1674</span></a><span class="sd">            object cannot be created.</span>
</span><span id="Lace-1675"><a href="#Lace-1675"><span class="linenos">1675</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1676"><a href="#Lace-1676"><span class="linenos">1676</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1677"><a href="#Lace-1677"><span class="linenos">1677</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace-1678"><a href="#Lace-1678"><span class="linenos">1678</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">):</span>
</span><span id="Lace-1679"><a href="#Lace-1679"><span class="linenos">1679</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Lace-1680"><a href="#Lace-1680"><span class="linenos">1680</span></a>                    <span class="n">ParallelPolyline</span><span class="p">(</span>
</span><span id="Lace-1681"><a href="#Lace-1681"><span class="linenos">1681</span></a>                        <span class="n">polyline</span><span class="p">,</span>
</span><span id="Lace-1682"><a href="#Lace-1682"><span class="linenos">1682</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
</span><span id="Lace-1683"><a href="#Lace-1683"><span class="linenos">1683</span></a>                        <span class="n">lace</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Lace-1684"><a href="#Lace-1684"><span class="linenos">1684</span></a>                        <span class="n">closed</span><span class="o">=</span><span class="n">polyline</span><span class="o">.</span><span class="n">closed</span><span class="p">,</span>
</span><span id="Lace-1685"><a href="#Lace-1685"><span class="linenos">1685</span></a>                        <span class="n">dist_tol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="Lace-1686"><a href="#Lace-1686"><span class="linenos">1686</span></a>                    <span class="p">)</span>
</span><span id="Lace-1687"><a href="#Lace-1687"><span class="linenos">1687</span></a>                <span class="p">)</span>
</span><span id="Lace-1688"><a href="#Lace-1688"><span class="linenos">1688</span></a>
</span><span id="Lace-1689"><a href="#Lace-1689"><span class="linenos">1689</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1690"><a href="#Lace-1690"><span class="linenos">1690</span></a>    <span class="k">def</span> <span class="nf">_set_overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1691"><a href="#Lace-1691"><span class="linenos">1691</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1692"><a href="#Lace-1692"><span class="linenos">1692</span></a><span class="sd">        Populate the self.overlaps list with Overlap objects. Side</span>
</span><span id="Lace-1693"><a href="#Lace-1693"><span class="linenos">1693</span></a><span class="sd">        effects listed below.</span>
</span><span id="Lace-1694"><a href="#Lace-1694"><span class="linenos">1694</span></a>
</span><span id="Lace-1695"><a href="#Lace-1695"><span class="linenos">1695</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1696"><a href="#Lace-1696"><span class="linenos">1696</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1697"><a href="#Lace-1697"><span class="linenos">1697</span></a><span class="sd">            None</span>
</span><span id="Lace-1698"><a href="#Lace-1698"><span class="linenos">1698</span></a>
</span><span id="Lace-1699"><a href="#Lace-1699"><span class="linenos">1699</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1700"><a href="#Lace-1700"><span class="linenos">1700</span></a><span class="sd">        --------</span>
</span><span id="Lace-1701"><a href="#Lace-1701"><span class="linenos">1701</span></a><span class="sd">            None</span>
</span><span id="Lace-1702"><a href="#Lace-1702"><span class="linenos">1702</span></a>
</span><span id="Lace-1703"><a href="#Lace-1703"><span class="linenos">1703</span></a><span class="sd">        Side Effects:</span>
</span><span id="Lace-1704"><a href="#Lace-1704"><span class="linenos">1704</span></a><span class="sd">        -------------</span>
</span><span id="Lace-1705"><a href="#Lace-1705"><span class="linenos">1705</span></a><span class="sd">            * self.overlaps is populated with Overlap objects.</span>
</span><span id="Lace-1706"><a href="#Lace-1706"><span class="linenos">1706</span></a><span class="sd">            * Section objects&#39; overlap attribute is populated with the</span>
</span><span id="Lace-1707"><a href="#Lace-1707"><span class="linenos">1707</span></a><span class="sd">              corresponding Overlap object that they are a part of. Not</span>
</span><span id="Lace-1708"><a href="#Lace-1708"><span class="linenos">1708</span></a><span class="sd">              all sections will have an overlap.</span>
</span><span id="Lace-1709"><a href="#Lace-1709"><span class="linenos">1709</span></a>
</span><span id="Lace-1710"><a href="#Lace-1710"><span class="linenos">1710</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1711"><a href="#Lace-1711"><span class="linenos">1711</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1712"><a href="#Lace-1712"><span class="linenos">1712</span></a><span class="sd">            self.polyline and self.parallel_poly_list must be populated.</span>
</span><span id="Lace-1713"><a href="#Lace-1713"><span class="linenos">1713</span></a><span class="sd">            self.main_intersections, self.offset_sections and</span>
</span><span id="Lace-1714"><a href="#Lace-1714"><span class="linenos">1714</span></a><span class="sd">            self.d_intersections must be populated prior to creating</span>
</span><span id="Lace-1715"><a href="#Lace-1715"><span class="linenos">1715</span></a><span class="sd">            the overlaps.</span>
</span><span id="Lace-1716"><a href="#Lace-1716"><span class="linenos">1716</span></a>
</span><span id="Lace-1717"><a href="#Lace-1717"><span class="linenos">1717</span></a><span class="sd">        Notes:</span>
</span><span id="Lace-1718"><a href="#Lace-1718"><span class="linenos">1718</span></a><span class="sd">        ------</span>
</span><span id="Lace-1719"><a href="#Lace-1719"><span class="linenos">1719</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="Lace-1720"><a href="#Lace-1720"><span class="linenos">1720</span></a><span class="sd">            for users to call directly.</span>
</span><span id="Lace-1721"><a href="#Lace-1721"><span class="linenos">1721</span></a><span class="sd">            Without this method, the Lace object cannot be created.</span>
</span><span id="Lace-1722"><a href="#Lace-1722"><span class="linenos">1722</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1723"><a href="#Lace-1723"><span class="linenos">1723</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace-1724"><a href="#Lace-1724"><span class="linenos">1724</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace-1725"><a href="#Lace-1725"><span class="linenos">1725</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1726"><a href="#Lace-1726"><span class="linenos">1726</span></a>                <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1727"><a href="#Lace-1727"><span class="linenos">1727</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span><span id="Lace-1728"><a href="#Lace-1728"><span class="linenos">1728</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="Lace-1729"><a href="#Lace-1729"><span class="linenos">1729</span></a>            <span class="n">cycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1730"><a href="#Lace-1730"><span class="linenos">1730</span></a>            <span class="n">edges</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="Lace-1731"><a href="#Lace-1731"><span class="linenos">1731</span></a>            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
</span><span id="Lace-1732"><a href="#Lace-1732"><span class="linenos">1732</span></a>            <span class="n">s_intersections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Lace-1733"><a href="#Lace-1733"><span class="linenos">1733</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="Lace-1734"><a href="#Lace-1734"><span class="linenos">1734</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="Lace-1735"><a href="#Lace-1735"><span class="linenos">1735</span></a>                <span class="n">s_intersections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="Lace-1736"><a href="#Lace-1736"><span class="linenos">1736</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s_intersections</span><span class="p">]</span>
</span><span id="Lace-1737"><a href="#Lace-1737"><span class="linenos">1737</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">Overlap</span><span class="p">(</span><span class="n">intersections</span><span class="o">=</span><span class="n">intersections</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="n">sections</span><span class="p">)</span>
</span><span id="Lace-1738"><a href="#Lace-1738"><span class="linenos">1738</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
</span><span id="Lace-1739"><a href="#Lace-1739"><span class="linenos">1739</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="Lace-1740"><a href="#Lace-1740"><span class="linenos">1740</span></a>            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span><span id="Lace-1741"><a href="#Lace-1741"><span class="linenos">1741</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;section&quot;</span><span class="p">]</span>
</span><span id="Lace-1742"><a href="#Lace-1742"><span class="linenos">1742</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="Lace-1743"><a href="#Lace-1743"><span class="linenos">1743</span></a>                <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">overlap</span>
</span><span id="Lace-1744"><a href="#Lace-1744"><span class="linenos">1744</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>
</span><span id="Lace-1745"><a href="#Lace-1745"><span class="linenos">1745</span></a>        <span class="k">for</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span><span class="p">:</span>
</span><span id="Lace-1746"><a href="#Lace-1746"><span class="linenos">1746</span></a>            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">overlap</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
</span><span id="Lace-1747"><a href="#Lace-1747"><span class="linenos">1747</span></a>                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_over</span><span class="p">:</span>
</span><span id="Lace-1748"><a href="#Lace-1748"><span class="linenos">1748</span></a>                    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Lace-1749"><a href="#Lace-1749"><span class="linenos">1749</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-1750"><a href="#Lace-1750"><span class="linenos">1750</span></a>                    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Lace-1751"><a href="#Lace-1751"><span class="linenos">1751</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span>
</span><span id="Lace-1752"><a href="#Lace-1752"><span class="linenos">1752</span></a>                    <span class="p">[</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">],</span> <span class="n">line_width</span><span class="o">=</span><span class="n">line_width</span>
</span><span id="Lace-1753"><a href="#Lace-1753"><span class="linenos">1753</span></a>                <span class="p">)</span>
</span><span id="Lace-1754"><a href="#Lace-1754"><span class="linenos">1754</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_divisions</span><span class="p">:</span>
</span><span id="Lace-1755"><a href="#Lace-1755"><span class="linenos">1755</span></a>            <span class="n">p1</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="Lace-1756"><a href="#Lace-1756"><span class="linenos">1756</span></a>            <span class="n">p2</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="Lace-1757"><a href="#Lace-1757"><span class="linenos">1757</span></a>
</span><span id="Lace-1758"><a href="#Lace-1758"><span class="linenos">1758</span></a>    <span class="k">def</span> <span class="nf">set_plaits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1759"><a href="#Lace-1759"><span class="linenos">1759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1760"><a href="#Lace-1760"><span class="linenos">1760</span></a><span class="sd">        Populate the self.plaits list with Plait objects. Plaits are</span>
</span><span id="Lace-1761"><a href="#Lace-1761"><span class="linenos">1761</span></a><span class="sd">        optional for drawing. They form the under/over interlacing. They</span>
</span><span id="Lace-1762"><a href="#Lace-1762"><span class="linenos">1762</span></a><span class="sd">        are created if the &quot;with_plaits&quot; argument is set to be True in</span>
</span><span id="Lace-1763"><a href="#Lace-1763"><span class="linenos">1763</span></a><span class="sd">        the constructor. with_plaits is True by default but this can be</span>
</span><span id="Lace-1764"><a href="#Lace-1764"><span class="linenos">1764</span></a><span class="sd">        changed by setting the auto_plaits value to False in the</span>
</span><span id="Lace-1765"><a href="#Lace-1765"><span class="linenos">1765</span></a><span class="sd">        settings.py This method can be called by the user to create the</span>
</span><span id="Lace-1766"><a href="#Lace-1766"><span class="linenos">1766</span></a><span class="sd">        plaits after the creation of the Lace object if they were not</span>
</span><span id="Lace-1767"><a href="#Lace-1767"><span class="linenos">1767</span></a><span class="sd">        created initally.</span>
</span><span id="Lace-1768"><a href="#Lace-1768"><span class="linenos">1768</span></a>
</span><span id="Lace-1769"><a href="#Lace-1769"><span class="linenos">1769</span></a><span class="sd">        * Can be called by users.</span>
</span><span id="Lace-1770"><a href="#Lace-1770"><span class="linenos">1770</span></a>
</span><span id="Lace-1771"><a href="#Lace-1771"><span class="linenos">1771</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1772"><a href="#Lace-1772"><span class="linenos">1772</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1773"><a href="#Lace-1773"><span class="linenos">1773</span></a><span class="sd">            None</span>
</span><span id="Lace-1774"><a href="#Lace-1774"><span class="linenos">1774</span></a>
</span><span id="Lace-1775"><a href="#Lace-1775"><span class="linenos">1775</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1776"><a href="#Lace-1776"><span class="linenos">1776</span></a><span class="sd">        --------</span>
</span><span id="Lace-1777"><a href="#Lace-1777"><span class="linenos">1777</span></a><span class="sd">            None</span>
</span><span id="Lace-1778"><a href="#Lace-1778"><span class="linenos">1778</span></a>
</span><span id="Lace-1779"><a href="#Lace-1779"><span class="linenos">1779</span></a><span class="sd">        Side Effects:</span>
</span><span id="Lace-1780"><a href="#Lace-1780"><span class="linenos">1780</span></a><span class="sd">        -------------</span>
</span><span id="Lace-1781"><a href="#Lace-1781"><span class="linenos">1781</span></a><span class="sd">            * self.plaits is populated with Plait objects.</span>
</span><span id="Lace-1782"><a href="#Lace-1782"><span class="linenos">1782</span></a>
</span><span id="Lace-1783"><a href="#Lace-1783"><span class="linenos">1783</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1784"><a href="#Lace-1784"><span class="linenos">1784</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1785"><a href="#Lace-1785"><span class="linenos">1785</span></a><span class="sd">            self.polyline and self.parallel_poly_list must be populated.</span>
</span><span id="Lace-1786"><a href="#Lace-1786"><span class="linenos">1786</span></a><span class="sd">            self.divisions and self.intersections must be populated.</span>
</span><span id="Lace-1787"><a href="#Lace-1787"><span class="linenos">1787</span></a><span class="sd">            self.overlaps must be populated.</span>
</span><span id="Lace-1788"><a href="#Lace-1788"><span class="linenos">1788</span></a>
</span><span id="Lace-1789"><a href="#Lace-1789"><span class="linenos">1789</span></a><span class="sd">        Where used:</span>
</span><span id="Lace-1790"><a href="#Lace-1790"><span class="linenos">1790</span></a><span class="sd">        -----------</span>
</span><span id="Lace-1791"><a href="#Lace-1791"><span class="linenos">1791</span></a><span class="sd">            Lace.__init__</span>
</span><span id="Lace-1792"><a href="#Lace-1792"><span class="linenos">1792</span></a>
</span><span id="Lace-1793"><a href="#Lace-1793"><span class="linenos">1793</span></a><span class="sd">        Notes:</span>
</span><span id="Lace-1794"><a href="#Lace-1794"><span class="linenos">1794</span></a><span class="sd">        ------</span>
</span><span id="Lace-1795"><a href="#Lace-1795"><span class="linenos">1795</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="Lace-1796"><a href="#Lace-1796"><span class="linenos">1796</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="Lace-1797"><a href="#Lace-1797"><span class="linenos">1797</span></a><span class="sd">            object cannot be created.</span>
</span><span id="Lace-1798"><a href="#Lace-1798"><span class="linenos">1798</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1799"><a href="#Lace-1799"><span class="linenos">1799</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace-1800"><a href="#Lace-1800"><span class="linenos">1800</span></a>            <span class="k">return</span>
</span><span id="Lace-1801"><a href="#Lace-1801"><span class="linenos">1801</span></a>        <span class="n">plait_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1802"><a href="#Lace-1802"><span class="linenos">1802</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_divisions</span><span class="p">():</span>
</span><span id="Lace-1803"><a href="#Lace-1803"><span class="linenos">1803</span></a>            <span class="n">merged_sections</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">_merged_sections</span><span class="p">()</span>
</span><span id="Lace-1804"><a href="#Lace-1804"><span class="linenos">1804</span></a>            <span class="k">for</span> <span class="n">merged</span> <span class="ow">in</span> <span class="n">merged_sections</span><span class="p">:</span>
</span><span id="Lace-1805"><a href="#Lace-1805"><span class="linenos">1805</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">merged</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Lace-1806"><a href="#Lace-1806"><span class="linenos">1806</span></a>
</span><span id="Lace-1807"><a href="#Lace-1807"><span class="linenos">1807</span></a>        <span class="c1"># connect the open ends of the polyline_shapes</span>
</span><span id="Lace-1808"><a href="#Lace-1808"><span class="linenos">1808</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1809"><a href="#Lace-1809"><span class="linenos">1809</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Lace-1810"><a href="#Lace-1810"><span class="linenos">1810</span></a>                <span class="n">polyline1</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace-1811"><a href="#Lace-1811"><span class="linenos">1811</span></a>                <span class="n">polyline2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace-1812"><a href="#Lace-1812"><span class="linenos">1812</span></a>                <span class="n">p1_start_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace-1813"><a href="#Lace-1813"><span class="linenos">1813</span></a>                <span class="n">p1_end_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace-1814"><a href="#Lace-1814"><span class="linenos">1814</span></a>                <span class="n">p2_start_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace-1815"><a href="#Lace-1815"><span class="linenos">1815</span></a>                <span class="n">p2_end_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace-1816"><a href="#Lace-1816"><span class="linenos">1816</span></a>
</span><span id="Lace-1817"><a href="#Lace-1817"><span class="linenos">1817</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_start_x</span><span class="p">,</span> <span class="n">p2_start_x</span><span class="p">))</span>
</span><span id="Lace-1818"><a href="#Lace-1818"><span class="linenos">1818</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_end_x</span><span class="p">,</span> <span class="n">p2_end_x</span><span class="p">))</span>
</span><span id="Lace-1819"><a href="#Lace-1819"><span class="linenos">1819</span></a>        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace-1820"><a href="#Lace-1820"><span class="linenos">1820</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_over</span> <span class="ow">and</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1821"><a href="#Lace-1821"><span class="linenos">1821</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sec</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">sec</span><span class="o">.</span><span class="n">end</span><span class="p">))</span>
</span><span id="Lace-1822"><a href="#Lace-1822"><span class="linenos">1822</span></a>
</span><span id="Lace-1823"><a href="#Lace-1823"><span class="linenos">1823</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">plait_sections</span><span class="p">]</span>
</span><span id="Lace-1824"><a href="#Lace-1824"><span class="linenos">1824</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="Lace-1825"><a href="#Lace-1825"><span class="linenos">1825</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1826"><a href="#Lace-1826"><span class="linenos">1826</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Lace-1827"><a href="#Lace-1827"><span class="linenos">1827</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="Lace-1828"><a href="#Lace-1828"><span class="linenos">1828</span></a>            <span class="n">cycle</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="Lace-1829"><a href="#Lace-1829"><span class="linenos">1829</span></a>            <span class="n">dup</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Lace-1830"><a href="#Lace-1830"><span class="linenos">1830</span></a>            <span class="n">plait</span> <span class="o">=</span> <span class="p">[</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Lace-1831"><a href="#Lace-1831"><span class="linenos">1831</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Lace-1832"><a href="#Lace-1832"><span class="linenos">1832</span></a>                <span class="n">last</span> <span class="o">=</span> <span class="n">plait</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace-1833"><a href="#Lace-1833"><span class="linenos">1833</span></a>                <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">dup</span><span class="p">:</span>
</span><span id="Lace-1834"><a href="#Lace-1834"><span class="linenos">1834</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="Lace-1835"><a href="#Lace-1835"><span class="linenos">1835</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Lace-1836"><a href="#Lace-1836"><span class="linenos">1836</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="Lace-1837"><a href="#Lace-1837"><span class="linenos">1837</span></a>                        <span class="k">break</span>
</span><span id="Lace-1838"><a href="#Lace-1838"><span class="linenos">1838</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="Lace-1839"><a href="#Lace-1839"><span class="linenos">1839</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-1840"><a href="#Lace-1840"><span class="linenos">1840</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="Lace-1841"><a href="#Lace-1841"><span class="linenos">1841</span></a>                        <span class="k">break</span>
</span><span id="Lace-1842"><a href="#Lace-1842"><span class="linenos">1842</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plait</span><span class="p">)</span>
</span><span id="Lace-1843"><a href="#Lace-1843"><span class="linenos">1843</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Lace-1844"><a href="#Lace-1844"><span class="linenos">1844</span></a>        <span class="n">d_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span>
</span><span id="Lace-1845"><a href="#Lace-1845"><span class="linenos">1845</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace-1846"><a href="#Lace-1846"><span class="linenos">1846</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_x</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plait</span><span class="p">]</span>
</span><span id="Lace-1847"><a href="#Lace-1847"><span class="linenos">1847</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intersections</span><span class="p">]</span>
</span><span id="Lace-1848"><a href="#Lace-1848"><span class="linenos">1848</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
</span><span id="Lace-1849"><a href="#Lace-1849"><span class="linenos">1849</span></a>                <span class="n">vertices</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace-1850"><a href="#Lace-1850"><span class="linenos">1850</span></a>                <span class="n">plait</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace-1851"><a href="#Lace-1851"><span class="linenos">1851</span></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace-1852"><a href="#Lace-1852"><span class="linenos">1852</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="Lace-1853"><a href="#Lace-1853"><span class="linenos">1853</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">gold</span>
</span><span id="Lace-1854"><a href="#Lace-1854"><span class="linenos">1854</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace-1855"><a href="#Lace-1855"><span class="linenos">1855</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="Lace-1856"><a href="#Lace-1856"><span class="linenos">1856</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Lace-1857"><a href="#Lace-1857"><span class="linenos">1857</span></a>
</span><span id="Lace-1858"><a href="#Lace-1858"><span class="linenos">1858</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1859"><a href="#Lace-1859"><span class="linenos">1859</span></a>    <span class="k">def</span> <span class="nf">_set_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1860"><a href="#Lace-1860"><span class="linenos">1860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-1861"><a href="#Lace-1861"><span class="linenos">1861</span></a><span class="sd">        Compute all intersection points (by calling all_intersections)</span>
</span><span id="Lace-1862"><a href="#Lace-1862"><span class="linenos">1862</span></a><span class="sd">        among the divisions of the polylines (both main and offset).</span>
</span><span id="Lace-1863"><a href="#Lace-1863"><span class="linenos">1863</span></a><span class="sd">        Populate the self.main_intersections and</span>
</span><span id="Lace-1864"><a href="#Lace-1864"><span class="linenos">1864</span></a><span class="sd">        self.offset_intersections lists with Intersection objects. This</span>
</span><span id="Lace-1865"><a href="#Lace-1865"><span class="linenos">1865</span></a><span class="sd">        method is called by the Lace constructor and customized to be</span>
</span><span id="Lace-1866"><a href="#Lace-1866"><span class="linenos">1866</span></a><span class="sd">        used with Lace objects only. Without this method, the Lace</span>
</span><span id="Lace-1867"><a href="#Lace-1867"><span class="linenos">1867</span></a><span class="sd">        object cannot be created.</span>
</span><span id="Lace-1868"><a href="#Lace-1868"><span class="linenos">1868</span></a>
</span><span id="Lace-1869"><a href="#Lace-1869"><span class="linenos">1869</span></a><span class="sd">        * Internal use only!</span>
</span><span id="Lace-1870"><a href="#Lace-1870"><span class="linenos">1870</span></a>
</span><span id="Lace-1871"><a href="#Lace-1871"><span class="linenos">1871</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace-1872"><a href="#Lace-1872"><span class="linenos">1872</span></a><span class="sd">        ----------</span>
</span><span id="Lace-1873"><a href="#Lace-1873"><span class="linenos">1873</span></a><span class="sd">            None</span>
</span><span id="Lace-1874"><a href="#Lace-1874"><span class="linenos">1874</span></a>
</span><span id="Lace-1875"><a href="#Lace-1875"><span class="linenos">1875</span></a><span class="sd">        Return:</span>
</span><span id="Lace-1876"><a href="#Lace-1876"><span class="linenos">1876</span></a><span class="sd">        --------</span>
</span><span id="Lace-1877"><a href="#Lace-1877"><span class="linenos">1877</span></a><span class="sd">            None</span>
</span><span id="Lace-1878"><a href="#Lace-1878"><span class="linenos">1878</span></a>
</span><span id="Lace-1879"><a href="#Lace-1879"><span class="linenos">1879</span></a><span class="sd">        Side Effects:</span>
</span><span id="Lace-1880"><a href="#Lace-1880"><span class="linenos">1880</span></a><span class="sd">        -------------</span>
</span><span id="Lace-1881"><a href="#Lace-1881"><span class="linenos">1881</span></a><span class="sd">            * self.main_intersections are populated.</span>
</span><span id="Lace-1882"><a href="#Lace-1882"><span class="linenos">1882</span></a><span class="sd">            * self.offset_intersections are populated.</span>
</span><span id="Lace-1883"><a href="#Lace-1883"><span class="linenos">1883</span></a><span class="sd">            * &quot;sections&quot; attribute of the divisions are populated.</span>
</span><span id="Lace-1884"><a href="#Lace-1884"><span class="linenos">1884</span></a><span class="sd">            * &quot;is_overlap&quot; attribute of the sections are populated.</span>
</span><span id="Lace-1885"><a href="#Lace-1885"><span class="linenos">1885</span></a><span class="sd">            * &quot;intersections&quot; attribute of the divisions are populated.</span>
</span><span id="Lace-1886"><a href="#Lace-1886"><span class="linenos">1886</span></a><span class="sd">            * &quot;endpoint&quot; attribute of the intersections are populated.</span>
</span><span id="Lace-1887"><a href="#Lace-1887"><span class="linenos">1887</span></a>
</span><span id="Lace-1888"><a href="#Lace-1888"><span class="linenos">1888</span></a><span class="sd">        Where used:</span>
</span><span id="Lace-1889"><a href="#Lace-1889"><span class="linenos">1889</span></a><span class="sd">        -----------</span>
</span><span id="Lace-1890"><a href="#Lace-1890"><span class="linenos">1890</span></a><span class="sd">            Lace.__init__</span>
</span><span id="Lace-1891"><a href="#Lace-1891"><span class="linenos">1891</span></a>
</span><span id="Lace-1892"><a href="#Lace-1892"><span class="linenos">1892</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace-1893"><a href="#Lace-1893"><span class="linenos">1893</span></a><span class="sd">        --------------</span>
</span><span id="Lace-1894"><a href="#Lace-1894"><span class="linenos">1894</span></a><span class="sd">            * self.main_divisions must be populated.</span>
</span><span id="Lace-1895"><a href="#Lace-1895"><span class="linenos">1895</span></a><span class="sd">            * self.offset_divisions must be populated.</span>
</span><span id="Lace-1896"><a href="#Lace-1896"><span class="linenos">1896</span></a><span class="sd">            * Two endpoint intersections of the divisions must be set.</span>
</span><span id="Lace-1897"><a href="#Lace-1897"><span class="linenos">1897</span></a>
</span><span id="Lace-1898"><a href="#Lace-1898"><span class="linenos">1898</span></a><span class="sd">        Notes:</span>
</span><span id="Lace-1899"><a href="#Lace-1899"><span class="linenos">1899</span></a><span class="sd">        ------</span>
</span><span id="Lace-1900"><a href="#Lace-1900"><span class="linenos">1900</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="Lace-1901"><a href="#Lace-1901"><span class="linenos">1901</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="Lace-1902"><a href="#Lace-1902"><span class="linenos">1902</span></a><span class="sd">            object cannot be created.</span>
</span><span id="Lace-1903"><a href="#Lace-1903"><span class="linenos">1903</span></a><span class="sd">            Works only for regular under/over interlacing.</span>
</span><span id="Lace-1904"><a href="#Lace-1904"><span class="linenos">1904</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1905"><a href="#Lace-1905"><span class="linenos">1905</span></a>        <span class="c1"># set intersections for the main polylines</span>
</span><span id="Lace-1906"><a href="#Lace-1906"><span class="linenos">1906</span></a>        <span class="n">main_divisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_divisions</span>
</span><span id="Lace-1907"><a href="#Lace-1907"><span class="linenos">1907</span></a>        <span class="n">offset_divisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_divisions</span>
</span><span id="Lace-1908"><a href="#Lace-1908"><span class="linenos">1908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">(</span>
</span><span id="Lace-1909"><a href="#Lace-1909"><span class="linenos">1909</span></a>            <span class="n">main_divisions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span>
</span><span id="Lace-1910"><a href="#Lace-1910"><span class="linenos">1910</span></a>        <span class="p">)</span>
</span><span id="Lace-1911"><a href="#Lace-1911"><span class="linenos">1911</span></a>
</span><span id="Lace-1912"><a href="#Lace-1912"><span class="linenos">1912</span></a>        <span class="c1"># set sections for the main divisions</span>
</span><span id="Lace-1913"><a href="#Lace-1913"><span class="linenos">1913</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1914"><a href="#Lace-1914"><span class="linenos">1914</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">main_divisions</span><span class="p">:</span>
</span><span id="Lace-1915"><a href="#Lace-1915"><span class="linenos">1915</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1916"><a href="#Lace-1916"><span class="linenos">1916</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1917"><a href="#Lace-1917"><span class="linenos">1917</span></a>            <span class="n">segments</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Lace-1918"><a href="#Lace-1918"><span class="linenos">1918</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1919"><a href="#Lace-1919"><span class="linenos">1919</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">segment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">segments</span><span class="p">):</span>
</span><span id="Lace-1920"><a href="#Lace-1920"><span class="linenos">1920</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">)</span>
</span><span id="Lace-1921"><a href="#Lace-1921"><span class="linenos">1921</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Lace-1922"><a href="#Lace-1922"><span class="linenos">1922</span></a>                    <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1923"><a href="#Lace-1923"><span class="linenos">1923</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1924"><a href="#Lace-1924"><span class="linenos">1924</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1925"><a href="#Lace-1925"><span class="linenos">1925</span></a>        <span class="c1"># set intersections for the offset polylines</span>
</span><span id="Lace-1926"><a href="#Lace-1926"><span class="linenos">1926</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">(</span>
</span><span id="Lace-1927"><a href="#Lace-1927"><span class="linenos">1927</span></a>            <span class="n">offset_divisions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span>
</span><span id="Lace-1928"><a href="#Lace-1928"><span class="linenos">1928</span></a>        <span class="p">)</span>
</span><span id="Lace-1929"><a href="#Lace-1929"><span class="linenos">1929</span></a>        <span class="c1"># set sections for the offset divisions</span>
</span><span id="Lace-1930"><a href="#Lace-1930"><span class="linenos">1930</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1931"><a href="#Lace-1931"><span class="linenos">1931</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">offset_divisions</span><span class="p">):</span>
</span><span id="Lace-1932"><a href="#Lace-1932"><span class="linenos">1932</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1933"><a href="#Lace-1933"><span class="linenos">1933</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1934"><a href="#Lace-1934"><span class="linenos">1934</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Lace-1935"><a href="#Lace-1935"><span class="linenos">1935</span></a>            <span class="n">division</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1936"><a href="#Lace-1936"><span class="linenos">1936</span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
</span><span id="Lace-1937"><a href="#Lace-1937"><span class="linenos">1937</span></a>                <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
</span><span id="Lace-1938"><a href="#Lace-1938"><span class="linenos">1938</span></a>                <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Lace-1939"><a href="#Lace-1939"><span class="linenos">1939</span></a>                    <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1940"><a href="#Lace-1940"><span class="linenos">1940</span></a>                <span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1941"><a href="#Lace-1941"><span class="linenos">1941</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">offset_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
</span><span id="Lace-1942"><a href="#Lace-1942"><span class="linenos">1942</span></a>
</span><span id="Lace-1943"><a href="#Lace-1943"><span class="linenos">1943</span></a>    <span class="k">def</span> <span class="nf">_all_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polylines</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Lace-1944"><a href="#Lace-1944"><span class="linenos">1944</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of polygons from a list of lists of points.</span>
</span><span id="Lace-1945"><a href="#Lace-1945"><span class="linenos">1945</span></a><span class="sd">        polylines: [[(x1, y1), (x2, y2)], [(x3, y3), (x4, y4)], ...]</span>
</span><span id="Lace-1946"><a href="#Lace-1946"><span class="linenos">1946</span></a><span class="sd">        return [[(x1, y1), (x2, y2), (x3, y3), ...], ...]</span>
</span><span id="Lace-1947"><a href="#Lace-1947"><span class="linenos">1947</span></a>
</span><span id="Lace-1948"><a href="#Lace-1948"><span class="linenos">1948</span></a><span class="sd">        Args:</span>
</span><span id="Lace-1949"><a href="#Lace-1949"><span class="linenos">1949</span></a><span class="sd">            polylines (list): List of lists of points.</span>
</span><span id="Lace-1950"><a href="#Lace-1950"><span class="linenos">1950</span></a><span class="sd">            rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="Lace-1951"><a href="#Lace-1951"><span class="linenos">1951</span></a>
</span><span id="Lace-1952"><a href="#Lace-1952"><span class="linenos">1952</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-1953"><a href="#Lace-1953"><span class="linenos">1953</span></a><span class="sd">            list: List of polygons.</span>
</span><span id="Lace-1954"><a href="#Lace-1954"><span class="linenos">1954</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-1955"><a href="#Lace-1955"><span class="linenos">1955</span></a>        <span class="k">if</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace-1956"><a href="#Lace-1956"><span class="linenos">1956</span></a>            <span class="n">rtol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span>
</span><span id="Lace-1957"><a href="#Lace-1957"><span class="linenos">1957</span></a>        <span class="k">return</span> <span class="n">get_polygons</span><span class="p">(</span><span class="n">polylines</span><span class="p">,</span> <span class="n">rtol</span><span class="p">)</span>
</span><span id="Lace-1958"><a href="#Lace-1958"><span class="linenos">1958</span></a>
</span><span id="Lace-1959"><a href="#Lace-1959"><span class="linenos">1959</span></a>    <span class="c1"># @timing</span>
</span><span id="Lace-1960"><a href="#Lace-1960"><span class="linenos">1960</span></a>    <span class="k">def</span> <span class="nf">_set_over_under</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace-1961"><a href="#Lace-1961"><span class="linenos">1961</span></a>        <span class="k">def</span> <span class="nf">next_poly</span><span class="p">(</span><span class="n">exclude</span><span class="p">):</span>
</span><span id="Lace-1962"><a href="#Lace-1962"><span class="linenos">1962</span></a>            <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1963"><a href="#Lace-1963"><span class="linenos">1963</span></a>                <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="Lace-1964"><a href="#Lace-1964"><span class="linenos">1964</span></a>                <span class="k">if</span> <span class="n">poly1</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">:</span>
</span><span id="Lace-1965"><a href="#Lace-1965"><span class="linenos">1965</span></a>                    <span class="k">continue</span>
</span><span id="Lace-1966"><a href="#Lace-1966"><span class="linenos">1966</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Lace-1967"><a href="#Lace-1967"><span class="linenos">1967</span></a>                <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">poly1</span><span class="o">.</span><span class="n">iter_sections</span><span class="p">():</span>
</span><span id="Lace-1968"><a href="#Lace-1968"><span class="linenos">1968</span></a>                    <span class="k">if</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1969"><a href="#Lace-1969"><span class="linenos">1969</span></a>                        <span class="k">if</span> <span class="n">sec</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span> <span class="ow">and</span> <span class="n">sec</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">visited</span><span class="p">:</span>
</span><span id="Lace-1970"><a href="#Lace-1970"><span class="linenos">1970</span></a>                            <span class="n">even_odd</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="Lace-1971"><a href="#Lace-1971"><span class="linenos">1971</span></a>                            <span class="k">return</span> <span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">,</span> <span class="n">even_odd</span><span class="p">)</span>
</span><span id="Lace-1972"><a href="#Lace-1972"><span class="linenos">1972</span></a>                        <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Lace-1973"><a href="#Lace-1973"><span class="linenos">1973</span></a>            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Lace-1974"><a href="#Lace-1974"><span class="linenos">1974</span></a>
</span><span id="Lace-1975"><a href="#Lace-1975"><span class="linenos">1975</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace-1976"><a href="#Lace-1976"><span class="linenos">1976</span></a>            <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span>
</span><span id="Lace-1977"><a href="#Lace-1977"><span class="linenos">1977</span></a>            <span class="n">exclude</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-1978"><a href="#Lace-1978"><span class="linenos">1978</span></a>            <span class="n">even_odd</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Lace-1979"><a href="#Lace-1979"><span class="linenos">1979</span></a>            <span class="k">while</span> <span class="n">poly1</span><span class="p">:</span>
</span><span id="Lace-1980"><a href="#Lace-1980"><span class="linenos">1980</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Lace-1981"><a href="#Lace-1981"><span class="linenos">1981</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">divisions</span><span class="p">):</span>
</span><span id="Lace-1982"><a href="#Lace-1982"><span class="linenos">1982</span></a>                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">section</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">sections</span><span class="p">):</span>
</span><span id="Lace-1983"><a href="#Lace-1983"><span class="linenos">1983</span></a>                        <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace-1984"><a href="#Lace-1984"><span class="linenos">1984</span></a>                            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">overlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace-1985"><a href="#Lace-1985"><span class="linenos">1985</span></a>                                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Lace-1986"><a href="#Lace-1986"><span class="linenos">1986</span></a>                                    <span class="s2">&quot;Overlap section in the lace has no &quot;</span>
</span><span id="Lace-1987"><a href="#Lace-1987"><span class="linenos">1987</span></a>                                    <span class="s2">&quot;overlap object.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Lace-1988"><a href="#Lace-1988"><span class="linenos">1988</span></a>                                    <span class="s2">&quot;Try different offset value and/or &quot;</span>
</span><span id="Lace-1989"><a href="#Lace-1989"><span class="linenos">1989</span></a>                                    <span class="s2">&quot;tolerance.&quot;</span>
</span><span id="Lace-1990"><a href="#Lace-1990"><span class="linenos">1990</span></a>                                <span class="p">)</span>
</span><span id="Lace-1991"><a href="#Lace-1991"><span class="linenos">1991</span></a>                                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace-1992"><a href="#Lace-1992"><span class="linenos">1992</span></a>                            <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1993"><a href="#Lace-1993"><span class="linenos">1993</span></a>                            <span class="k">if</span> <span class="n">ind</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">even_odd</span><span class="p">:</span>
</span><span id="Lace-1994"><a href="#Lace-1994"><span class="linenos">1994</span></a>                                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span><span class="p">:</span>
</span><span id="Lace-1995"><a href="#Lace-1995"><span class="linenos">1995</span></a>                                    <span class="n">section</span><span class="o">.</span><span class="n">overlap</span><span class="o">.</span><span class="n">drawable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Lace-1996"><a href="#Lace-1996"><span class="linenos">1996</span></a>                                    <span class="n">section</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1997"><a href="#Lace-1997"><span class="linenos">1997</span></a>                                    <span class="n">section2</span> <span class="o">=</span> <span class="n">poly2</span><span class="o">.</span><span class="n">divisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Lace-1998"><a href="#Lace-1998"><span class="linenos">1998</span></a>                                    <span class="n">section2</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace-1999"><a href="#Lace-1999"><span class="linenos">1999</span></a>                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Lace-2000"><a href="#Lace-2000"><span class="linenos">2000</span></a>                <span class="n">exclude</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">])</span>
</span><span id="Lace-2001"><a href="#Lace-2001"><span class="linenos">2001</span></a>                <span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">,</span> <span class="n">even_odd</span> <span class="o">=</span> <span class="n">next_poly</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
</span><span id="Lace-2002"><a href="#Lace-2002"><span class="linenos">2002</span></a>
</span><span id="Lace-2003"><a href="#Lace-2003"><span class="linenos">2003</span></a>    <span class="k">def</span> <span class="nf">fragment_edge_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="Lace-2004"><a href="#Lace-2004"><span class="linenos">2004</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-2005"><a href="#Lace-2005"><span class="linenos">2005</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="Lace-2006"><a href="#Lace-2006"><span class="linenos">2006</span></a><span class="sd">        If two fragments have a &quot;common&quot; division then they are connected.</span>
</span><span id="Lace-2007"><a href="#Lace-2007"><span class="linenos">2007</span></a>
</span><span id="Lace-2008"><a href="#Lace-2008"><span class="linenos">2008</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-2009"><a href="#Lace-2009"><span class="linenos">2009</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="Lace-2010"><a href="#Lace-2010"><span class="linenos">2010</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-2011"><a href="#Lace-2011"><span class="linenos">2011</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace-2012"><a href="#Lace-2012"><span class="linenos">2012</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">]</span>
</span><span id="Lace-2013"><a href="#Lace-2013"><span class="linenos">2013</span></a>        <span class="n">fragments</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace-2014"><a href="#Lace-2014"><span class="linenos">2014</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
</span><span id="Lace-2015"><a href="#Lace-2015"><span class="linenos">2015</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace-2016"><a href="#Lace-2016"><span class="linenos">2016</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="ow">and</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span><span class="p">:</span>
</span><span id="Lace-2017"><a href="#Lace-2017"><span class="linenos">2017</span></a>                    <span class="n">fragment2</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="Lace-2018"><a href="#Lace-2018"><span class="linenos">2018</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace-2019"><a href="#Lace-2019"><span class="linenos">2019</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment2</span><span class="p">)</span>
</span><span id="Lace-2020"><a href="#Lace-2020"><span class="linenos">2020</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">division</span><span class="p">)</span>
</span><span id="Lace-2021"><a href="#Lace-2021"><span class="linenos">2021</span></a>        <span class="k">return</span> <span class="n">G</span>
</span><span id="Lace-2022"><a href="#Lace-2022"><span class="linenos">2022</span></a>
</span><span id="Lace-2023"><a href="#Lace-2023"><span class="linenos">2023</span></a>    <span class="k">def</span> <span class="nf">fragment_vertex_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="Lace-2024"><a href="#Lace-2024"><span class="linenos">2024</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace-2025"><a href="#Lace-2025"><span class="linenos">2025</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="Lace-2026"><a href="#Lace-2026"><span class="linenos">2026</span></a><span class="sd">        If two fragments have a &quot;common&quot; vertex then they are connected.</span>
</span><span id="Lace-2027"><a href="#Lace-2027"><span class="linenos">2027</span></a>
</span><span id="Lace-2028"><a href="#Lace-2028"><span class="linenos">2028</span></a><span class="sd">        Returns:</span>
</span><span id="Lace-2029"><a href="#Lace-2029"><span class="linenos">2029</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="Lace-2030"><a href="#Lace-2030"><span class="linenos">2030</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace-2031"><a href="#Lace-2031"><span class="linenos">2031</span></a>        <span class="k">def</span> <span class="nf">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">):</span>
</span><span id="Lace-2032"><a href="#Lace-2032"><span class="linenos">2032</span></a>            <span class="n">division</span> <span class="o">=</span> <span class="n">intersection</span><span class="o">.</span><span class="n">division</span>
</span><span id="Lace-2033"><a href="#Lace-2033"><span class="linenos">2033</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace-2034"><a href="#Lace-2034"><span class="linenos">2034</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Lace-2035"><a href="#Lace-2035"><span class="linenos">2035</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace-2036"><a href="#Lace-2036"><span class="linenos">2036</span></a>            <span class="n">start_division_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace-2037"><a href="#Lace-2037"><span class="linenos">2037</span></a>            <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace-2038"><a href="#Lace-2038"><span class="linenos">2038</span></a>                <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace-2039"><a href="#Lace-2039"><span class="linenos">2039</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-2040"><a href="#Lace-2040"><span class="linenos">2040</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Lace-2041"><a href="#Lace-2041"><span class="linenos">2041</span></a>            <span class="k">while</span> <span class="n">twin_id</span> <span class="o">!=</span> <span class="n">start_division_id</span><span class="p">:</span>
</span><span id="Lace-2042"><a href="#Lace-2042"><span class="linenos">2042</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace-2043"><a href="#Lace-2043"><span class="linenos">2043</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="Lace-2044"><a href="#Lace-2044"><span class="linenos">2044</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace-2045"><a href="#Lace-2045"><span class="linenos">2045</span></a>                    <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace-2046"><a href="#Lace-2046"><span class="linenos">2046</span></a>                    <span class="n">division</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span>
</span><span id="Lace-2047"><a href="#Lace-2047"><span class="linenos">2047</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace-2048"><a href="#Lace-2048"><span class="linenos">2048</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="Lace-2049"><a href="#Lace-2049"><span class="linenos">2049</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace-2050"><a href="#Lace-2050"><span class="linenos">2050</span></a>                    <span class="k">break</span>
</span><span id="Lace-2051"><a href="#Lace-2051"><span class="linenos">2051</span></a>
</span><span id="Lace-2052"><a href="#Lace-2052"><span class="linenos">2052</span></a>            <span class="k">return</span> <span class="n">fragments</span>
</span><span id="Lace-2053"><a href="#Lace-2053"><span class="linenos">2053</span></a>
</span><span id="Lace-2054"><a href="#Lace-2054"><span class="linenos">2054</span></a>        <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace-2055"><a href="#Lace-2055"><span class="linenos">2055</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace-2056"><a href="#Lace-2056"><span class="linenos">2056</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="Lace-2057"><a href="#Lace-2057"><span class="linenos">2057</span></a>                <span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span>
</span><span id="Lace-2058"><a href="#Lace-2058"><span class="linenos">2058</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_edge_graph</span><span class="p">()</span>
</span><span id="Lace-2059"><a href="#Lace-2059"><span class="linenos">2059</span></a>        <span class="n">G2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace-2060"><a href="#Lace-2060"><span class="linenos">2060</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
</span><span id="Lace-2061"><a href="#Lace-2061"><span class="linenos">2061</span></a>            <span class="k">if</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Lace-2062"><a href="#Lace-2062"><span class="linenos">2062</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Lace-2063"><a href="#Lace-2063"><span class="linenos">2063</span></a>                    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Lace-2064"><a href="#Lace-2064"><span class="linenos">2064</span></a>                        <span class="n">ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">])</span>
</span><span id="Lace-2065"><a href="#Lace-2065"><span class="linenos">2065</span></a>                        <span class="k">if</span> <span class="n">ids</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="Lace-2066"><a href="#Lace-2066"><span class="linenos">2066</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace-2067"><a href="#Lace-2067"><span class="linenos">2067</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Lace-2068"><a href="#Lace-2068"><span class="linenos">2068</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">ids</span><span class="p">)</span>
</span><span id="Lace-2069"><a href="#Lace-2069"><span class="linenos">2069</span></a>        <span class="k">return</span> <span class="n">G2</span>
</span></pre></div>


            <div class="docstring"><p>A Lace is a collection of ParallelPolylines objects.
They are used to create interlace patterns.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>polygon_shapes (Union[Batch, list[Shape]], optional):</strong>  List of polygon shapes. Defaults to None.</li>
<li><strong>polyline_shapes (Union[Batch, list[Shape]], optional):</strong>  List of polyline shapes. Defaults to None.</li>
<li><strong>offset (float, optional):</strong>  Offset value. Defaults to 2.</li>
<li><strong>rtol (float, optional):</strong>  Relative tolerance. Defaults to None.</li>
<li><strong>swatch (list, optional):</strong>  Swatch list. Defaults to None.</li>
<li><strong>breakpoints (list, optional):</strong>  Breakpoints list. Defaults to None.</li>
<li><strong>plait_color (colors.Color, optional):</strong>  Plait color. Defaults to None.</li>
<li><strong>draw_fragments (bool, optional):</strong>  If fragments should be drawn. Defaults to True.</li>
<li><strong>palette (list, optional):</strong>  Palette list. Defaults to None.</li>
<li><strong>color_step (int, optional):</strong>  Color step. Defaults to 1.</li>
<li><strong>with_plaits (bool, optional):</strong>  If plaits should be included. Defaults to True.</li>
<li><strong>area_threshold (float, optional):</strong>  Area threshold. Defaults to None.</li>
<li><strong>radius_threshold (float, optional):</strong>  Radius threshold. Defaults to None.</li>
<li><strong>**kwargs:</strong>  Additional attributes for cosmetic/drawing purposes.</li>
</ul>
</div>


                            <div id="Lace.__init__" class="classattr">
                                        <input id="Lace.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Lace</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polygon_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">polyline_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../graphics/shape.html#Shape">simetri.graphics.shape.Shape</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">swatch</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">breakpoints</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">plait_color</span><span class="p">:</span> <span class="n"><a href="../colors/colors.html#Color">simetri.colors.colors.Color</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">draw_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">palette</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">color_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">with_plaits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">area_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">radius_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Lace.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.__init__-966"><a href="#Lace.__init__-966"><span class="linenos"> 966</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Lace.__init__-967"><a href="#Lace.__init__-967"><span class="linenos"> 967</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Lace.__init__-968"><a href="#Lace.__init__-968"><span class="linenos"> 968</span></a>        <span class="n">polygon_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-969"><a href="#Lace.__init__-969"><span class="linenos"> 969</span></a>        <span class="n">polyline_shapes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shape</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-970"><a href="#Lace.__init__-970"><span class="linenos"> 970</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Lace.__init__-971"><a href="#Lace.__init__-971"><span class="linenos"> 971</span></a>        <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-972"><a href="#Lace.__init__-972"><span class="linenos"> 972</span></a>        <span class="n">swatch</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-973"><a href="#Lace.__init__-973"><span class="linenos"> 973</span></a>        <span class="n">breakpoints</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-974"><a href="#Lace.__init__-974"><span class="linenos"> 974</span></a>        <span class="n">plait_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-975"><a href="#Lace.__init__-975"><span class="linenos"> 975</span></a>        <span class="n">draw_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Lace.__init__-976"><a href="#Lace.__init__-976"><span class="linenos"> 976</span></a>        <span class="n">palette</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-977"><a href="#Lace.__init__-977"><span class="linenos"> 977</span></a>        <span class="n">color_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Lace.__init__-978"><a href="#Lace.__init__-978"><span class="linenos"> 978</span></a>        <span class="n">with_plaits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Lace.__init__-979"><a href="#Lace.__init__-979"><span class="linenos"> 979</span></a>        <span class="n">area_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-980"><a href="#Lace.__init__-980"><span class="linenos"> 980</span></a>        <span class="n">radius_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Lace.__init__-981"><a href="#Lace.__init__-981"><span class="linenos"> 981</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Lace.__init__-982"><a href="#Lace.__init__-982"><span class="linenos"> 982</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace.__init__-983"><a href="#Lace.__init__-983"><span class="linenos"> 983</span></a>        <span class="n">validate_args</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">shape_style_map</span><span class="p">)</span>
</span><span id="Lace.__init__-984"><a href="#Lace.__init__-984"><span class="linenos"> 984</span></a>        <span class="p">(</span>
</span><span id="Lace.__init__-985"><a href="#Lace.__init__-985"><span class="linenos"> 985</span></a>            <span class="n">rtol</span><span class="p">,</span>
</span><span id="Lace.__init__-986"><a href="#Lace.__init__-986"><span class="linenos"> 986</span></a>            <span class="n">swatch</span><span class="p">,</span>
</span><span id="Lace.__init__-987"><a href="#Lace.__init__-987"><span class="linenos"> 987</span></a>            <span class="n">plait_color</span><span class="p">,</span>
</span><span id="Lace.__init__-988"><a href="#Lace.__init__-988"><span class="linenos"> 988</span></a>            <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="Lace.__init__-989"><a href="#Lace.__init__-989"><span class="linenos"> 989</span></a>            <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="Lace.__init__-990"><a href="#Lace.__init__-990"><span class="linenos"> 990</span></a>            <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="Lace.__init__-991"><a href="#Lace.__init__-991"><span class="linenos"> 991</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="Lace.__init__-992"><a href="#Lace.__init__-992"><span class="linenos"> 992</span></a>            <span class="p">[</span>
</span><span id="Lace.__init__-993"><a href="#Lace.__init__-993"><span class="linenos"> 993</span></a>                <span class="s2">&quot;rtol&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-994"><a href="#Lace.__init__-994"><span class="linenos"> 994</span></a>                <span class="s2">&quot;swatch&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-995"><a href="#Lace.__init__-995"><span class="linenos"> 995</span></a>                <span class="s2">&quot;plait_color&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-996"><a href="#Lace.__init__-996"><span class="linenos"> 996</span></a>                <span class="s2">&quot;draw_fragments&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-997"><a href="#Lace.__init__-997"><span class="linenos"> 997</span></a>                <span class="s2">&quot;area_threshold&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-998"><a href="#Lace.__init__-998"><span class="linenos"> 998</span></a>                <span class="s2">&quot;radius_threshold&quot;</span><span class="p">,</span>
</span><span id="Lace.__init__-999"><a href="#Lace.__init__-999"><span class="linenos"> 999</span></a>            <span class="p">],</span>
</span><span id="Lace.__init__-1000"><a href="#Lace.__init__-1000"><span class="linenos">1000</span></a>            <span class="p">[</span>
</span><span id="Lace.__init__-1001"><a href="#Lace.__init__-1001"><span class="linenos">1001</span></a>                <span class="n">rtol</span><span class="p">,</span>
</span><span id="Lace.__init__-1002"><a href="#Lace.__init__-1002"><span class="linenos">1002</span></a>                <span class="n">swatch</span><span class="p">,</span>
</span><span id="Lace.__init__-1003"><a href="#Lace.__init__-1003"><span class="linenos">1003</span></a>                <span class="n">plait_color</span><span class="p">,</span>
</span><span id="Lace.__init__-1004"><a href="#Lace.__init__-1004"><span class="linenos">1004</span></a>                <span class="n">draw_fragments</span><span class="p">,</span>
</span><span id="Lace.__init__-1005"><a href="#Lace.__init__-1005"><span class="linenos">1005</span></a>                <span class="n">area_threshold</span><span class="p">,</span>
</span><span id="Lace.__init__-1006"><a href="#Lace.__init__-1006"><span class="linenos">1006</span></a>                <span class="n">radius_threshold</span><span class="p">,</span>
</span><span id="Lace.__init__-1007"><a href="#Lace.__init__-1007"><span class="linenos">1007</span></a>            <span class="p">],</span>
</span><span id="Lace.__init__-1008"><a href="#Lace.__init__-1008"><span class="linenos">1008</span></a>        <span class="p">)</span>
</span><span id="Lace.__init__-1009"><a href="#Lace.__init__-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="n">polygon_shapes</span><span class="p">:</span>
</span><span id="Lace.__init__-1010"><a href="#Lace.__init__-1010"><span class="linenos">1010</span></a>            <span class="n">polygon_shapes</span> <span class="o">=</span> <span class="n">polygon_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="Lace.__init__-1011"><a href="#Lace.__init__-1011"><span class="linenos">1011</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polygons</span><span class="p">(</span><span class="n">polygon_shapes</span><span class="p">)</span>
</span><span id="Lace.__init__-1012"><a href="#Lace.__init__-1012"><span class="linenos">1012</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.__init__-1013"><a href="#Lace.__init__-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.__init__-1014"><a href="#Lace.__init__-1014"><span class="linenos">1014</span></a>        <span class="k">if</span> <span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace.__init__-1015"><a href="#Lace.__init__-1015"><span class="linenos">1015</span></a>            <span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span><span class="o">.</span><span class="n">merge_shapes</span><span class="p">()</span>
</span><span id="Lace.__init__-1016"><a href="#Lace.__init__-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_polylines</span><span class="p">(</span><span class="n">polyline_shapes</span><span class="p">)</span>
</span><span id="Lace.__init__-1017"><a href="#Lace.__init__-1017"><span class="linenos">1017</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.__init__-1018"><a href="#Lace.__init__-1018"><span class="linenos">1018</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.__init__-1019"><a href="#Lace.__init__-1019"><span class="linenos">1019</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_shapes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace.__init__-1020"><a href="#Lace.__init__-1020"><span class="linenos">1020</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Lace.__init__ : No polygons or polylines found.&quot;</span>
</span><span id="Lace.__init__-1021"><a href="#Lace.__init__-1021"><span class="linenos">1021</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Lace.__init__-1022"><a href="#Lace.__init__-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span> <span class="o">=</span> <span class="n">polyline_shapes</span>
</span><span id="Lace.__init__-1023"><a href="#Lace.__init__-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="Lace.__init__-1024"><a href="#Lace.__init__-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace.__init__-1025"><a href="#Lace.__init__-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset_intersections</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace.__init__-1026"><a href="#Lace.__init__-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Lace.__init__-1027"><a href="#Lace.__init__-1027"><span class="linenos">1027</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span> <span class="o">=</span> <span class="n">rtol</span>
</span><span id="Lace.__init__-1028"><a href="#Lace.__init__-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swatch</span> <span class="o">=</span> <span class="n">swatch</span>
</span><span id="Lace.__init__-1029"><a href="#Lace.__init__-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span> <span class="o">=</span> <span class="n">breakpoints</span>
</span><span id="Lace.__init__-1030"><a href="#Lace.__init__-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plait_color</span> <span class="o">=</span> <span class="n">plait_color</span>
</span><span id="Lace.__init__-1031"><a href="#Lace.__init__-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="n">draw_fragments</span>
</span><span id="Lace.__init__-1032"><a href="#Lace.__init__-1032"><span class="linenos">1032</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span>
</span><span id="Lace.__init__-1033"><a href="#Lace.__init__-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">color_step</span> <span class="o">=</span> <span class="n">color_step</span>
</span><span id="Lace.__init__-1034"><a href="#Lace.__init__-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span> <span class="o">=</span> <span class="n">with_plaits</span>
</span><span id="Lace.__init__-1035"><a href="#Lace.__init__-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># key, value:intersection.id, intersection</span>
</span><span id="Lace.__init__-1036"><a href="#Lace.__init__-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_connections</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Lace.__init__-1037"><a href="#Lace.__init__-1037"><span class="linenos">1037</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.__init__-1038"><a href="#Lace.__init__-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.__init__-1039"><a href="#Lace.__init__-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace.__init__-1040"><a href="#Lace.__init__-1040"><span class="linenos">1040</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span> <span class="o">=</span> <span class="n">area_threshold</span>
</span><span id="Lace.__init__-1041"><a href="#Lace.__init__-1041"><span class="linenos">1041</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span> <span class="o">=</span> <span class="n">radius_threshold</span>
</span><span id="Lace.__init__-1042"><a href="#Lace.__init__-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace.__init__-1043"><a href="#Lace.__init__-1043"><span class="linenos">1043</span></a>            <span class="c1"># pass the pre-computed values</span>
</span><span id="Lace.__init__-1044"><a href="#Lace.__init__-1044"><span class="linenos">1044</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace.__init__-1045"><a href="#Lace.__init__-1045"><span class="linenos">1045</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;_copy&quot;</span><span class="p">:</span>
</span><span id="Lace.__init__-1046"><a href="#Lace.__init__-1046"><span class="linenos">1046</span></a>                    <span class="k">continue</span>
</span><span id="Lace.__init__-1047"><a href="#Lace.__init__-1047"><span class="linenos">1047</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.__init__-1048"><a href="#Lace.__init__-1048"><span class="linenos">1048</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Lace.__init__-1049"><a href="#Lace.__init__-1049"><span class="linenos">1049</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.__init__-1050"><a href="#Lace.__init__-1050"><span class="linenos">1050</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_polyline_list</span><span class="p">()</span>  <span class="c1"># main divisions are set here along with polylines</span>
</span><span id="Lace.__init__-1051"><a href="#Lace.__init__-1051"><span class="linenos">1051</span></a>            <span class="c1"># polyline.divisions is the list of Division objects</span>
</span><span id="Lace.__init__-1052"><a href="#Lace.__init__-1052"><span class="linenos">1052</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_parallel_poly_list</span><span class="p">()</span>
</span><span id="Lace.__init__-1053"><a href="#Lace.__init__-1053"><span class="linenos">1053</span></a>            <span class="c1"># start_time2 = time.perf_counter()</span>
</span><span id="Lace.__init__-1054"><a href="#Lace.__init__-1054"><span class="linenos">1054</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_intersections</span><span class="p">()</span>
</span><span id="Lace.__init__-1055"><a href="#Lace.__init__-1055"><span class="linenos">1055</span></a>            <span class="c1"># end_time2 = time.perf_counter()</span>
</span><span id="Lace.__init__-1056"><a href="#Lace.__init__-1056"><span class="linenos">1056</span></a>            <span class="c1"># print(</span>
</span><span id="Lace.__init__-1057"><a href="#Lace.__init__-1057"><span class="linenos">1057</span></a>            <span class="c1">#     f&quot;Lace.__init__ intersections computed in {end_time2 - start_time2:0.4f} seconds&quot;</span>
</span><span id="Lace.__init__-1058"><a href="#Lace.__init__-1058"><span class="linenos">1058</span></a>            <span class="c1"># )</span>
</span><span id="Lace.__init__-1059"><a href="#Lace.__init__-1059"><span class="linenos">1059</span></a>
</span><span id="Lace.__init__-1060"><a href="#Lace.__init__-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_overlaps</span><span class="p">()</span>
</span><span id="Lace.__init__-1061"><a href="#Lace.__init__-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_twin_sections</span><span class="p">()</span>
</span><span id="Lace.__init__-1062"><a href="#Lace.__init__-1062"><span class="linenos">1062</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_fragments</span><span class="p">()</span>
</span><span id="Lace.__init__-1063"><a href="#Lace.__init__-1063"><span class="linenos">1063</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_shapes</span><span class="p">:</span>
</span><span id="Lace.__init__-1064"><a href="#Lace.__init__-1064"><span class="linenos">1064</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_set_outline</span><span class="p">()</span>
</span><span id="Lace.__init__-1065"><a href="#Lace.__init__-1065"><span class="linenos">1065</span></a>            <span class="c1"># self._set_partitions()</span>
</span><span id="Lace.__init__-1066"><a href="#Lace.__init__-1066"><span class="linenos">1066</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_over_under</span><span class="p">()</span>
</span><span id="Lace.__init__-1067"><a href="#Lace.__init__-1067"><span class="linenos">1067</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_plaits</span><span class="p">:</span>
</span><span id="Lace.__init__-1068"><a href="#Lace.__init__-1068"><span class="linenos">1068</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_plaits</span><span class="p">()</span>
</span><span id="Lace.__init__-1069"><a href="#Lace.__init__-1069"><span class="linenos">1069</span></a>            <span class="c1"># self._set_convex_hull()</span>
</span><span id="Lace.__init__-1070"><a href="#Lace.__init__-1070"><span class="linenos">1070</span></a>            <span class="c1"># self._set_concave_hull()</span>
</span><span id="Lace.__init__-1071"><a href="#Lace.__init__-1071"><span class="linenos">1071</span></a>            <span class="c1"># self._set_fragment_groups()</span>
</span><span id="Lace.__init__-1072"><a href="#Lace.__init__-1072"><span class="linenos">1072</span></a>            <span class="c1"># self._set_partition_groups()</span>
</span><span id="Lace.__init__-1073"><a href="#Lace.__init__-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_b_box</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace.__init__-1074"><a href="#Lace.__init__-1074"><span class="linenos">1074</span></a>        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">polyline</span> <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="Lace.__init__-1075"><a href="#Lace.__init__-1075"><span class="linenos">1075</span></a>
</span><span id="Lace.__init__-1076"><a href="#Lace.__init__-1076"><span class="linenos">1076</span></a>        <span class="k">if</span> <span class="s2">&quot;debug&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace.__init__-1077"><a href="#Lace.__init__-1077"><span class="linenos">1077</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span>
</span><span id="Lace.__init__-1078"><a href="#Lace.__init__-1078"><span class="linenos">1078</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Lace.__init__-1079"><a href="#Lace.__init__-1079"><span class="linenos">1079</span></a>        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;_copy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="Lace.__init__-1080"><a href="#Lace.__init__-1080"><span class="linenos">1080</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Lace.__init__-1081"><a href="#Lace.__init__-1081"><span class="linenos">1081</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
</span><span id="Lace.__init__-1082"><a href="#Lace.__init__-1082"><span class="linenos">1082</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># todo: we should check for valid values here</span>
</span><span id="Lace.__init__-1083"><a href="#Lace.__init__-1083"><span class="linenos">1083</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.__init__-1084"><a href="#Lace.__init__-1084"><span class="linenos">1084</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">. Invalid attribute!&quot;</span><span class="p">)</span>
</span><span id="Lace.__init__-1085"><a href="#Lace.__init__-1085"><span class="linenos">1085</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">LACE</span>
</span><span id="Lace.__init__-1086"><a href="#Lace.__init__-1086"><span class="linenos">1086</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Batch object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>elements (Sequence[Any], optional):</strong>  The elements to include in the batch.</li>
<li><strong>modifiers (Sequence[Modifier], optional):</strong>  The modifiers to apply to the batch.</li>
<li><strong>subtype (Types, optional):</strong>  The subtype of the batch.</li>
<li><strong>kwargs (dict):</strong>  Additional keyword arguments.</li>
</ul>
</div>


                            </div>
                            <div id="Lace.polyline_shapes" class="classattr">
                                <div class="attr variable">
            <span class="name">polyline_shapes</span>

        
    </div>
    <a class="headerlink" href="#Lace.polyline_shapes"></a>
    
    

                            </div>
                            <div id="Lace.offset" class="classattr">
                                <div class="attr variable">
            <span class="name">offset</span>

        
    </div>
    <a class="headerlink" href="#Lace.offset"></a>
    
    

                            </div>
                            <div id="Lace.main_intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">main_intersections</span>

        
    </div>
    <a class="headerlink" href="#Lace.main_intersections"></a>
    
    

                            </div>
                            <div id="Lace.offset_intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">offset_intersections</span>

        
    </div>
    <a class="headerlink" href="#Lace.offset_intersections"></a>
    
    

                            </div>
                            <div id="Lace.xform_matrix" class="classattr">
                                <div class="attr variable">
            <span class="name">xform_matrix</span>

        
    </div>
    <a class="headerlink" href="#Lace.xform_matrix"></a>
    
    

                            </div>
                            <div id="Lace.rtol" class="classattr">
                                <div class="attr variable">
            <span class="name">rtol</span>

        
    </div>
    <a class="headerlink" href="#Lace.rtol"></a>
    
    

                            </div>
                            <div id="Lace.swatch" class="classattr">
                                <div class="attr variable">
            <span class="name">swatch</span>

        
    </div>
    <a class="headerlink" href="#Lace.swatch"></a>
    
    

                            </div>
                            <div id="Lace.breakpoints" class="classattr">
                                <div class="attr variable">
            <span class="name">breakpoints</span>

        
    </div>
    <a class="headerlink" href="#Lace.breakpoints"></a>
    
    

                            </div>
                            <div id="Lace.plait_color" class="classattr">
                                <div class="attr variable">
            <span class="name">plait_color</span>

        
    </div>
    <a class="headerlink" href="#Lace.plait_color"></a>
    
    

                            </div>
                            <div id="Lace.draw_fragments" class="classattr">
                                <div class="attr variable">
            <span class="name">draw_fragments</span>

        
    </div>
    <a class="headerlink" href="#Lace.draw_fragments"></a>
    
    

                            </div>
                            <div id="Lace.palette" class="classattr">
                                <div class="attr variable">
            <span class="name">palette</span>

        
    </div>
    <a class="headerlink" href="#Lace.palette"></a>
    
    

                            </div>
                            <div id="Lace.color_step" class="classattr">
                                <div class="attr variable">
            <span class="name">color_step</span>

        
    </div>
    <a class="headerlink" href="#Lace.color_step"></a>
    
    

                            </div>
                            <div id="Lace.with_plaits" class="classattr">
                                <div class="attr variable">
            <span class="name">with_plaits</span>

        
    </div>
    <a class="headerlink" href="#Lace.with_plaits"></a>
    
    

                            </div>
                            <div id="Lace.d_intersections" class="classattr">
                                <div class="attr variable">
            <span class="name">d_intersections</span>

        
    </div>
    <a class="headerlink" href="#Lace.d_intersections"></a>
    
    

                            </div>
                            <div id="Lace.d_connections" class="classattr">
                                <div class="attr variable">
            <span class="name">d_connections</span>

        
    </div>
    <a class="headerlink" href="#Lace.d_connections"></a>
    
    

                            </div>
                            <div id="Lace.plaits" class="classattr">
                                <div class="attr variable">
            <span class="name">plaits</span>

        
    </div>
    <a class="headerlink" href="#Lace.plaits"></a>
    
    

                            </div>
                            <div id="Lace.overlaps" class="classattr">
                                <div class="attr variable">
            <span class="name">overlaps</span>

        
    </div>
    <a class="headerlink" href="#Lace.overlaps"></a>
    
    

                            </div>
                            <div id="Lace.area_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">area_threshold</span>

        
    </div>
    <a class="headerlink" href="#Lace.area_threshold"></a>
    
    

                            </div>
                            <div id="Lace.radius_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">radius_threshold</span>

        
    </div>
    <a class="headerlink" href="#Lace.radius_threshold"></a>
    
    

                            </div>
                            <div id="Lace.subtype" class="classattr">
                                <div class="attr variable">
            <span class="name">subtype</span>

        
    </div>
    <a class="headerlink" href="#Lace.subtype"></a>
    
    

                            </div>
                            <div id="Lace.center" class="classattr">
                                        <input id="Lace.center-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">center</span>

                <label class="view-source-button" for="Lace.center-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.center"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.center-1088"><a href="#Lace.center-1088"><span class="linenos">1088</span></a>    <span class="nd">@property</span>
</span><span id="Lace.center-1089"><a href="#Lace.center-1089"><span class="linenos">1089</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.center-1090"><a href="#Lace.center-1090"><span class="linenos">1090</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the lace.</span>
</span><span id="Lace.center-1091"><a href="#Lace.center-1091"><span class="linenos">1091</span></a>
</span><span id="Lace.center-1092"><a href="#Lace.center-1092"><span class="linenos">1092</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.center-1093"><a href="#Lace.center-1093"><span class="linenos">1093</span></a><span class="sd">            list: Center coordinates.</span>
</span><span id="Lace.center-1094"><a href="#Lace.center-1094"><span class="linenos">1094</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.center-1095"><a href="#Lace.center-1095"><span class="linenos">1095</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">CG</span>
</span></pre></div>


            <div class="docstring"><p>Return the center of the lace.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Center coordinates.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.fragment_groups" class="classattr">
                                        <input id="Lace.fragment_groups-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">fragment_groups</span>

                <label class="view-source-button" for="Lace.fragment_groups-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.fragment_groups"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.fragment_groups-1097"><a href="#Lace.fragment_groups-1097"><span class="linenos">1097</span></a>    <span class="nd">@property</span>
</span><span id="Lace.fragment_groups-1098"><a href="#Lace.fragment_groups-1098"><span class="linenos">1098</span></a>    <span class="k">def</span> <span class="nf">fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.fragment_groups-1099"><a href="#Lace.fragment_groups-1099"><span class="linenos">1099</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the fragment groups of the lace.</span>
</span><span id="Lace.fragment_groups-1100"><a href="#Lace.fragment_groups-1100"><span class="linenos">1100</span></a>
</span><span id="Lace.fragment_groups-1101"><a href="#Lace.fragment_groups-1101"><span class="linenos">1101</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.fragment_groups-1102"><a href="#Lace.fragment_groups-1102"><span class="linenos">1102</span></a><span class="sd">            dict: Dictionary of fragment groups.</span>
</span><span id="Lace.fragment_groups-1103"><a href="#Lace.fragment_groups-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.fragment_groups-1104"><a href="#Lace.fragment_groups-1104"><span class="linenos">1104</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
</span><span id="Lace.fragment_groups-1105"><a href="#Lace.fragment_groups-1105"><span class="linenos">1105</span></a>        <span class="n">radius_frag</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.fragment_groups-1106"><a href="#Lace.fragment_groups-1106"><span class="linenos">1106</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1107"><a href="#Lace.fragment_groups-1107"><span class="linenos">1107</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">))</span>
</span><span id="Lace.fragment_groups-1108"><a href="#Lace.fragment_groups-1108"><span class="linenos">1108</span></a>            <span class="k">for</span> <span class="n">rad</span><span class="p">,</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">radius_frag</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1109"><a href="#Lace.fragment_groups-1109"><span class="linenos">1109</span></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span> <span class="o">-</span> <span class="n">rad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1110"><a href="#Lace.fragment_groups-1110"><span class="linenos">1110</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">rad</span>
</span><span id="Lace.fragment_groups-1111"><a href="#Lace.fragment_groups-1111"><span class="linenos">1111</span></a>                    <span class="k">break</span>
</span><span id="Lace.fragment_groups-1112"><a href="#Lace.fragment_groups-1112"><span class="linenos">1112</span></a>            <span class="n">radius_frag</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">))</span>
</span><span id="Lace.fragment_groups-1113"><a href="#Lace.fragment_groups-1113"><span class="linenos">1113</span></a>
</span><span id="Lace.fragment_groups-1114"><a href="#Lace.fragment_groups-1114"><span class="linenos">1114</span></a>        <span class="n">radius_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace.fragment_groups-1115"><a href="#Lace.fragment_groups-1115"><span class="linenos">1115</span></a>
</span><span id="Lace.fragment_groups-1116"><a href="#Lace.fragment_groups-1116"><span class="linenos">1116</span></a>        <span class="n">d_groups</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Lace.fragment_groups-1117"><a href="#Lace.fragment_groups-1117"><span class="linenos">1117</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">fragment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radius_frag</span><span class="p">):</span>
</span><span id="Lace.fragment_groups-1118"><a href="#Lace.fragment_groups-1118"><span class="linenos">1118</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1119"><a href="#Lace.fragment_groups-1119"><span class="linenos">1119</span></a>                <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace.fragment_groups-1120"><a href="#Lace.fragment_groups-1120"><span class="linenos">1120</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1121"><a href="#Lace.fragment_groups-1121"><span class="linenos">1121</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">d_groups</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1122"><a href="#Lace.fragment_groups-1122"><span class="linenos">1122</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace.fragment_groups-1123"><a href="#Lace.fragment_groups-1123"><span class="linenos">1123</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.fragment_groups-1124"><a href="#Lace.fragment_groups-1124"><span class="linenos">1124</span></a>                    <span class="n">d_groups</span><span class="p">[</span><span class="n">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace.fragment_groups-1125"><a href="#Lace.fragment_groups-1125"><span class="linenos">1125</span></a>
</span><span id="Lace.fragment_groups-1126"><a href="#Lace.fragment_groups-1126"><span class="linenos">1126</span></a>        <span class="k">return</span> <span class="n">d_groups</span>
</span></pre></div>


            <div class="docstring"><p>Return the fragment groups of the lace.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict: Dictionary of fragment groups.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.set_fragment_groups" class="classattr">
                                        <input id="Lace.set_fragment_groups-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fragment_groups</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.set_fragment_groups-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.set_fragment_groups"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.set_fragment_groups-1235"><a href="#Lace.set_fragment_groups-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="nf">set_fragment_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.set_fragment_groups-1236"><a href="#Lace.set_fragment_groups-1236"><span class="linenos">1236</span></a>        <span class="c1"># to do : handle repeated code. same in _set_partition_groups</span>
</span><span id="Lace.set_fragment_groups-1237"><a href="#Lace.set_fragment_groups-1237"><span class="linenos">1237</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_fragment_groups-1238"><a href="#Lace.set_fragment_groups-1238"><span class="linenos">1238</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="Lace.set_fragment_groups-1239"><a href="#Lace.set_fragment_groups-1239"><span class="linenos">1239</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fragment</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace.set_fragment_groups-1240"><a href="#Lace.set_fragment_groups-1240"><span class="linenos">1240</span></a>        <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace.set_fragment_groups-1241"><a href="#Lace.set_fragment_groups-1241"><span class="linenos">1241</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_threshold</span><span class="p">)</span>
</span><span id="Lace.set_fragment_groups-1242"><a href="#Lace.set_fragment_groups-1242"><span class="linenos">1242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace.set_fragment_groups-1243"><a href="#Lace.set_fragment_groups-1243"><span class="linenos">1243</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace.set_fragment_groups-1244"><a href="#Lace.set_fragment_groups-1244"><span class="linenos">1244</span></a>            <span class="n">area_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="Lace.set_fragment_groups-1245"><a href="#Lace.set_fragment_groups-1245"><span class="linenos">1245</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="Lace.set_fragment_groups-1246"><a href="#Lace.set_fragment_groups-1246"><span class="linenos">1246</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_fragment_groups-1247"><a href="#Lace.set_fragment_groups-1247"><span class="linenos">1247</span></a>            <span class="k">for</span> <span class="n">area</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
</span><span id="Lace.set_fragment_groups-1248"><a href="#Lace.set_fragment_groups-1248"><span class="linenos">1248</span></a>                <span class="k">if</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">area_values</span><span class="p">:</span>
</span><span id="Lace.set_fragment_groups-1249"><a href="#Lace.set_fragment_groups-1249"><span class="linenos">1249</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace.set_fragment_groups-1250"><a href="#Lace.set_fragment_groups-1250"><span class="linenos">1250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_area</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace.set_fragment_groups-1251"><a href="#Lace.set_fragment_groups-1251"><span class="linenos">1251</span></a>
</span><span id="Lace.set_fragment_groups-1252"><a href="#Lace.set_fragment_groups-1252"><span class="linenos">1252</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_fragment_groups-1253"><a href="#Lace.set_fragment_groups-1253"><span class="linenos">1253</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
</span><span id="Lace.set_fragment_groups-1254"><a href="#Lace.set_fragment_groups-1254"><span class="linenos">1254</span></a>            <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">CG</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
</span><span id="Lace.set_fragment_groups-1255"><a href="#Lace.set_fragment_groups-1255"><span class="linenos">1255</span></a>        <span class="n">radii</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Lace.set_fragment_groups-1256"><a href="#Lace.set_fragment_groups-1256"><span class="linenos">1256</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="n">group_into_bins</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_threshold</span><span class="p">)</span>
</span><span id="Lace.set_fragment_groups-1257"><a href="#Lace.set_fragment_groups-1257"><span class="linenos">1257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
</span><span id="Lace.set_fragment_groups-1258"><a href="#Lace.set_fragment_groups-1258"><span class="linenos">1258</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
</span><span id="Lace.set_fragment_groups-1259"><a href="#Lace.set_fragment_groups-1259"><span class="linenos">1259</span></a>            <span class="n">radius_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">]</span>
</span><span id="Lace.set_fragment_groups-1260"><a href="#Lace.set_fragment_groups-1260"><span class="linenos">1260</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>
</span><span id="Lace.set_fragment_groups-1261"><a href="#Lace.set_fragment_groups-1261"><span class="linenos">1261</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_fragment_groups-1262"><a href="#Lace.set_fragment_groups-1262"><span class="linenos">1262</span></a>            <span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Lace.set_fragment_groups-1263"><a href="#Lace.set_fragment_groups-1263"><span class="linenos">1263</span></a>                <span class="k">if</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radius_values</span><span class="p">:</span>
</span><span id="Lace.set_fragment_groups-1264"><a href="#Lace.set_fragment_groups-1264"><span class="linenos">1264</span></a>                    <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="Lace.set_fragment_groups-1265"><a href="#Lace.set_fragment_groups-1265"><span class="linenos">1265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fragments_by_radius</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
</span></pre></div>


    

                            </div>
                            <div id="Lace.copy" class="classattr">
                                        <input id="Lace.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.copy-1347"><a href="#Lace.copy-1347"><span class="linenos">1347</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.copy-1348"><a href="#Lace.copy-1348"><span class="linenos">1348</span></a>        <span class="k">class</span> <span class="nc">Dummy</span><span class="p">(</span><span class="n">Lace</span><span class="p">):</span>
</span><span id="Lace.copy-1349"><a href="#Lace.copy-1349"><span class="linenos">1349</span></a>            <span class="k">pass</span>
</span><span id="Lace.copy-1350"><a href="#Lace.copy-1350"><span class="linenos">1350</span></a>
</span><span id="Lace.copy-1351"><a href="#Lace.copy-1351"><span class="linenos">1351</span></a>        <span class="c1"># we need to copy the polyline_list and parallel_poly_list</span>
</span><span id="Lace.copy-1352"><a href="#Lace.copy-1352"><span class="linenos">1352</span></a>        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace.copy-1353"><a href="#Lace.copy-1353"><span class="linenos">1353</span></a>            <span class="n">polyline</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Returns a copy of the batch.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Batch: A copy of the batch.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.get_sketch" class="classattr">
                                        <input id="Lace.get_sketch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sketch</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.get_sketch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.get_sketch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.get_sketch-1355"><a href="#Lace.get_sketch-1355"><span class="linenos">1355</span></a>    <span class="k">def</span> <span class="nf">get_sketch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.get_sketch-1356"><a href="#Lace.get_sketch-1356"><span class="linenos">1356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.get_sketch-1357"><a href="#Lace.get_sketch-1357"><span class="linenos">1357</span></a><span class="sd">        Create and return a Sketch object. Sketch is a Batch object</span>
</span><span id="Lace.get_sketch-1358"><a href="#Lace.get_sketch-1358"><span class="linenos">1358</span></a><span class="sd">        with Shape elements corresponding to the vertices of the plaits</span>
</span><span id="Lace.get_sketch-1359"><a href="#Lace.get_sketch-1359"><span class="linenos">1359</span></a><span class="sd">        and fragments of the Lace instance. They have &#39;plaits&#39; and</span>
</span><span id="Lace.get_sketch-1360"><a href="#Lace.get_sketch-1360"><span class="linenos">1360</span></a><span class="sd">        &#39;fragments&#39; attributes to hold lists of Shape objects populated</span>
</span><span id="Lace.get_sketch-1361"><a href="#Lace.get_sketch-1361"><span class="linenos">1361</span></a><span class="sd">        with plait and fragment vertices of the Lace instance</span>
</span><span id="Lace.get_sketch-1362"><a href="#Lace.get_sketch-1362"><span class="linenos">1362</span></a><span class="sd">        respectively. They are used for drawing multiple copies of the</span>
</span><span id="Lace.get_sketch-1363"><a href="#Lace.get_sketch-1363"><span class="linenos">1363</span></a><span class="sd">        original lace pattern. They are light-weight compared to the</span>
</span><span id="Lace.get_sketch-1364"><a href="#Lace.get_sketch-1364"><span class="linenos">1364</span></a><span class="sd">        Lace objects since they only contain sufficient data to draw the</span>
</span><span id="Lace.get_sketch-1365"><a href="#Lace.get_sketch-1365"><span class="linenos">1365</span></a><span class="sd">        lace objects. Hundreds of these objects can be used to create</span>
</span><span id="Lace.get_sketch-1366"><a href="#Lace.get_sketch-1366"><span class="linenos">1366</span></a><span class="sd">        wallpaper patterns or other patterns without having to contain</span>
</span><span id="Lace.get_sketch-1367"><a href="#Lace.get_sketch-1367"><span class="linenos">1367</span></a><span class="sd">        unnecessary data. They do not share points with the original</span>
</span><span id="Lace.get_sketch-1368"><a href="#Lace.get_sketch-1368"><span class="linenos">1368</span></a><span class="sd">        Lace object.</span>
</span><span id="Lace.get_sketch-1369"><a href="#Lace.get_sketch-1369"><span class="linenos">1369</span></a>
</span><span id="Lace.get_sketch-1370"><a href="#Lace.get_sketch-1370"><span class="linenos">1370</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace.get_sketch-1371"><a href="#Lace.get_sketch-1371"><span class="linenos">1371</span></a><span class="sd">        ----------</span>
</span><span id="Lace.get_sketch-1372"><a href="#Lace.get_sketch-1372"><span class="linenos">1372</span></a><span class="sd">            None</span>
</span><span id="Lace.get_sketch-1373"><a href="#Lace.get_sketch-1373"><span class="linenos">1373</span></a>
</span><span id="Lace.get_sketch-1374"><a href="#Lace.get_sketch-1374"><span class="linenos">1374</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace.get_sketch-1375"><a href="#Lace.get_sketch-1375"><span class="linenos">1375</span></a><span class="sd">        --------------</span>
</span><span id="Lace.get_sketch-1376"><a href="#Lace.get_sketch-1376"><span class="linenos">1376</span></a><span class="sd">            * A lace object to be copied.</span>
</span><span id="Lace.get_sketch-1377"><a href="#Lace.get_sketch-1377"><span class="linenos">1377</span></a>
</span><span id="Lace.get_sketch-1378"><a href="#Lace.get_sketch-1378"><span class="linenos">1378</span></a><span class="sd">        Side effects:</span>
</span><span id="Lace.get_sketch-1379"><a href="#Lace.get_sketch-1379"><span class="linenos">1379</span></a><span class="sd">        -------------</span>
</span><span id="Lace.get_sketch-1380"><a href="#Lace.get_sketch-1380"><span class="linenos">1380</span></a><span class="sd">            None</span>
</span><span id="Lace.get_sketch-1381"><a href="#Lace.get_sketch-1381"><span class="linenos">1381</span></a>
</span><span id="Lace.get_sketch-1382"><a href="#Lace.get_sketch-1382"><span class="linenos">1382</span></a><span class="sd">        Return:</span>
</span><span id="Lace.get_sketch-1383"><a href="#Lace.get_sketch-1383"><span class="linenos">1383</span></a><span class="sd">        --------</span>
</span><span id="Lace.get_sketch-1384"><a href="#Lace.get_sketch-1384"><span class="linenos">1384</span></a><span class="sd">            A Sketch object.</span>
</span><span id="Lace.get_sketch-1385"><a href="#Lace.get_sketch-1385"><span class="linenos">1385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.get_sketch-1386"><a href="#Lace.get_sketch-1386"><span class="linenos">1386</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.get_sketch-1387"><a href="#Lace.get_sketch-1387"><span class="linenos">1387</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace.get_sketch-1388"><a href="#Lace.get_sketch-1388"><span class="linenos">1388</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace.get_sketch-1389"><a href="#Lace.get_sketch-1389"><span class="linenos">1389</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace.get_sketch-1390"><a href="#Lace.get_sketch-1390"><span class="linenos">1390</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">FRAGMENT</span>
</span><span id="Lace.get_sketch-1391"><a href="#Lace.get_sketch-1391"><span class="linenos">1391</span></a>            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Lace.get_sketch-1392"><a href="#Lace.get_sketch-1392"><span class="linenos">1392</span></a>
</span><span id="Lace.get_sketch-1393"><a href="#Lace.get_sketch-1393"><span class="linenos">1393</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.get_sketch-1394"><a href="#Lace.get_sketch-1394"><span class="linenos">1394</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace.get_sketch-1395"><a href="#Lace.get_sketch-1395"><span class="linenos">1395</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">plait</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace.get_sketch-1396"><a href="#Lace.get_sketch-1396"><span class="linenos">1396</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace.get_sketch-1397"><a href="#Lace.get_sketch-1397"><span class="linenos">1397</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="Lace.get_sketch-1398"><a href="#Lace.get_sketch-1398"><span class="linenos">1398</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Lace.get_sketch-1399"><a href="#Lace.get_sketch-1399"><span class="linenos">1399</span></a>
</span><span id="Lace.get_sketch-1400"><a href="#Lace.get_sketch-1400"><span class="linenos">1400</span></a>        <span class="n">sketch</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">((</span><span class="n">fragments</span> <span class="o">+</span> <span class="n">plaits</span><span class="p">))</span>
</span><span id="Lace.get_sketch-1401"><a href="#Lace.get_sketch-1401"><span class="linenos">1401</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="n">fragments</span>
</span><span id="Lace.get_sketch-1402"><a href="#Lace.get_sketch-1402"><span class="linenos">1402</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">plaits</span> <span class="o">=</span> <span class="n">plaits</span>
</span><span id="Lace.get_sketch-1403"><a href="#Lace.get_sketch-1403"><span class="linenos">1403</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outline</span>
</span><span id="Lace.get_sketch-1404"><a href="#Lace.get_sketch-1404"><span class="linenos">1404</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">SKETCH</span>
</span><span id="Lace.get_sketch-1405"><a href="#Lace.get_sketch-1405"><span class="linenos">1405</span></a>
</span><span id="Lace.get_sketch-1406"><a href="#Lace.get_sketch-1406"><span class="linenos">1406</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_plaits</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace.get_sketch-1407"><a href="#Lace.get_sketch-1407"><span class="linenos">1407</span></a>        <span class="n">sketch</span><span class="o">.</span><span class="n">draw_fragments</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Lace.get_sketch-1408"><a href="#Lace.get_sketch-1408"><span class="linenos">1408</span></a>        <span class="k">return</span> <span class="n">sketch</span>
</span></pre></div>


            <div class="docstring"><p>Create and return a Sketch object. Sketch is a Batch object
with Shape elements corresponding to the vertices of the plaits
and fragments of the Lace instance. They have 'plaits' and
'fragments' attributes to hold lists of Shape objects populated
with plait and fragment vertices of the Lace instance
respectively. They are used for drawing multiple copies of the
original lace pattern. They are light-weight compared to the
Lace objects since they only contain sufficient data to draw the
lace objects. Hundreds of these objects can be used to create
wallpaper patterns or other patterns without having to contain
unnecessary data. They do not share points with the original
Lace object.</p>

<h2 id="arguments">Arguments:</h2>

<pre><code>None
</code></pre>

<h2 id="prerequisites">Prerequisites:</h2>

<pre><code>* A lace object to be copied.
</code></pre>

<h2 id="side-effects">Side effects:</h2>

<pre><code>None
</code></pre>

<h2 id="return">Return:</h2>

<pre><code>A Sketch object.
</code></pre>
</div>


                            </div>
                            <div id="Lace.group_fragments" class="classattr">
                                        <input id="Lace.group_fragments-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">group_fragments</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.group_fragments-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.group_fragments"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.group_fragments-1410"><a href="#Lace.group_fragments-1410"><span class="linenos">1410</span></a>    <span class="k">def</span> <span class="nf">group_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Lace.group_fragments-1411"><a href="#Lace.group_fragments-1411"><span class="linenos">1411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Group the fragments by the number of vertices and the area.</span>
</span><span id="Lace.group_fragments-1412"><a href="#Lace.group_fragments-1412"><span class="linenos">1412</span></a>
</span><span id="Lace.group_fragments-1413"><a href="#Lace.group_fragments-1413"><span class="linenos">1413</span></a><span class="sd">        Args:</span>
</span><span id="Lace.group_fragments-1414"><a href="#Lace.group_fragments-1414"><span class="linenos">1414</span></a><span class="sd">            tol (float, optional): Tolerance value. Defaults to None.</span>
</span><span id="Lace.group_fragments-1415"><a href="#Lace.group_fragments-1415"><span class="linenos">1415</span></a>
</span><span id="Lace.group_fragments-1416"><a href="#Lace.group_fragments-1416"><span class="linenos">1416</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.group_fragments-1417"><a href="#Lace.group_fragments-1417"><span class="linenos">1417</span></a><span class="sd">            list: List of grouped fragments.</span>
</span><span id="Lace.group_fragments-1418"><a href="#Lace.group_fragments-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.group_fragments-1419"><a href="#Lace.group_fragments-1419"><span class="linenos">1419</span></a>        <span class="k">if</span> <span class="n">tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace.group_fragments-1420"><a href="#Lace.group_fragments-1420"><span class="linenos">1420</span></a>            <span class="n">tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;tol&quot;</span><span class="p">]</span>
</span><span id="Lace.group_fragments-1421"><a href="#Lace.group_fragments-1421"><span class="linenos">1421</span></a>        <span class="n">frags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span>
</span><span id="Lace.group_fragments-1422"><a href="#Lace.group_fragments-1422"><span class="linenos">1422</span></a>        <span class="n">vert_groups</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Lace.group_fragments-1423"><a href="#Lace.group_fragments-1423"><span class="linenos">1423</span></a>            <span class="p">[</span><span class="n">frag</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">]</span>
</span><span id="Lace.group_fragments-1424"><a href="#Lace.group_fragments-1424"><span class="linenos">1424</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">])</span>
</span><span id="Lace.group_fragments-1425"><a href="#Lace.group_fragments-1425"><span class="linenos">1425</span></a>        <span class="p">]</span>
</span><span id="Lace.group_fragments-1426"><a href="#Lace.group_fragments-1426"><span class="linenos">1426</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.group_fragments-1427"><a href="#Lace.group_fragments-1427"><span class="linenos">1427</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">vert_groups</span><span class="p">:</span>
</span><span id="Lace.group_fragments-1428"><a href="#Lace.group_fragments-1428"><span class="linenos">1428</span></a>            <span class="n">areas</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Lace.group_fragments-1429"><a href="#Lace.group_fragments-1429"><span class="linenos">1429</span></a>                <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">group</span> <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)]</span>
</span><span id="Lace.group_fragments-1430"><a href="#Lace.group_fragments-1430"><span class="linenos">1430</span></a>                <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">frag</span><span class="o">.</span><span class="n">area</span> <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">group</span><span class="p">])</span>
</span><span id="Lace.group_fragments-1431"><a href="#Lace.group_fragments-1431"><span class="linenos">1431</span></a>            <span class="p">]</span>
</span><span id="Lace.group_fragments-1432"><a href="#Lace.group_fragments-1432"><span class="linenos">1432</span></a>            <span class="n">areas</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace.group_fragments-1433"><a href="#Lace.group_fragments-1433"><span class="linenos">1433</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
</span><span id="Lace.group_fragments-1434"><a href="#Lace.group_fragments-1434"><span class="linenos">1434</span></a>        <span class="n">groups</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace.group_fragments-1435"><a href="#Lace.group_fragments-1435"><span class="linenos">1435</span></a>
</span><span id="Lace.group_fragments-1436"><a href="#Lace.group_fragments-1436"><span class="linenos">1436</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>Group the fragments by the number of vertices and the area.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>tol (float, optional):</strong>  Tolerance value. Defaults to None.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of grouped fragments.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.get_fragment_cycles" class="classattr">
                                        <input id="Lace.get_fragment_cycles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_fragment_cycles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.get_fragment_cycles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.get_fragment_cycles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.get_fragment_cycles-1438"><a href="#Lace.get_fragment_cycles-1438"><span class="linenos">1438</span></a>    <span class="k">def</span> <span class="nf">get_fragment_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.get_fragment_cycles-1439"><a href="#Lace.get_fragment_cycles-1439"><span class="linenos">1439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.get_fragment_cycles-1440"><a href="#Lace.get_fragment_cycles-1440"><span class="linenos">1440</span></a><span class="sd">        Iterate over the offset sections and create a graph of the</span>
</span><span id="Lace.get_fragment_cycles-1441"><a href="#Lace.get_fragment_cycles-1441"><span class="linenos">1441</span></a><span class="sd">        intersections (start and end of the sections). Then find the</span>
</span><span id="Lace.get_fragment_cycles-1442"><a href="#Lace.get_fragment_cycles-1442"><span class="linenos">1442</span></a><span class="sd">        cycles in the graph. self.d_intersections is used to map</span>
</span><span id="Lace.get_fragment_cycles-1443"><a href="#Lace.get_fragment_cycles-1443"><span class="linenos">1443</span></a><span class="sd">        the graph nodes to the actual intersection points.</span>
</span><span id="Lace.get_fragment_cycles-1444"><a href="#Lace.get_fragment_cycles-1444"><span class="linenos">1444</span></a>
</span><span id="Lace.get_fragment_cycles-1445"><a href="#Lace.get_fragment_cycles-1445"><span class="linenos">1445</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.get_fragment_cycles-1446"><a href="#Lace.get_fragment_cycles-1446"><span class="linenos">1446</span></a><span class="sd">            list: List of fragment cycles.</span>
</span><span id="Lace.get_fragment_cycles-1447"><a href="#Lace.get_fragment_cycles-1447"><span class="linenos">1447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.get_fragment_cycles-1448"><a href="#Lace.get_fragment_cycles-1448"><span class="linenos">1448</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.get_fragment_cycles-1449"><a href="#Lace.get_fragment_cycles-1449"><span class="linenos">1449</span></a>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace.get_fragment_cycles-1450"><a href="#Lace.get_fragment_cycles-1450"><span class="linenos">1450</span></a>            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace.get_fragment_cycles-1451"><a href="#Lace.get_fragment_cycles-1451"><span class="linenos">1451</span></a>                <span class="k">continue</span>
</span><span id="Lace.get_fragment_cycles-1452"><a href="#Lace.get_fragment_cycles-1452"><span class="linenos">1452</span></a>            <span class="n">graph_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="Lace.get_fragment_cycles-1453"><a href="#Lace.get_fragment_cycles-1453"><span class="linenos">1453</span></a>
</span><span id="Lace.get_fragment_cycles-1454"><a href="#Lace.get_fragment_cycles-1454"><span class="linenos">1454</span></a>        <span class="k">return</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the offset sections and create a graph of the
intersections (start and end of the sections). Then find the
cycles in the graph. self.d_intersections is used to map
the graph nodes to the actual intersection points.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of fragment cycles.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.set_plait_lines" class="classattr">
                                        <input id="Lace.set_plait_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_plait_lines</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">offset</span>, </span><span class="param"><span class="n">line_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mf">0.012</span><span class="p">,</span> <span class="mf">0.263</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">)</span>, </span><span class="param"><span class="n">line_width</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.set_plait_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.set_plait_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.set_plait_lines-1469"><a href="#Lace.set_plait_lines-1469"><span class="linenos">1469</span></a>    <span class="k">def</span> <span class="nf">set_plait_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Lace.set_plait_lines-1470"><a href="#Lace.set_plait_lines-1470"><span class="linenos">1470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create offset lines inside the plaits of the lace.</span>
</span><span id="Lace.set_plait_lines-1471"><a href="#Lace.set_plait_lines-1471"><span class="linenos">1471</span></a>
</span><span id="Lace.set_plait_lines-1472"><a href="#Lace.set_plait_lines-1472"><span class="linenos">1472</span></a><span class="sd">        Args:</span>
</span><span id="Lace.set_plait_lines-1473"><a href="#Lace.set_plait_lines-1473"><span class="linenos">1473</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="Lace.set_plait_lines-1474"><a href="#Lace.set_plait_lines-1474"><span class="linenos">1474</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="Lace.set_plait_lines-1475"><a href="#Lace.set_plait_lines-1475"><span class="linenos">1475</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="Lace.set_plait_lines-1476"><a href="#Lace.set_plait_lines-1476"><span class="linenos">1476</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="Lace.set_plait_lines-1477"><a href="#Lace.set_plait_lines-1477"><span class="linenos">1477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.set_plait_lines-1478"><a href="#Lace.set_plait_lines-1478"><span class="linenos">1478</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace.set_plait_lines-1479"><a href="#Lace.set_plait_lines-1479"><span class="linenos">1479</span></a>            <span class="n">plait</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_plait_lines-1480"><a href="#Lace.set_plait_lines-1480"><span class="linenos">1480</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">plait</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create offset lines inside the plaits of the lace.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n (int):</strong>  Number of lines.</li>
<li><strong>offset (float):</strong>  Offset value.</li>
<li><strong>line_color (colors.Color, optional):</strong>  Line color. Defaults to colors.blue.</li>
<li><strong>line_width (int, optional):</strong>  Line width. Defaults to 1.</li>
</ul>
</div>


                            </div>
                            <div id="Lace.set_fragment_lines" class="classattr">
                                        <input id="Lace.set_fragment_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fragment_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">line_color</span><span class="p">:</span> <span class="n"><a href="../colors/colors.html#Color">simetri.colors.colors.Color</a></span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mf">0.012</span><span class="p">,</span> <span class="mf">0.263</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">)</span>,</span><span class="param">	<span class="n">line_width</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Lace.set_fragment_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.set_fragment_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.set_fragment_lines-1482"><a href="#Lace.set_fragment_lines-1482"><span class="linenos">1482</span></a>    <span class="k">def</span> <span class="nf">set_fragment_lines</span><span class="p">(</span>
</span><span id="Lace.set_fragment_lines-1483"><a href="#Lace.set_fragment_lines-1483"><span class="linenos">1483</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Lace.set_fragment_lines-1484"><a href="#Lace.set_fragment_lines-1484"><span class="linenos">1484</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Lace.set_fragment_lines-1485"><a href="#Lace.set_fragment_lines-1485"><span class="linenos">1485</span></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="Lace.set_fragment_lines-1486"><a href="#Lace.set_fragment_lines-1486"><span class="linenos">1486</span></a>        <span class="n">line_color</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
</span><span id="Lace.set_fragment_lines-1487"><a href="#Lace.set_fragment_lines-1487"><span class="linenos">1487</span></a>        <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Lace.set_fragment_lines-1488"><a href="#Lace.set_fragment_lines-1488"><span class="linenos">1488</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Lace.set_fragment_lines-1489"><a href="#Lace.set_fragment_lines-1489"><span class="linenos">1489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.set_fragment_lines-1490"><a href="#Lace.set_fragment_lines-1490"><span class="linenos">1490</span></a><span class="sd">        Create offset lines inside the fragments of the lace.</span>
</span><span id="Lace.set_fragment_lines-1491"><a href="#Lace.set_fragment_lines-1491"><span class="linenos">1491</span></a>
</span><span id="Lace.set_fragment_lines-1492"><a href="#Lace.set_fragment_lines-1492"><span class="linenos">1492</span></a><span class="sd">        Args:</span>
</span><span id="Lace.set_fragment_lines-1493"><a href="#Lace.set_fragment_lines-1493"><span class="linenos">1493</span></a><span class="sd">            n (int): Number of lines.</span>
</span><span id="Lace.set_fragment_lines-1494"><a href="#Lace.set_fragment_lines-1494"><span class="linenos">1494</span></a><span class="sd">            offset (float): Offset value.</span>
</span><span id="Lace.set_fragment_lines-1495"><a href="#Lace.set_fragment_lines-1495"><span class="linenos">1495</span></a><span class="sd">            line_color (colors.Color, optional): Line color. Defaults to colors.blue.</span>
</span><span id="Lace.set_fragment_lines-1496"><a href="#Lace.set_fragment_lines-1496"><span class="linenos">1496</span></a><span class="sd">            line_width (int, optional): Line width. Defaults to 1.</span>
</span><span id="Lace.set_fragment_lines-1497"><a href="#Lace.set_fragment_lines-1497"><span class="linenos">1497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.set_fragment_lines-1498"><a href="#Lace.set_fragment_lines-1498"><span class="linenos">1498</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace.set_fragment_lines-1499"><a href="#Lace.set_fragment_lines-1499"><span class="linenos">1499</span></a>            <span class="n">fragment</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_fragment_lines-1500"><a href="#Lace.set_fragment_lines-1500"><span class="linenos">1500</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_inner_lines</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">line_color</span><span class="p">,</span> <span class="n">line_width</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create offset lines inside the fragments of the lace.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n (int):</strong>  Number of lines.</li>
<li><strong>offset (float):</strong>  Offset value.</li>
<li><strong>line_color (colors.Color, optional):</strong>  Line color. Defaults to colors.blue.</li>
<li><strong>line_width (int, optional):</strong>  Line width. Defaults to 1.</li>
</ul>
</div>


                            </div>
                            <div id="Lace.all_divisions" class="classattr">
                                        <input id="Lace.all_divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">all_divisions</span><span class="annotation">: List</span>

                <label class="view-source-button" for="Lace.all_divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.all_divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.all_divisions-1502"><a href="#Lace.all_divisions-1502"><span class="linenos">1502</span></a>    <span class="nd">@property</span>
</span><span id="Lace.all_divisions-1503"><a href="#Lace.all_divisions-1503"><span class="linenos">1503</span></a>    <span class="k">def</span> <span class="nf">all_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
</span><span id="Lace.all_divisions-1504"><a href="#Lace.all_divisions-1504"><span class="linenos">1504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.all_divisions-1505"><a href="#Lace.all_divisions-1505"><span class="linenos">1505</span></a><span class="sd">        Return a list of all the divisions (both main and offset) in the lace.</span>
</span><span id="Lace.all_divisions-1506"><a href="#Lace.all_divisions-1506"><span class="linenos">1506</span></a>
</span><span id="Lace.all_divisions-1507"><a href="#Lace.all_divisions-1507"><span class="linenos">1507</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.all_divisions-1508"><a href="#Lace.all_divisions-1508"><span class="linenos">1508</span></a><span class="sd">            list: List of all divisions.</span>
</span><span id="Lace.all_divisions-1509"><a href="#Lace.all_divisions-1509"><span class="linenos">1509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.all_divisions-1510"><a href="#Lace.all_divisions-1510"><span class="linenos">1510</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.all_divisions-1511"><a href="#Lace.all_divisions-1511"><span class="linenos">1511</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.all_divisions-1512"><a href="#Lace.all_divisions-1512"><span class="linenos">1512</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace.all_divisions-1513"><a href="#Lace.all_divisions-1513"><span class="linenos">1513</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace.all_divisions-1514"><a href="#Lace.all_divisions-1514"><span class="linenos">1514</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of all the divisions (both main and offset) in the lace.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of all divisions.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_main_intersections" class="classattr">
                                        <input id="Lace.iter_main_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_main_intersections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_main_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_main_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_main_intersections-1516"><a href="#Lace.iter_main_intersections-1516"><span class="linenos">1516</span></a>    <span class="k">def</span> <span class="nf">iter_main_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_main_intersections-1517"><a href="#Lace.iter_main_intersections-1517"><span class="linenos">1517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main intersections.</span>
</span><span id="Lace.iter_main_intersections-1518"><a href="#Lace.iter_main_intersections-1518"><span class="linenos">1518</span></a>
</span><span id="Lace.iter_main_intersections-1519"><a href="#Lace.iter_main_intersections-1519"><span class="linenos">1519</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_main_intersections-1520"><a href="#Lace.iter_main_intersections-1520"><span class="linenos">1520</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Lace.iter_main_intersections-1521"><a href="#Lace.iter_main_intersections-1521"><span class="linenos">1521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_main_intersections-1522"><a href="#Lace.iter_main_intersections-1522"><span class="linenos">1522</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_main_intersections-1523"><a href="#Lace.iter_main_intersections-1523"><span class="linenos">1523</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace.iter_main_intersections-1524"><a href="#Lace.iter_main_intersections-1524"><span class="linenos">1524</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the main intersections.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Intersection: Intersection object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_offset_intersections" class="classattr">
                                        <input id="Lace.iter_offset_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_offset_intersections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_offset_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_offset_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_offset_intersections-1526"><a href="#Lace.iter_offset_intersections-1526"><span class="linenos">1526</span></a>    <span class="k">def</span> <span class="nf">iter_offset_intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_offset_intersections-1527"><a href="#Lace.iter_offset_intersections-1527"><span class="linenos">1527</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_intersections-1528"><a href="#Lace.iter_offset_intersections-1528"><span class="linenos">1528</span></a><span class="sd">        Iterate over the offset intersections.</span>
</span><span id="Lace.iter_offset_intersections-1529"><a href="#Lace.iter_offset_intersections-1529"><span class="linenos">1529</span></a>
</span><span id="Lace.iter_offset_intersections-1530"><a href="#Lace.iter_offset_intersections-1530"><span class="linenos">1530</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_offset_intersections-1531"><a href="#Lace.iter_offset_intersections-1531"><span class="linenos">1531</span></a><span class="sd">            Intersection: Intersection object.</span>
</span><span id="Lace.iter_offset_intersections-1532"><a href="#Lace.iter_offset_intersections-1532"><span class="linenos">1532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_intersections-1533"><a href="#Lace.iter_offset_intersections-1533"><span class="linenos">1533</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_intersections-1534"><a href="#Lace.iter_offset_intersections-1534"><span class="linenos">1534</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_intersections-1535"><a href="#Lace.iter_offset_intersections-1535"><span class="linenos">1535</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace.iter_offset_intersections-1536"><a href="#Lace.iter_offset_intersections-1536"><span class="linenos">1536</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the offset intersections.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Intersection: Intersection object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_offset_sections" class="classattr">
                                        <input id="Lace.iter_offset_sections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_offset_sections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_offset_sections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_offset_sections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_offset_sections-1538"><a href="#Lace.iter_offset_sections-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">iter_offset_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_offset_sections-1539"><a href="#Lace.iter_offset_sections-1539"><span class="linenos">1539</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_sections-1540"><a href="#Lace.iter_offset_sections-1540"><span class="linenos">1540</span></a><span class="sd">        Iterate over the offset sections.</span>
</span><span id="Lace.iter_offset_sections-1541"><a href="#Lace.iter_offset_sections-1541"><span class="linenos">1541</span></a>
</span><span id="Lace.iter_offset_sections-1542"><a href="#Lace.iter_offset_sections-1542"><span class="linenos">1542</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_offset_sections-1543"><a href="#Lace.iter_offset_sections-1543"><span class="linenos">1543</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Lace.iter_offset_sections-1544"><a href="#Lace.iter_offset_sections-1544"><span class="linenos">1544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_sections-1545"><a href="#Lace.iter_offset_sections-1545"><span class="linenos">1545</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_sections-1546"><a href="#Lace.iter_offset_sections-1546"><span class="linenos">1546</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_sections-1547"><a href="#Lace.iter_offset_sections-1547"><span class="linenos">1547</span></a>                <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace.iter_offset_sections-1548"><a href="#Lace.iter_offset_sections-1548"><span class="linenos">1548</span></a>                    <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the offset sections.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Section: Section object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_main_sections" class="classattr">
                                        <input id="Lace.iter_main_sections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_main_sections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_main_sections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_main_sections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_main_sections-1550"><a href="#Lace.iter_main_sections-1550"><span class="linenos">1550</span></a>    <span class="k">def</span> <span class="nf">iter_main_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_main_sections-1551"><a href="#Lace.iter_main_sections-1551"><span class="linenos">1551</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the main sections.</span>
</span><span id="Lace.iter_main_sections-1552"><a href="#Lace.iter_main_sections-1552"><span class="linenos">1552</span></a>
</span><span id="Lace.iter_main_sections-1553"><a href="#Lace.iter_main_sections-1553"><span class="linenos">1553</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_main_sections-1554"><a href="#Lace.iter_main_sections-1554"><span class="linenos">1554</span></a><span class="sd">            Section: Section object.</span>
</span><span id="Lace.iter_main_sections-1555"><a href="#Lace.iter_main_sections-1555"><span class="linenos">1555</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_main_sections-1556"><a href="#Lace.iter_main_sections-1556"><span class="linenos">1556</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_main_sections-1557"><a href="#Lace.iter_main_sections-1557"><span class="linenos">1557</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace.iter_main_sections-1558"><a href="#Lace.iter_main_sections-1558"><span class="linenos">1558</span></a>                <span class="k">yield from</span> <span class="n">division</span><span class="o">.</span><span class="n">sections</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the main sections.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Section: Section object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_offset_divisions" class="classattr">
                                        <input id="Lace.iter_offset_divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_offset_divisions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_offset_divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_offset_divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_offset_divisions-1560"><a href="#Lace.iter_offset_divisions-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">iter_offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_offset_divisions-1561"><a href="#Lace.iter_offset_divisions-1561"><span class="linenos">1561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_divisions-1562"><a href="#Lace.iter_offset_divisions-1562"><span class="linenos">1562</span></a><span class="sd">        Iterate over the offset divisions.</span>
</span><span id="Lace.iter_offset_divisions-1563"><a href="#Lace.iter_offset_divisions-1563"><span class="linenos">1563</span></a>
</span><span id="Lace.iter_offset_divisions-1564"><a href="#Lace.iter_offset_divisions-1564"><span class="linenos">1564</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_offset_divisions-1565"><a href="#Lace.iter_offset_divisions-1565"><span class="linenos">1565</span></a><span class="sd">            Division: Division object.</span>
</span><span id="Lace.iter_offset_divisions-1566"><a href="#Lace.iter_offset_divisions-1566"><span class="linenos">1566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_offset_divisions-1567"><a href="#Lace.iter_offset_divisions-1567"><span class="linenos">1567</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_divisions-1568"><a href="#Lace.iter_offset_divisions-1568"><span class="linenos">1568</span></a>            <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_offset_divisions-1569"><a href="#Lace.iter_offset_divisions-1569"><span class="linenos">1569</span></a>                <span class="k">yield from</span> <span class="n">poly</span><span class="o">.</span><span class="n">divisions</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the offset divisions.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Division: Division object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.iter_main_divisions" class="classattr">
                                        <input id="Lace.iter_main_divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iter_main_divisions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Iterator</span>:</span></span>

                <label class="view-source-button" for="Lace.iter_main_divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.iter_main_divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.iter_main_divisions-1571"><a href="#Lace.iter_main_divisions-1571"><span class="linenos">1571</span></a>    <span class="k">def</span> <span class="nf">iter_main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
</span><span id="Lace.iter_main_divisions-1572"><a href="#Lace.iter_main_divisions-1572"><span class="linenos">1572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.iter_main_divisions-1573"><a href="#Lace.iter_main_divisions-1573"><span class="linenos">1573</span></a><span class="sd">        Iterate over the main divisions.</span>
</span><span id="Lace.iter_main_divisions-1574"><a href="#Lace.iter_main_divisions-1574"><span class="linenos">1574</span></a>
</span><span id="Lace.iter_main_divisions-1575"><a href="#Lace.iter_main_divisions-1575"><span class="linenos">1575</span></a><span class="sd">        Yields:</span>
</span><span id="Lace.iter_main_divisions-1576"><a href="#Lace.iter_main_divisions-1576"><span class="linenos">1576</span></a><span class="sd">            Division: Division object.</span>
</span><span id="Lace.iter_main_divisions-1577"><a href="#Lace.iter_main_divisions-1577"><span class="linenos">1577</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.iter_main_divisions-1578"><a href="#Lace.iter_main_divisions-1578"><span class="linenos">1578</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.iter_main_divisions-1579"><a href="#Lace.iter_main_divisions-1579"><span class="linenos">1579</span></a>            <span class="k">yield from</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span>
</span></pre></div>


            <div class="docstring"><p>Iterate over the main divisions.</p>

<h6 id="yields">Yields:</h6>

<blockquote>
  <p>Division: Division object.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.main_divisions" class="classattr">
                                        <input id="Lace.main_divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">main_divisions</span><span class="annotation">: List[<a href="#Division">Division</a>]</span>

                <label class="view-source-button" for="Lace.main_divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.main_divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.main_divisions-1581"><a href="#Lace.main_divisions-1581"><span class="linenos">1581</span></a>    <span class="nd">@property</span>
</span><span id="Lace.main_divisions-1582"><a href="#Lace.main_divisions-1582"><span class="linenos">1582</span></a>    <span class="k">def</span> <span class="nf">main_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="Lace.main_divisions-1583"><a href="#Lace.main_divisions-1583"><span class="linenos">1583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Main divisions are the divisions of the main polyline.</span>
</span><span id="Lace.main_divisions-1584"><a href="#Lace.main_divisions-1584"><span class="linenos">1584</span></a>
</span><span id="Lace.main_divisions-1585"><a href="#Lace.main_divisions-1585"><span class="linenos">1585</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.main_divisions-1586"><a href="#Lace.main_divisions-1586"><span class="linenos">1586</span></a><span class="sd">            list: List of main divisions.</span>
</span><span id="Lace.main_divisions-1587"><a href="#Lace.main_divisions-1587"><span class="linenos">1587</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.main_divisions-1588"><a href="#Lace.main_divisions-1588"><span class="linenos">1588</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.main_divisions-1589"><a href="#Lace.main_divisions-1589"><span class="linenos">1589</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.main_divisions-1590"><a href="#Lace.main_divisions-1590"><span class="linenos">1590</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace.main_divisions-1591"><a href="#Lace.main_divisions-1591"><span class="linenos">1591</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Main divisions are the divisions of the main polyline.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of main divisions.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.offset_divisions" class="classattr">
                                        <input id="Lace.offset_divisions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">offset_divisions</span><span class="annotation">: List[<a href="#Division">Division</a>]</span>

                <label class="view-source-button" for="Lace.offset_divisions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.offset_divisions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.offset_divisions-1593"><a href="#Lace.offset_divisions-1593"><span class="linenos">1593</span></a>    <span class="nd">@property</span>
</span><span id="Lace.offset_divisions-1594"><a href="#Lace.offset_divisions-1594"><span class="linenos">1594</span></a>    <span class="k">def</span> <span class="nf">offset_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Division</span><span class="p">]:</span>
</span><span id="Lace.offset_divisions-1595"><a href="#Lace.offset_divisions-1595"><span class="linenos">1595</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Offset divisions are the divisions of the offset polylines.</span>
</span><span id="Lace.offset_divisions-1596"><a href="#Lace.offset_divisions-1596"><span class="linenos">1596</span></a>
</span><span id="Lace.offset_divisions-1597"><a href="#Lace.offset_divisions-1597"><span class="linenos">1597</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.offset_divisions-1598"><a href="#Lace.offset_divisions-1598"><span class="linenos">1598</span></a><span class="sd">            list: List of offset divisions.</span>
</span><span id="Lace.offset_divisions-1599"><a href="#Lace.offset_divisions-1599"><span class="linenos">1599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.offset_divisions-1600"><a href="#Lace.offset_divisions-1600"><span class="linenos">1600</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.offset_divisions-1601"><a href="#Lace.offset_divisions-1601"><span class="linenos">1601</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.offset_divisions-1602"><a href="#Lace.offset_divisions-1602"><span class="linenos">1602</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">:</span>
</span><span id="Lace.offset_divisions-1603"><a href="#Lace.offset_divisions-1603"><span class="linenos">1603</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">divisions</span><span class="p">)</span>
</span><span id="Lace.offset_divisions-1604"><a href="#Lace.offset_divisions-1604"><span class="linenos">1604</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Offset divisions are the divisions of the offset polylines.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of offset divisions.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.intersections" class="classattr">
                                        <input id="Lace.intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">intersections</span><span class="annotation">: List[<a href="#Intersection">Intersection</a>]</span>

                <label class="view-source-button" for="Lace.intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.intersections-1606"><a href="#Lace.intersections-1606"><span class="linenos">1606</span></a>    <span class="nd">@property</span>
</span><span id="Lace.intersections-1607"><a href="#Lace.intersections-1607"><span class="linenos">1607</span></a>    <span class="k">def</span> <span class="nf">intersections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="Lace.intersections-1608"><a href="#Lace.intersections-1608"><span class="linenos">1608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all the intersections in the parallel_poly_list.</span>
</span><span id="Lace.intersections-1609"><a href="#Lace.intersections-1609"><span class="linenos">1609</span></a>
</span><span id="Lace.intersections-1610"><a href="#Lace.intersections-1610"><span class="linenos">1610</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.intersections-1611"><a href="#Lace.intersections-1611"><span class="linenos">1611</span></a><span class="sd">            list: List of intersections.</span>
</span><span id="Lace.intersections-1612"><a href="#Lace.intersections-1612"><span class="linenos">1612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.intersections-1613"><a href="#Lace.intersections-1613"><span class="linenos">1613</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.intersections-1614"><a href="#Lace.intersections-1614"><span class="linenos">1614</span></a>        <span class="k">for</span> <span class="n">parallel_polyline</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.intersections-1615"><a href="#Lace.intersections-1615"><span class="linenos">1615</span></a>            <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">parallel_polyline</span><span class="o">.</span><span class="n">polyline_list</span><span class="p">:</span>
</span><span id="Lace.intersections-1616"><a href="#Lace.intersections-1616"><span class="linenos">1616</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">intersections</span><span class="p">)</span>
</span><span id="Lace.intersections-1617"><a href="#Lace.intersections-1617"><span class="linenos">1617</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return all the intersections in the parallel_poly_list.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of intersections.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.set_plaits" class="classattr">
                                        <input id="Lace.set_plaits-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_plaits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Lace.set_plaits-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.set_plaits"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.set_plaits-1758"><a href="#Lace.set_plaits-1758"><span class="linenos">1758</span></a>    <span class="k">def</span> <span class="nf">set_plaits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Lace.set_plaits-1759"><a href="#Lace.set_plaits-1759"><span class="linenos">1759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.set_plaits-1760"><a href="#Lace.set_plaits-1760"><span class="linenos">1760</span></a><span class="sd">        Populate the self.plaits list with Plait objects. Plaits are</span>
</span><span id="Lace.set_plaits-1761"><a href="#Lace.set_plaits-1761"><span class="linenos">1761</span></a><span class="sd">        optional for drawing. They form the under/over interlacing. They</span>
</span><span id="Lace.set_plaits-1762"><a href="#Lace.set_plaits-1762"><span class="linenos">1762</span></a><span class="sd">        are created if the &quot;with_plaits&quot; argument is set to be True in</span>
</span><span id="Lace.set_plaits-1763"><a href="#Lace.set_plaits-1763"><span class="linenos">1763</span></a><span class="sd">        the constructor. with_plaits is True by default but this can be</span>
</span><span id="Lace.set_plaits-1764"><a href="#Lace.set_plaits-1764"><span class="linenos">1764</span></a><span class="sd">        changed by setting the auto_plaits value to False in the</span>
</span><span id="Lace.set_plaits-1765"><a href="#Lace.set_plaits-1765"><span class="linenos">1765</span></a><span class="sd">        settings.py This method can be called by the user to create the</span>
</span><span id="Lace.set_plaits-1766"><a href="#Lace.set_plaits-1766"><span class="linenos">1766</span></a><span class="sd">        plaits after the creation of the Lace object if they were not</span>
</span><span id="Lace.set_plaits-1767"><a href="#Lace.set_plaits-1767"><span class="linenos">1767</span></a><span class="sd">        created initally.</span>
</span><span id="Lace.set_plaits-1768"><a href="#Lace.set_plaits-1768"><span class="linenos">1768</span></a>
</span><span id="Lace.set_plaits-1769"><a href="#Lace.set_plaits-1769"><span class="linenos">1769</span></a><span class="sd">        * Can be called by users.</span>
</span><span id="Lace.set_plaits-1770"><a href="#Lace.set_plaits-1770"><span class="linenos">1770</span></a>
</span><span id="Lace.set_plaits-1771"><a href="#Lace.set_plaits-1771"><span class="linenos">1771</span></a><span class="sd">        Arguments:</span>
</span><span id="Lace.set_plaits-1772"><a href="#Lace.set_plaits-1772"><span class="linenos">1772</span></a><span class="sd">        ----------</span>
</span><span id="Lace.set_plaits-1773"><a href="#Lace.set_plaits-1773"><span class="linenos">1773</span></a><span class="sd">            None</span>
</span><span id="Lace.set_plaits-1774"><a href="#Lace.set_plaits-1774"><span class="linenos">1774</span></a>
</span><span id="Lace.set_plaits-1775"><a href="#Lace.set_plaits-1775"><span class="linenos">1775</span></a><span class="sd">        Return:</span>
</span><span id="Lace.set_plaits-1776"><a href="#Lace.set_plaits-1776"><span class="linenos">1776</span></a><span class="sd">        --------</span>
</span><span id="Lace.set_plaits-1777"><a href="#Lace.set_plaits-1777"><span class="linenos">1777</span></a><span class="sd">            None</span>
</span><span id="Lace.set_plaits-1778"><a href="#Lace.set_plaits-1778"><span class="linenos">1778</span></a>
</span><span id="Lace.set_plaits-1779"><a href="#Lace.set_plaits-1779"><span class="linenos">1779</span></a><span class="sd">        Side Effects:</span>
</span><span id="Lace.set_plaits-1780"><a href="#Lace.set_plaits-1780"><span class="linenos">1780</span></a><span class="sd">        -------------</span>
</span><span id="Lace.set_plaits-1781"><a href="#Lace.set_plaits-1781"><span class="linenos">1781</span></a><span class="sd">            * self.plaits is populated with Plait objects.</span>
</span><span id="Lace.set_plaits-1782"><a href="#Lace.set_plaits-1782"><span class="linenos">1782</span></a>
</span><span id="Lace.set_plaits-1783"><a href="#Lace.set_plaits-1783"><span class="linenos">1783</span></a><span class="sd">        Prerequisites:</span>
</span><span id="Lace.set_plaits-1784"><a href="#Lace.set_plaits-1784"><span class="linenos">1784</span></a><span class="sd">        --------------</span>
</span><span id="Lace.set_plaits-1785"><a href="#Lace.set_plaits-1785"><span class="linenos">1785</span></a><span class="sd">            self.polyline and self.parallel_poly_list must be populated.</span>
</span><span id="Lace.set_plaits-1786"><a href="#Lace.set_plaits-1786"><span class="linenos">1786</span></a><span class="sd">            self.divisions and self.intersections must be populated.</span>
</span><span id="Lace.set_plaits-1787"><a href="#Lace.set_plaits-1787"><span class="linenos">1787</span></a><span class="sd">            self.overlaps must be populated.</span>
</span><span id="Lace.set_plaits-1788"><a href="#Lace.set_plaits-1788"><span class="linenos">1788</span></a>
</span><span id="Lace.set_plaits-1789"><a href="#Lace.set_plaits-1789"><span class="linenos">1789</span></a><span class="sd">        Where used:</span>
</span><span id="Lace.set_plaits-1790"><a href="#Lace.set_plaits-1790"><span class="linenos">1790</span></a><span class="sd">        -----------</span>
</span><span id="Lace.set_plaits-1791"><a href="#Lace.set_plaits-1791"><span class="linenos">1791</span></a><span class="sd">            Lace.__init__</span>
</span><span id="Lace.set_plaits-1792"><a href="#Lace.set_plaits-1792"><span class="linenos">1792</span></a>
</span><span id="Lace.set_plaits-1793"><a href="#Lace.set_plaits-1793"><span class="linenos">1793</span></a><span class="sd">        Notes:</span>
</span><span id="Lace.set_plaits-1794"><a href="#Lace.set_plaits-1794"><span class="linenos">1794</span></a><span class="sd">        ------</span>
</span><span id="Lace.set_plaits-1795"><a href="#Lace.set_plaits-1795"><span class="linenos">1795</span></a><span class="sd">            This method is called by the Lace constructor.  It is not</span>
</span><span id="Lace.set_plaits-1796"><a href="#Lace.set_plaits-1796"><span class="linenos">1796</span></a><span class="sd">            for users to call directly. Without this method, the Lace</span>
</span><span id="Lace.set_plaits-1797"><a href="#Lace.set_plaits-1797"><span class="linenos">1797</span></a><span class="sd">            object cannot be created.</span>
</span><span id="Lace.set_plaits-1798"><a href="#Lace.set_plaits-1798"><span class="linenos">1798</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.set_plaits-1799"><a href="#Lace.set_plaits-1799"><span class="linenos">1799</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1800"><a href="#Lace.set_plaits-1800"><span class="linenos">1800</span></a>            <span class="k">return</span>
</span><span id="Lace.set_plaits-1801"><a href="#Lace.set_plaits-1801"><span class="linenos">1801</span></a>        <span class="n">plait_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_plaits-1802"><a href="#Lace.set_plaits-1802"><span class="linenos">1802</span></a>        <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_divisions</span><span class="p">():</span>
</span><span id="Lace.set_plaits-1803"><a href="#Lace.set_plaits-1803"><span class="linenos">1803</span></a>            <span class="n">merged_sections</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">_merged_sections</span><span class="p">()</span>
</span><span id="Lace.set_plaits-1804"><a href="#Lace.set_plaits-1804"><span class="linenos">1804</span></a>            <span class="k">for</span> <span class="n">merged</span> <span class="ow">in</span> <span class="n">merged_sections</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1805"><a href="#Lace.set_plaits-1805"><span class="linenos">1805</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">merged</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Lace.set_plaits-1806"><a href="#Lace.set_plaits-1806"><span class="linenos">1806</span></a>
</span><span id="Lace.set_plaits-1807"><a href="#Lace.set_plaits-1807"><span class="linenos">1807</span></a>        <span class="c1"># connect the open ends of the polyline_shapes</span>
</span><span id="Lace.set_plaits-1808"><a href="#Lace.set_plaits-1808"><span class="linenos">1808</span></a>        <span class="k">for</span> <span class="n">ppoly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_poly_list</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1809"><a href="#Lace.set_plaits-1809"><span class="linenos">1809</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1810"><a href="#Lace.set_plaits-1810"><span class="linenos">1810</span></a>                <span class="n">polyline1</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1811"><a href="#Lace.set_plaits-1811"><span class="linenos">1811</span></a>                <span class="n">polyline2</span> <span class="o">=</span> <span class="n">ppoly</span><span class="o">.</span><span class="n">offset_poly_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1812"><a href="#Lace.set_plaits-1812"><span class="linenos">1812</span></a>                <span class="n">p1_start_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1813"><a href="#Lace.set_plaits-1813"><span class="linenos">1813</span></a>                <span class="n">p1_end_x</span> <span class="o">=</span> <span class="n">polyline1</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1814"><a href="#Lace.set_plaits-1814"><span class="linenos">1814</span></a>                <span class="n">p2_start_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1815"><a href="#Lace.set_plaits-1815"><span class="linenos">1815</span></a>                <span class="n">p2_end_x</span> <span class="o">=</span> <span class="n">polyline2</span><span class="o">.</span><span class="n">intersections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1816"><a href="#Lace.set_plaits-1816"><span class="linenos">1816</span></a>
</span><span id="Lace.set_plaits-1817"><a href="#Lace.set_plaits-1817"><span class="linenos">1817</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_start_x</span><span class="p">,</span> <span class="n">p2_start_x</span><span class="p">))</span>
</span><span id="Lace.set_plaits-1818"><a href="#Lace.set_plaits-1818"><span class="linenos">1818</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1_end_x</span><span class="p">,</span> <span class="n">p2_end_x</span><span class="p">))</span>
</span><span id="Lace.set_plaits-1819"><a href="#Lace.set_plaits-1819"><span class="linenos">1819</span></a>        <span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_offset_sections</span><span class="p">():</span>
</span><span id="Lace.set_plaits-1820"><a href="#Lace.set_plaits-1820"><span class="linenos">1820</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_over</span> <span class="ow">and</span> <span class="n">sec</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1821"><a href="#Lace.set_plaits-1821"><span class="linenos">1821</span></a>                <span class="n">plait_sections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sec</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">sec</span><span class="o">.</span><span class="n">end</span><span class="p">))</span>
</span><span id="Lace.set_plaits-1822"><a href="#Lace.set_plaits-1822"><span class="linenos">1822</span></a>
</span><span id="Lace.set_plaits-1823"><a href="#Lace.set_plaits-1823"><span class="linenos">1823</span></a>        <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">plait_sections</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1824"><a href="#Lace.set_plaits-1824"><span class="linenos">1824</span></a>        <span class="n">cycles</span> <span class="o">=</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1825"><a href="#Lace.set_plaits-1825"><span class="linenos">1825</span></a>        <span class="n">plaits</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.set_plaits-1826"><a href="#Lace.set_plaits-1826"><span class="linenos">1826</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Lace.set_plaits-1827"><a href="#Lace.set_plaits-1827"><span class="linenos">1827</span></a>        <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1828"><a href="#Lace.set_plaits-1828"><span class="linenos">1828</span></a>            <span class="n">cycle</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1829"><a href="#Lace.set_plaits-1829"><span class="linenos">1829</span></a>            <span class="n">dup</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Lace.set_plaits-1830"><a href="#Lace.set_plaits-1830"><span class="linenos">1830</span></a>            <span class="n">plait</span> <span class="o">=</span> <span class="p">[</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Lace.set_plaits-1831"><a href="#Lace.set_plaits-1831"><span class="linenos">1831</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Lace.set_plaits-1832"><a href="#Lace.set_plaits-1832"><span class="linenos">1832</span></a>                <span class="n">last</span> <span class="o">=</span> <span class="n">plait</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1833"><a href="#Lace.set_plaits-1833"><span class="linenos">1833</span></a>                <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">dup</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1834"><a href="#Lace.set_plaits-1834"><span class="linenos">1834</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1835"><a href="#Lace.set_plaits-1835"><span class="linenos">1835</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Lace.set_plaits-1836"><a href="#Lace.set_plaits-1836"><span class="linenos">1836</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1837"><a href="#Lace.set_plaits-1837"><span class="linenos">1837</span></a>                        <span class="k">break</span>
</span><span id="Lace.set_plaits-1838"><a href="#Lace.set_plaits-1838"><span class="linenos">1838</span></a>                    <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1839"><a href="#Lace.set_plaits-1839"><span class="linenos">1839</span></a>                        <span class="n">plait</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace.set_plaits-1840"><a href="#Lace.set_plaits-1840"><span class="linenos">1840</span></a>                        <span class="n">dup</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1841"><a href="#Lace.set_plaits-1841"><span class="linenos">1841</span></a>                        <span class="k">break</span>
</span><span id="Lace.set_plaits-1842"><a href="#Lace.set_plaits-1842"><span class="linenos">1842</span></a>            <span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plait</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1843"><a href="#Lace.set_plaits-1843"><span class="linenos">1843</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Lace.set_plaits-1844"><a href="#Lace.set_plaits-1844"><span class="linenos">1844</span></a>        <span class="n">d_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_intersections</span>
</span><span id="Lace.set_plaits-1845"><a href="#Lace.set_plaits-1845"><span class="linenos">1845</span></a>        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="n">plaits</span><span class="p">:</span>
</span><span id="Lace.set_plaits-1846"><a href="#Lace.set_plaits-1846"><span class="linenos">1846</span></a>            <span class="n">intersections</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_x</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plait</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1847"><a href="#Lace.set_plaits-1847"><span class="linenos">1847</span></a>            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intersections</span><span class="p">]</span>
</span><span id="Lace.set_plaits-1848"><a href="#Lace.set_plaits-1848"><span class="linenos">1848</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
</span><span id="Lace.set_plaits-1849"><a href="#Lace.set_plaits-1849"><span class="linenos">1849</span></a>                <span class="n">vertices</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace.set_plaits-1850"><a href="#Lace.set_plaits-1850"><span class="linenos">1850</span></a>                <span class="n">plait</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Lace.set_plaits-1851"><a href="#Lace.set_plaits-1851"><span class="linenos">1851</span></a>            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Lace.set_plaits-1852"><a href="#Lace.set_plaits-1852"><span class="linenos">1852</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span>
</span><span id="Lace.set_plaits-1853"><a href="#Lace.set_plaits-1853"><span class="linenos">1853</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">gold</span>
</span><span id="Lace.set_plaits-1854"><a href="#Lace.set_plaits-1854"><span class="linenos">1854</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">inner_lines</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Lace.set_plaits-1855"><a href="#Lace.set_plaits-1855"><span class="linenos">1855</span></a>            <span class="n">shape</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">PLAIT</span>
</span><span id="Lace.set_plaits-1856"><a href="#Lace.set_plaits-1856"><span class="linenos">1856</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plaits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Populate the self.plaits list with Plait objects. Plaits are
optional for drawing. They form the under/over interlacing. They
are created if the "with_plaits" argument is set to be True in
the constructor. with_plaits is True by default but this can be
changed by setting the auto_plaits value to False in the
settings.py This method can be called by the user to create the
plaits after the creation of the Lace object if they were not
created initally.</p>

<ul>
<li>Can be called by users.</li>
</ul>

<h2 id="arguments">Arguments:</h2>

<pre><code>None
</code></pre>

<h2 id="return">Return:</h2>

<pre><code>None
</code></pre>

<h2 id="side-effects">Side Effects:</h2>

<pre><code>* self.plaits is populated with Plait objects.
</code></pre>

<h2 id="prerequisites">Prerequisites:</h2>

<pre><code>self.polyline and self.parallel_poly_list must be populated.
self.divisions and self.intersections must be populated.
self.overlaps must be populated.
</code></pre>

<h2 id="where-used">Where used:</h2>

<pre><code><a href="#Lace.__init__">Lace.__init__</a>
</code></pre>

<h2 id="notes">Notes:</h2>

<pre><code>This method is called by the Lace constructor.  It is not
for users to call directly. Without this method, the Lace
object cannot be created.
</code></pre>
</div>


                            </div>
                            <div id="Lace.fragment_edge_graph" class="classattr">
                                        <input id="Lace.fragment_edge_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fragment_edge_graph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>:</span></span>

                <label class="view-source-button" for="Lace.fragment_edge_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.fragment_edge_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.fragment_edge_graph-2003"><a href="#Lace.fragment_edge_graph-2003"><span class="linenos">2003</span></a>    <span class="k">def</span> <span class="nf">fragment_edge_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="Lace.fragment_edge_graph-2004"><a href="#Lace.fragment_edge_graph-2004"><span class="linenos">2004</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.fragment_edge_graph-2005"><a href="#Lace.fragment_edge_graph-2005"><span class="linenos">2005</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="Lace.fragment_edge_graph-2006"><a href="#Lace.fragment_edge_graph-2006"><span class="linenos">2006</span></a><span class="sd">        If two fragments have a &quot;common&quot; division then they are connected.</span>
</span><span id="Lace.fragment_edge_graph-2007"><a href="#Lace.fragment_edge_graph-2007"><span class="linenos">2007</span></a>
</span><span id="Lace.fragment_edge_graph-2008"><a href="#Lace.fragment_edge_graph-2008"><span class="linenos">2008</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.fragment_edge_graph-2009"><a href="#Lace.fragment_edge_graph-2009"><span class="linenos">2009</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="Lace.fragment_edge_graph-2010"><a href="#Lace.fragment_edge_graph-2010"><span class="linenos">2010</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.fragment_edge_graph-2011"><a href="#Lace.fragment_edge_graph-2011"><span class="linenos">2011</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace.fragment_edge_graph-2012"><a href="#Lace.fragment_edge_graph-2012"><span class="linenos">2012</span></a>        <span class="n">fragments</span> <span class="o">=</span> <span class="p">[(</span><span class="n">f</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">]</span>
</span><span id="Lace.fragment_edge_graph-2013"><a href="#Lace.fragment_edge_graph-2013"><span class="linenos">2013</span></a>        <span class="n">fragments</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Lace.fragment_edge_graph-2014"><a href="#Lace.fragment_edge_graph-2014"><span class="linenos">2014</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
</span><span id="Lace.fragment_edge_graph-2015"><a href="#Lace.fragment_edge_graph-2015"><span class="linenos">2015</span></a>            <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">divisions</span><span class="p">:</span>
</span><span id="Lace.fragment_edge_graph-2016"><a href="#Lace.fragment_edge_graph-2016"><span class="linenos">2016</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span> <span class="ow">and</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span><span class="p">:</span>
</span><span id="Lace.fragment_edge_graph-2017"><a href="#Lace.fragment_edge_graph-2017"><span class="linenos">2017</span></a>                    <span class="n">fragment2</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">fragment</span>
</span><span id="Lace.fragment_edge_graph-2018"><a href="#Lace.fragment_edge_graph-2018"><span class="linenos">2018</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace.fragment_edge_graph-2019"><a href="#Lace.fragment_edge_graph-2019"><span class="linenos">2019</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">fragment2</span><span class="p">)</span>
</span><span id="Lace.fragment_edge_graph-2020"><a href="#Lace.fragment_edge_graph-2020"><span class="linenos">2020</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">fragment2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="n">division</span><span class="p">)</span>
</span><span id="Lace.fragment_edge_graph-2021"><a href="#Lace.fragment_edge_graph-2021"><span class="linenos">2021</span></a>        <span class="k">return</span> <span class="n">G</span>
</span></pre></div>


            <div class="docstring"><p>Return a networkx graph of the connected fragments.
If two fragments have a "common" division then they are connected.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>nx.Graph: Graph of connected fragments.</p>
</blockquote>
</div>


                            </div>
                            <div id="Lace.fragment_vertex_graph" class="classattr">
                                        <input id="Lace.fragment_vertex_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fragment_vertex_graph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>:</span></span>

                <label class="view-source-button" for="Lace.fragment_vertex_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Lace.fragment_vertex_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Lace.fragment_vertex_graph-2023"><a href="#Lace.fragment_vertex_graph-2023"><span class="linenos">2023</span></a>    <span class="k">def</span> <span class="nf">fragment_vertex_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2024"><a href="#Lace.fragment_vertex_graph-2024"><span class="linenos">2024</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Lace.fragment_vertex_graph-2025"><a href="#Lace.fragment_vertex_graph-2025"><span class="linenos">2025</span></a><span class="sd">        Return a networkx graph of the connected fragments.</span>
</span><span id="Lace.fragment_vertex_graph-2026"><a href="#Lace.fragment_vertex_graph-2026"><span class="linenos">2026</span></a><span class="sd">        If two fragments have a &quot;common&quot; vertex then they are connected.</span>
</span><span id="Lace.fragment_vertex_graph-2027"><a href="#Lace.fragment_vertex_graph-2027"><span class="linenos">2027</span></a>
</span><span id="Lace.fragment_vertex_graph-2028"><a href="#Lace.fragment_vertex_graph-2028"><span class="linenos">2028</span></a><span class="sd">        Returns:</span>
</span><span id="Lace.fragment_vertex_graph-2029"><a href="#Lace.fragment_vertex_graph-2029"><span class="linenos">2029</span></a><span class="sd">            nx.Graph: Graph of connected fragments.</span>
</span><span id="Lace.fragment_vertex_graph-2030"><a href="#Lace.fragment_vertex_graph-2030"><span class="linenos">2030</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Lace.fragment_vertex_graph-2031"><a href="#Lace.fragment_vertex_graph-2031"><span class="linenos">2031</span></a>        <span class="k">def</span> <span class="nf">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">):</span>
</span><span id="Lace.fragment_vertex_graph-2032"><a href="#Lace.fragment_vertex_graph-2032"><span class="linenos">2032</span></a>            <span class="n">division</span> <span class="o">=</span> <span class="n">intersection</span><span class="o">.</span><span class="n">division</span>
</span><span id="Lace.fragment_vertex_graph-2033"><a href="#Lace.fragment_vertex_graph-2033"><span class="linenos">2033</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2034"><a href="#Lace.fragment_vertex_graph-2034"><span class="linenos">2034</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Lace.fragment_vertex_graph-2035"><a href="#Lace.fragment_vertex_graph-2035"><span class="linenos">2035</span></a>            <span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">]</span>
</span><span id="Lace.fragment_vertex_graph-2036"><a href="#Lace.fragment_vertex_graph-2036"><span class="linenos">2036</span></a>            <span class="n">start_division_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace.fragment_vertex_graph-2037"><a href="#Lace.fragment_vertex_graph-2037"><span class="linenos">2037</span></a>            <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2038"><a href="#Lace.fragment_vertex_graph-2038"><span class="linenos">2038</span></a>                <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace.fragment_vertex_graph-2039"><a href="#Lace.fragment_vertex_graph-2039"><span class="linenos">2039</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2040"><a href="#Lace.fragment_vertex_graph-2040"><span class="linenos">2040</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Lace.fragment_vertex_graph-2041"><a href="#Lace.fragment_vertex_graph-2041"><span class="linenos">2041</span></a>            <span class="k">while</span> <span class="n">twin_id</span> <span class="o">!=</span> <span class="n">start_division_id</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2042"><a href="#Lace.fragment_vertex_graph-2042"><span class="linenos">2042</span></a>                <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2043"><a href="#Lace.fragment_vertex_graph-2043"><span class="linenos">2043</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="Lace.fragment_vertex_graph-2044"><a href="#Lace.fragment_vertex_graph-2044"><span class="linenos">2044</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace.fragment_vertex_graph-2045"><a href="#Lace.fragment_vertex_graph-2045"><span class="linenos">2045</span></a>                    <span class="n">twin_id</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span><span class="o">.</span><span class="n">id</span>
</span><span id="Lace.fragment_vertex_graph-2046"><a href="#Lace.fragment_vertex_graph-2046"><span class="linenos">2046</span></a>                    <span class="n">division</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">twin</span>
</span><span id="Lace.fragment_vertex_graph-2047"><a href="#Lace.fragment_vertex_graph-2047"><span class="linenos">2047</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2048"><a href="#Lace.fragment_vertex_graph-2048"><span class="linenos">2048</span></a>                    <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">]:</span>
</span><span id="Lace.fragment_vertex_graph-2049"><a href="#Lace.fragment_vertex_graph-2049"><span class="linenos">2049</span></a>                        <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">fragment</span><span class="p">)</span>
</span><span id="Lace.fragment_vertex_graph-2050"><a href="#Lace.fragment_vertex_graph-2050"><span class="linenos">2050</span></a>                    <span class="k">break</span>
</span><span id="Lace.fragment_vertex_graph-2051"><a href="#Lace.fragment_vertex_graph-2051"><span class="linenos">2051</span></a>
</span><span id="Lace.fragment_vertex_graph-2052"><a href="#Lace.fragment_vertex_graph-2052"><span class="linenos">2052</span></a>            <span class="k">return</span> <span class="n">fragments</span>
</span><span id="Lace.fragment_vertex_graph-2053"><a href="#Lace.fragment_vertex_graph-2053"><span class="linenos">2053</span></a>
</span><span id="Lace.fragment_vertex_graph-2054"><a href="#Lace.fragment_vertex_graph-2054"><span class="linenos">2054</span></a>        <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Lace.fragment_vertex_graph-2055"><a href="#Lace.fragment_vertex_graph-2055"><span class="linenos">2055</span></a>        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2056"><a href="#Lace.fragment_vertex_graph-2056"><span class="linenos">2056</span></a>            <span class="k">for</span> <span class="n">intersection</span> <span class="ow">in</span> <span class="n">fragment</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2057"><a href="#Lace.fragment_vertex_graph-2057"><span class="linenos">2057</span></a>                <span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_neighbours</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span>
</span><span id="Lace.fragment_vertex_graph-2058"><a href="#Lace.fragment_vertex_graph-2058"><span class="linenos">2058</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_edge_graph</span><span class="p">()</span>
</span><span id="Lace.fragment_vertex_graph-2059"><a href="#Lace.fragment_vertex_graph-2059"><span class="linenos">2059</span></a>        <span class="n">G2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span><span id="Lace.fragment_vertex_graph-2060"><a href="#Lace.fragment_vertex_graph-2060"><span class="linenos">2060</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2061"><a href="#Lace.fragment_vertex_graph-2061"><span class="linenos">2061</span></a>            <span class="k">if</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2062"><a href="#Lace.fragment_vertex_graph-2062"><span class="linenos">2062</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2063"><a href="#Lace.fragment_vertex_graph-2063"><span class="linenos">2063</span></a>                    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Lace.fragment_vertex_graph-2064"><a href="#Lace.fragment_vertex_graph-2064"><span class="linenos">2064</span></a>                        <span class="n">ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">])</span>
</span><span id="Lace.fragment_vertex_graph-2065"><a href="#Lace.fragment_vertex_graph-2065"><span class="linenos">2065</span></a>                        <span class="k">if</span> <span class="n">ids</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="Lace.fragment_vertex_graph-2066"><a href="#Lace.fragment_vertex_graph-2066"><span class="linenos">2066</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Lace.fragment_vertex_graph-2067"><a href="#Lace.fragment_vertex_graph-2067"><span class="linenos">2067</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fragment</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Lace.fragment_vertex_graph-2068"><a href="#Lace.fragment_vertex_graph-2068"><span class="linenos">2068</span></a>                            <span class="n">G2</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">ids</span><span class="p">)</span>
</span><span id="Lace.fragment_vertex_graph-2069"><a href="#Lace.fragment_vertex_graph-2069"><span class="linenos">2069</span></a>        <span class="k">return</span> <span class="n">G2</span>
</span></pre></div>


            <div class="docstring"><p>Return a networkx graph of the connected fragments.
If two fragments have a "common" vertex then they are connected.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>nx.Graph: Graph of connected fragments.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../graphics/batch.html#Batch">simetri.graphics.batch.Batch</a></dt>
                                <dd id="Lace.type" class="variable"><a href="../graphics/batch.html#Batch.type">type</a></dd>
                <dd id="Lace.modifiers" class="variable"><a href="../graphics/batch.html#Batch.modifiers">modifiers</a></dd>
                <dd id="Lace.blend_mode" class="variable"><a href="../graphics/batch.html#Batch.blend_mode">blend_mode</a></dd>
                <dd id="Lace.alpha" class="variable"><a href="../graphics/batch.html#Batch.alpha">alpha</a></dd>
                <dd id="Lace.line_alpha" class="variable"><a href="../graphics/batch.html#Batch.line_alpha">line_alpha</a></dd>
                <dd id="Lace.fill_alpha" class="variable"><a href="../graphics/batch.html#Batch.fill_alpha">fill_alpha</a></dd>
                <dd id="Lace.text_alpha" class="variable"><a href="../graphics/batch.html#Batch.text_alpha">text_alpha</a></dd>
                <dd id="Lace.clip" class="variable"><a href="../graphics/batch.html#Batch.clip">clip</a></dd>
                <dd id="Lace.mask" class="variable"><a href="../graphics/batch.html#Batch.mask">mask</a></dd>
                <dd id="Lace.even_odd_rule" class="variable"><a href="../graphics/batch.html#Batch.even_odd_rule">even_odd_rule</a></dd>
                <dd id="Lace.blend_group" class="variable"><a href="../graphics/batch.html#Batch.blend_group">blend_group</a></dd>
                <dd id="Lace.transparency_group" class="variable"><a href="../graphics/batch.html#Batch.transparency_group">transparency_group</a></dd>
                <dd id="Lace.set_attribs" class="function"><a href="../graphics/batch.html#Batch.set_attribs">set_attribs</a></dd>
                <dd id="Lace.set_batch_attr" class="function"><a href="../graphics/batch.html#Batch.set_batch_attr">set_batch_attr</a></dd>
                <dd id="Lace.proximity" class="function"><a href="../graphics/batch.html#Batch.proximity">proximity</a></dd>
                <dd id="Lace.append" class="function"><a href="../graphics/batch.html#Batch.append">append</a></dd>
                <dd id="Lace.reverse" class="function"><a href="../graphics/batch.html#Batch.reverse">reverse</a></dd>
                <dd id="Lace.insert" class="function"><a href="../graphics/batch.html#Batch.insert">insert</a></dd>
                <dd id="Lace.remove" class="function"><a href="../graphics/batch.html#Batch.remove">remove</a></dd>
                <dd id="Lace.pop" class="function"><a href="../graphics/batch.html#Batch.pop">pop</a></dd>
                <dd id="Lace.clear" class="function"><a href="../graphics/batch.html#Batch.clear">clear</a></dd>
                <dd id="Lace.extend" class="function"><a href="../graphics/batch.html#Batch.extend">extend</a></dd>
                <dd id="Lace.iter_elements" class="function"><a href="../graphics/batch.html#Batch.iter_elements">iter_elements</a></dd>
                <dd id="Lace.all_elements" class="variable"><a href="../graphics/batch.html#Batch.all_elements">all_elements</a></dd>
                <dd id="Lace.all_shapes" class="variable"><a href="../graphics/batch.html#Batch.all_shapes">all_shapes</a></dd>
                <dd id="Lace.all_vertices" class="variable"><a href="../graphics/batch.html#Batch.all_vertices">all_vertices</a></dd>
                <dd id="Lace.all_segments" class="variable"><a href="../graphics/batch.html#Batch.all_segments">all_segments</a></dd>
                <dd id="Lace.as_graph" class="function"><a href="../graphics/batch.html#Batch.as_graph">as_graph</a></dd>
                <dd id="Lace.graph_summary" class="function"><a href="../graphics/batch.html#Batch.graph_summary">graph_summary</a></dd>
                <dd id="Lace.merge_shapes" class="function"><a href="../graphics/batch.html#Batch.merge_shapes">merge_shapes</a></dd>
                <dd id="Lace.all_polygons" class="function"><a href="../graphics/batch.html#Batch.all_polygons">all_polygons</a></dd>
                <dd id="Lace.b_box" class="variable"><a href="../graphics/batch.html#Batch.b_box">b_box</a></dd>

            </div>
            <div><dt><a href="../graphics/core.html#Base">simetri.graphics.core.Base</a></dt>
                                <dd id="Lace.translate" class="function"><a href="../graphics/core.html#Base.translate">translate</a></dd>
                <dd id="Lace.translate_along" class="function"><a href="../graphics/core.html#Base.translate_along">translate_along</a></dd>
                <dd id="Lace.rotate" class="function"><a href="../graphics/core.html#Base.rotate">rotate</a></dd>
                <dd id="Lace.mirror" class="function"><a href="../graphics/core.html#Base.mirror">mirror</a></dd>
                <dd id="Lace.glide" class="function"><a href="../graphics/core.html#Base.glide">glide</a></dd>
                <dd id="Lace.scale" class="function"><a href="../graphics/core.html#Base.scale">scale</a></dd>
                <dd id="Lace.shear" class="function"><a href="../graphics/core.html#Base.shear">shear</a></dd>
                <dd id="Lace.reset_xform_matrix" class="function"><a href="../graphics/core.html#Base.reset_xform_matrix">reset_xform_matrix</a></dd>
                <dd id="Lace.transform" class="function"><a href="../graphics/core.html#Base.transform">transform</a></dd>
                <dd id="Lace.move_to" class="function"><a href="../graphics/core.html#Base.move_to">move_to</a></dd>
                <dd id="Lace.offset_line" class="function"><a href="../graphics/core.html#Base.offset_line">offset_line</a></dd>
                <dd id="Lace.offset_point" class="function"><a href="../graphics/core.html#Base.offset_point">offset_point</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="all_intersections">
                            <input id="all_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">all_intersections</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Division">Division</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">loom</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="all_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#all_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="all_intersections-2072"><a href="#all_intersections-2072"><span class="linenos">2072</span></a><span class="k">def</span> <span class="nf">all_intersections</span><span class="p">(</span>
</span><span id="all_intersections-2073"><a href="#all_intersections-2073"><span class="linenos">2073</span></a>    <span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Division</span><span class="p">],</span>
</span><span id="all_intersections-2074"><a href="#all_intersections-2074"><span class="linenos">2074</span></a>    <span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="all_intersections-2075"><a href="#all_intersections-2075"><span class="linenos">2075</span></a>    <span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="all_intersections-2076"><a href="#all_intersections-2076"><span class="linenos">2076</span></a>    <span class="n">loom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="all_intersections-2077"><a href="#all_intersections-2077"><span class="linenos">2077</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="all_intersections-2078"><a href="#all_intersections-2078"><span class="linenos">2078</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="all_intersections-2079"><a href="#all_intersections-2079"><span class="linenos">2079</span></a><span class="sd">    Find all intersections of the given divisions. Sweep-line algorithm</span>
</span><span id="all_intersections-2080"><a href="#all_intersections-2080"><span class="linenos">2080</span></a><span class="sd">    without a self-balancing tree. Instead of a self-balancing tree,</span>
</span><span id="all_intersections-2081"><a href="#all_intersections-2081"><span class="linenos">2081</span></a><span class="sd">    it uses a numpy array to sort and filter the divisions. For the</span>
</span><span id="all_intersections-2082"><a href="#all_intersections-2082"><span class="linenos">2082</span></a><span class="sd">    number of divisions that are commonly needed in a lace, this is</span>
</span><span id="all_intersections-2083"><a href="#all_intersections-2083"><span class="linenos">2083</span></a><span class="sd">    sufficiently fast. It is also more robust and much easier to</span>
</span><span id="all_intersections-2084"><a href="#all_intersections-2084"><span class="linenos">2084</span></a><span class="sd">    understand and debug. Tested with tens of thousands of divisions but</span>
</span><span id="all_intersections-2085"><a href="#all_intersections-2085"><span class="linenos">2085</span></a><span class="sd">    not millions. The book has a section on this algorithm.</span>
</span><span id="all_intersections-2086"><a href="#all_intersections-2086"><span class="linenos">2086</span></a><span class="sd">    simetri.geometry.py has another version (called</span>
</span><span id="all_intersections-2087"><a href="#all_intersections-2087"><span class="linenos">2087</span></a><span class="sd">    all_intersections) for finding intersections among a given</span>
</span><span id="all_intersections-2088"><a href="#all_intersections-2088"><span class="linenos">2088</span></a><span class="sd">    list of divisions.</span>
</span><span id="all_intersections-2089"><a href="#all_intersections-2089"><span class="linenos">2089</span></a>
</span><span id="all_intersections-2090"><a href="#all_intersections-2090"><span class="linenos">2090</span></a><span class="sd">    Arguments:</span>
</span><span id="all_intersections-2091"><a href="#all_intersections-2091"><span class="linenos">2091</span></a><span class="sd">    ----------</span>
</span><span id="all_intersections-2092"><a href="#all_intersections-2092"><span class="linenos">2092</span></a><span class="sd">        division_list: list of Division objects.</span>
</span><span id="all_intersections-2093"><a href="#all_intersections-2093"><span class="linenos">2093</span></a>
</span><span id="all_intersections-2094"><a href="#all_intersections-2094"><span class="linenos">2094</span></a><span class="sd">    Side Effects:</span>
</span><span id="all_intersections-2095"><a href="#all_intersections-2095"><span class="linenos">2095</span></a><span class="sd">    -------------</span>
</span><span id="all_intersections-2096"><a href="#all_intersections-2096"><span class="linenos">2096</span></a><span class="sd">        * Modifies the given division objects (in the division_list) in place</span>
</span><span id="all_intersections-2097"><a href="#all_intersections-2097"><span class="linenos">2097</span></a><span class="sd">            by adding the intersections to the divisions&#39; &quot;intersections&quot;</span>
</span><span id="all_intersections-2098"><a href="#all_intersections-2098"><span class="linenos">2098</span></a><span class="sd">            attribute.</span>
</span><span id="all_intersections-2099"><a href="#all_intersections-2099"><span class="linenos">2099</span></a><span class="sd">        * Updates the d_intersections</span>
</span><span id="all_intersections-2100"><a href="#all_intersections-2100"><span class="linenos">2100</span></a><span class="sd">        * Updates the d_connections</span>
</span><span id="all_intersections-2101"><a href="#all_intersections-2101"><span class="linenos">2101</span></a>
</span><span id="all_intersections-2102"><a href="#all_intersections-2102"><span class="linenos">2102</span></a><span class="sd">    Return:</span>
</span><span id="all_intersections-2103"><a href="#all_intersections-2103"><span class="linenos">2103</span></a><span class="sd">    --------</span>
</span><span id="all_intersections-2104"><a href="#all_intersections-2104"><span class="linenos">2104</span></a><span class="sd">        A list of all intersection objects among the given division</span>
</span><span id="all_intersections-2105"><a href="#all_intersections-2105"><span class="linenos">2105</span></a><span class="sd">        list.</span>
</span><span id="all_intersections-2106"><a href="#all_intersections-2106"><span class="linenos">2106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="all_intersections-2107"><a href="#all_intersections-2107"><span class="linenos">2107</span></a>    <span class="c1"># register fake intersections at the endpoints of the open lines</span>
</span><span id="all_intersections-2108"><a href="#all_intersections-2108"><span class="linenos">2108</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="all_intersections-2109"><a href="#all_intersections-2109"><span class="linenos">2109</span></a>        <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="all_intersections-2110"><a href="#all_intersections-2110"><span class="linenos">2110</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="all_intersections-2111"><a href="#all_intersections-2111"><span class="linenos">2111</span></a>                <span class="n">d_intersections</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="all_intersections-2112"><a href="#all_intersections-2112"><span class="linenos">2112</span></a>
</span><span id="all_intersections-2113"><a href="#all_intersections-2113"><span class="linenos">2113</span></a>    <span class="c1"># All objects are assigned an integer id attribute when they are created</span>
</span><span id="all_intersections-2114"><a href="#all_intersections-2114"><span class="linenos">2114</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
</span><span id="all_intersections-2115"><a href="#all_intersections-2115"><span class="linenos">2115</span></a>        <span class="p">[</span><span class="n">flatten</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">]</span>
</span><span id="all_intersections-2116"><a href="#all_intersections-2116"><span class="linenos">2116</span></a>    <span class="p">)</span>
</span><span id="all_intersections-2117"><a href="#all_intersections-2117"><span class="linenos">2117</span></a>    <span class="n">n_divisions</span> <span class="o">=</span> <span class="n">division_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of divisions</span>
</span><span id="all_intersections-2118"><a href="#all_intersections-2118"><span class="linenos">2118</span></a>    <span class="c1"># precompute the min and max x and y values for each division</span>
</span><span id="all_intersections-2119"><a href="#all_intersections-2119"><span class="linenos">2119</span></a>    <span class="c1"># these will be used with the sweep line algorithm</span>
</span><span id="all_intersections-2120"><a href="#all_intersections-2120"><span class="linenos">2120</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="all_intersections-2121"><a href="#all_intersections-2121"><span class="linenos">2121</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="all_intersections-2122"><a href="#all_intersections-2122"><span class="linenos">2122</span></a>    <span class="p">)</span>
</span><span id="all_intersections-2123"><a href="#all_intersections-2123"><span class="linenos">2123</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="all_intersections-2124"><a href="#all_intersections-2124"><span class="linenos">2124</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="all_intersections-2125"><a href="#all_intersections-2125"><span class="linenos">2125</span></a>    <span class="p">)</span>
</span><span id="all_intersections-2126"><a href="#all_intersections-2126"><span class="linenos">2126</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="all_intersections-2127"><a href="#all_intersections-2127"><span class="linenos">2127</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="all_intersections-2128"><a href="#all_intersections-2128"><span class="linenos">2128</span></a>    <span class="p">)</span>
</span><span id="all_intersections-2129"><a href="#all_intersections-2129"><span class="linenos">2129</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="all_intersections-2130"><a href="#all_intersections-2130"><span class="linenos">2130</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="all_intersections-2131"><a href="#all_intersections-2131"><span class="linenos">2131</span></a>    <span class="p">)</span>
</span><span id="all_intersections-2132"><a href="#all_intersections-2132"><span class="linenos">2132</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">division_array</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-2133"><a href="#all_intersections-2133"><span class="linenos">2133</span></a>    <span class="n">d_divisions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="all_intersections-2134"><a href="#all_intersections-2134"><span class="linenos">2134</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="all_intersections-2135"><a href="#all_intersections-2135"><span class="linenos">2135</span></a>        <span class="n">d_divisions</span><span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="all_intersections-2136"><a href="#all_intersections-2136"><span class="linenos">2136</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="all_intersections-2137"><a href="#all_intersections-2137"><span class="linenos">2137</span></a>    <span class="c1"># sort by xmin values</span>
</span><span id="all_intersections-2138"><a href="#all_intersections-2138"><span class="linenos">2138</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">division_array</span><span class="p">[:,</span> <span class="n">i_xmin</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="all_intersections-2139"><a href="#all_intersections-2139"><span class="linenos">2139</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_intersections-2140"><a href="#all_intersections-2140"><span class="linenos">2140</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_divisions</span><span class="p">):</span>
</span><span id="all_intersections-2141"><a href="#all_intersections-2141"><span class="linenos">2141</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="all_intersections-2142"><a href="#all_intersections-2142"><span class="linenos">2142</span></a>        <span class="n">division1_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="all_intersections-2143"><a href="#all_intersections-2143"><span class="linenos">2143</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># search should start from the next division</span>
</span><span id="all_intersections-2144"><a href="#all_intersections-2144"><span class="linenos">2144</span></a>        <span class="c1"># filter the array by checking if the divisions&#39; bounding-boxes are</span>
</span><span id="all_intersections-2145"><a href="#all_intersections-2145"><span class="linenos">2145</span></a>        <span class="c1"># overlapping with the bounding-box of the current division</span>
</span><span id="all_intersections-2146"><a href="#all_intersections-2146"><span class="linenos">2146</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="all_intersections-2147"><a href="#all_intersections-2147"><span class="linenos">2147</span></a>            <span class="p">(</span>
</span><span id="all_intersections-2148"><a href="#all_intersections-2148"><span class="linenos">2148</span></a>                <span class="p">(</span>
</span><span id="all_intersections-2149"><a href="#all_intersections-2149"><span class="linenos">2149</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="all_intersections-2150"><a href="#all_intersections-2150"><span class="linenos">2150</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="all_intersections-2151"><a href="#all_intersections-2151"><span class="linenos">2151</span></a>                <span class="p">)</span>
</span><span id="all_intersections-2152"><a href="#all_intersections-2152"><span class="linenos">2152</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="all_intersections-2153"><a href="#all_intersections-2153"><span class="linenos">2153</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="all_intersections-2154"><a href="#all_intersections-2154"><span class="linenos">2154</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="all_intersections-2155"><a href="#all_intersections-2155"><span class="linenos">2155</span></a>                <span class="p">)</span>
</span><span id="all_intersections-2156"><a href="#all_intersections-2156"><span class="linenos">2156</span></a>            <span class="p">)</span>
</span><span id="all_intersections-2157"><a href="#all_intersections-2157"><span class="linenos">2157</span></a>        <span class="p">]</span>
</span><span id="all_intersections-2158"><a href="#all_intersections-2158"><span class="linenos">2158</span></a>        <span class="k">for</span> <span class="n">candid</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="all_intersections-2159"><a href="#all_intersections-2159"><span class="linenos">2159</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[</span><span class="n">i_id</span><span class="p">]</span>
</span><span id="all_intersections-2160"><a href="#all_intersections-2160"><span class="linenos">2160</span></a>            <span class="n">division2_vertices</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="all_intersections-2161"><a href="#all_intersections-2161"><span class="linenos">2161</span></a>            <span class="k">if</span> <span class="n">loom</span><span class="p">:</span>
</span><span id="all_intersections-2162"><a href="#all_intersections-2162"><span class="linenos">2162</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">division1_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="all_intersections-2163"><a href="#all_intersections-2163"><span class="linenos">2163</span></a>                <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">division2_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="all_intersections-2164"><a href="#all_intersections-2164"><span class="linenos">2164</span></a>                <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
</span><span id="all_intersections-2165"><a href="#all_intersections-2165"><span class="linenos">2165</span></a>                    <span class="k">continue</span>
</span><span id="all_intersections-2166"><a href="#all_intersections-2166"><span class="linenos">2166</span></a>            <span class="n">connection_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span>
</span><span id="all_intersections-2167"><a href="#all_intersections-2167"><span class="linenos">2167</span></a>                <span class="o">*</span><span class="n">division1_vertices</span><span class="p">,</span> <span class="o">*</span><span class="n">division2_vertices</span>
</span><span id="all_intersections-2168"><a href="#all_intersections-2168"><span class="linenos">2168</span></a>            <span class="p">)</span>
</span><span id="all_intersections-2169"><a href="#all_intersections-2169"><span class="linenos">2169</span></a>            <span class="k">if</span> <span class="n">connection_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="all_intersections-2170"><a href="#all_intersections-2170"><span class="linenos">2170</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span>
</span><span id="all_intersections-2171"><a href="#all_intersections-2171"><span class="linenos">2171</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
</span><span id="all_intersections-2172"><a href="#all_intersections-2172"><span class="linenos">2172</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span>
</span><span id="all_intersections-2173"><a href="#all_intersections-2173"><span class="linenos">2173</span></a>            <span class="p">]:</span>
</span><span id="all_intersections-2174"><a href="#all_intersections-2174"><span class="linenos">2174</span></a>                <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span> <span class="o">=</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id2</span><span class="p">)]</span>
</span><span id="all_intersections-2175"><a href="#all_intersections-2175"><span class="linenos">2175</span></a>                <span class="n">x_point__e1_2</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">division1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="all_intersections-2176"><a href="#all_intersections-2176"><span class="linenos">2176</span></a>                <span class="k">if</span> <span class="n">x_point__e1_2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="p">:</span>
</span><span id="all_intersections-2177"><a href="#all_intersections-2177"><span class="linenos">2177</span></a>                    <span class="n">inters_obj</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">x_point</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span><span class="p">)</span>
</span><span id="all_intersections-2178"><a href="#all_intersections-2178"><span class="linenos">2178</span></a>                    <span class="n">d_intersections</span><span class="p">[</span><span class="n">inters_obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="all_intersections-2179"><a href="#all_intersections-2179"><span class="linenos">2179</span></a>                    <span class="n">d_connections</span><span class="p">[</span><span class="n">x_point__e1_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="all_intersections-2180"><a href="#all_intersections-2180"><span class="linenos">2180</span></a>                    <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="all_intersections-2181"><a href="#all_intersections-2181"><span class="linenos">2181</span></a>                    <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="all_intersections-2182"><a href="#all_intersections-2182"><span class="linenos">2182</span></a>                    <span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="all_intersections-2183"><a href="#all_intersections-2183"><span class="linenos">2183</span></a>
</span><span id="all_intersections-2184"><a href="#all_intersections-2184"><span class="linenos">2184</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="all_intersections-2185"><a href="#all_intersections-2185"><span class="linenos">2185</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">_sort_intersections</span><span class="p">()</span>
</span><span id="all_intersections-2186"><a href="#all_intersections-2186"><span class="linenos">2186</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Find all intersections of the given divisions. Sweep-line algorithm
without a self-balancing tree. Instead of a self-balancing tree,
it uses a numpy array to sort and filter the divisions. For the
number of divisions that are commonly needed in a lace, this is
sufficiently fast. It is also more robust and much easier to
understand and debug. Tested with tens of thousands of divisions but
not millions. The book has a section on this algorithm.
simetri.geometry.py has another version (called
all_intersections) for finding intersections among a given
list of divisions.</p>

<h2 id="arguments">Arguments:</h2>

<pre><code>division_list: list of Division objects.
</code></pre>

<h2 id="side-effects">Side Effects:</h2>

<pre><code>* Modifies the given division objects (in the division_list) in place
    by adding the intersections to the divisions' "intersections"
    attribute.
* Updates the d_intersections
* Updates the d_connections
</code></pre>

<h2 id="return">Return:</h2>

<pre><code>A list of all intersection objects among the given division
list.
</code></pre>
</div>


                </section>
                <section id="merge_nodes">
                            <input id="merge_nodes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merge_nodes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Division">Division</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">loom</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Intersection">Intersection</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="merge_nodes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#merge_nodes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="merge_nodes-2189"><a href="#merge_nodes-2189"><span class="linenos">2189</span></a><span class="k">def</span> <span class="nf">merge_nodes</span><span class="p">(</span>
</span><span id="merge_nodes-2190"><a href="#merge_nodes-2190"><span class="linenos">2190</span></a>    <span class="n">division_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Division</span><span class="p">],</span>
</span><span id="merge_nodes-2191"><a href="#merge_nodes-2191"><span class="linenos">2191</span></a>    <span class="n">d_intersections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="merge_nodes-2192"><a href="#merge_nodes-2192"><span class="linenos">2192</span></a>    <span class="n">d_connections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">Intersection</span><span class="p">],</span>
</span><span id="merge_nodes-2193"><a href="#merge_nodes-2193"><span class="linenos">2193</span></a>    <span class="n">loom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="merge_nodes-2194"><a href="#merge_nodes-2194"><span class="linenos">2194</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Intersection</span><span class="p">]:</span>
</span><span id="merge_nodes-2195"><a href="#merge_nodes-2195"><span class="linenos">2195</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="merge_nodes-2196"><a href="#merge_nodes-2196"><span class="linenos">2196</span></a><span class="sd">    Find all intersections of the given divisions. Sweep-line algorithm</span>
</span><span id="merge_nodes-2197"><a href="#merge_nodes-2197"><span class="linenos">2197</span></a><span class="sd">    without a self-balancing tree. Instead of a self-balancing tree,</span>
</span><span id="merge_nodes-2198"><a href="#merge_nodes-2198"><span class="linenos">2198</span></a><span class="sd">    it uses a numpy array to sort and filter the divisions. For the</span>
</span><span id="merge_nodes-2199"><a href="#merge_nodes-2199"><span class="linenos">2199</span></a><span class="sd">    number of divisions that are commonly needed in a lace, this is</span>
</span><span id="merge_nodes-2200"><a href="#merge_nodes-2200"><span class="linenos">2200</span></a><span class="sd">    sufficiently fast. It is also more robust and much easier to</span>
</span><span id="merge_nodes-2201"><a href="#merge_nodes-2201"><span class="linenos">2201</span></a><span class="sd">    understand and debug. Tested with tens of thousands of divisions but</span>
</span><span id="merge_nodes-2202"><a href="#merge_nodes-2202"><span class="linenos">2202</span></a><span class="sd">    not millions. The book has a section on this algorithm.</span>
</span><span id="merge_nodes-2203"><a href="#merge_nodes-2203"><span class="linenos">2203</span></a><span class="sd">    simetri.geometry.py has another version (called</span>
</span><span id="merge_nodes-2204"><a href="#merge_nodes-2204"><span class="linenos">2204</span></a><span class="sd">    all_intersections) for finding intersections among a given</span>
</span><span id="merge_nodes-2205"><a href="#merge_nodes-2205"><span class="linenos">2205</span></a><span class="sd">    list of divisions.</span>
</span><span id="merge_nodes-2206"><a href="#merge_nodes-2206"><span class="linenos">2206</span></a>
</span><span id="merge_nodes-2207"><a href="#merge_nodes-2207"><span class="linenos">2207</span></a><span class="sd">    Arguments:</span>
</span><span id="merge_nodes-2208"><a href="#merge_nodes-2208"><span class="linenos">2208</span></a><span class="sd">    ----------</span>
</span><span id="merge_nodes-2209"><a href="#merge_nodes-2209"><span class="linenos">2209</span></a><span class="sd">        division_list: list of division objects.</span>
</span><span id="merge_nodes-2210"><a href="#merge_nodes-2210"><span class="linenos">2210</span></a>
</span><span id="merge_nodes-2211"><a href="#merge_nodes-2211"><span class="linenos">2211</span></a><span class="sd">    Side Effects:</span>
</span><span id="merge_nodes-2212"><a href="#merge_nodes-2212"><span class="linenos">2212</span></a><span class="sd">    -------------</span>
</span><span id="merge_nodes-2213"><a href="#merge_nodes-2213"><span class="linenos">2213</span></a><span class="sd">        * Modifies the given division objects (in the division_list) in place</span>
</span><span id="merge_nodes-2214"><a href="#merge_nodes-2214"><span class="linenos">2214</span></a><span class="sd">            by adding the intersections to the divisions&#39; &quot;intersections&quot;</span>
</span><span id="merge_nodes-2215"><a href="#merge_nodes-2215"><span class="linenos">2215</span></a><span class="sd">            attribute.</span>
</span><span id="merge_nodes-2216"><a href="#merge_nodes-2216"><span class="linenos">2216</span></a><span class="sd">        * Updates the d_intersections</span>
</span><span id="merge_nodes-2217"><a href="#merge_nodes-2217"><span class="linenos">2217</span></a><span class="sd">        * Updates the d_connections</span>
</span><span id="merge_nodes-2218"><a href="#merge_nodes-2218"><span class="linenos">2218</span></a>
</span><span id="merge_nodes-2219"><a href="#merge_nodes-2219"><span class="linenos">2219</span></a><span class="sd">    Return:</span>
</span><span id="merge_nodes-2220"><a href="#merge_nodes-2220"><span class="linenos">2220</span></a><span class="sd">    --------</span>
</span><span id="merge_nodes-2221"><a href="#merge_nodes-2221"><span class="linenos">2221</span></a><span class="sd">        A list of all intersection objects among the given division</span>
</span><span id="merge_nodes-2222"><a href="#merge_nodes-2222"><span class="linenos">2222</span></a><span class="sd">        list.</span>
</span><span id="merge_nodes-2223"><a href="#merge_nodes-2223"><span class="linenos">2223</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="merge_nodes-2224"><a href="#merge_nodes-2224"><span class="linenos">2224</span></a>    <span class="c1"># register fake intersections at the endpoints of the open lines</span>
</span><span id="merge_nodes-2225"><a href="#merge_nodes-2225"><span class="linenos">2225</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="merge_nodes-2226"><a href="#merge_nodes-2226"><span class="linenos">2226</span></a>        <span class="k">if</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="merge_nodes-2227"><a href="#merge_nodes-2227"><span class="linenos">2227</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">division</span><span class="o">.</span><span class="n">intersections</span><span class="p">:</span>
</span><span id="merge_nodes-2228"><a href="#merge_nodes-2228"><span class="linenos">2228</span></a>                <span class="n">d_intersections</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="merge_nodes-2229"><a href="#merge_nodes-2229"><span class="linenos">2229</span></a>
</span><span id="merge_nodes-2230"><a href="#merge_nodes-2230"><span class="linenos">2230</span></a>    <span class="c1"># All objects are assigned an integer id attribute when they are created</span>
</span><span id="merge_nodes-2231"><a href="#merge_nodes-2231"><span class="linenos">2231</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
</span><span id="merge_nodes-2232"><a href="#merge_nodes-2232"><span class="linenos">2232</span></a>        <span class="p">[</span><span class="n">flatten</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">]</span>
</span><span id="merge_nodes-2233"><a href="#merge_nodes-2233"><span class="linenos">2233</span></a>    <span class="p">)</span>
</span><span id="merge_nodes-2234"><a href="#merge_nodes-2234"><span class="linenos">2234</span></a>    <span class="n">n_divisions</span> <span class="o">=</span> <span class="n">division_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of divisions</span>
</span><span id="merge_nodes-2235"><a href="#merge_nodes-2235"><span class="linenos">2235</span></a>    <span class="c1"># precompute the min and max x and y values for each division</span>
</span><span id="merge_nodes-2236"><a href="#merge_nodes-2236"><span class="linenos">2236</span></a>    <span class="c1"># these will be used with the sweep line algorithm</span>
</span><span id="merge_nodes-2237"><a href="#merge_nodes-2237"><span class="linenos">2237</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="merge_nodes-2238"><a href="#merge_nodes-2238"><span class="linenos">2238</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="merge_nodes-2239"><a href="#merge_nodes-2239"><span class="linenos">2239</span></a>    <span class="p">)</span>
</span><span id="merge_nodes-2240"><a href="#merge_nodes-2240"><span class="linenos">2240</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="merge_nodes-2241"><a href="#merge_nodes-2241"><span class="linenos">2241</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="merge_nodes-2242"><a href="#merge_nodes-2242"><span class="linenos">2242</span></a>    <span class="p">)</span>
</span><span id="merge_nodes-2243"><a href="#merge_nodes-2243"><span class="linenos">2243</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="merge_nodes-2244"><a href="#merge_nodes-2244"><span class="linenos">2244</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="merge_nodes-2245"><a href="#merge_nodes-2245"><span class="linenos">2245</span></a>    <span class="p">)</span>
</span><span id="merge_nodes-2246"><a href="#merge_nodes-2246"><span class="linenos">2246</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">division_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">division_array</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="merge_nodes-2247"><a href="#merge_nodes-2247"><span class="linenos">2247</span></a>        <span class="n">n_divisions</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="merge_nodes-2248"><a href="#merge_nodes-2248"><span class="linenos">2248</span></a>    <span class="p">)</span>
</span><span id="merge_nodes-2249"><a href="#merge_nodes-2249"><span class="linenos">2249</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">division_array</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="merge_nodes-2250"><a href="#merge_nodes-2250"><span class="linenos">2250</span></a>    <span class="n">d_divisions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="merge_nodes-2251"><a href="#merge_nodes-2251"><span class="linenos">2251</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="merge_nodes-2252"><a href="#merge_nodes-2252"><span class="linenos">2252</span></a>        <span class="n">d_divisions</span><span class="p">[</span><span class="n">division</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">division</span>
</span><span id="merge_nodes-2253"><a href="#merge_nodes-2253"><span class="linenos">2253</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="merge_nodes-2254"><a href="#merge_nodes-2254"><span class="linenos">2254</span></a>    <span class="c1"># sort by xmin values</span>
</span><span id="merge_nodes-2255"><a href="#merge_nodes-2255"><span class="linenos">2255</span></a>    <span class="n">division_array</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">division_array</span><span class="p">[:,</span> <span class="n">i_xmin</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="merge_nodes-2256"><a href="#merge_nodes-2256"><span class="linenos">2256</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="merge_nodes-2257"><a href="#merge_nodes-2257"><span class="linenos">2257</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_divisions</span><span class="p">):</span>
</span><span id="merge_nodes-2258"><a href="#merge_nodes-2258"><span class="linenos">2258</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="merge_nodes-2259"><a href="#merge_nodes-2259"><span class="linenos">2259</span></a>        <span class="n">division1_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="merge_nodes-2260"><a href="#merge_nodes-2260"><span class="linenos">2260</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># search should start from the next division</span>
</span><span id="merge_nodes-2261"><a href="#merge_nodes-2261"><span class="linenos">2261</span></a>        <span class="c1"># filter the array by checking if the divisions&#39; bounding-boxes are</span>
</span><span id="merge_nodes-2262"><a href="#merge_nodes-2262"><span class="linenos">2262</span></a>        <span class="c1"># overlapping with the bounding-box of the current division</span>
</span><span id="merge_nodes-2263"><a href="#merge_nodes-2263"><span class="linenos">2263</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="merge_nodes-2264"><a href="#merge_nodes-2264"><span class="linenos">2264</span></a>            <span class="p">(</span>
</span><span id="merge_nodes-2265"><a href="#merge_nodes-2265"><span class="linenos">2265</span></a>                <span class="p">(</span>
</span><span id="merge_nodes-2266"><a href="#merge_nodes-2266"><span class="linenos">2266</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="merge_nodes-2267"><a href="#merge_nodes-2267"><span class="linenos">2267</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="merge_nodes-2268"><a href="#merge_nodes-2268"><span class="linenos">2268</span></a>                <span class="p">)</span>
</span><span id="merge_nodes-2269"><a href="#merge_nodes-2269"><span class="linenos">2269</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="merge_nodes-2270"><a href="#merge_nodes-2270"><span class="linenos">2270</span></a>                    <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="merge_nodes-2271"><a href="#merge_nodes-2271"><span class="linenos">2271</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">division_array</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="merge_nodes-2272"><a href="#merge_nodes-2272"><span class="linenos">2272</span></a>                <span class="p">)</span>
</span><span id="merge_nodes-2273"><a href="#merge_nodes-2273"><span class="linenos">2273</span></a>            <span class="p">)</span>
</span><span id="merge_nodes-2274"><a href="#merge_nodes-2274"><span class="linenos">2274</span></a>        <span class="p">]</span>
</span><span id="merge_nodes-2275"><a href="#merge_nodes-2275"><span class="linenos">2275</span></a>        <span class="k">for</span> <span class="n">candid</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="merge_nodes-2276"><a href="#merge_nodes-2276"><span class="linenos">2276</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[</span><span class="n">i_id</span><span class="p">]</span>
</span><span id="merge_nodes-2277"><a href="#merge_nodes-2277"><span class="linenos">2277</span></a>            <span class="n">division2_vertices</span> <span class="o">=</span> <span class="n">candid</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="merge_nodes-2278"><a href="#merge_nodes-2278"><span class="linenos">2278</span></a>            <span class="k">if</span> <span class="n">loom</span><span class="p">:</span>
</span><span id="merge_nodes-2279"><a href="#merge_nodes-2279"><span class="linenos">2279</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">division1_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="merge_nodes-2280"><a href="#merge_nodes-2280"><span class="linenos">2280</span></a>                <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">division2_vertices</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="merge_nodes-2281"><a href="#merge_nodes-2281"><span class="linenos">2281</span></a>                <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
</span><span id="merge_nodes-2282"><a href="#merge_nodes-2282"><span class="linenos">2282</span></a>                    <span class="k">continue</span>
</span><span id="merge_nodes-2283"><a href="#merge_nodes-2283"><span class="linenos">2283</span></a>            <span class="n">connection_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span>
</span><span id="merge_nodes-2284"><a href="#merge_nodes-2284"><span class="linenos">2284</span></a>                <span class="o">*</span><span class="n">division1_vertices</span><span class="p">,</span> <span class="o">*</span><span class="n">division2_vertices</span>
</span><span id="merge_nodes-2285"><a href="#merge_nodes-2285"><span class="linenos">2285</span></a>            <span class="p">)</span>
</span><span id="merge_nodes-2286"><a href="#merge_nodes-2286"><span class="linenos">2286</span></a>            <span class="k">if</span> <span class="n">connection_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="merge_nodes-2287"><a href="#merge_nodes-2287"><span class="linenos">2287</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span>
</span><span id="merge_nodes-2288"><a href="#merge_nodes-2288"><span class="linenos">2288</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
</span><span id="merge_nodes-2289"><a href="#merge_nodes-2289"><span class="linenos">2289</span></a>                <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span>
</span><span id="merge_nodes-2290"><a href="#merge_nodes-2290"><span class="linenos">2290</span></a>            <span class="p">]:</span>
</span><span id="merge_nodes-2291"><a href="#merge_nodes-2291"><span class="linenos">2291</span></a>                <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span> <span class="o">=</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">d_divisions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">id2</span><span class="p">)]</span>
</span><span id="merge_nodes-2292"><a href="#merge_nodes-2292"><span class="linenos">2292</span></a>                <span class="n">x_point__e1_2</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">division1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">division2</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
</span><span id="merge_nodes-2293"><a href="#merge_nodes-2293"><span class="linenos">2293</span></a>                <span class="k">if</span> <span class="n">x_point__e1_2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="p">:</span>
</span><span id="merge_nodes-2294"><a href="#merge_nodes-2294"><span class="linenos">2294</span></a>                    <span class="n">inters_obj</span> <span class="o">=</span> <span class="n">Intersection</span><span class="p">(</span><span class="n">x_point</span><span class="p">,</span> <span class="n">division1</span><span class="p">,</span> <span class="n">division2</span><span class="p">)</span>
</span><span id="merge_nodes-2295"><a href="#merge_nodes-2295"><span class="linenos">2295</span></a>                    <span class="n">d_intersections</span><span class="p">[</span><span class="n">inters_obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="merge_nodes-2296"><a href="#merge_nodes-2296"><span class="linenos">2296</span></a>                    <span class="n">d_connections</span><span class="p">[</span><span class="n">x_point__e1_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inters_obj</span>
</span><span id="merge_nodes-2297"><a href="#merge_nodes-2297"><span class="linenos">2297</span></a>                    <span class="n">division1</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="merge_nodes-2298"><a href="#merge_nodes-2298"><span class="linenos">2298</span></a>                    <span class="n">division2</span><span class="o">.</span><span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="merge_nodes-2299"><a href="#merge_nodes-2299"><span class="linenos">2299</span></a>                    <span class="n">intersections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inters_obj</span><span class="p">)</span>
</span><span id="merge_nodes-2300"><a href="#merge_nodes-2300"><span class="linenos">2300</span></a>
</span><span id="merge_nodes-2301"><a href="#merge_nodes-2301"><span class="linenos">2301</span></a>    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">division_list</span><span class="p">:</span>
</span><span id="merge_nodes-2302"><a href="#merge_nodes-2302"><span class="linenos">2302</span></a>        <span class="n">division</span><span class="o">.</span><span class="n">_sort_intersections</span><span class="p">()</span>
</span><span id="merge_nodes-2303"><a href="#merge_nodes-2303"><span class="linenos">2303</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Find all intersections of the given divisions. Sweep-line algorithm
without a self-balancing tree. Instead of a self-balancing tree,
it uses a numpy array to sort and filter the divisions. For the
number of divisions that are commonly needed in a lace, this is
sufficiently fast. It is also more robust and much easier to
understand and debug. Tested with tens of thousands of divisions but
not millions. The book has a section on this algorithm.
simetri.geometry.py has another version (called
all_intersections) for finding intersections among a given
list of divisions.</p>

<h2 id="arguments">Arguments:</h2>

<pre><code>division_list: list of division objects.
</code></pre>

<h2 id="side-effects">Side Effects:</h2>

<pre><code>* Modifies the given division objects (in the division_list) in place
    by adding the intersections to the divisions' "intersections"
    attribute.
* Updates the d_intersections
* Updates the d_connections
</code></pre>

<h2 id="return">Return:</h2>

<pre><code>A list of all intersection objects among the given division
list.
</code></pre>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>