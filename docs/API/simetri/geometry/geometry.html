<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>simetri.geometry.geometry API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../geometry.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simetri.geometry</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#array">array</a>
            </li>
            <li>
                    <a class="function" href="#around">around</a>
            </li>
            <li>
                    <a class="variable" href="#tau">tau</a>
            </li>
            <li>
                    <a class="function" href="#is_number">is_number</a>
            </li>
            <li>
                    <a class="function" href="#bbox_overlap">bbox_overlap</a>
            </li>
            <li>
                    <a class="function" href="#sine_wave">sine_wave</a>
            </li>
            <li>
                    <a class="function" href="#damping_function">damping_function</a>
            </li>
            <li>
                    <a class="function" href="#sine_points">sine_points</a>
            </li>
            <li>
                    <a class="function" href="#check_consecutive_duplicates">check_consecutive_duplicates</a>
            </li>
            <li>
                    <a class="function" href="#circle_inversion">circle_inversion</a>
            </li>
            <li>
                    <a class="function" href="#line_segment_bbox">line_segment_bbox</a>
            </li>
            <li>
                    <a class="function" href="#line_segment_bbox_check">line_segment_bbox_check</a>
            </li>
            <li>
                    <a class="function" href="#all_close_points">all_close_points</a>
            </li>
            <li>
                    <a class="function" href="#is_simple">is_simple</a>
            </li>
            <li>
                    <a class="function" href="#all_intersections">all_intersections</a>
            </li>
            <li>
                    <a class="function" href="#dot_product2">dot_product2</a>
            </li>
            <li>
                    <a class="function" href="#cross_product2">cross_product2</a>
            </li>
            <li>
                    <a class="function" href="#triangle_angles_from_sides">triangle_angles_from_sides</a>
            </li>
            <li>
                    <a class="function" href="#angle_between_lines2">angle_between_lines2</a>
            </li>
            <li>
                    <a class="function" href="#angled_line">angled_line</a>
            </li>
            <li>
                    <a class="function" href="#angled_vector">angled_vector</a>
            </li>
            <li>
                    <a class="function" href="#close_points2">close_points2</a>
            </li>
            <li>
                    <a class="function" href="#close_angles">close_angles</a>
            </li>
            <li>
                    <a class="function" href="#distance">distance</a>
            </li>
            <li>
                    <a class="function" href="#distance2">distance2</a>
            </li>
            <li>
                    <a class="function" href="#connect2">connect2</a>
            </li>
            <li>
                    <a class="function" href="#stitch">stitch</a>
            </li>
            <li>
                    <a class="function" href="#double_offset_polylines">double_offset_polylines</a>
            </li>
            <li>
                    <a class="function" href="#polygon_cg">polygon_cg</a>
            </li>
            <li>
                    <a class="function" href="#polygon_center2">polygon_center2</a>
            </li>
            <li>
                    <a class="function" href="#polygon_center">polygon_center</a>
            </li>
            <li>
                    <a class="function" href="#offset_polygon">offset_polygon</a>
            </li>
            <li>
                    <a class="function" href="#double_offset_polygons">double_offset_polygons</a>
            </li>
            <li>
                    <a class="function" href="#offset_polygon_points">offset_polygon_points</a>
            </li>
            <li>
                    <a class="function" href="#double_offset_lines">double_offset_lines</a>
            </li>
            <li>
                    <a class="function" href="#equal_lines">equal_lines</a>
            </li>
            <li>
                    <a class="function" href="#equal_polygons">equal_polygons</a>
            </li>
            <li>
                    <a class="function" href="#extended_line">extended_line</a>
            </li>
            <li>
                    <a class="function" href="#line_through_point_angle">line_through_point_angle</a>
            </li>
            <li>
                    <a class="function" href="#remove_duplicate_points">remove_duplicate_points</a>
            </li>
            <li>
                    <a class="function" href="#remove_collinear_points">remove_collinear_points</a>
            </li>
            <li>
                    <a class="function" href="#fix_degen_points">fix_degen_points</a>
            </li>
            <li>
                    <a class="function" href="#clockwise">clockwise</a>
            </li>
            <li>
                    <a class="function" href="#intersects">intersects</a>
            </li>
            <li>
                    <a class="function" href="#is_chained">is_chained</a>
            </li>
            <li>
                    <a class="function" href="#direction">direction</a>
            </li>
            <li>
                    <a class="function" href="#collinear_segments">collinear_segments</a>
            </li>
            <li>
                    <a class="function" href="#global_to_local">global_to_local</a>
            </li>
            <li>
                    <a class="function" href="#stitch_lines">stitch_lines</a>
            </li>
            <li>
                    <a class="function" href="#get_quadrant">get_quadrant</a>
            </li>
            <li>
                    <a class="function" href="#get_quadrant_from_deg_angle">get_quadrant_from_deg_angle</a>
            </li>
            <li>
                    <a class="function" href="#homogenize">homogenize</a>
            </li>
            <li>
                    <a class="function" href="#intersect2">intersect2</a>
            </li>
            <li>
                    <a class="function" href="#intersect">intersect</a>
            </li>
            <li>
                    <a class="function" href="#intersection2">intersection2</a>
            </li>
            <li>
                    <a class="function" href="#intersection3">intersection3</a>
            </li>
            <li>
                    <a class="function" href="#merge_consecutive_collinear_edges">merge_consecutive_collinear_edges</a>
            </li>
            <li>
                    <a class="function" href="#intersection">intersection</a>
            </li>
            <li>
                    <a class="function" href="#merge_segments">merge_segments</a>
            </li>
            <li>
                    <a class="function" href="#invert">invert</a>
            </li>
            <li>
                    <a class="function" href="#is_horizontal">is_horizontal</a>
            </li>
            <li>
                    <a class="function" href="#is_line">is_line</a>
            </li>
            <li>
                    <a class="function" href="#is_point">is_point</a>
            </li>
            <li>
                    <a class="function" href="#is_vertical">is_vertical</a>
            </li>
            <li>
                    <a class="function" href="#length">length</a>
            </li>
            <li>
                    <a class="function" href="#lerp_point">lerp_point</a>
            </li>
            <li>
                    <a class="function" href="#slope">slope</a>
            </li>
            <li>
                    <a class="function" href="#segmentize_line">segmentize_line</a>
            </li>
            <li>
                    <a class="function" href="#line_angle">line_angle</a>
            </li>
            <li>
                    <a class="function" href="#angle">angle</a>
            </li>
            <li>
                    <a class="function" href="#inclination_angle">inclination_angle</a>
            </li>
            <li>
                    <a class="function" href="#line2vector">line2vector</a>
            </li>
            <li>
                    <a class="function" href="#line_through_point_and_angle">line_through_point_and_angle</a>
            </li>
            <li>
                    <a class="function" href="#line_vector">line_vector</a>
            </li>
            <li>
                    <a class="function" href="#mid_point">mid_point</a>
            </li>
            <li>
                    <a class="function" href="#norm">norm</a>
            </li>
            <li>
                    <a class="function" href="#ndarray_to_xy_list">ndarray_to_xy_list</a>
            </li>
            <li>
                    <a class="function" href="#offset_line">offset_line</a>
            </li>
            <li>
                    <a class="function" href="#offset_lines">offset_lines</a>
            </li>
            <li>
                    <a class="function" href="#normalize">normalize</a>
            </li>
            <li>
                    <a class="function" href="#offset_point_on_line">offset_point_on_line</a>
            </li>
            <li>
                    <a class="function" href="#offset_point">offset_point</a>
            </li>
            <li>
                    <a class="function" href="#parallel_line">parallel_line</a>
            </li>
            <li>
                    <a class="function" href="#perp_offset_point">perp_offset_point</a>
            </li>
            <li>
                    <a class="function" href="#perp_unit_vector">perp_unit_vector</a>
            </li>
            <li>
                    <a class="function" href="#tfl_by_sides">tfl_by_sides</a>
            </li>
            <li>
                    <a class="function" href="#point_on_line">point_on_line</a>
            </li>
            <li>
                    <a class="function" href="#point_on_line_segment">point_on_line_segment</a>
            </li>
            <li>
                    <a class="function" href="#point_to_line_distance">point_to_line_distance</a>
            </li>
            <li>
                    <a class="function" href="#point_to_line_seg_distance">point_to_line_seg_distance</a>
            </li>
            <li>
                    <a class="function" href="#rotate_point">rotate_point</a>
            </li>
            <li>
                    <a class="function" href="#point_to_line_vec">point_to_line_vec</a>
            </li>
            <li>
                    <a class="function" href="#polygon_area">polygon_area</a>
            </li>
            <li>
                    <a class="function" href="#polyline_length">polyline_length</a>
            </li>
            <li>
                    <a class="function" href="#right_handed">right_handed</a>
            </li>
            <li>
                    <a class="function" href="#radius2side_len">radius2side_len</a>
            </li>
            <li>
                    <a class="function" href="#tokenize_svg_path">tokenize_svg_path</a>
            </li>
            <li>
                    <a class="function" href="#law_of_cosines">law_of_cosines</a>
            </li>
            <li>
                    <a class="function" href="#segmentize_catmull_rom">segmentize_catmull_rom</a>
            </li>
            <li>
                    <a class="function" href="#side_len_to_radius">side_len_to_radius</a>
            </li>
            <li>
                    <a class="function" href="#translate_line">translate_line</a>
            </li>
            <li>
                    <a class="function" href="#trim_line">trim_line</a>
            </li>
            <li>
                    <a class="function" href="#unit_vector">unit_vector</a>
            </li>
            <li>
                    <a class="function" href="#unit_vector_">unit_vector_</a>
            </li>
            <li>
                    <a class="function" href="#vec_along_line">vec_along_line</a>
            </li>
            <li>
                    <a class="function" href="#vec_dir_angle">vec_dir_angle</a>
            </li>
            <li>
                    <a class="function" href="#cross_product_sense">cross_product_sense</a>
            </li>
            <li>
                    <a class="function" href="#right_turn">right_turn</a>
            </li>
            <li>
                    <a class="function" href="#left_turn">left_turn</a>
            </li>
            <li>
                    <a class="function" href="#cross">cross</a>
            </li>
            <li>
                    <a class="function" href="#tri_to_cart">tri_to_cart</a>
            </li>
            <li>
                    <a class="function" href="#cart_to_tri">cart_to_tri</a>
            </li>
            <li>
                    <a class="function" href="#convex_hull">convex_hull</a>
            </li>
            <li>
                    <a class="function" href="#connected_pairs">connected_pairs</a>
            </li>
            <li>
                    <a class="function" href="#flat_points">flat_points</a>
            </li>
            <li>
                    <a class="function" href="#point_in_quad">point_in_quad</a>
            </li>
            <li>
                    <a class="function" href="#get_polygons">get_polygons</a>
            </li>
            <li>
                    <a class="function" href="#offset_point_from_start">offset_point_from_start</a>
            </li>
            <li>
                    <a class="function" href="#angle_between_two_lines">angle_between_two_lines</a>
            </li>
            <li>
                    <a class="function" href="#circle_tangent_to2lines">circle_tangent_to2lines</a>
            </li>
            <li>
                    <a class="function" href="#triangle_area">triangle_area</a>
            </li>
            <li>
                    <a class="function" href="#round_point">round_point</a>
            </li>
            <li>
                    <a class="function" href="#round_segment">round_segment</a>
            </li>
            <li>
                    <a class="function" href="#get_polygon_grid_point">get_polygon_grid_point</a>
            </li>
            <li>
                    <a class="function" href="#congruent_polygons">congruent_polygons</a>
            </li>
            <li>
                    <a class="function" href="#positive_angle">positive_angle</a>
            </li>
            <li>
                    <a class="function" href="#polygon_internal_angles">polygon_internal_angles</a>
            </li>
            <li>
                    <a class="function" href="#bisector_line">bisector_line</a>
            </li>
            <li>
                    <a class="function" href="#between">between</a>
            </li>
            <li>
                    <a class="function" href="#collinear">collinear</a>
            </li>
            <li>
                    <a class="function" href="#polar_to_cartesian">polar_to_cartesian</a>
            </li>
            <li>
                    <a class="function" href="#cartesian_to_polar">cartesian_to_polar</a>
            </li>
            <li>
                    <a class="function" href="#fillet">fillet</a>
            </li>
            <li>
                    <a class="function" href="#line_by_point_angle_length">line_by_point_angle_length</a>
            </li>
            <li>
                    <a class="function" href="#surface_normal">surface_normal</a>
            </li>
            <li>
                    <a class="function" href="#normal">normal</a>
            </li>
            <li>
                    <a class="function" href="#area">area</a>
            </li>
            <li>
                    <a class="function" href="#calc_area">calc_area</a>
            </li>
            <li>
                    <a class="function" href="#remove_bad_points">remove_bad_points</a>
            </li>
            <li>
                    <a class="function" href="#is_convex">is_convex</a>
            </li>
            <li>
                    <a class="function" href="#set_vertices">set_vertices</a>
            </li>
            <li>
                    <a class="function" href="#circle_circle_intersections">circle_circle_intersections</a>
            </li>
            <li>
                    <a class="function" href="#circle_segment_intersection">circle_segment_intersection</a>
            </li>
            <li>
                    <a class="function" href="#r_polar">r_polar</a>
            </li>
            <li>
                    <a class="function" href="#ellipse_line_intersection">ellipse_line_intersection</a>
            </li>
            <li>
                    <a class="function" href="#ellipse_tangent">ellipse_tangent</a>
            </li>
            <li>
                    <a class="function" href="#elliptic_arclength">elliptic_arclength</a>
            </li>
            <li>
                    <a class="function" href="#central_to_parametric_angle">central_to_parametric_angle</a>
            </li>
            <li>
                    <a class="function" href="#parametric_to_central_angle">parametric_to_central_angle</a>
            </li>
            <li>
                    <a class="function" href="#ellipse_points">ellipse_points</a>
            </li>
            <li>
                    <a class="function" href="#ellipse_point">ellipse_point</a>
            </li>
            <li>
                    <a class="function" href="#circle_line_intersection">circle_line_intersection</a>
            </li>
            <li>
                    <a class="function" href="#circle_poly_intersection">circle_poly_intersection</a>
            </li>
            <li>
                    <a class="function" href="#point_to_circle_distance">point_to_circle_distance</a>
            </li>
            <li>
                    <a class="function" href="#get_interior_points">get_interior_points</a>
            </li>
            <li>
                    <a class="function" href="#circle_3point">circle_3point</a>
            </li>
            <li>
                    <a class="function" href="#project_point_on_line">project_point_on_line</a>
            </li>
            <li>
                    <a class="class" href="#Vertex">Vertex</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Vertex.__init__">Vertex</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.x">x</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.z">z</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.type">type</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.copy">copy</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.coords">coords</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.array">array</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.v_tuple">v_tuple</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.below">below</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.above">above</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Edge">Edge</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Edge.__init__">Edge</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.start">start</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.end">end</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.slope">slope</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.angle">angle</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.inclination">inclination</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.length">length</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.x1">x1</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.y1">y1</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.x2">x2</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.y2">y2</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.points">points</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.vertices">vertices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.array">array</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#rotate_point_3D">rotate_point_3D</a>
            </li>
            <li>
                    <a class="function" href="#rotate_line_3D">rotate_line_3D</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../simetri.html">simetri</a><wbr>.<a href="./../geometry.html">geometry</a><wbr>.geometry    </h1>

                        <div class="docstring"><p>Geometry related utilities.
These functions are used to perform geometric operations.
They are not documented. Some of the are one off functions that
are not used in the main codebase or tested.</p>
</div>

                        <input id="mod-geometry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-geometry-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Geometry related utilities.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">These functions are used to perform geometric operations.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">They are not documented. Some of the are one off functions that</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">are not used in the main codebase or tested.&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1"># To do: Clean up this module and add documentation.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">hypot</span><span class="p">,</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">acos</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">isclose</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">around</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span> <span class="nn">simetri.helpers.utilities</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>    <span class="n">flatten</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>    <span class="n">lerp</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>    <span class="n">sanitize_graph_edges</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>    <span class="n">equal_cycles</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>    <span class="n">reg_poly_points</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">..helpers.vector</span> <span class="kn">import</span> <span class="n">Vector2D</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span> <span class="nn">..graphics.common</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>    <span class="n">get_defaults</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">common_properties</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">Point</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="n">Line</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>    <span class="n">Sequence</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>    <span class="n">i_vec</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>    <span class="n">j_vec</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>    <span class="n">VecType</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="n">axis_x</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="n">axis_y</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="p">)</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">from</span> <span class="nn">..graphics.all_enums</span> <span class="kn">import</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">Types</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="kn">from</span> <span class="nn">..settings.settings</span> <span class="kn">import</span> <span class="n">defaults</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="n">around</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>  <span class="c1"># 360 degrees</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">    Return True if x is a number.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">    Args:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">        x (Any): The input value to check.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">    Returns:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">        bool: True if x is a number, False otherwise.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="k">def</span> <span class="nf">bbox_overlap</span><span class="p">(</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>    <span class="n">min_x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>    <span class="n">min_y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>    <span class="n">max_x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>    <span class="n">max_y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>    <span class="n">min_x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>    <span class="n">min_y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>    <span class="n">max_x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>    <span class="n">max_y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    Given two bounding boxes, return True if they overlap.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    Args:</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">        min_x1 (float): Minimum x-coordinate of the first bounding box.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        min_y1 (float): Minimum y-coordinate of the first bounding box.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">        max_x2 (float): Maximum x-coordinate of the first bounding box.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">        max_y2 (float): Maximum y-coordinate of the first bounding box.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">        min_x3 (float): Minimum x-coordinate of the second bounding box.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">        min_y3 (float): Minimum y-coordinate of the second bounding box.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">        max_x4 (float): Maximum x-coordinate of the second bounding box.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">        max_y4 (float): Maximum y-coordinate of the second bounding box.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    Returns:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        bool: True if the bounding boxes overlap, False otherwise.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>        <span class="n">max_x2</span> <span class="o">&lt;</span> <span class="n">min_x3</span> <span class="ow">or</span> <span class="n">max_x4</span> <span class="o">&lt;</span> <span class="n">min_x1</span> <span class="ow">or</span> <span class="n">max_y2</span> <span class="o">&lt;</span> <span class="n">min_y3</span> <span class="ow">or</span> <span class="n">max_y4</span> <span class="o">&lt;</span> <span class="n">min_y1</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>    <span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="k">def</span> <span class="nf">sine_wave</span><span class="p">(</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>    <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>    <span class="n">phase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    Generate a sine wave.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    Args:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">        amplitude (float): Amplitude of the wave.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">        frequency (float): Frequency of the wave.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">        duration (float): Duration of the wave.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">        sample_rate (float): Sample rate.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        phase (float, optional): Phase angle of the wave. Defaults to 0.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">    Returns:</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        np.ndarray: Time and signal arrays representing the sine wave.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span> <span class="o">*</span> <span class="n">duration</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>    <span class="n">signal</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">time</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="c1"># plt.plot(time, signal)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>    <span class="c1"># plt.xlabel(&#39;Time (s)&#39;)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="c1"># plt.ylabel(&#39;Amplitude&#39;)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="c1"># plt.title(&#39;Discretized Sine Wave&#39;)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>    <span class="c1"># plt.grid(True)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>    <span class="c1"># plt.show()</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="k">return</span> <span class="n">time</span><span class="p">,</span> <span class="n">signal</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="k">def</span> <span class="nf">damping_function</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">    Generates a damping function based on the given amplitude, duration, and sample rate.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">    Args:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">        amplitude (float): The initial amplitude of the damping function.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">        duration (float): The duration over which the damping occurs, in seconds.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">        sample_rate (float): The number of samples per second.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">    Returns:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">        list: A list of float values representing the damping function over time.</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="n">damping</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>        <span class="n">damping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)))</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>    <span class="k">return</span> <span class="n">damping</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="k">def</span> <span class="nf">sine_points</span><span class="p">(</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>    <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="n">n_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>    <span class="n">phase_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>    <span class="n">damping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">    Generate sine wave points.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">    Args:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        amplitude (float): Amplitude of the wave.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        frequency (float): Frequency of the wave.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        duration (float): Duration of the wave.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        sample_rate (float): Sample rate.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        phase (float, optional): Phase angle of the wave. Defaults to 0.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        damping (float, optional): Damping coefficient. Defaults to 0.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">    Returns:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        np.ndarray: Array of points representing the sine wave.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="n">phase</span> <span class="o">=</span> <span class="n">phase_angle</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>    <span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">period</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="n">n_cycles</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="n">period</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_points</span> <span class="o">*</span> <span class="n">n_cycles</span><span class="p">))</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>    <span class="k">if</span> <span class="n">damping</span><span class="p">:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="n">y</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">damping</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>    <span class="k">return</span> <span class="n">vertices</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="k">def</span> <span class="nf">check_consecutive_duplicates</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for consecutive duplicate points in a list of points.</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">        Args:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">            points (list): List of points to check.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">            rtol (float, optional): Relative tolerance. Defaults to 0.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">            atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        Returns:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">            bool: True if consecutive duplicate points are found, False otherwise.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>    <span class="k">if</span> <span class="n">atol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="n">atol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="k">if</span> <span class="n">points</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>            <span class="n">next_pnt</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>            <span class="n">val1</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>            <span class="n">val2</span> <span class="o">=</span> <span class="n">next_pnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">next_pnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pnt</span><span class="p">,</span> <span class="n">next_pnt</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a><span class="k">def</span> <span class="nf">circle_inversion</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">    Inverts a point with respect to a circle.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">    Args:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">        point (tuple): The point to invert, represented as a tuple (x, y).</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        center (tuple): The center of the circle, represented as a tuple (x, y).</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        radius (float): The radius of the circle.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">    Returns:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        tuple: The inverted point, represented as a tuple (x, y).</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>    <span class="c1"># Calculate the distance from the point to the center of the circle</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>    <span class="c1"># If the point is at the center of the circle, return the point at infinity</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>    <span class="c1"># Calculate the distance from the inverted point to the center of the circle</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>    <span class="n">inv_dist</span> <span class="o">=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>    <span class="c1"># Calculate the inverted point</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>    <span class="n">inv_x</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">inv_dist</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>    <span class="n">inv_y</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">inv_dist</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>    <span class="k">return</span> <span class="n">inv_x</span><span class="p">,</span> <span class="n">inv_y</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="k">def</span> <span class="nf">line_segment_bbox</span><span class="p">(</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">    Return the bounding box of a line segment.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">    Args:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">        x1 (float): Segment start point x-coordinate.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        y1 (float): Segment start point y-coordinate.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">        x2 (float): Segment end point x-coordinate.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        y2 (float): Segment end point y-coordinate.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">    Returns:</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">        tuple: Bounding box as (min_x, min_y, max_x, max_y).</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="k">def</span> <span class="nf">line_segment_bbox_check</span><span class="p">(</span><span class="n">seg1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">seg2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">    Given two line segments, return True if their bounding boxes overlap.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">    Args:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">    Returns:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        bool: True if the bounding boxes overlap, False otherwise.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">seg1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">seg1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">seg2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">seg2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>    <span class="k">return</span> <span class="n">bbox_overlap</span><span class="p">(</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>        <span class="o">*</span><span class="n">line_segment_bbox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="o">*</span><span class="n">line_segment_bbox</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>    <span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="k">def</span> <span class="nf">all_close_points</span><span class="p">(</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    <span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">],</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_dist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">    Find all close points in a list of points along with their ids.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">    Args:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">        points (Sequence[Sequence]): List of points with ids [[x1, y1, id1], [x2, y2, id2], ...].</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        with_dist (bool, optional): Whether to include distances in the result. Defaults to False.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">    Returns:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        dict: Dictionary of the form {id1: [id2, id3, ...], ...}.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>  <span class="c1"># points array [[x1, y1, id1], ...]]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>  <span class="c1"># sort by x values in the</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>    <span class="c1"># first column</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">point_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># [x, y, id, xmin, xmax]</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_xmax</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>  <span class="c1"># column indices</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>    <span class="n">d_connections</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="n">d_connections</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>    <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_xmax</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        <span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>            <span class="p">(</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>                <span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="p">]</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>            <span class="n">point2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>            <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>                <span class="n">d_connections</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>                <span class="n">d_connections</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>                <span class="k">if</span> <span class="n">with_dist</span><span class="p">:</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>                    <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point2</span><span class="p">)))</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>                    <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">pairs</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="k">def</span> <span class="nf">is_simple</span><span class="p">(</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>    <span class="n">polygon</span><span class="p">,</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">    Return True if the polygon is simple.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">    Args:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">        polygon (list): List of points representing the polygon.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">    Returns:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        bool: True if the polygon is simple, False otherwise.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>    <span class="n">segments</span> <span class="o">=</span> <span class="p">[[</span><span class="n">polygon</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>    <span class="n">segment_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="n">segment_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>            <span class="p">[</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segment_coords</span><span class="p">)</span>  <span class="c1"># segments array</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>    <span class="n">id_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">seg_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">id_</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>    <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>    <span class="n">s_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># set of processed segment pairs</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span><span class="p">,</span> <span class="n">id1</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># keep pushing the sweep line forward</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>            <span class="p">(</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>                <span class="p">(</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>                <span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>                <span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>            <span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="p">]</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="n">pair</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>            <span class="k">if</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">s_processed</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>                <span class="k">continue</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="n">s_processed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>            <span class="n">seg2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">segment</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>            <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">intersection3</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>                <span class="n">length1</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                <span class="n">length2</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>                <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>                <span class="n">chain_length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span><span class="p">,</span> <span class="n">chain_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>                    <span class="k">continue</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">):</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>                <span class="k">continue</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="k">def</span> <span class="nf">all_intersections</span><span class="p">(</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>    <span class="n">segments</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>    <span class="n">use_intersection3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">    Find all intersection points of the given list of segments</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">    (sweep line algorithm variant)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">    Args:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">        segments (Sequence[Line]): List of line segments [[[x1, y1], [x2, y2]], [[x1, y1], [x2, y2]], ...].</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        use_intersection3 (bool, optional): Whether to use intersection3 function. Defaults to False.</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">    Returns:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">        dict: Dictionary of the form {segment_id: [[id1, (x1, y1)], [id2, (x2, y2)]], ...}.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>    <span class="n">segment_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>        <span class="n">segment_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>            <span class="p">[</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segment_coords</span><span class="p">)</span>  <span class="c1"># segments array</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>    <span class="n">id_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">seg_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">id_</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>    <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>    <span class="c1"># ind1, ind2 are indexes of segments in the list of segments</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>    <span class="n">d_ind1_x_point_ind2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {id1: [((x, y), id2), ...], ...}</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>    <span class="n">d_ind1_conn_type_x_res_ind2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {id1: [(conn_type, x_res, id2), ...], ...}</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>            <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>    <span class="n">x_points</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># intersection points</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>    <span class="n">s_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># set of processed segment pairs</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span><span class="p">,</span> <span class="n">id1</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># keep pushing the sweep line forward</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="c1"># filter by overlap of the bounding boxes of the segments with the</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="c1"># sweep line&#39;s active segment. If the bounding boxes do not overlap,</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="c1"># the segments cannot intersect. If the bounding boxes overlap,</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="c1"># the segments may intersect.</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="p">(</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>                <span class="p">(</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>                <span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>                <span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            <span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="p">]</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>            <span class="n">pair</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="k">if</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">s_processed</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                <span class="k">continue</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>            <span class="n">s_processed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>            <span class="n">seg2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                <span class="c1"># connection type, point/segment</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">intersection3</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">,</span> <span class="o">*</span><span class="n">seg2</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                <span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span> <span class="o">=</span> <span class="n">res</span>  <span class="c1"># x_res can be a segment or a point</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                <span class="c1"># connection type, point</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">,</span> <span class="o">*</span><span class="n">seg2</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                <span class="n">conn_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>            <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                <span class="k">if</span> <span class="n">conn_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">]:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>                    <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>                    <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span><span class="p">,</span> <span class="n">id1</span><span class="p">))</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                <span class="k">if</span> <span class="n">conn_type</span> <span class="o">==</span> <span class="n">Connection</span><span class="o">.</span><span class="n">INTERSECT</span><span class="p">:</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>                    <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_point</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                    <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_point</span><span class="p">,</span> <span class="n">id1</span><span class="p">))</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>                    <span class="n">x_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>    <span class="n">d_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>    <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>                <span class="n">d_results</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">d_results</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_ind1_x_point_ind2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>                <span class="n">d_results</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">d_results</span><span class="p">,</span> <span class="n">x_points</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="k">def</span> <span class="nf">dot_product2</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dot product of two vectors. AB and BC</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a><span class="sd">    Args:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="sd">        a (Point): First point, creating vector BA</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="sd">        b (Point): Second point, common point for both vectors</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="sd">        c (Point): Third point, creating vector BC</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">    Returns:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">        float: The dot product of vectors BA and BC</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">    Note:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        The function calculates (a-b)·(c-b) which is the dot product of vectors BA and BC.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">        This is useful for finding angles between segments that share a common point.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>    <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>    <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>    <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>    <span class="n">b_a_x</span> <span class="o">=</span> <span class="n">a_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>    <span class="n">b_a_y</span> <span class="o">=</span> <span class="n">a_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>    <span class="n">b_c_x</span> <span class="o">=</span> <span class="n">c_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>    <span class="n">b_c_y</span> <span class="o">=</span> <span class="n">c_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>    <span class="k">return</span> <span class="n">b_a_x</span> <span class="o">*</span> <span class="n">b_c_x</span> <span class="o">+</span> <span class="n">b_a_y</span> <span class="o">*</span> <span class="n">b_c_y</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="k">def</span> <span class="nf">cross_product2</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">    Return the cross product of two vectors: BA and BC.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">    Args:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">        a (Point): First point, creating vector BA</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">        b (Point): Second point, common point for both vectors</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">        c (Point): Third point, creating vector BC</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">    Returns:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">        float: The z-component of cross product between vectors BA and BC</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">    Note:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="sd">        This gives the signed area of the parallelogram formed by the vectors BA and BC.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">        The sign indicates the orientation (positive for counter-clockwise, negative for clockwise).</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">        It is useful for determining the orientation of three points and calculating angles.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a><span class="sd">    vec1 = b - a</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">    vec2 = c - b</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>    <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>    <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>    <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>    <span class="n">b_a_x</span> <span class="o">=</span> <span class="n">a_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>    <span class="n">b_a_y</span> <span class="o">=</span> <span class="n">a_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>    <span class="n">b_c_x</span> <span class="o">=</span> <span class="n">c_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>    <span class="n">b_c_y</span> <span class="o">=</span> <span class="n">c_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>    <span class="k">return</span> <span class="n">b_a_x</span> <span class="o">*</span> <span class="n">b_c_y</span> <span class="o">-</span> <span class="n">b_a_y</span> <span class="o">*</span> <span class="n">b_c_x</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="k">def</span> <span class="nf">triangle_angles_from_sides</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">    Calculates the inner angles of a triangle given its side lengths.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">    Args:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">        a float: Length of side a.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        b float: Length of side b.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        c float: Length of side c.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">    Returns:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">        tuple[float, float, float]: A tuple containing the angles (A, B, C) in degrees.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>    <span class="n">a2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>    <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>    <span class="n">c2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">b2</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">a2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">a2</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">a2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="k">def</span> <span class="nf">angle_between_lines2</span><span class="p">(</span><span class="n">point1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point3</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">    Given line1 as point1 and point2, and line2 as point2 and point3</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">    return the angle between two lines</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="sd">    (point2 is the corner point)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">    Args:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a><span class="sd">        point1 (Point): First point of the first line.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        point2 (Point): Second point of the first line and first point of the second line.</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a><span class="sd">        point3 (Point): Second point of the second line.</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">    Returns:</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a><span class="sd">        float: Angle between the two lines in radians.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="n">cross_product2</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">),</span> <span class="n">dot_product2</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>    <span class="p">)</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="k">def</span> <span class="nf">angled_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">    Given a line find another line with theta radians between them.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">    Args:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">    Returns:</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">        Line: New line with the given angle.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>    <span class="c1"># find the angle of the line</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>    <span class="n">theta1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="n">theta2</span> <span class="o">=</span> <span class="n">theta1</span> <span class="o">+</span> <span class="n">theta</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>    <span class="c1"># find the length of the line</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>    <span class="c1"># find the new line</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="n">x3</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>    <span class="n">y3</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)]</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="k">def</span> <span class="nf">angled_vector</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">    Return a vector with the given angle</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">    Args:</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">        angle (float): Angle in radians.</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">    Returns:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">        Sequence[float]: Vector with the given angle.</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="k">def</span> <span class="nf">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">dist2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">    Return True if two points are close to each other.</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="sd">    Args:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        dist2 (float, optional): Square of the threshold distance. Defaults to 0.01.</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">    Returns:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">        bool: True if the points are close to each other, False otherwise.</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>    <span class="k">return</span> <span class="n">distance2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dist2</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="k">def</span> <span class="nf">close_angles</span><span class="p">(</span><span class="n">angle1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angle2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angtol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">    Return True if two angles are close to each other.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">    Args:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        angle1 (float): First angle in radians.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        angle2 (float): Second angle in radians.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        angtol (float, optional): Angle tolerance. Defaults to None.</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">    Returns:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        bool: True if the angles are close to each other, False otherwise.</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>    <span class="k">if</span> <span class="n">angtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="n">angtol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;angtol&quot;</span><span class="p">]</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">angle1</span> <span class="o">-</span> <span class="n">angle2</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">angtol</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">    Return the distance between two points.</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">    Args:</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">    Returns:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        float: Distance between the two points.</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="k">return</span> <span class="n">hypot</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="k">def</span> <span class="nf">distance2</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">    Return the squared distance between two points.</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">    Useful for comparing distances without the need to</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">    compute the square root.</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">    Args:</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">    Returns:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        float: Squared distance between the two points.</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="k">def</span> <span class="nf">connect2</span><span class="p">(</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>    <span class="n">poly_point1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>    <span class="n">poly_point2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">    Connect two polypoints together.</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="sd">    Args:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        poly_point1 (list[Point]): First list of points.</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        poly_point2 (list[Point]): Second list of points.</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="sd">    Returns:</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">        list[Point]: Connected list of points.</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;dist_tol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">])</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>    <span class="n">start1</span><span class="p">,</span> <span class="n">end1</span> <span class="o">=</span> <span class="n">poly_point1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly_point1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>    <span class="n">start2</span><span class="p">,</span> <span class="n">end2</span> <span class="o">=</span> <span class="n">poly_point2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly_point2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>    <span class="n">pp1</span> <span class="o">=</span> <span class="n">poly_point1</span><span class="p">[:]</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>    <span class="n">pp2</span> <span class="o">=</span> <span class="n">poly_point2</span><span class="p">[:]</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="n">end2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="n">pp2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="n">pp1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">end2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="n">pp1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="n">pp2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="k">def</span> <span class="nf">stitch</span><span class="p">(</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>    <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>    <span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>    <span class="n">return_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">    Stitches a list of lines together.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">    Args:</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        lines (list[Line]): List of lines to stitch.</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        closed (bool, optional): Whether the lines form a closed shape. Defaults to True.</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">        return_points (bool, optional): Whether to return points or lines. Defaults to True.</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">    Returns:</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        list[Point]: Stitched list of points or lines.</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersect2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="k">if</span> <span class="n">x_point</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_point</span><span class="p">)</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="n">final_x</span> <span class="o">=</span> <span class="n">intersect2</span><span class="p">(</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>            <span class="n">x1</span><span class="p">,</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="n">y1</span><span class="p">,</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="n">x2</span><span class="p">,</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="n">y2</span><span class="p">,</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>            <span class="n">x3</span><span class="p">,</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>            <span class="n">y3</span><span class="p">,</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>            <span class="n">x4</span><span class="p">,</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>            <span class="n">y4</span><span class="p">,</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="p">)</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="k">if</span> <span class="n">final_x</span><span class="p">:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_x</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_x</span><span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>    <span class="k">if</span> <span class="n">return_points</span><span class="p">:</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">points</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="k">def</span> <span class="nf">double_offset_polylines</span><span class="p">(</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>    <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">    Args:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        lines (list[Point]): List of points representing the lines.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">    Returns:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>    <span class="n">lines1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>    <span class="n">lines2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="n">lines1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>        <span class="n">lines2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="n">lines1</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">lines1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>    <span class="n">lines2</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">lines2</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">lines1</span><span class="p">,</span> <span class="n">lines2</span><span class="p">]</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="k">def</span> <span class="nf">polygon_cg</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">    Args:</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">    Returns:</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    <span class="n">cx</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="n">xnext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>        <span class="n">ynext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">ynext</span> <span class="o">-</span> <span class="n">xnext</span> <span class="o">*</span> <span class="n">y</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>        <span class="n">cx</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">xnext</span><span class="p">)</span> <span class="o">*</span> <span class="n">temp</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="n">cy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">ynext</span><span class="p">)</span> <span class="o">*</span> <span class="n">temp</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="n">area_</span> <span class="o">*</span> <span class="mi">6</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>    <span class="k">if</span> <span class="n">denom</span><span class="p">:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">cx</span> <span class="o">/</span> <span class="n">denom</span><span class="p">,</span> <span class="n">cy</span> <span class="o">/</span> <span class="n">denom</span><span class="p">]</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="k">def</span> <span class="nf">polygon_center2</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">    Args:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        polygon_points (list[Point]): List of points representing the polygon.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">    Returns:</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">)</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">polygon_points</span><span class="p">:</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="k">def</span> <span class="nf">polygon_center</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">    Args:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">        polygon_points (list[Point]): List of points representing the polygon.</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">    Returns:</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area_</span><span class="p">),</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area_</span><span class="p">))</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="k">def</span> <span class="nf">offset_polygon</span><span class="p">(</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">    Return a list of offset lines from a list of lines.</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">    Args:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to -1.</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">    Returns:</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        list[Point]: List of offset lines.</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>    <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:])</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="n">offset_edge</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">-</span><span class="n">offset</span><span class="p">)</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_edge</span><span class="p">)</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="k">def</span> <span class="nf">double_offset_polygons</span><span class="p">(</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">    Args:</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">    Returns:</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="n">poly1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        <span class="n">poly2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>    <span class="k">if</span> <span class="s2">&quot;canvas&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="n">canvas</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;canvas&quot;</span><span class="p">]</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="k">if</span> <span class="n">canvas</span><span class="p">:</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>            <span class="kn">from</span> <span class="nn">..graphics.shape</span> <span class="kn">import</span> <span class="n">Shape</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>            <span class="n">closed</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Shape</span><span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="n">closed</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Shape</span><span class="p">(</span><span class="n">poly2</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">]</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="k">def</span> <span class="nf">offset_polygon_points</span><span class="p">(</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">    Args:</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">    Returns:</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>    <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="n">offset_edge</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_edge</span><span class="p">)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="k">def</span> <span class="nf">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Line</span><span class="p">,</span> <span class="n">Line</span><span class="p">]:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">    Return two offset lines to a given line segment with the given offset amount.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">    Args:</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">        line (Line): Input line segment.</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">    Returns:</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        tuple[Line, Line]: Two offset lines.</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="n">line1</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>    <span class="n">line2</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">-</span><span class="n">offset</span><span class="p">)</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>    <span class="k">return</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="k">def</span> <span class="nf">equal_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">    Return True if two lines are close enough.</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">    Args:</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">    Returns:</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        bool: True if the lines are close enough, False otherwise.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line1</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>    <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="ow">and</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>        <span class="ow">and</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>    <span class="p">)</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="k">def</span> <span class="nf">equal_polygons</span><span class="p">(</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>    <span class="n">poly1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">poly2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">    Return True if two polygons are close enough.</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">    Args:</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">        poly1 (Sequence[Point]): First polygon.</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">        poly2 (Sequence[Point]): Second polygon.</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    Returns:</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">        bool: True if the polygons are close enough, False otherwise.</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly2</span><span class="p">):</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="p">):</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">pnt</span><span class="p">,</span> <span class="n">poly2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="k">def</span> <span class="nf">extended_line</span><span class="p">(</span><span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">extend_both</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">    Given a line ((x1, y1), (x2, y2)) and a distance,</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">    the given line is extended by distance units.</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">    Return a new line ((x1, y1), (x2&#39;, y2&#39;)).</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">    Args:</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        dist (float): Distance to extend the line.</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        extend_both (bool, optional): Whether to extend both ends of the line. Defaults to False.</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">    Returns:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        Line: Extended line.</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="c1"># p = (1-t)*p1 + t*p2 : parametric equation of a line segment (p1, p2)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="n">line_length</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_length</span> <span class="o">+</span> <span class="n">dist</span><span class="p">)</span> <span class="o">/</span> <span class="n">line_length</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">x2</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">y2</span><span class="p">)]</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>    <span class="k">if</span> <span class="n">extend_both</span><span class="p">:</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">])</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">]</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="k">def</span> <span class="nf">line_through_point_angle</span><span class="p">(</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">length_</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">both_sides</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">    Return a line that passes through the given point</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">    with the given angle and length.</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">    If both_side is True, the line is extended on both sides by the given</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">    length.</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">    Args:</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        point (Point): Point through which the line passes.</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        length_ (float): Length of the line.</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">        both_sides (bool, optional): Whether to extend the line on both sides. Defaults to False.</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">    Returns:</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">        Line: Line passing through the given point with the given angle and length.</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>    <span class="n">line</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))]</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>    <span class="k">if</span> <span class="n">both_sides</span><span class="p">:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="n">extended_line</span><span class="p">(</span><span class="n">length_</span><span class="p">,</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">])</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>    <span class="k">return</span> <span class="n">line</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="k">def</span> <span class="nf">remove_duplicate_points</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">    Return a list of points with duplicate points removed.</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">    Args:</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">    Returns:</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">        list[Point]: List of points with duplicate points removed.</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>            <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="k">def</span> <span class="nf">remove_collinear_points</span><span class="p">(</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">    Return a list of points with collinear points removed.</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">    Args:</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">    Returns:</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">        list[Point]: List of points with collinear points removed.</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">collinear</span><span class="p">(</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>                <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">,</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)],</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>            <span class="p">):</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="k">def</span> <span class="nf">fix_degen_points</span><span class="p">(</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>    <span class="n">loop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>    <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>    <span class="n">area_rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>    <span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>    <span class="n">check_collinear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">    Return a list of points with duplicate points removed.</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">    Remove the middle point from the collinear points.</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">    Args:</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">        loop (bool, optional): Whether to loop the points. Defaults to False.</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">        closed (bool, optional): Whether the points form a closed shape. Defaults to False.</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">        check_collinear (bool, optional): Whether to check for collinear points. Defaults to True.</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">    Returns:</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">        list[Point]: List of points with duplicate and collinear points removed.</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>    <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>    <span class="p">)</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>    <span class="k">if</span> <span class="n">loop</span><span class="p">:</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">new_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="k">if</span> <span class="n">check_collinear</span><span class="p">:</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="c1"># Check for collinear points and remove the middle one.</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="n">new_points</span> <span class="o">=</span> <span class="n">merge_consecutive_collinear_edges</span><span class="p">(</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="n">new_points</span><span class="p">,</span> <span class="n">closed</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="k">def</span> <span class="nf">clockwise</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return 1 if the points p, q, and r are in clockwise order,</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">    return -1 if the points are in counter-clockwise order,</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">    return 0 if the points are collinear</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">    Args:</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        p (Point): First point.</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        q (Point): Second point.</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">        r (Point): Third point.</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">    Returns:</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        int: 1 if the points are in clockwise order, -1 if counter-clockwise, 0 if collinear.</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">area</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>    <span class="k">if</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>    <span class="k">elif</span> <span class="n">area_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">):</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the line segments intersect.</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    If they are chained together, they are considered as intersecting.</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">    Returns True if the segments intersect, False otherwise.</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">    Args:</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">    Returns:</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">        bool: True if the segments intersect, False otherwise.</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>    <span class="n">p2</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>    <span class="n">o1</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>    <span class="n">o2</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="n">o3</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="n">o4</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>    <span class="k">if</span> <span class="n">o1</span> <span class="o">!=</span> <span class="n">o2</span> <span class="ow">and</span> <span class="n">o3</span> <span class="o">!=</span> <span class="n">o4</span><span class="p">:</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>    <span class="k">if</span> <span class="n">o1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>    <span class="k">if</span> <span class="n">o2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>    <span class="k">if</span> <span class="n">o3</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>    <span class="k">if</span> <span class="n">o4</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="k">def</span> <span class="nf">is_chained</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">):</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the line segments are chained together.</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a><span class="sd">    Args:</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">    Returns:</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">        bool: True if the segments are chained together, False otherwise.</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>    <span class="n">p2</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>    <span class="p">):</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">    Checks the orientation of three points (p, q, r).</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">    Args:</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">        p (Point): First point.</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">        q (Point): Second point.</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        r (Point): Third point.</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">    Returns:</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        int: 0 if collinear, &gt;0 if counter-clockwise, &lt;0 if clockwise.</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="k">def</span> <span class="nf">collinear_segments</span><span class="p">(</span><span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">    Checks if two line segments (a1, b1) and (a2, b2) are collinear.</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a><span class="sd">    Args:</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a><span class="sd">        segment1 (Line): First line segment.</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="sd">        segment2 (Line): Second line segment.</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        tol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a><span class="sd">    Returns:</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="sd">        bool: True if the segments are collinear, False otherwise.</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>    <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;tol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>    <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">segment1</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>    <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">segment2</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">direction</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>        <span class="n">direction</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>    <span class="p">)</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="k">def</span> <span class="nf">global_to_local</span><span class="p">(</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">yi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point(x, y) in global coordinates</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">    and local CS position and orientation,</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">    return a point(ksi, eta) in local coordinates</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a><span class="sd">    Args:</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a><span class="sd">        x (float): Global x-coordinate.</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a><span class="sd">        y (float): Global y-coordinate.</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a><span class="sd">        xi (float): Local x-coordinate.</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a><span class="sd">        yi (float): Local y-coordinate.</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a><span class="sd">        theta (float, optional): Angle in radians. Defaults to 0.</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="sd">    Returns:</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">        Point: Local coordinates (ksi, eta).</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>    <span class="n">sin_theta</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>    <span class="n">cos_theta</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>    <span class="n">ksi</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_theta</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">yi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin_theta</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">yi</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_theta</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin_theta</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ksi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="k">def</span> <span class="nf">stitch_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;if the lines intersect, trim the lines</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a><span class="sd">    if the lines don&#39;t intersect, extend the lines</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="sd">    Args:</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a><span class="sd">    Returns:</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        Sequence[Line]: Trimmed or extended lines.</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>    <span class="n">intersection_</span> <span class="o">=</span> <span class="n">intersect</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>    <span class="k">if</span> <span class="n">intersection_</span><span class="p">:</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">line1</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="n">line1</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">]</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>        <span class="n">line2</span> <span class="o">=</span> <span class="p">[</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="k">def</span> <span class="nf">get_quadrant</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;quadrants:</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">    +x, +y = 1st</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">    +x, -y = 2nd</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="sd">    -x, -y = 3rd</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a><span class="sd">    +x, -y = 4th</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="sd">    Args:</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a><span class="sd">        x (float): x-coordinate.</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="sd">        y (float): y-coordinate.</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">    Returns:</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">        int: Quadrant number.</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">((</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="k">def</span> <span class="nf">get_quadrant_from_deg_angle</span><span class="p">(</span><span class="n">deg_angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;quadrants:</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="sd">    (0, 90) = 1st</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a><span class="sd">    (90, 180) = 2nd</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="sd">    (180, 270) = 3rd</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a><span class="sd">    (270, 360) = 4th</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">    Args:</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">        deg_angle (float): Angle in degrees.</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    Returns:</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">        int: Quadrant number.</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">deg_angle</span> <span class="o">/</span> <span class="mf">90.0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="k">def</span> <span class="nf">homogenize</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">    Convert a list of points to homogeneous coordinates.</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">    Args:</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        points (Sequence[Point]): List of points.</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">    Returns:</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        np.ndarray: Homogeneous coordinates.</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>    <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">xy_array</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>    <span class="k">if</span> <span class="n">n_cols</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">xy_array</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>    <span class="n">ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>    <span class="n">homogeneous_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_array</span><span class="p">,</span> <span class="n">ones</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>    <span class="k">return</span> <span class="n">homogeneous_array</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="k">def</span> <span class="nf">_homogenize</span><span class="p">(</span><span class="n">coordinates</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal use only. API provides a homogenize function.</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">    Given a sequence of coordinates(x1, y1, x2, y2, ... xn, yn),</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">    return a numpy array of points array(((x1, y1, 1.),</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">    (x2, y2, 1.), ... (xn, yn, 1.))).</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">    Args:</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a><span class="sd">        coordinates (Sequence[float]): Sequence of coordinates.</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">    Returns:</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">        np.ndarray: Homogeneous coordinates.</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>    <span class="n">xy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="n">xy_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>    <span class="n">ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>    <span class="n">homogeneous_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_array</span><span class="p">,</span> <span class="n">ones</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>    <span class="k">return</span> <span class="n">homogeneous_array</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="k">def</span> <span class="nf">intersect2</span><span class="p">(</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>    <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>    <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>    <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>    <span class="n">x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>    <span class="n">y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>    <span class="n">x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>    <span class="n">y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection point of two lines.</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">    line1: (x1, y1), (x2, y2)</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">    line2: (x3, y3), (x4, y4)</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">    To find the intersection point of two line segments use the</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">    &quot;intersection&quot; function</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">    Args:</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line.</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line.</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line.</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line.</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line.</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line.</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line.</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line.</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="sd">    Returns:</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">        Point: Intersection point of the two lines.</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>    <span class="n">x1_x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>    <span class="n">y1_y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>    <span class="n">x3_x4</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">-</span> <span class="n">x4</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>    <span class="n">y3_y4</span> <span class="o">=</span> <span class="n">y3</span> <span class="o">-</span> <span class="n">y4</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3_y4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1_y2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3_x4</span><span class="p">)</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># parallel lines</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3_x4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span> <span class="o">*</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">x4</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3_y4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1_y2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span> <span class="o">*</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">x4</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection point of two lines.</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a><span class="sd">    line1: [(x1, y1), (x2, y2)]</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="sd">    line2: [(x3, y3), (x4, y4)]</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a><span class="sd">    To find the intersection point of two line segments use the</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a><span class="sd">    &quot;intersection&quot; function</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a><span class="sd">    Args:</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">    Returns:</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">        Point: Intersection point of the two lines.</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>    <span class="k">return</span> <span class="n">intersect2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="k">def</span> <span class="nf">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the intersection of two line segments. See the documentation</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">    Args:</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line segment.</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line segment.</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line segment.</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line segment.</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line segment.</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line segment.</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line segment.</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line segment.</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">    Returns:</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a><span class="sd">        tuple: Connection type and intersection point.</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>    <span class="n">x2_x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>    <span class="n">y2_y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>    <span class="n">x4_x3</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>    <span class="n">y4_y3</span> <span class="o">=</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>  <span class="c1"># parallel</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>    <span class="n">x1_x3</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>    <span class="n">y1_y3</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>    <span class="n">ua</span> <span class="o">=</span> <span class="p">((</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1_y3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x3</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>    <span class="k">if</span> <span class="n">ua</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ua</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>    <span class="n">ub</span> <span class="o">=</span> <span class="p">((</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1_y3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x3</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>    <span class="k">if</span> <span class="n">ub</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ub</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">ua</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ua</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">INTERSECT</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a><span class="k">def</span> <span class="nf">intersection3</span><span class="p">(</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>    <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>    <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>    <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>    <span class="n">x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>    <span class="n">y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>    <span class="n">x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>    <span class="n">y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>    <span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Connection</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the intersection of two line segments. See the documentation</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">    for more details.</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">    Args:</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line segment.</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line segment.</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line segment.</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line segment.</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line segment.</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line segment.</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line segment.</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line segment.</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="sd">    Returns:</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">        tuple: Connection type and intersection result.</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>    <span class="c1"># collinear check uses area_atol</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>    <span class="c1"># s1: start1 = (x1, y1)</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>    <span class="c1"># e1: end1 = (x2, y2)</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>    <span class="c1"># s2: start2 = (x3, y3)</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>    <span class="c1"># e2: end2 = (x4, y4)</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>    <span class="c1"># s1s2: start1 and start2 is connected</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>    <span class="c1"># s1e2: start1 and end2 is connected</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>    <span class="c1"># e1s2: end1 and start2 is connected</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>    <span class="c1"># e1e2: end1 and end2 is connected</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>        <span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">,</span> <span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>    <span class="p">)</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>    <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>    <span class="n">e1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>    <span class="n">e2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>    <span class="n">segment1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>    <span class="n">segment2</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)]</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>    <span class="c1"># check if the segments&#39; bounding boxes overlap</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">line_segment_bbox_check</span><span class="p">(</span><span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">):</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>    <span class="c1"># Check if the segments are parallel</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>    <span class="n">x2_x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>    <span class="n">y2_y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>    <span class="n">x4_x3</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>    <span class="n">y4_y3</span> <span class="o">=</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>    <span class="n">parallel</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>    <span class="c1"># angle1 = atan2(y2 - y1, x2 - x1) % pi</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>    <span class="c1"># angle2 = atan2(y4 - y3, x4 - x3) % pi</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>    <span class="c1"># parallel = close_angles(angle1, angle2, angtol=defaults[&#39;angtol&#39;])</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>    <span class="c1"># Coincident end points</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>    <span class="n">s1s2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>    <span class="n">s1e2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>    <span class="n">e1s2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>    <span class="n">e1e2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>    <span class="n">connected</span> <span class="o">=</span> <span class="n">s1s2</span> <span class="ow">or</span> <span class="n">s1e2</span> <span class="ow">or</span> <span class="n">e1s2</span> <span class="ow">or</span> <span class="n">e1e2</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>    <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>        <span class="n">length1</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>        <span class="n">length2</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>        <span class="n">min_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>        <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>        <span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>        <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>        <span class="n">total_length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">),</span> <span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">))</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="n">l1_eq_l2</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span><span class="p">,</span> <span class="n">length2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>        <span class="n">l1_eq_total</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>        <span class="n">l2_eq_total</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length2</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>            <span class="k">if</span> <span class="n">l1_eq_l2</span> <span class="ow">and</span> <span class="n">l1_eq_total</span><span class="p">:</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CONGRUENT</span><span class="p">,</span> <span class="n">segment1</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>            <span class="k">if</span> <span class="n">l1_eq_total</span><span class="p">:</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CONTAINS</span><span class="p">,</span> <span class="n">segment1</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>            <span class="k">if</span> <span class="n">l2_eq_total</span><span class="p">:</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">WITHIN</span><span class="p">,</span> <span class="n">segment2</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>            <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">):</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>                <span class="c1"># chained and collienar</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>                <span class="k">if</span> <span class="n">s1s2</span><span class="p">:</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>                <span class="k">if</span> <span class="n">s1e2</span><span class="p">:</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>                <span class="k">if</span> <span class="n">e1s2</span><span class="p">:</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>                <span class="k">if</span> <span class="n">e1e2</span><span class="p">:</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>            <span class="k">if</span> <span class="n">total_length</span> <span class="o">&lt;</span> <span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span> <span class="ow">and</span> <span class="n">collinear_segments</span><span class="p">(</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>                <span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>            <span class="p">):</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>                <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">)</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>                <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>                <span class="n">seg</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">OVERLAPS</span><span class="p">,</span> <span class="n">seg</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>            <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>        <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>            <span class="k">if</span> <span class="n">s1s2</span><span class="p">:</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>            <span class="k">if</span> <span class="n">s1e2</span><span class="p">:</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="k">if</span> <span class="n">e1s2</span><span class="p">:</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>            <span class="k">if</span> <span class="n">e1e2</span><span class="p">:</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">):</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">e1</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">s1</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">e2</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">s1</span><span class="p">):</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">s2</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>            <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a><span class="k">def</span> <span class="nf">merge_consecutive_collinear_edges</span><span class="p">(</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>    <span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a><span class="p">):</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove the middle points from collinear edges.</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a><span class="sd">    Args:</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a><span class="sd">        closed (bool, optional): Whether the points form a closed shape. Defaults to False.</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a><span class="sd">    Returns:</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a><span class="sd">        list[Point]: List of points with collinear points removed.</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>    <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>        <span class="p">[</span><span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>    <span class="p">)</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:]</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>        <span class="n">cyc</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>        <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>        <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>        <span class="n">discarded</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>            <span class="k">if</span> <span class="n">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="n">area_atol</span><span class="p">):</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>                <span class="n">discarded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>                <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>                <span class="k">break</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">discarded</span><span class="p">:</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">looping</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>            <span class="k">break</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a><span class="k">def</span> <span class="nf">intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;return the intersection point of two line segments.</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">    segment1: ((x1, y1), (x2, y2))</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a><span class="sd">    segment2: ((x3, y3), (x4, y4))</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a><span class="sd">    if line segments do not intersect return -1</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">    if line segments are parallel return 0</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">    if line segments are connected (share a point) return 1</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">    To find the intersection point of two lines use the &quot;intersect&quot; function</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">    Args:</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">        line1 (Line): First line segment.</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">        line2 (Line): Second line segment.</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a><span class="sd">    Returns:</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a><span class="sd">        int: Intersection type.</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>    <span class="k">if</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>        <span class="n">rtol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>    <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="k">def</span> <span class="nf">merge_segments</span><span class="p">(</span><span class="n">seg1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">seg2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge two segments into one segment if they are connected.</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">    They need to be overlapping or simply connected to each other,</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">    otherwise they will not be merged. Order doesn&#39;t matter.</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">    Args:</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a><span class="sd">        seg1 (Sequence[Point]): First segment.</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a><span class="sd">        seg2 (Sequence[Point]): Second segment.</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a><span class="sd">    Returns:</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a><span class="sd">        Sequence[Point]: Merged segment.</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>    <span class="n">Conn</span> <span class="o">=</span> <span class="n">Connection</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>    <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">([(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)],</span> <span class="n">use_intersection3</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>        <span class="n">conn_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>        <span class="n">verts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>        <span class="k">if</span> <span class="n">conn_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Conn</span><span class="o">.</span><span class="n">OVERLAPS</span><span class="p">,</span> <span class="n">Conn</span><span class="o">.</span><span class="n">CONGRUENT</span><span class="p">,</span> <span class="n">Conn</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">]:</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">verts</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>        <span class="k">elif</span> <span class="n">conn_type</span> <span class="o">==</span> <span class="n">Conn</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">:</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># need this to avoid returning an empty dict</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverts p about a circle at the given center and radius</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a><span class="sd">    Args:</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a><span class="sd">        p (Point): Point to invert.</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a><span class="sd">        center (Point): Center of the circle.</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a><span class="sd">    Returns:</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a><span class="sd">        Point: Inverted point.</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>        <span class="k">return</span> <span class="n">p</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>    <span class="k">return</span> <span class="n">center</span> <span class="o">+</span> <span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dist</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>    <span class="c1"># return radius**2 * (p - center) / dist</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a><span class="k">def</span> <span class="nf">is_horizontal</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the line is horizontal.</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a><span class="sd">    Args:</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a><span class="sd">        eps (float, optional): Tolerance. Defaults to 0.0001.</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">    Returns:</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a><span class="sd">        bool: True if the line is horizontal, False otherwise.</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j_vec</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">eps</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a><span class="k">def</span> <span class="nf">is_line</span><span class="p">(</span><span class="n">line_</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the input is a line.</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">    Args:</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">        line_ (Any): Input value.</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="sd">    Returns:</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">        bool: True if the input is a line, False otherwise.</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line_</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>        <span class="k">return</span> <span class="n">is_point</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_point</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="k">def</span> <span class="nf">is_point</span><span class="p">(</span><span class="n">pnt</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the input is a point.</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a><span class="sd">    Args:</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a><span class="sd">        pnt (Any): Input value.</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a><span class="sd">    Returns:</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a><span class="sd">        bool: True if the input is a point, False otherwise.</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>        <span class="k">return</span> <span class="n">is_number</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_number</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a><span class="k">def</span> <span class="nf">is_vertical</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the line is vertical.</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a><span class="sd">    Args:</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a><span class="sd">        eps (float, optional): Tolerance. Defaults to 0.0001.</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a><span class="sd">    Returns:</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a><span class="sd">        bool: True if the line is vertical, False otherwise.</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i_vec</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">eps</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a><span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the length of a line.</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a><span class="sd">    Args:</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a><span class="sd">    Returns:</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a><span class="sd">        float: Length of the line.</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>    <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a><span class="k">def</span> <span class="nf">lerp_point</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear interpolation of two points.</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a><span class="sd">    Args:</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a><span class="sd">        t (float): Interpolation parameter. t = 0 =&gt; p1, t = 1 =&gt; p2.</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a><span class="sd">    Returns:</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a><span class="sd">        Point: Interpolated point.</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">lerp</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">lerp</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a><span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the slope of a line given by two points.</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a><span class="sd">    Order makes a difference.</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a><span class="sd">    Args:</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a><span class="sd">    Returns:</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a><span class="sd">        float: Slope of the line.</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">start_point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">end_point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;INF&quot;</span><span class="p">]</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="k">def</span> <span class="nf">segmentize_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">segment_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of points that would form segments with the given length.</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">    Args:</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a><span class="sd">        segment_length (float): Length of each segment.</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a><span class="sd">    Returns:</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a><span class="sd">        list[Line]: List of segments.</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>    <span class="n">increments</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length_</span> <span class="o">/</span> <span class="n">segment_length</span><span class="p">)</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>    <span class="n">x_segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">increments</span><span class="p">)</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>    <span class="n">y_segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">increments</span><span class="p">)</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x_segments</span><span class="p">,</span> <span class="n">y_segments</span><span class="p">))</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a><span class="k">def</span> <span class="nf">line_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the orientation angle (in radians) of a line given by start and end points.</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a><span class="sd">    Order makes a difference.</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a><span class="sd">    Args:</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a><span class="sd">    Returns:</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a><span class="sd">        float: Orientation angle of the line in radians.</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a><span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle of a line drawn from the given point to the origin in radians.</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a><span class="sd">    Args:</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a><span class="sd">    Returns:</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a><span class="sd">        float: Angle of the point in radians.</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="k">def</span> <span class="nf">inclination_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the inclination angle (in radians) of a line given by start and end points.</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">    Inclination angle is always between zero and pi.</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">    Order makes no difference.</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">    Args:</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a><span class="sd">    Returns:</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a><span class="sd">        float: Inclination angle of the line in radians.</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>    <span class="k">return</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a><span class="k">def</span> <span class="nf">line2vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector representation of a line</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a><span class="sd">    Args:</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a><span class="sd">    Returns:</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a><span class="sd">        VecType: Vector representation of the line.</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a><span class="k">def</span> <span class="nf">line_through_point_and_angle</span><span class="p">(</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">length_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a line through the given point with the given angle and length</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a><span class="sd">    Args:</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a><span class="sd">        point (Point): Point through which the line passes.</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a><span class="sd">        length_ (float, optional): Length of the line. Defaults to 100.</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a><span class="sd">    Returns:</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a><span class="sd">        Line: Line passing through the given point with the given angle and length.</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="k">def</span> <span class="nf">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector representation of a line.</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a><span class="sd">    Args:</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a><span class="sd">    Returns:</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a><span class="sd">        VecType: Vector representation of the line.</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>    <span class="k">return</span> <span class="n">Vector2D</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a><span class="k">def</span> <span class="nf">mid_point</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the mid point of two points.</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a><span class="sd">    Args:</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a><span class="sd">    Returns:</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a><span class="sd">        Point: Mid point of the two points.</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">VecType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the norm (vector length) of a vector.</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a><span class="sd">    Args:</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a><span class="sd">        vec (VecType): Input vector.</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a><span class="sd">    Returns:</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a><span class="sd">        float: Norm of the vector.</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>    <span class="k">return</span> <span class="n">hypot</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a><span class="k">def</span> <span class="nf">ndarray_to_xy_list</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a numpy array to a list of points.</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a><span class="sd">    Args:</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a><span class="sd">        arr (np.ndarray): Input numpy array.</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a><span class="sd">    Returns:</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a><span class="sd">        Sequence[Point]: List of points.</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>    <span class="k">return</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a><span class="k">def</span> <span class="nf">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an offset line from a given line.</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a><span class="sd">    Args:</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a><span class="sd">        line (Sequence[Point]): Input line.</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a><span class="sd">    Returns:</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a><span class="sd">        Sequence[Point]: Offset line.</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="n">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">],</span> <span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a><span class="k">def</span> <span class="nf">offset_lines</span><span class="p">(</span><span class="n">polylines</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of offset lines from a list of lines.</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a><span class="sd">    Args:</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a><span class="sd">        polylines (Sequence[Line]): List of input lines.</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a><span class="sd">    Returns:</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a><span class="sd">        list[Line]: List of offset lines.</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>    <span class="k">def</span> <span class="nf">stitch_</span><span class="p">(</span><span class="n">polyline</span><span class="p">):</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>        <span class="n">line1</span> <span class="o">=</span> <span class="n">polyline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polyline</span><span class="p">):</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">polyline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>                <span class="k">break</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>            <span class="n">line2</span> <span class="o">=</span> <span class="n">polyline</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>            <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">stitch_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>            <span class="n">line1</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">polylines</span><span class="p">:</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch_</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">VecType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the normalized vector.</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a><span class="sd">    Args:</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a><span class="sd">        vec (VecType): Input vector.</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a><span class="sd">    Returns:</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a><span class="sd">        VecType: Normalized vector.</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a><span class="k">def</span> <span class="nf">offset_point_on_line</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point on a line that is offset from the given point.</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a><span class="sd">    Args:</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a><span class="sd">    Returns:</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a><span class="sd">        Point: Offset point on the line.</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>    <span class="c1"># normalize the vector</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>    <span class="n">mag</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">mag</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">mag</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a><span class="k">def</span> <span class="nf">offset_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an offset point from a given point.</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a><span class="sd">    Args:</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a><span class="sd">        dx (float, optional): Offset distance in x-direction. Defaults to 0.</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a><span class="sd">        dy (float, optional): Offset distance in y-direction. Defaults to 0.</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a><span class="sd">    Returns:</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a><span class="sd">        Point: Offset point.</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a><span class="k">def</span> <span class="nf">parallel_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a parallel line to the given line that goes through the given point</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a><span class="sd">    Args:</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a><span class="sd">        point (Point): Point through which the parallel line passes.</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a><span class="sd">    Returns:</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a><span class="sd">        Line: Parallel line.</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">],</span> <span class="p">[</span><span class="n">x3</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y3</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a><span class="k">def</span> <span class="nf">perp_offset_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point that is offset from the given point in the perpendicular direction to the given line.</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a><span class="sd">    Args:</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a><span class="sd">    Returns:</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a><span class="sd">        Point: Perpendicular offset point.</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="n">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a><span class="k">def</span> <span class="nf">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the perpendicular unit vector to a line</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a><span class="sd">    Args:</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a><span class="sd">    Returns:</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a><span class="sd">        VecType: Perpendicular unit vector.</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a>    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a><span class="k">def</span> <span class="nf">tfl_by_sides</span><span class="p">(</span><span class="n">point1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">side1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">side2</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Triangle from line segment and two sides.</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a><span class="sd">    Returns the points of the triangle given by the two points and the two sides.</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a><span class="sd">        Args:</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a><span class="sd">            point1 (Point): First point of the line segment.</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a><span class="sd">            point2 (Point): Second point of the line segment.</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a><span class="sd">            side1 (float): Length of the first side.</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a><span class="sd">            side2 (float): Length of the second side.</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a><span class="sd">        Returns:</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a><span class="sd">            list[Point]: List of points of the triangle.</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>        <span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>    <span class="p">)</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! Points are coincident.&quot;</span><span class="p">)</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">+</span> <span class="n">side2</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the sides is less than the distance between the points.&quot;</span><span class="p">)</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">side2</span><span class="p">:</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the first side and the distance between the points is less than the second side.&quot;</span><span class="p">)</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a>    <span class="k">if</span> <span class="n">side2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">side1</span><span class="p">:</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the second side and the distance between the points is less than the first side.&quot;</span><span class="p">)</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">side2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! One of the sides is zero.&quot;</span><span class="p">)</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">side2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! One of the sides is negative.&quot;</span><span class="p">)</span>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="n">circle_circle_intersections</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">side1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">side2</span><span class="p">)</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a><span class="k">def</span> <span class="nf">point_on_line</span><span class="p">(</span>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given point is on the given line</span>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a><span class="sd">    Args:</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a><span class="sd">    Returns:</span>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a><span class="sd">        bool: True if the point is on the line, False otherwise.</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">slope</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">point</span><span class="p">),</span> <span class="n">slope</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a><span class="k">def</span> <span class="nf">point_on_line_segment</span><span class="p">(</span>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given point is on the given line segment</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a><span class="sd">    Args:</span>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a><span class="sd">        line (Line): Input line segment.</span>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a><span class="sd">    Returns:</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a><span class="sd">        bool: True if the point is on the line segment, False otherwise.</span>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a>        <span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">+</span> <span class="n">distance</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">point</span><span class="p">)),</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a>        <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a>        <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a>        <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a>    <span class="p">)</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a><span class="k">def</span> <span class="nf">point_to_line_distance</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector from a point to a line</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a><span class="sd">    Args:</span>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos">2363</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos">2364</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos">2365</span></a>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos">2366</span></a><span class="sd">    Returns:</span>
</span><span id="L-2367"><a href="#L-2367"><span class="linenos">2367</span></a><span class="sd">        float: Distance from the point to the line.</span>
</span><span id="L-2368"><a href="#L-2368"><span class="linenos">2368</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2369"><a href="#L-2369"><span class="linenos">2369</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-2370"><a href="#L-2370"><span class="linenos">2370</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2371"><a href="#L-2371"><span class="linenos">2371</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2372"><a href="#L-2372"><span class="linenos">2372</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2373"><a href="#L-2373"><span class="linenos">2373</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2374"><a href="#L-2374"><span class="linenos">2374</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">))</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2375"><a href="#L-2375"><span class="linenos">2375</span></a>
</span><span id="L-2376"><a href="#L-2376"><span class="linenos">2376</span></a>
</span><span id="L-2377"><a href="#L-2377"><span class="linenos">2377</span></a><span class="k">def</span> <span class="nf">point_to_line_seg_distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lp1</span><span class="p">,</span> <span class="n">lp2</span><span class="p">):</span>
</span><span id="L-2378"><a href="#L-2378"><span class="linenos">2378</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point p and a line segment defined by boundary points</span>
</span><span id="L-2379"><a href="#L-2379"><span class="linenos">2379</span></a><span class="sd">    lp1 and lp2, returns the distance between the line segment and the point.</span>
</span><span id="L-2380"><a href="#L-2380"><span class="linenos">2380</span></a><span class="sd">    If the point is not located in the perpendicular area between the</span>
</span><span id="L-2381"><a href="#L-2381"><span class="linenos">2381</span></a><span class="sd">    boundary points, returns False.</span>
</span><span id="L-2382"><a href="#L-2382"><span class="linenos">2382</span></a>
</span><span id="L-2383"><a href="#L-2383"><span class="linenos">2383</span></a><span class="sd">    Args:</span>
</span><span id="L-2384"><a href="#L-2384"><span class="linenos">2384</span></a><span class="sd">        p (Point): Input point.</span>
</span><span id="L-2385"><a href="#L-2385"><span class="linenos">2385</span></a><span class="sd">        lp1 (Point): First boundary point of the line segment.</span>
</span><span id="L-2386"><a href="#L-2386"><span class="linenos">2386</span></a><span class="sd">        lp2 (Point): Second boundary point of the line segment.</span>
</span><span id="L-2387"><a href="#L-2387"><span class="linenos">2387</span></a>
</span><span id="L-2388"><a href="#L-2388"><span class="linenos">2388</span></a><span class="sd">    Returns:</span>
</span><span id="L-2389"><a href="#L-2389"><span class="linenos">2389</span></a><span class="sd">        float: Distance between the point and the line segment, or False if the point is not in the perpendicular area.</span>
</span><span id="L-2390"><a href="#L-2390"><span class="linenos">2390</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2391"><a href="#L-2391"><span class="linenos">2391</span></a>    <span class="k">if</span> <span class="n">lp1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">lp2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="L-2392"><a href="#L-2392"><span class="linenos">2392</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error! Line is ill defined. Start and end points are coincident.&quot;</span>
</span><span id="L-2393"><a href="#L-2393"><span class="linenos">2393</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-2394"><a href="#L-2394"><span class="linenos">2394</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2395"><a href="#L-2395"><span class="linenos">2395</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">lp1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2396"><a href="#L-2396"><span class="linenos">2396</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">lp2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2397"><a href="#L-2397"><span class="linenos">2397</span></a>
</span><span id="L-2398"><a href="#L-2398"><span class="linenos">2398</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span> <span class="o">/</span> <span class="n">distance</span><span class="p">(</span><span class="n">lp1</span><span class="p">,</span> <span class="n">lp2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-2399"><a href="#L-2399"><span class="linenos">2399</span></a>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2400"><a href="#L-2400"><span class="linenos">2400</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-2401"><a href="#L-2401"><span class="linenos">2401</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-2402"><a href="#L-2402"><span class="linenos">2402</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
</span><span id="L-2403"><a href="#L-2403"><span class="linenos">2403</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2404"><a href="#L-2404"><span class="linenos">2404</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># p is not between lp1 and lp2</span>
</span><span id="L-2405"><a href="#L-2405"><span class="linenos">2405</span></a>
</span><span id="L-2406"><a href="#L-2406"><span class="linenos">2406</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-2407"><a href="#L-2407"><span class="linenos">2407</span></a>
</span><span id="L-2408"><a href="#L-2408"><span class="linenos">2408</span></a><span class="k">def</span> <span class="nf">rotate_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-2409"><a href="#L-2409"><span class="linenos">2409</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2410"><a href="#L-2410"><span class="linenos">2410</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2411"><a href="#L-2411"><span class="linenos">2411</span></a>    <span class="n">x</span> <span class="o">-=</span> <span class="n">cx</span>
</span><span id="L-2412"><a href="#L-2412"><span class="linenos">2412</span></a>    <span class="n">y</span> <span class="o">-=</span> <span class="n">cy</span>
</span><span id="L-2413"><a href="#L-2413"><span class="linenos">2413</span></a>    <span class="n">cos_angle</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-2414"><a href="#L-2414"><span class="linenos">2414</span></a>    <span class="n">sin_angle</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-2415"><a href="#L-2415"><span class="linenos">2415</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">cos_angle</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">sin_angle</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">sin_angle</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">cos_angle</span>
</span><span id="L-2416"><a href="#L-2416"><span class="linenos">2416</span></a>    <span class="n">x</span> <span class="o">+=</span> <span class="n">cx</span>
</span><span id="L-2417"><a href="#L-2417"><span class="linenos">2417</span></a>    <span class="n">y</span> <span class="o">+=</span> <span class="n">cy</span>
</span><span id="L-2418"><a href="#L-2418"><span class="linenos">2418</span></a>
</span><span id="L-2419"><a href="#L-2419"><span class="linenos">2419</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-2420"><a href="#L-2420"><span class="linenos">2420</span></a>
</span><span id="L-2421"><a href="#L-2421"><span class="linenos">2421</span></a>
</span><span id="L-2422"><a href="#L-2422"><span class="linenos">2422</span></a><span class="k">def</span> <span class="nf">point_to_line_vec</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2423"><a href="#L-2423"><span class="linenos">2423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the perpendicular vector from a point to a line</span>
</span><span id="L-2424"><a href="#L-2424"><span class="linenos">2424</span></a>
</span><span id="L-2425"><a href="#L-2425"><span class="linenos">2425</span></a><span class="sd">    Args:</span>
</span><span id="L-2426"><a href="#L-2426"><span class="linenos">2426</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2427"><a href="#L-2427"><span class="linenos">2427</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2428"><a href="#L-2428"><span class="linenos">2428</span></a><span class="sd">        unit (bool, optional): Whether to return a unit vector. Defaults to False.</span>
</span><span id="L-2429"><a href="#L-2429"><span class="linenos">2429</span></a>
</span><span id="L-2430"><a href="#L-2430"><span class="linenos">2430</span></a><span class="sd">    Returns:</span>
</span><span id="L-2431"><a href="#L-2431"><span class="linenos">2431</span></a><span class="sd">        VecType: Perpendicular vector from the point to the line.</span>
</span><span id="L-2432"><a href="#L-2432"><span class="linenos">2432</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2433"><a href="#L-2433"><span class="linenos">2433</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-2434"><a href="#L-2434"><span class="linenos">2434</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2435"><a href="#L-2435"><span class="linenos">2435</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2436"><a href="#L-2436"><span class="linenos">2436</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2437"><a href="#L-2437"><span class="linenos">2437</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2438"><a href="#L-2438"><span class="linenos">2438</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2439"><a href="#L-2439"><span class="linenos">2439</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="L-2440"><a href="#L-2440"><span class="linenos">2440</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2441"><a href="#L-2441"><span class="linenos">2441</span></a>    <span class="k">if</span> <span class="n">unit</span><span class="p">:</span>
</span><span id="L-2442"><a href="#L-2442"><span class="linenos">2442</span></a>        <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2443"><a href="#L-2443"><span class="linenos">2443</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-2444"><a href="#L-2444"><span class="linenos">2444</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2445"><a href="#L-2445"><span class="linenos">2445</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-2446"><a href="#L-2446"><span class="linenos">2446</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2447"><a href="#L-2447"><span class="linenos">2447</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dist</span><span class="p">,</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dist</span><span class="p">]</span>
</span><span id="L-2448"><a href="#L-2448"><span class="linenos">2448</span></a>
</span><span id="L-2449"><a href="#L-2449"><span class="linenos">2449</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-2450"><a href="#L-2450"><span class="linenos">2450</span></a>
</span><span id="L-2451"><a href="#L-2451"><span class="linenos">2451</span></a>
</span><span id="L-2452"><a href="#L-2452"><span class="linenos">2452</span></a><span class="k">def</span> <span class="nf">polygon_area</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2453"><a href="#L-2453"><span class="linenos">2453</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a polygon.</span>
</span><span id="L-2454"><a href="#L-2454"><span class="linenos">2454</span></a>
</span><span id="L-2455"><a href="#L-2455"><span class="linenos">2455</span></a><span class="sd">    Args:</span>
</span><span id="L-2456"><a href="#L-2456"><span class="linenos">2456</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="L-2457"><a href="#L-2457"><span class="linenos">2457</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-2458"><a href="#L-2458"><span class="linenos">2458</span></a>
</span><span id="L-2459"><a href="#L-2459"><span class="linenos">2459</span></a><span class="sd">    Returns:</span>
</span><span id="L-2460"><a href="#L-2460"><span class="linenos">2460</span></a><span class="sd">        float: Area of the polygon.</span>
</span><span id="L-2461"><a href="#L-2461"><span class="linenos">2461</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2462"><a href="#L-2462"><span class="linenos">2462</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2463"><a href="#L-2463"><span class="linenos">2463</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-2464"><a href="#L-2464"><span class="linenos">2464</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-2465"><a href="#L-2465"><span class="linenos">2465</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-2466"><a href="#L-2466"><span class="linenos">2466</span></a>        <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:])</span>
</span><span id="L-2467"><a href="#L-2467"><span class="linenos">2467</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2468"><a href="#L-2468"><span class="linenos">2468</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2469"><a href="#L-2469"><span class="linenos">2469</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-2470"><a href="#L-2470"><span class="linenos">2470</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-2471"><a href="#L-2471"><span class="linenos">2471</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-2472"><a href="#L-2472"><span class="linenos">2472</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="L-2473"><a href="#L-2473"><span class="linenos">2473</span></a>
</span><span id="L-2474"><a href="#L-2474"><span class="linenos">2474</span></a>    <span class="k">return</span> <span class="n">area_</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-2475"><a href="#L-2475"><span class="linenos">2475</span></a>
</span><span id="L-2476"><a href="#L-2476"><span class="linenos">2476</span></a>
</span><span id="L-2477"><a href="#L-2477"><span class="linenos">2477</span></a><span class="k">def</span> <span class="nf">polyline_length</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2478"><a href="#L-2478"><span class="linenos">2478</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the perimeter of a polygon.</span>
</span><span id="L-2479"><a href="#L-2479"><span class="linenos">2479</span></a>
</span><span id="L-2480"><a href="#L-2480"><span class="linenos">2480</span></a><span class="sd">    Args:</span>
</span><span id="L-2481"><a href="#L-2481"><span class="linenos">2481</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="L-2482"><a href="#L-2482"><span class="linenos">2482</span></a><span class="sd">        closed (bool, optional): Whether the polygon is closed. Defaults to False.</span>
</span><span id="L-2483"><a href="#L-2483"><span class="linenos">2483</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-2484"><a href="#L-2484"><span class="linenos">2484</span></a>
</span><span id="L-2485"><a href="#L-2485"><span class="linenos">2485</span></a><span class="sd">    Returns:</span>
</span><span id="L-2486"><a href="#L-2486"><span class="linenos">2486</span></a><span class="sd">        float: Perimeter of the polygon.</span>
</span><span id="L-2487"><a href="#L-2487"><span class="linenos">2487</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2488"><a href="#L-2488"><span class="linenos">2488</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2489"><a href="#L-2489"><span class="linenos">2489</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-2490"><a href="#L-2490"><span class="linenos">2490</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-2491"><a href="#L-2491"><span class="linenos">2491</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="L-2492"><a href="#L-2492"><span class="linenos">2492</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-2493"><a href="#L-2493"><span class="linenos">2493</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[:]</span>
</span><span id="L-2494"><a href="#L-2494"><span class="linenos">2494</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2495"><a href="#L-2495"><span class="linenos">2495</span></a>    <span class="n">perimeter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2496"><a href="#L-2496"><span class="linenos">2496</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-2497"><a href="#L-2497"><span class="linenos">2497</span></a>        <span class="n">perimeter</span> <span class="o">+=</span> <span class="n">distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-2498"><a href="#L-2498"><span class="linenos">2498</span></a>    <span class="k">return</span> <span class="n">perimeter</span>
</span><span id="L-2499"><a href="#L-2499"><span class="linenos">2499</span></a>
</span><span id="L-2500"><a href="#L-2500"><span class="linenos">2500</span></a>
</span><span id="L-2501"><a href="#L-2501"><span class="linenos">2501</span></a><span class="k">def</span> <span class="nf">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2502"><a href="#L-2502"><span class="linenos">2502</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;If polygon is counter-clockwise, return True</span>
</span><span id="L-2503"><a href="#L-2503"><span class="linenos">2503</span></a>
</span><span id="L-2504"><a href="#L-2504"><span class="linenos">2504</span></a><span class="sd">    Args:</span>
</span><span id="L-2505"><a href="#L-2505"><span class="linenos">2505</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="L-2506"><a href="#L-2506"><span class="linenos">2506</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-2507"><a href="#L-2507"><span class="linenos">2507</span></a>
</span><span id="L-2508"><a href="#L-2508"><span class="linenos">2508</span></a><span class="sd">    Returns:</span>
</span><span id="L-2509"><a href="#L-2509"><span class="linenos">2509</span></a><span class="sd">        bool: True if the polygon is counter-clockwise, False otherwise.</span>
</span><span id="L-2510"><a href="#L-2510"><span class="linenos">2510</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2511"><a href="#L-2511"><span class="linenos">2511</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2512"><a href="#L-2512"><span class="linenos">2512</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-2513"><a href="#L-2513"><span class="linenos">2513</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-2514"><a href="#L-2514"><span class="linenos">2514</span></a>    <span class="n">added_point</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-2515"><a href="#L-2515"><span class="linenos">2515</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-2516"><a href="#L-2516"><span class="linenos">2516</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2517"><a href="#L-2517"><span class="linenos">2517</span></a>        <span class="n">added_point</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-2518"><a href="#L-2518"><span class="linenos">2518</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2519"><a href="#L-2519"><span class="linenos">2519</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-2520"><a href="#L-2520"><span class="linenos">2520</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-2521"><a href="#L-2521"><span class="linenos">2521</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-2522"><a href="#L-2522"><span class="linenos">2522</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="L-2523"><a href="#L-2523"><span class="linenos">2523</span></a>    <span class="k">if</span> <span class="n">added_point</span><span class="p">:</span>
</span><span id="L-2524"><a href="#L-2524"><span class="linenos">2524</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-2525"><a href="#L-2525"><span class="linenos">2525</span></a>    <span class="k">return</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-2526"><a href="#L-2526"><span class="linenos">2526</span></a>
</span><span id="L-2527"><a href="#L-2527"><span class="linenos">2527</span></a>
</span><span id="L-2528"><a href="#L-2528"><span class="linenos">2528</span></a><span class="k">def</span> <span class="nf">radius2side_len</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2529"><a href="#L-2529"><span class="linenos">2529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a radius and the number of sides, return the side length</span>
</span><span id="L-2530"><a href="#L-2530"><span class="linenos">2530</span></a><span class="sd">    of an n-sided regular polygon with the given radius</span>
</span><span id="L-2531"><a href="#L-2531"><span class="linenos">2531</span></a>
</span><span id="L-2532"><a href="#L-2532"><span class="linenos">2532</span></a><span class="sd">    Args:</span>
</span><span id="L-2533"><a href="#L-2533"><span class="linenos">2533</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="L-2534"><a href="#L-2534"><span class="linenos">2534</span></a><span class="sd">        radius (float): Radius of the polygon.</span>
</span><span id="L-2535"><a href="#L-2535"><span class="linenos">2535</span></a>
</span><span id="L-2536"><a href="#L-2536"><span class="linenos">2536</span></a><span class="sd">    Returns:</span>
</span><span id="L-2537"><a href="#L-2537"><span class="linenos">2537</span></a><span class="sd">        float: Side length of the polygon.</span>
</span><span id="L-2538"><a href="#L-2538"><span class="linenos">2538</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2539"><a href="#L-2539"><span class="linenos">2539</span></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</span><span id="L-2540"><a href="#L-2540"><span class="linenos">2540</span></a>
</span><span id="L-2541"><a href="#L-2541"><span class="linenos">2541</span></a>
</span><span id="L-2542"><a href="#L-2542"><span class="linenos">2542</span></a><span class="k">def</span> <span class="nf">tokenize_svg_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-2543"><a href="#L-2543"><span class="linenos">2543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tokenize an SVG path string.</span>
</span><span id="L-2544"><a href="#L-2544"><span class="linenos">2544</span></a>
</span><span id="L-2545"><a href="#L-2545"><span class="linenos">2545</span></a><span class="sd">    Args:</span>
</span><span id="L-2546"><a href="#L-2546"><span class="linenos">2546</span></a><span class="sd">        path (str): SVG path string.</span>
</span><span id="L-2547"><a href="#L-2547"><span class="linenos">2547</span></a>
</span><span id="L-2548"><a href="#L-2548"><span class="linenos">2548</span></a><span class="sd">    Returns:</span>
</span><span id="L-2549"><a href="#L-2549"><span class="linenos">2549</span></a><span class="sd">        list[str]: List of tokens.</span>
</span><span id="L-2550"><a href="#L-2550"><span class="linenos">2550</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2551"><a href="#L-2551"><span class="linenos">2551</span></a>    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-zA-Z]|[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-2552"><a href="#L-2552"><span class="linenos">2552</span></a>
</span><span id="L-2553"><a href="#L-2553"><span class="linenos">2553</span></a>
</span><span id="L-2554"><a href="#L-2554"><span class="linenos">2554</span></a><span class="k">def</span> <span class="nf">law_of_cosines</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2555"><a href="#L-2555"><span class="linenos">2555</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle of a triangle given the three sides.</span>
</span><span id="L-2556"><a href="#L-2556"><span class="linenos">2556</span></a><span class="sd">    Returns the angle of A in radians. A is the angle between</span>
</span><span id="L-2557"><a href="#L-2557"><span class="linenos">2557</span></a><span class="sd">    sides b and c.</span>
</span><span id="L-2558"><a href="#L-2558"><span class="linenos">2558</span></a><span class="sd">    cos(A) = (b^2 + c^2 - a^2) / (2 * b * c)</span>
</span><span id="L-2559"><a href="#L-2559"><span class="linenos">2559</span></a>
</span><span id="L-2560"><a href="#L-2560"><span class="linenos">2560</span></a><span class="sd">    Args:</span>
</span><span id="L-2561"><a href="#L-2561"><span class="linenos">2561</span></a><span class="sd">        a (float): Length of side a.</span>
</span><span id="L-2562"><a href="#L-2562"><span class="linenos">2562</span></a><span class="sd">        b (float): Length of side b.</span>
</span><span id="L-2563"><a href="#L-2563"><span class="linenos">2563</span></a><span class="sd">        c (float): Length of side c.</span>
</span><span id="L-2564"><a href="#L-2564"><span class="linenos">2564</span></a>
</span><span id="L-2565"><a href="#L-2565"><span class="linenos">2565</span></a><span class="sd">    Returns:</span>
</span><span id="L-2566"><a href="#L-2566"><span class="linenos">2566</span></a><span class="sd">        float: Angle of A in radians.</span>
</span><span id="L-2567"><a href="#L-2567"><span class="linenos">2567</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2568"><a href="#L-2568"><span class="linenos">2568</span></a>    <span class="k">return</span> <span class="n">acos</span><span class="p">((</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span><span id="L-2569"><a href="#L-2569"><span class="linenos">2569</span></a>
</span><span id="L-2570"><a href="#L-2570"><span class="linenos">2570</span></a>
</span><span id="L-2571"><a href="#L-2571"><span class="linenos">2571</span></a><span class="k">def</span> <span class="nf">segmentize_catmull_rom</span><span class="p">(</span>
</span><span id="L-2572"><a href="#L-2572"><span class="linenos">2572</span></a>    <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="L-2573"><a href="#L-2573"><span class="linenos">2573</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-2574"><a href="#L-2574"><span class="linenos">2574</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;a and b are the control points and c and d are</span>
</span><span id="L-2575"><a href="#L-2575"><span class="linenos">2575</span></a><span class="sd">    start and end points respectively,</span>
</span><span id="L-2576"><a href="#L-2576"><span class="linenos">2576</span></a><span class="sd">    n is the number of segments to generate.</span>
</span><span id="L-2577"><a href="#L-2577"><span class="linenos">2577</span></a>
</span><span id="L-2578"><a href="#L-2578"><span class="linenos">2578</span></a><span class="sd">    Args:</span>
</span><span id="L-2579"><a href="#L-2579"><span class="linenos">2579</span></a><span class="sd">        a (float): First control point.</span>
</span><span id="L-2580"><a href="#L-2580"><span class="linenos">2580</span></a><span class="sd">        b (float): Second control point.</span>
</span><span id="L-2581"><a href="#L-2581"><span class="linenos">2581</span></a><span class="sd">        c (float): Start point.</span>
</span><span id="L-2582"><a href="#L-2582"><span class="linenos">2582</span></a><span class="sd">        d (float): End point.</span>
</span><span id="L-2583"><a href="#L-2583"><span class="linenos">2583</span></a><span class="sd">        n (int, optional): Number of segments to generate. Defaults to 100.</span>
</span><span id="L-2584"><a href="#L-2584"><span class="linenos">2584</span></a>
</span><span id="L-2585"><a href="#L-2585"><span class="linenos">2585</span></a><span class="sd">    Returns:</span>
</span><span id="L-2586"><a href="#L-2586"><span class="linenos">2586</span></a><span class="sd">        Sequence[float]: List of points representing the segments.</span>
</span><span id="L-2587"><a href="#L-2587"><span class="linenos">2587</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2588"><a href="#L-2588"><span class="linenos">2588</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-2589"><a href="#L-2589"><span class="linenos">2589</span></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-2590"><a href="#L-2590"><span class="linenos">2590</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-2591"><a href="#L-2591"><span class="linenos">2591</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-2592"><a href="#L-2592"><span class="linenos">2592</span></a>
</span><span id="L-2593"><a href="#L-2593"><span class="linenos">2593</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2594"><a href="#L-2594"><span class="linenos">2594</span></a>    <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-2595"><a href="#L-2595"><span class="linenos">2595</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2596"><a href="#L-2596"><span class="linenos">2596</span></a>    <span class="n">term1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="L-2597"><a href="#L-2597"><span class="linenos">2597</span></a>    <span class="n">term2</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="L-2598"><a href="#L-2598"><span class="linenos">2598</span></a>    <span class="n">term3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">d</span>
</span><span id="L-2599"><a href="#L-2599"><span class="linenos">2599</span></a>    <span class="n">term4</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
</span><span id="L-2600"><a href="#L-2600"><span class="linenos">2600</span></a>
</span><span id="L-2601"><a href="#L-2601"><span class="linenos">2601</span></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-2602"><a href="#L-2602"><span class="linenos">2602</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">term3</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">term4</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-2603"><a href="#L-2603"><span class="linenos">2603</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-2604"><a href="#L-2604"><span class="linenos">2604</span></a>        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
</span><span id="L-2605"><a href="#L-2605"><span class="linenos">2605</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-2606"><a href="#L-2606"><span class="linenos">2606</span></a>
</span><span id="L-2607"><a href="#L-2607"><span class="linenos">2607</span></a>
</span><span id="L-2608"><a href="#L-2608"><span class="linenos">2608</span></a><span class="k">def</span> <span class="nf">side_len_to_radius</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">side_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2609"><a href="#L-2609"><span class="linenos">2609</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a side length and the number of sides, return the radius</span>
</span><span id="L-2610"><a href="#L-2610"><span class="linenos">2610</span></a><span class="sd">    of an n-sided regular polygon with the given side_len length</span>
</span><span id="L-2611"><a href="#L-2611"><span class="linenos">2611</span></a>
</span><span id="L-2612"><a href="#L-2612"><span class="linenos">2612</span></a><span class="sd">    Args:</span>
</span><span id="L-2613"><a href="#L-2613"><span class="linenos">2613</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="L-2614"><a href="#L-2614"><span class="linenos">2614</span></a><span class="sd">        side_len (float): Side length of the polygon.</span>
</span><span id="L-2615"><a href="#L-2615"><span class="linenos">2615</span></a>
</span><span id="L-2616"><a href="#L-2616"><span class="linenos">2616</span></a><span class="sd">    Returns:</span>
</span><span id="L-2617"><a href="#L-2617"><span class="linenos">2617</span></a><span class="sd">        float: Radius of the polygon.</span>
</span><span id="L-2618"><a href="#L-2618"><span class="linenos">2618</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2619"><a href="#L-2619"><span class="linenos">2619</span></a>    <span class="k">return</span> <span class="n">side_len</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">))</span>
</span><span id="L-2620"><a href="#L-2620"><span class="linenos">2620</span></a>
</span><span id="L-2621"><a href="#L-2621"><span class="linenos">2621</span></a>
</span><span id="L-2622"><a href="#L-2622"><span class="linenos">2622</span></a><span class="k">def</span> <span class="nf">translate_line</span><span class="p">(</span><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-2623"><a href="#L-2623"><span class="linenos">2623</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a translated line by dx and dy</span>
</span><span id="L-2624"><a href="#L-2624"><span class="linenos">2624</span></a>
</span><span id="L-2625"><a href="#L-2625"><span class="linenos">2625</span></a><span class="sd">    Args:</span>
</span><span id="L-2626"><a href="#L-2626"><span class="linenos">2626</span></a><span class="sd">        dx (float): Translation distance in x-direction.</span>
</span><span id="L-2627"><a href="#L-2627"><span class="linenos">2627</span></a><span class="sd">        dy (float): Translation distance in y-direction.</span>
</span><span id="L-2628"><a href="#L-2628"><span class="linenos">2628</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2629"><a href="#L-2629"><span class="linenos">2629</span></a>
</span><span id="L-2630"><a href="#L-2630"><span class="linenos">2630</span></a><span class="sd">    Returns:</span>
</span><span id="L-2631"><a href="#L-2631"><span class="linenos">2631</span></a><span class="sd">        Line: Translated line.</span>
</span><span id="L-2632"><a href="#L-2632"><span class="linenos">2632</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2633"><a href="#L-2633"><span class="linenos">2633</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2634"><a href="#L-2634"><span class="linenos">2634</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2635"><a href="#L-2635"><span class="linenos">2635</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">],</span> <span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span><span id="L-2636"><a href="#L-2636"><span class="linenos">2636</span></a>
</span><span id="L-2637"><a href="#L-2637"><span class="linenos">2637</span></a>
</span><span id="L-2638"><a href="#L-2638"><span class="linenos">2638</span></a><span class="k">def</span> <span class="nf">trim_line</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-2639"><a href="#L-2639"><span class="linenos">2639</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Trim line1 to the intersection of line1 and line2.</span>
</span><span id="L-2640"><a href="#L-2640"><span class="linenos">2640</span></a><span class="sd">    Extend it if necessary.</span>
</span><span id="L-2641"><a href="#L-2641"><span class="linenos">2641</span></a>
</span><span id="L-2642"><a href="#L-2642"><span class="linenos">2642</span></a><span class="sd">    Args:</span>
</span><span id="L-2643"><a href="#L-2643"><span class="linenos">2643</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-2644"><a href="#L-2644"><span class="linenos">2644</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-2645"><a href="#L-2645"><span class="linenos">2645</span></a>
</span><span id="L-2646"><a href="#L-2646"><span class="linenos">2646</span></a><span class="sd">    Returns:</span>
</span><span id="L-2647"><a href="#L-2647"><span class="linenos">2647</span></a><span class="sd">        Line: Trimmed line.</span>
</span><span id="L-2648"><a href="#L-2648"><span class="linenos">2648</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2649"><a href="#L-2649"><span class="linenos">2649</span></a>    <span class="n">intersection_</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="L-2650"><a href="#L-2650"><span class="linenos">2650</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intersection_</span><span class="p">]</span>
</span><span id="L-2651"><a href="#L-2651"><span class="linenos">2651</span></a>
</span><span id="L-2652"><a href="#L-2652"><span class="linenos">2652</span></a>
</span><span id="L-2653"><a href="#L-2653"><span class="linenos">2653</span></a><span class="k">def</span> <span class="nf">unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2654"><a href="#L-2654"><span class="linenos">2654</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the unit vector of a line</span>
</span><span id="L-2655"><a href="#L-2655"><span class="linenos">2655</span></a>
</span><span id="L-2656"><a href="#L-2656"><span class="linenos">2656</span></a><span class="sd">    Args:</span>
</span><span id="L-2657"><a href="#L-2657"><span class="linenos">2657</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2658"><a href="#L-2658"><span class="linenos">2658</span></a>
</span><span id="L-2659"><a href="#L-2659"><span class="linenos">2659</span></a><span class="sd">    Returns:</span>
</span><span id="L-2660"><a href="#L-2660"><span class="linenos">2660</span></a><span class="sd">        VecType: Unit vector of the line.</span>
</span><span id="L-2661"><a href="#L-2661"><span class="linenos">2661</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2662"><a href="#L-2662"><span class="linenos">2662</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-2663"><a href="#L-2663"><span class="linenos">2663</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-2664"><a href="#L-2664"><span class="linenos">2664</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="L-2665"><a href="#L-2665"><span class="linenos">2665</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="L-2666"><a href="#L-2666"><span class="linenos">2666</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="L-2667"><a href="#L-2667"><span class="linenos">2667</span></a>
</span><span id="L-2668"><a href="#L-2668"><span class="linenos">2668</span></a>
</span><span id="L-2669"><a href="#L-2669"><span class="linenos">2669</span></a><span class="k">def</span> <span class="nf">unit_vector_</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">VecType</span><span class="p">]:</span>
</span><span id="L-2670"><a href="#L-2670"><span class="linenos">2670</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cartesian unit vector of a line</span>
</span><span id="L-2671"><a href="#L-2671"><span class="linenos">2671</span></a><span class="sd">    with the given line&#39;s start and end points</span>
</span><span id="L-2672"><a href="#L-2672"><span class="linenos">2672</span></a>
</span><span id="L-2673"><a href="#L-2673"><span class="linenos">2673</span></a><span class="sd">    Args:</span>
</span><span id="L-2674"><a href="#L-2674"><span class="linenos">2674</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2675"><a href="#L-2675"><span class="linenos">2675</span></a>
</span><span id="L-2676"><a href="#L-2676"><span class="linenos">2676</span></a><span class="sd">    Returns:</span>
</span><span id="L-2677"><a href="#L-2677"><span class="linenos">2677</span></a><span class="sd">        Sequence[VecType]: Cartesian unit vector of the line.</span>
</span><span id="L-2678"><a href="#L-2678"><span class="linenos">2678</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2679"><a href="#L-2679"><span class="linenos">2679</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2680"><a href="#L-2680"><span class="linenos">2680</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2681"><a href="#L-2681"><span class="linenos">2681</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-2682"><a href="#L-2682"><span class="linenos">2682</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2683"><a href="#L-2683"><span class="linenos">2683</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2684"><a href="#L-2684"><span class="linenos">2684</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="L-2685"><a href="#L-2685"><span class="linenos">2685</span></a>
</span><span id="L-2686"><a href="#L-2686"><span class="linenos">2686</span></a>
</span><span id="L-2687"><a href="#L-2687"><span class="linenos">2687</span></a><span class="k">def</span> <span class="nf">vec_along_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-2688"><a href="#L-2688"><span class="linenos">2688</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a vector along a line with the given magnitude.</span>
</span><span id="L-2689"><a href="#L-2689"><span class="linenos">2689</span></a>
</span><span id="L-2690"><a href="#L-2690"><span class="linenos">2690</span></a><span class="sd">    Args:</span>
</span><span id="L-2691"><a href="#L-2691"><span class="linenos">2691</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="L-2692"><a href="#L-2692"><span class="linenos">2692</span></a><span class="sd">        magnitude (float): Magnitude of the vector.</span>
</span><span id="L-2693"><a href="#L-2693"><span class="linenos">2693</span></a>
</span><span id="L-2694"><a href="#L-2694"><span class="linenos">2694</span></a><span class="sd">    Returns:</span>
</span><span id="L-2695"><a href="#L-2695"><span class="linenos">2695</span></a><span class="sd">        VecType: Vector along the line with the given magnitude.</span>
</span><span id="L-2696"><a href="#L-2696"><span class="linenos">2696</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2697"><a href="#L-2697"><span class="linenos">2697</span></a>    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="n">axis_x</span><span class="p">:</span>
</span><span id="L-2698"><a href="#L-2698"><span class="linenos">2698</span></a>        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="L-2699"><a href="#L-2699"><span class="linenos">2699</span></a>    <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="n">axis_y</span><span class="p">:</span>
</span><span id="L-2700"><a href="#L-2700"><span class="linenos">2700</span></a>        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">magnitude</span>
</span><span id="L-2701"><a href="#L-2701"><span class="linenos">2701</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2702"><a href="#L-2702"><span class="linenos">2702</span></a>        <span class="c1"># line is (p1, p2)</span>
</span><span id="L-2703"><a href="#L-2703"><span class="linenos">2703</span></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-2704"><a href="#L-2704"><span class="linenos">2704</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-2705"><a href="#L-2705"><span class="linenos">2705</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-2706"><a href="#L-2706"><span class="linenos">2706</span></a>    <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
</span><span id="L-2707"><a href="#L-2707"><span class="linenos">2707</span></a>
</span><span id="L-2708"><a href="#L-2708"><span class="linenos">2708</span></a>
</span><span id="L-2709"><a href="#L-2709"><span class="linenos">2709</span></a><span class="k">def</span> <span class="nf">vec_dir_angle</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2710"><a href="#L-2710"><span class="linenos">2710</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the direction angle of a vector</span>
</span><span id="L-2711"><a href="#L-2711"><span class="linenos">2711</span></a>
</span><span id="L-2712"><a href="#L-2712"><span class="linenos">2712</span></a><span class="sd">    Args:</span>
</span><span id="L-2713"><a href="#L-2713"><span class="linenos">2713</span></a><span class="sd">        vec (Sequence[float]): Input vector.</span>
</span><span id="L-2714"><a href="#L-2714"><span class="linenos">2714</span></a>
</span><span id="L-2715"><a href="#L-2715"><span class="linenos">2715</span></a><span class="sd">    Returns:</span>
</span><span id="L-2716"><a href="#L-2716"><span class="linenos">2716</span></a><span class="sd">        float: Direction angle of the vector.</span>
</span><span id="L-2717"><a href="#L-2717"><span class="linenos">2717</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2718"><a href="#L-2718"><span class="linenos">2718</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2719"><a href="#L-2719"><span class="linenos">2719</span></a>
</span><span id="L-2720"><a href="#L-2720"><span class="linenos">2720</span></a>
</span><span id="L-2721"><a href="#L-2721"><span class="linenos">2721</span></a><span class="k">def</span> <span class="nf">cross_product_sense</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-2722"><a href="#L-2722"><span class="linenos">2722</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cross product sense of vectors a and b.</span>
</span><span id="L-2723"><a href="#L-2723"><span class="linenos">2723</span></a>
</span><span id="L-2724"><a href="#L-2724"><span class="linenos">2724</span></a><span class="sd">    Args:</span>
</span><span id="L-2725"><a href="#L-2725"><span class="linenos">2725</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="L-2726"><a href="#L-2726"><span class="linenos">2726</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="L-2727"><a href="#L-2727"><span class="linenos">2727</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="L-2728"><a href="#L-2728"><span class="linenos">2728</span></a>
</span><span id="L-2729"><a href="#L-2729"><span class="linenos">2729</span></a><span class="sd">    Returns:</span>
</span><span id="L-2730"><a href="#L-2730"><span class="linenos">2730</span></a><span class="sd">        int: Cross product sense.</span>
</span><span id="L-2731"><a href="#L-2731"><span class="linenos">2731</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2732"><a href="#L-2732"><span class="linenos">2732</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">cross_product2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="L-2733"><a href="#L-2733"><span class="linenos">2733</span></a>    <span class="k">if</span> <span class="n">length_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2734"><a href="#L-2734"><span class="linenos">2734</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-2735"><a href="#L-2735"><span class="linenos">2735</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2736"><a href="#L-2736"><span class="linenos">2736</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="L-2737"><a href="#L-2737"><span class="linenos">2737</span></a>
</span><span id="L-2738"><a href="#L-2738"><span class="linenos">2738</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-2739"><a href="#L-2739"><span class="linenos">2739</span></a>
</span><span id="L-2740"><a href="#L-2740"><span class="linenos">2740</span></a>
</span><span id="L-2741"><a href="#L-2741"><span class="linenos">2741</span></a><span class="c1">#      A</span>
</span><span id="L-2742"><a href="#L-2742"><span class="linenos">2742</span></a><span class="c1">#      /</span>
</span><span id="L-2743"><a href="#L-2743"><span class="linenos">2743</span></a><span class="c1">#     /</span>
</span><span id="L-2744"><a href="#L-2744"><span class="linenos">2744</span></a><span class="c1">#   B/</span>
</span><span id="L-2745"><a href="#L-2745"><span class="linenos">2745</span></a><span class="c1">#    \</span>
</span><span id="L-2746"><a href="#L-2746"><span class="linenos">2746</span></a><span class="c1">#     \</span>
</span><span id="L-2747"><a href="#L-2747"><span class="linenos">2747</span></a><span class="c1">#      \</span>
</span><span id="L-2748"><a href="#L-2748"><span class="linenos">2748</span></a><span class="c1">#       C</span>
</span><span id="L-2749"><a href="#L-2749"><span class="linenos">2749</span></a>
</span><span id="L-2750"><a href="#L-2750"><span class="linenos">2750</span></a>
</span><span id="L-2751"><a href="#L-2751"><span class="linenos">2751</span></a><span class="k">def</span> <span class="nf">right_turn</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="L-2752"><a href="#L-2752"><span class="linenos">2752</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if p1, p2, p3 make a right turn.</span>
</span><span id="L-2753"><a href="#L-2753"><span class="linenos">2753</span></a>
</span><span id="L-2754"><a href="#L-2754"><span class="linenos">2754</span></a><span class="sd">    Args:</span>
</span><span id="L-2755"><a href="#L-2755"><span class="linenos">2755</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-2756"><a href="#L-2756"><span class="linenos">2756</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-2757"><a href="#L-2757"><span class="linenos">2757</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="L-2758"><a href="#L-2758"><span class="linenos">2758</span></a>
</span><span id="L-2759"><a href="#L-2759"><span class="linenos">2759</span></a><span class="sd">    Returns:</span>
</span><span id="L-2760"><a href="#L-2760"><span class="linenos">2760</span></a><span class="sd">        bool: True if the points make a right turn, False otherwise.</span>
</span><span id="L-2761"><a href="#L-2761"><span class="linenos">2761</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2762"><a href="#L-2762"><span class="linenos">2762</span></a>    <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span><span id="L-2763"><a href="#L-2763"><span class="linenos">2763</span></a>
</span><span id="L-2764"><a href="#L-2764"><span class="linenos">2764</span></a>
</span><span id="L-2765"><a href="#L-2765"><span class="linenos">2765</span></a><span class="k">def</span> <span class="nf">left_turn</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="L-2766"><a href="#L-2766"><span class="linenos">2766</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if p1, p2, p3 make a left turn.</span>
</span><span id="L-2767"><a href="#L-2767"><span class="linenos">2767</span></a>
</span><span id="L-2768"><a href="#L-2768"><span class="linenos">2768</span></a><span class="sd">    Args:</span>
</span><span id="L-2769"><a href="#L-2769"><span class="linenos">2769</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-2770"><a href="#L-2770"><span class="linenos">2770</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-2771"><a href="#L-2771"><span class="linenos">2771</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="L-2772"><a href="#L-2772"><span class="linenos">2772</span></a>
</span><span id="L-2773"><a href="#L-2773"><span class="linenos">2773</span></a><span class="sd">    Returns:</span>
</span><span id="L-2774"><a href="#L-2774"><span class="linenos">2774</span></a><span class="sd">        bool: True if the points make a left turn, False otherwise.</span>
</span><span id="L-2775"><a href="#L-2775"><span class="linenos">2775</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2776"><a href="#L-2776"><span class="linenos">2776</span></a>    <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-2777"><a href="#L-2777"><span class="linenos">2777</span></a>
</span><span id="L-2778"><a href="#L-2778"><span class="linenos">2778</span></a>
</span><span id="L-2779"><a href="#L-2779"><span class="linenos">2779</span></a><span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="L-2780"><a href="#L-2780"><span class="linenos">2780</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cross product of vectors p1p2 and p1p3.</span>
</span><span id="L-2781"><a href="#L-2781"><span class="linenos">2781</span></a>
</span><span id="L-2782"><a href="#L-2782"><span class="linenos">2782</span></a><span class="sd">    Args:</span>
</span><span id="L-2783"><a href="#L-2783"><span class="linenos">2783</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="L-2784"><a href="#L-2784"><span class="linenos">2784</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="L-2785"><a href="#L-2785"><span class="linenos">2785</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="L-2786"><a href="#L-2786"><span class="linenos">2786</span></a>
</span><span id="L-2787"><a href="#L-2787"><span class="linenos">2787</span></a><span class="sd">    Returns:</span>
</span><span id="L-2788"><a href="#L-2788"><span class="linenos">2788</span></a><span class="sd">        float: Cross product of the vectors.</span>
</span><span id="L-2789"><a href="#L-2789"><span class="linenos">2789</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2790"><a href="#L-2790"><span class="linenos">2790</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2791"><a href="#L-2791"><span class="linenos">2791</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2792"><a href="#L-2792"><span class="linenos">2792</span></a>    <span class="k">return</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="L-2793"><a href="#L-2793"><span class="linenos">2793</span></a>
</span><span id="L-2794"><a href="#L-2794"><span class="linenos">2794</span></a>
</span><span id="L-2795"><a href="#L-2795"><span class="linenos">2795</span></a><span class="k">def</span> <span class="nf">tri_to_cart</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2796"><a href="#L-2796"><span class="linenos">2796</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2797"><a href="#L-2797"><span class="linenos">2797</span></a><span class="sd">    Convert a list of points from triangular to cartesian coordinates.</span>
</span><span id="L-2798"><a href="#L-2798"><span class="linenos">2798</span></a>
</span><span id="L-2799"><a href="#L-2799"><span class="linenos">2799</span></a><span class="sd">    Args:</span>
</span><span id="L-2800"><a href="#L-2800"><span class="linenos">2800</span></a><span class="sd">        points (list[Point]): List of points in triangular coordinates.</span>
</span><span id="L-2801"><a href="#L-2801"><span class="linenos">2801</span></a>
</span><span id="L-2802"><a href="#L-2802"><span class="linenos">2802</span></a><span class="sd">    Returns:</span>
</span><span id="L-2803"><a href="#L-2803"><span class="linenos">2803</span></a><span class="sd">        np.ndarray: List of points in cartesian coordinates.</span>
</span><span id="L-2804"><a href="#L-2804"><span class="linenos">2804</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2805"><a href="#L-2805"><span class="linenos">2805</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-2806"><a href="#L-2806"><span class="linenos">2806</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-2807"><a href="#L-2807"><span class="linenos">2807</span></a>    <span class="n">convert</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])</span>
</span><span id="L-2808"><a href="#L-2808"><span class="linenos">2808</span></a>
</span><span id="L-2809"><a href="#L-2809"><span class="linenos">2809</span></a>    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">@</span> <span class="n">convert</span>
</span><span id="L-2810"><a href="#L-2810"><span class="linenos">2810</span></a>
</span><span id="L-2811"><a href="#L-2811"><span class="linenos">2811</span></a>
</span><span id="L-2812"><a href="#L-2812"><span class="linenos">2812</span></a><span class="k">def</span> <span class="nf">cart_to_tri</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2813"><a href="#L-2813"><span class="linenos">2813</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2814"><a href="#L-2814"><span class="linenos">2814</span></a><span class="sd">    Convert a list of points from cartesian to triangular coordinates.</span>
</span><span id="L-2815"><a href="#L-2815"><span class="linenos">2815</span></a>
</span><span id="L-2816"><a href="#L-2816"><span class="linenos">2816</span></a><span class="sd">    Args:</span>
</span><span id="L-2817"><a href="#L-2817"><span class="linenos">2817</span></a><span class="sd">        points (list[Point]): List of points in cartesian coordinates.</span>
</span><span id="L-2818"><a href="#L-2818"><span class="linenos">2818</span></a>
</span><span id="L-2819"><a href="#L-2819"><span class="linenos">2819</span></a><span class="sd">    Returns:</span>
</span><span id="L-2820"><a href="#L-2820"><span class="linenos">2820</span></a><span class="sd">        np.ndarray: List of points in triangular coordinates.</span>
</span><span id="L-2821"><a href="#L-2821"><span class="linenos">2821</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2822"><a href="#L-2822"><span class="linenos">2822</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-2823"><a href="#L-2823"><span class="linenos">2823</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-2824"><a href="#L-2824"><span class="linenos">2824</span></a>    <span class="n">convert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">]))</span>
</span><span id="L-2825"><a href="#L-2825"><span class="linenos">2825</span></a>
</span><span id="L-2826"><a href="#L-2826"><span class="linenos">2826</span></a>    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">@</span> <span class="n">convert</span>
</span><span id="L-2827"><a href="#L-2827"><span class="linenos">2827</span></a>
</span><span id="L-2828"><a href="#L-2828"><span class="linenos">2828</span></a>
</span><span id="L-2829"><a href="#L-2829"><span class="linenos">2829</span></a><span class="k">def</span> <span class="nf">convex_hull</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2830"><a href="#L-2830"><span class="linenos">2830</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the convex hull of a set of 2D points.</span>
</span><span id="L-2831"><a href="#L-2831"><span class="linenos">2831</span></a>
</span><span id="L-2832"><a href="#L-2832"><span class="linenos">2832</span></a><span class="sd">    Args:</span>
</span><span id="L-2833"><a href="#L-2833"><span class="linenos">2833</span></a><span class="sd">        points (list[Point]): List of 2D points.</span>
</span><span id="L-2834"><a href="#L-2834"><span class="linenos">2834</span></a>
</span><span id="L-2835"><a href="#L-2835"><span class="linenos">2835</span></a><span class="sd">    Returns:</span>
</span><span id="L-2836"><a href="#L-2836"><span class="linenos">2836</span></a><span class="sd">        list[Point]: Convex hull of the points.</span>
</span><span id="L-2837"><a href="#L-2837"><span class="linenos">2837</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2838"><a href="#L-2838"><span class="linenos">2838</span></a>    <span class="c1"># From http://en.wikibooks.org/wiki/Algorithm__implementation/Geometry/</span>
</span><span id="L-2839"><a href="#L-2839"><span class="linenos">2839</span></a>    <span class="c1"># Convex_hull/Monotone_chain</span>
</span><span id="L-2840"><a href="#L-2840"><span class="linenos">2840</span></a>    <span class="c1"># Sort points lexicographically (tuples are compared lexicographically).</span>
</span><span id="L-2841"><a href="#L-2841"><span class="linenos">2841</span></a>    <span class="c1"># Remove duplicates to detect the case we have just one unique point.</span>
</span><span id="L-2842"><a href="#L-2842"><span class="linenos">2842</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="L-2843"><a href="#L-2843"><span class="linenos">2843</span></a>    <span class="c1"># Boring case: no points or a single point, possibly repeated multiple times.</span>
</span><span id="L-2844"><a href="#L-2844"><span class="linenos">2844</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-2845"><a href="#L-2845"><span class="linenos">2845</span></a>        <span class="k">return</span> <span class="n">points</span>
</span><span id="L-2846"><a href="#L-2846"><span class="linenos">2846</span></a>
</span><span id="L-2847"><a href="#L-2847"><span class="linenos">2847</span></a>    <span class="c1"># 2D cross product of OA and OB vectors, i.e. z-component of their 3D cross</span>
</span><span id="L-2848"><a href="#L-2848"><span class="linenos">2848</span></a>    <span class="c1"># product.</span>
</span><span id="L-2849"><a href="#L-2849"><span class="linenos">2849</span></a>    <span class="c1"># Return a positive value, if OAB makes a counter-clockwise turn,</span>
</span><span id="L-2850"><a href="#L-2850"><span class="linenos">2850</span></a>    <span class="c1"># negative for clockwise turn, and zero if the points are collinear.</span>
</span><span id="L-2851"><a href="#L-2851"><span class="linenos">2851</span></a>    <span class="k">def</span> <span class="nf">cross_</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="L-2852"><a href="#L-2852"><span class="linenos">2852</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-2853"><a href="#L-2853"><span class="linenos">2853</span></a>
</span><span id="L-2854"><a href="#L-2854"><span class="linenos">2854</span></a>    <span class="c1"># Build lower hull</span>
</span><span id="L-2855"><a href="#L-2855"><span class="linenos">2855</span></a>    <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2856"><a href="#L-2856"><span class="linenos">2856</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="L-2857"><a href="#L-2857"><span class="linenos">2857</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross_</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2858"><a href="#L-2858"><span class="linenos">2858</span></a>            <span class="n">lower</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-2859"><a href="#L-2859"><span class="linenos">2859</span></a>        <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-2860"><a href="#L-2860"><span class="linenos">2860</span></a>    <span class="c1"># Build upper hull</span>
</span><span id="L-2861"><a href="#L-2861"><span class="linenos">2861</span></a>    <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2862"><a href="#L-2862"><span class="linenos">2862</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2863"><a href="#L-2863"><span class="linenos">2863</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross_</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2864"><a href="#L-2864"><span class="linenos">2864</span></a>            <span class="n">upper</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-2865"><a href="#L-2865"><span class="linenos">2865</span></a>        <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-2866"><a href="#L-2866"><span class="linenos">2866</span></a>    <span class="c1"># Concatenation of the lower and upper hulls gives the convex hull.</span>
</span><span id="L-2867"><a href="#L-2867"><span class="linenos">2867</span></a>    <span class="c1"># Last point of each list is omitted because it is repeated at the beginning</span>
</span><span id="L-2868"><a href="#L-2868"><span class="linenos">2868</span></a>    <span class="c1"># of the other list.</span>
</span><span id="L-2869"><a href="#L-2869"><span class="linenos">2869</span></a>    <span class="k">return</span> <span class="n">lower</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">upper</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2870"><a href="#L-2870"><span class="linenos">2870</span></a>
</span><span id="L-2871"><a href="#L-2871"><span class="linenos">2871</span></a>
</span><span id="L-2872"><a href="#L-2872"><span class="linenos">2872</span></a><span class="k">def</span> <span class="nf">connected_pairs</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
</span><span id="L-2873"><a href="#L-2873"><span class="linenos">2873</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of connected pair tuples corresponding to the items.</span>
</span><span id="L-2874"><a href="#L-2874"><span class="linenos">2874</span></a><span class="sd">    [a, b, c] -&gt; [(a, b), (b, c)]</span>
</span><span id="L-2875"><a href="#L-2875"><span class="linenos">2875</span></a>
</span><span id="L-2876"><a href="#L-2876"><span class="linenos">2876</span></a><span class="sd">    Args:</span>
</span><span id="L-2877"><a href="#L-2877"><span class="linenos">2877</span></a><span class="sd">        items (list): List of items.</span>
</span><span id="L-2878"><a href="#L-2878"><span class="linenos">2878</span></a>
</span><span id="L-2879"><a href="#L-2879"><span class="linenos">2879</span></a><span class="sd">    Returns:</span>
</span><span id="L-2880"><a href="#L-2880"><span class="linenos">2880</span></a><span class="sd">        list[tuple]: List of connected pair tuples.</span>
</span><span id="L-2881"><a href="#L-2881"><span class="linenos">2881</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2882"><a href="#L-2882"><span class="linenos">2882</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
</span><span id="L-2883"><a href="#L-2883"><span class="linenos">2883</span></a>
</span><span id="L-2884"><a href="#L-2884"><span class="linenos">2884</span></a>
</span><span id="L-2885"><a href="#L-2885"><span class="linenos">2885</span></a><span class="k">def</span> <span class="nf">flat_points</span><span class="p">(</span><span class="n">connected_segments</span><span class="p">):</span>
</span><span id="L-2886"><a href="#L-2886"><span class="linenos">2886</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of points from a list of connected pairs of points.</span>
</span><span id="L-2887"><a href="#L-2887"><span class="linenos">2887</span></a>
</span><span id="L-2888"><a href="#L-2888"><span class="linenos">2888</span></a><span class="sd">    Args:</span>
</span><span id="L-2889"><a href="#L-2889"><span class="linenos">2889</span></a><span class="sd">        connected_segments (list[tuple]): List of connected pairs of points.</span>
</span><span id="L-2890"><a href="#L-2890"><span class="linenos">2890</span></a>
</span><span id="L-2891"><a href="#L-2891"><span class="linenos">2891</span></a><span class="sd">    Returns:</span>
</span><span id="L-2892"><a href="#L-2892"><span class="linenos">2892</span></a><span class="sd">        list[Point]: List of points.</span>
</span><span id="L-2893"><a href="#L-2893"><span class="linenos">2893</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2894"><a href="#L-2894"><span class="linenos">2894</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">connected_segments</span><span class="p">]</span>
</span><span id="L-2895"><a href="#L-2895"><span class="linenos">2895</span></a>    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connected_segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2896"><a href="#L-2896"><span class="linenos">2896</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-2897"><a href="#L-2897"><span class="linenos">2897</span></a>
</span><span id="L-2898"><a href="#L-2898"><span class="linenos">2898</span></a>
</span><span id="L-2899"><a href="#L-2899"><span class="linenos">2899</span></a><span class="k">def</span> <span class="nf">point_in_quad</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">quad</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2900"><a href="#L-2900"><span class="linenos">2900</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the point is inside the quad.</span>
</span><span id="L-2901"><a href="#L-2901"><span class="linenos">2901</span></a>
</span><span id="L-2902"><a href="#L-2902"><span class="linenos">2902</span></a><span class="sd">    Args:</span>
</span><span id="L-2903"><a href="#L-2903"><span class="linenos">2903</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-2904"><a href="#L-2904"><span class="linenos">2904</span></a><span class="sd">        quad (list[Point]): List of points representing the quad.</span>
</span><span id="L-2905"><a href="#L-2905"><span class="linenos">2905</span></a>
</span><span id="L-2906"><a href="#L-2906"><span class="linenos">2906</span></a><span class="sd">    Returns:</span>
</span><span id="L-2907"><a href="#L-2907"><span class="linenos">2907</span></a><span class="sd">        bool: True if the point is inside the quad, False otherwise.</span>
</span><span id="L-2908"><a href="#L-2908"><span class="linenos">2908</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2909"><a href="#L-2909"><span class="linenos">2909</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2910"><a href="#L-2910"><span class="linenos">2910</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2911"><a href="#L-2911"><span class="linenos">2911</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2912"><a href="#L-2912"><span class="linenos">2912</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2913"><a href="#L-2913"><span class="linenos">2913</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-2914"><a href="#L-2914"><span class="linenos">2914</span></a>    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">]</span>
</span><span id="L-2915"><a href="#L-2915"><span class="linenos">2915</span></a>    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">]</span>
</span><span id="L-2916"><a href="#L-2916"><span class="linenos">2916</span></a>    <span class="n">min_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="L-2917"><a href="#L-2917"><span class="linenos">2917</span></a>    <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="L-2918"><a href="#L-2918"><span class="linenos">2918</span></a>    <span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="L-2919"><a href="#L-2919"><span class="linenos">2919</span></a>    <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="L-2920"><a href="#L-2920"><span class="linenos">2920</span></a>    <span class="k">return</span> <span class="n">min_x</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">max_x</span> <span class="ow">and</span> <span class="n">min_y</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">max_y</span>
</span><span id="L-2921"><a href="#L-2921"><span class="linenos">2921</span></a>
</span><span id="L-2922"><a href="#L-2922"><span class="linenos">2922</span></a>
</span><span id="L-2923"><a href="#L-2923"><span class="linenos">2923</span></a><span class="k">def</span> <span class="nf">get_polygons</span><span class="p">(</span>
</span><span id="L-2924"><a href="#L-2924"><span class="linenos">2924</span></a>    <span class="n">nested_points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">n_round_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2925"><a href="#L-2925"><span class="linenos">2925</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2926"><a href="#L-2926"><span class="linenos">2926</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert points to clean polygons. Points are vertices of polygons.</span>
</span><span id="L-2927"><a href="#L-2927"><span class="linenos">2927</span></a>
</span><span id="L-2928"><a href="#L-2928"><span class="linenos">2928</span></a><span class="sd">    Args:</span>
</span><span id="L-2929"><a href="#L-2929"><span class="linenos">2929</span></a><span class="sd">        nested_points (Sequence[Point]): List of nested points.</span>
</span><span id="L-2930"><a href="#L-2930"><span class="linenos">2930</span></a><span class="sd">        n_round_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="L-2931"><a href="#L-2931"><span class="linenos">2931</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-2932"><a href="#L-2932"><span class="linenos">2932</span></a>
</span><span id="L-2933"><a href="#L-2933"><span class="linenos">2933</span></a><span class="sd">    Returns:</span>
</span><span id="L-2934"><a href="#L-2934"><span class="linenos">2934</span></a><span class="sd">        list: List of clean polygons.</span>
</span><span id="L-2935"><a href="#L-2935"><span class="linenos">2935</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2936"><a href="#L-2936"><span class="linenos">2936</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2937"><a href="#L-2937"><span class="linenos">2937</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="L-2938"><a href="#L-2938"><span class="linenos">2938</span></a>    <span class="kn">from</span> <span class="nn">..graph</span> <span class="kn">import</span> <span class="n">get_cycles</span>
</span><span id="L-2939"><a href="#L-2939"><span class="linenos">2939</span></a>
</span><span id="L-2940"><a href="#L-2940"><span class="linenos">2940</span></a>    <span class="n">nested_rounded_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2941"><a href="#L-2941"><span class="linenos">2941</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_points</span><span class="p">:</span>
</span><span id="L-2942"><a href="#L-2942"><span class="linenos">2942</span></a>        <span class="n">rounded_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2943"><a href="#L-2943"><span class="linenos">2943</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="L-2944"><a href="#L-2944"><span class="linenos">2944</span></a>            <span class="n">rounded_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">around</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">n_round_digits</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-2945"><a href="#L-2945"><span class="linenos">2945</span></a>            <span class="n">rounded_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rounded_point</span><span class="p">))</span>
</span><span id="L-2946"><a href="#L-2946"><span class="linenos">2946</span></a>        <span class="n">nested_rounded_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rounded_points</span><span class="p">)</span>
</span><span id="L-2947"><a href="#L-2947"><span class="linenos">2947</span></a>
</span><span id="L-2948"><a href="#L-2948"><span class="linenos">2948</span></a>    <span class="n">s_points</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-2949"><a href="#L-2949"><span class="linenos">2949</span></a>    <span class="n">d_id__point</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2950"><a href="#L-2950"><span class="linenos">2950</span></a>    <span class="n">d_point__id</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-2951"><a href="#L-2951"><span class="linenos">2951</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_rounded_points</span><span class="p">:</span>
</span><span id="L-2952"><a href="#L-2952"><span class="linenos">2952</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="L-2953"><a href="#L-2953"><span class="linenos">2953</span></a>            <span class="n">s_points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-2954"><a href="#L-2954"><span class="linenos">2954</span></a>
</span><span id="L-2955"><a href="#L-2955"><span class="linenos">2955</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fs_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s_points</span><span class="p">):</span>
</span><span id="L-2956"><a href="#L-2956"><span class="linenos">2956</span></a>        <span class="n">d_id__point</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fs_point</span>  <span class="c1"># we need a bidirectional dictionary</span>
</span><span id="L-2957"><a href="#L-2957"><span class="linenos">2957</span></a>        <span class="n">d_point__id</span><span class="p">[</span><span class="n">fs_point</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-2958"><a href="#L-2958"><span class="linenos">2958</span></a>
</span><span id="L-2959"><a href="#L-2959"><span class="linenos">2959</span></a>    <span class="n">nested_point_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2960"><a href="#L-2960"><span class="linenos">2960</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_rounded_points</span><span class="p">:</span>
</span><span id="L-2961"><a href="#L-2961"><span class="linenos">2961</span></a>        <span class="n">point_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2962"><a href="#L-2962"><span class="linenos">2962</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="L-2963"><a href="#L-2963"><span class="linenos">2963</span></a>            <span class="n">point_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_point__id</span><span class="p">[</span><span class="n">point</span><span class="p">])</span>
</span><span id="L-2964"><a href="#L-2964"><span class="linenos">2964</span></a>        <span class="n">nested_point_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point_ids</span><span class="p">)</span>
</span><span id="L-2965"><a href="#L-2965"><span class="linenos">2965</span></a>
</span><span id="L-2966"><a href="#L-2966"><span class="linenos">2966</span></a>    <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2967"><a href="#L-2967"><span class="linenos">2967</span></a>    <span class="k">for</span> <span class="n">point_ids</span> <span class="ow">in</span> <span class="n">nested_point_ids</span><span class="p">:</span>
</span><span id="L-2968"><a href="#L-2968"><span class="linenos">2968</span></a>        <span class="n">graph_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">connected_pairs</span><span class="p">(</span><span class="n">point_ids</span><span class="p">))</span>
</span><span id="L-2969"><a href="#L-2969"><span class="linenos">2969</span></a>    <span class="n">polygons</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2970"><a href="#L-2970"><span class="linenos">2970</span></a>    <span class="n">graph_edges</span> <span class="o">=</span> <span class="n">sanitize_graph_edges</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="L-2971"><a href="#L-2971"><span class="linenos">2971</span></a>    <span class="n">cycles</span> <span class="o">=</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="L-2972"><a href="#L-2972"><span class="linenos">2972</span></a>    <span class="k">if</span> <span class="n">cycles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2973"><a href="#L-2973"><span class="linenos">2973</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-2974"><a href="#L-2974"><span class="linenos">2974</span></a>    <span class="k">for</span> <span class="n">cycle_</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="L-2975"><a href="#L-2975"><span class="linenos">2975</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="n">cycle_</span>
</span><span id="L-2976"><a href="#L-2976"><span class="linenos">2976</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_id__point</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
</span><span id="L-2977"><a href="#L-2977"><span class="linenos">2977</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">fix_degen_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="n">dist_tol</span><span class="p">)</span>
</span><span id="L-2978"><a href="#L-2978"><span class="linenos">2978</span></a>        <span class="n">polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-2979"><a href="#L-2979"><span class="linenos">2979</span></a>
</span><span id="L-2980"><a href="#L-2980"><span class="linenos">2980</span></a>    <span class="k">return</span> <span class="n">polygons</span>
</span><span id="L-2981"><a href="#L-2981"><span class="linenos">2981</span></a>
</span><span id="L-2982"><a href="#L-2982"><span class="linenos">2982</span></a>
</span><span id="L-2983"><a href="#L-2983"><span class="linenos">2983</span></a><span class="k">def</span> <span class="nf">offset_point_from_start</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
</span><span id="L-2984"><a href="#L-2984"><span class="linenos">2984</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;p1, p2: points on a line</span>
</span><span id="L-2985"><a href="#L-2985"><span class="linenos">2985</span></a><span class="sd">    offset: distance from p1</span>
</span><span id="L-2986"><a href="#L-2986"><span class="linenos">2986</span></a><span class="sd">    return the point on the line at the given offset</span>
</span><span id="L-2987"><a href="#L-2987"><span class="linenos">2987</span></a>
</span><span id="L-2988"><a href="#L-2988"><span class="linenos">2988</span></a><span class="sd">    Args:</span>
</span><span id="L-2989"><a href="#L-2989"><span class="linenos">2989</span></a><span class="sd">        p1 (Point): First point on the line.</span>
</span><span id="L-2990"><a href="#L-2990"><span class="linenos">2990</span></a><span class="sd">        p2 (Point): Second point on the line.</span>
</span><span id="L-2991"><a href="#L-2991"><span class="linenos">2991</span></a><span class="sd">        offset (float): Distance from p1.</span>
</span><span id="L-2992"><a href="#L-2992"><span class="linenos">2992</span></a>
</span><span id="L-2993"><a href="#L-2993"><span class="linenos">2993</span></a><span class="sd">    Returns:</span>
</span><span id="L-2994"><a href="#L-2994"><span class="linenos">2994</span></a><span class="sd">        Point: Point on the line at the given offset.</span>
</span><span id="L-2995"><a href="#L-2995"><span class="linenos">2995</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2996"><a href="#L-2996"><span class="linenos">2996</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="L-2997"><a href="#L-2997"><span class="linenos">2997</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="L-2998"><a href="#L-2998"><span class="linenos">2998</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-2999"><a href="#L-2999"><span class="linenos">2999</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="L-3000"><a href="#L-3000"><span class="linenos">3000</span></a>    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3001"><a href="#L-3001"><span class="linenos">3001</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="L-3002"><a href="#L-3002"><span class="linenos">3002</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3003"><a href="#L-3003"><span class="linenos">3003</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
</span><span id="L-3004"><a href="#L-3004"><span class="linenos">3004</span></a>
</span><span id="L-3005"><a href="#L-3005"><span class="linenos">3005</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3006"><a href="#L-3006"><span class="linenos">3006</span></a>
</span><span id="L-3007"><a href="#L-3007"><span class="linenos">3007</span></a>
</span><span id="L-3008"><a href="#L-3008"><span class="linenos">3008</span></a><span class="k">def</span> <span class="nf">angle_between_two_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
</span><span id="L-3009"><a href="#L-3009"><span class="linenos">3009</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle between two lines in radians.</span>
</span><span id="L-3010"><a href="#L-3010"><span class="linenos">3010</span></a>
</span><span id="L-3011"><a href="#L-3011"><span class="linenos">3011</span></a><span class="sd">    Args:</span>
</span><span id="L-3012"><a href="#L-3012"><span class="linenos">3012</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-3013"><a href="#L-3013"><span class="linenos">3013</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-3014"><a href="#L-3014"><span class="linenos">3014</span></a>
</span><span id="L-3015"><a href="#L-3015"><span class="linenos">3015</span></a><span class="sd">    Returns:</span>
</span><span id="L-3016"><a href="#L-3016"><span class="linenos">3016</span></a><span class="sd">        float: Angle between the two lines in radians.</span>
</span><span id="L-3017"><a href="#L-3017"><span class="linenos">3017</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3018"><a href="#L-3018"><span class="linenos">3018</span></a>    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line1</span><span class="p">)</span>
</span><span id="L-3019"><a href="#L-3019"><span class="linenos">3019</span></a>    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line2</span><span class="p">)</span>
</span><span id="L-3020"><a href="#L-3020"><span class="linenos">3020</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">alpha1</span> <span class="o">-</span> <span class="n">alpha2</span><span class="p">)</span>
</span><span id="L-3021"><a href="#L-3021"><span class="linenos">3021</span></a>
</span><span id="L-3022"><a href="#L-3022"><span class="linenos">3022</span></a>
</span><span id="L-3023"><a href="#L-3023"><span class="linenos">3023</span></a><span class="k">def</span> <span class="nf">rotate_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span><span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span><span class="n">Point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="L-3024"><a href="#L-3024"><span class="linenos">3024</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a point around a center by an angle in radians.</span>
</span><span id="L-3025"><a href="#L-3025"><span class="linenos">3025</span></a>
</span><span id="L-3026"><a href="#L-3026"><span class="linenos">3026</span></a><span class="sd">    Args:</span>
</span><span id="L-3027"><a href="#L-3027"><span class="linenos">3027</span></a><span class="sd">        point (Point): Point to rotate.</span>
</span><span id="L-3028"><a href="#L-3028"><span class="linenos">3028</span></a><span class="sd">        angle (float): Angle of rotation in radians.</span>
</span><span id="L-3029"><a href="#L-3029"><span class="linenos">3029</span></a><span class="sd">        center (Point): Center of rotation.</span>
</span><span id="L-3030"><a href="#L-3030"><span class="linenos">3030</span></a>
</span><span id="L-3031"><a href="#L-3031"><span class="linenos">3031</span></a><span class="sd">    Returns:</span>
</span><span id="L-3032"><a href="#L-3032"><span class="linenos">3032</span></a><span class="sd">        Point: Rotated point.</span>
</span><span id="L-3033"><a href="#L-3033"><span class="linenos">3033</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3034"><a href="#L-3034"><span class="linenos">3034</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3035"><a href="#L-3035"><span class="linenos">3035</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3036"><a href="#L-3036"><span class="linenos">3036</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">cx</span>
</span><span id="L-3037"><a href="#L-3037"><span class="linenos">3037</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">cy</span>
</span><span id="L-3038"><a href="#L-3038"><span class="linenos">3038</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-3039"><a href="#L-3039"><span class="linenos">3039</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-3040"><a href="#L-3040"><span class="linenos">3040</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-3041"><a href="#L-3041"><span class="linenos">3041</span></a>
</span><span id="L-3042"><a href="#L-3042"><span class="linenos">3042</span></a>
</span><span id="L-3043"><a href="#L-3043"><span class="linenos">3043</span></a><span class="k">def</span> <span class="nf">circle_tangent_to2lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="L-3044"><a href="#L-3044"><span class="linenos">3044</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given two lines, their intersection point and a radius,</span>
</span><span id="L-3045"><a href="#L-3045"><span class="linenos">3045</span></a><span class="sd">    return the center of the circle tangent to both lines and</span>
</span><span id="L-3046"><a href="#L-3046"><span class="linenos">3046</span></a><span class="sd">    with the given radius.</span>
</span><span id="L-3047"><a href="#L-3047"><span class="linenos">3047</span></a>
</span><span id="L-3048"><a href="#L-3048"><span class="linenos">3048</span></a><span class="sd">    Args:</span>
</span><span id="L-3049"><a href="#L-3049"><span class="linenos">3049</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-3050"><a href="#L-3050"><span class="linenos">3050</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-3051"><a href="#L-3051"><span class="linenos">3051</span></a><span class="sd">        intersection_ (Point): Intersection point of the lines.</span>
</span><span id="L-3052"><a href="#L-3052"><span class="linenos">3052</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="L-3053"><a href="#L-3053"><span class="linenos">3053</span></a>
</span><span id="L-3054"><a href="#L-3054"><span class="linenos">3054</span></a><span class="sd">    Returns:</span>
</span><span id="L-3055"><a href="#L-3055"><span class="linenos">3055</span></a><span class="sd">        tuple: Center of the circle, start and end points of the tangent lines.</span>
</span><span id="L-3056"><a href="#L-3056"><span class="linenos">3056</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3057"><a href="#L-3057"><span class="linenos">3057</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle_between_two_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="L-3058"><a href="#L-3058"><span class="linenos">3058</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-3059"><a href="#L-3059"><span class="linenos">3059</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">line1</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="L-3060"><a href="#L-3060"><span class="linenos">3060</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">rotate_point</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-3061"><a href="#L-3061"><span class="linenos">3061</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">line2</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="L-3062"><a href="#L-3062"><span class="linenos">3062</span></a>
</span><span id="L-3063"><a href="#L-3063"><span class="linenos">3063</span></a>    <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span>
</span><span id="L-3064"><a href="#L-3064"><span class="linenos">3064</span></a>
</span><span id="L-3065"><a href="#L-3065"><span class="linenos">3065</span></a>
</span><span id="L-3066"><a href="#L-3066"><span class="linenos">3066</span></a><span class="k">def</span> <span class="nf">triangle_area</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-3067"><a href="#L-3067"><span class="linenos">3067</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3068"><a href="#L-3068"><span class="linenos">3068</span></a><span class="sd">    Given side lengths a, b and c, return the area of the triangle.</span>
</span><span id="L-3069"><a href="#L-3069"><span class="linenos">3069</span></a>
</span><span id="L-3070"><a href="#L-3070"><span class="linenos">3070</span></a><span class="sd">    Args:</span>
</span><span id="L-3071"><a href="#L-3071"><span class="linenos">3071</span></a><span class="sd">        a (float): Length of side a.</span>
</span><span id="L-3072"><a href="#L-3072"><span class="linenos">3072</span></a><span class="sd">        b (float): Length of side b.</span>
</span><span id="L-3073"><a href="#L-3073"><span class="linenos">3073</span></a><span class="sd">        c (float): Length of side c.</span>
</span><span id="L-3074"><a href="#L-3074"><span class="linenos">3074</span></a>
</span><span id="L-3075"><a href="#L-3075"><span class="linenos">3075</span></a><span class="sd">    Returns:</span>
</span><span id="L-3076"><a href="#L-3076"><span class="linenos">3076</span></a><span class="sd">        float: Area of the triangle.</span>
</span><span id="L-3077"><a href="#L-3077"><span class="linenos">3077</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3078"><a href="#L-3078"><span class="linenos">3078</span></a>    <span class="n">a_b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="L-3079"><a href="#L-3079"><span class="linenos">3079</span></a>    <span class="k">return</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="p">(</span><span class="n">a_b</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="p">(</span><span class="n">a_b</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="L-3080"><a href="#L-3080"><span class="linenos">3080</span></a>
</span><span id="L-3081"><a href="#L-3081"><span class="linenos">3081</span></a>
</span><span id="L-3082"><a href="#L-3082"><span class="linenos">3082</span></a><span class="k">def</span> <span class="nf">round_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-3083"><a href="#L-3083"><span class="linenos">3083</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3084"><a href="#L-3084"><span class="linenos">3084</span></a><span class="sd">    Round a point (x, y) to a given precision.</span>
</span><span id="L-3085"><a href="#L-3085"><span class="linenos">3085</span></a>
</span><span id="L-3086"><a href="#L-3086"><span class="linenos">3086</span></a><span class="sd">    Args:</span>
</span><span id="L-3087"><a href="#L-3087"><span class="linenos">3087</span></a><span class="sd">        point (list[float]): Input point.</span>
</span><span id="L-3088"><a href="#L-3088"><span class="linenos">3088</span></a><span class="sd">        n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="L-3089"><a href="#L-3089"><span class="linenos">3089</span></a>
</span><span id="L-3090"><a href="#L-3090"><span class="linenos">3090</span></a><span class="sd">    Returns:</span>
</span><span id="L-3091"><a href="#L-3091"><span class="linenos">3091</span></a><span class="sd">        list[float]: Rounded point.</span>
</span><span id="L-3092"><a href="#L-3092"><span class="linenos">3092</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3093"><a href="#L-3093"><span class="linenos">3093</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3094"><a href="#L-3094"><span class="linenos">3094</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="L-3095"><a href="#L-3095"><span class="linenos">3095</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="L-3096"><a href="#L-3096"><span class="linenos">3096</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-3097"><a href="#L-3097"><span class="linenos">3097</span></a>
</span><span id="L-3098"><a href="#L-3098"><span class="linenos">3098</span></a>
</span><span id="L-3099"><a href="#L-3099"><span class="linenos">3099</span></a><span class="k">def</span> <span class="nf">round_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-3100"><a href="#L-3100"><span class="linenos">3100</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Round a segment to a given precision.</span>
</span><span id="L-3101"><a href="#L-3101"><span class="linenos">3101</span></a>
</span><span id="L-3102"><a href="#L-3102"><span class="linenos">3102</span></a><span class="sd">    Args:</span>
</span><span id="L-3103"><a href="#L-3103"><span class="linenos">3103</span></a><span class="sd">        segment (Sequence[Point]): Input segment.</span>
</span><span id="L-3104"><a href="#L-3104"><span class="linenos">3104</span></a><span class="sd">        n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="L-3105"><a href="#L-3105"><span class="linenos">3105</span></a>
</span><span id="L-3106"><a href="#L-3106"><span class="linenos">3106</span></a><span class="sd">    Returns:</span>
</span><span id="L-3107"><a href="#L-3107"><span class="linenos">3107</span></a><span class="sd">        Sequence[Point]: Rounded segment.</span>
</span><span id="L-3108"><a href="#L-3108"><span class="linenos">3108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3109"><a href="#L-3109"><span class="linenos">3109</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="L-3110"><a href="#L-3110"><span class="linenos">3110</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="L-3111"><a href="#L-3111"><span class="linenos">3111</span></a>
</span><span id="L-3112"><a href="#L-3112"><span class="linenos">3112</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span><span id="L-3113"><a href="#L-3113"><span class="linenos">3113</span></a>
</span><span id="L-3114"><a href="#L-3114"><span class="linenos">3114</span></a>
</span><span id="L-3115"><a href="#L-3115"><span class="linenos">3115</span></a><span class="k">def</span> <span class="nf">get_polygon_grid_point</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">circumradius</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="L-3116"><a href="#L-3116"><span class="linenos">3116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;See chapter ??? for explanation of this function.</span>
</span><span id="L-3117"><a href="#L-3117"><span class="linenos">3117</span></a>
</span><span id="L-3118"><a href="#L-3118"><span class="linenos">3118</span></a><span class="sd">    Args:</span>
</span><span id="L-3119"><a href="#L-3119"><span class="linenos">3119</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="L-3120"><a href="#L-3120"><span class="linenos">3120</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="L-3121"><a href="#L-3121"><span class="linenos">3121</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="L-3122"><a href="#L-3122"><span class="linenos">3122</span></a><span class="sd">        circumradius (float, optional): Circumradius of the polygon. Defaults to 100.</span>
</span><span id="L-3123"><a href="#L-3123"><span class="linenos">3123</span></a>
</span><span id="L-3124"><a href="#L-3124"><span class="linenos">3124</span></a><span class="sd">    Returns:</span>
</span><span id="L-3125"><a href="#L-3125"><span class="linenos">3125</span></a><span class="sd">        Point: Grid point of the polygon.</span>
</span><span id="L-3126"><a href="#L-3126"><span class="linenos">3126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3127"><a href="#L-3127"><span class="linenos">3127</span></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">circumradius</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># side length</span>
</span><span id="L-3128"><a href="#L-3128"><span class="linenos">3128</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">reg_poly_points</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3129"><a href="#L-3129"><span class="linenos">3129</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-3130"><a href="#L-3130"><span class="linenos">3130</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-3131"><a href="#L-3131"><span class="linenos">3131</span></a>    <span class="n">p3</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-3132"><a href="#L-3132"><span class="linenos">3132</span></a>    <span class="n">p4</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-3133"><a href="#L-3133"><span class="linenos">3133</span></a>
</span><span id="L-3134"><a href="#L-3134"><span class="linenos">3134</span></a>    <span class="k">return</span> <span class="n">intersection</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3135"><a href="#L-3135"><span class="linenos">3135</span></a>
</span><span id="L-3136"><a href="#L-3136"><span class="linenos">3136</span></a>
</span><span id="L-3137"><a href="#L-3137"><span class="linenos">3137</span></a><span class="k">def</span> <span class="nf">congruent_polygons</span><span class="p">(</span>
</span><span id="L-3138"><a href="#L-3138"><span class="linenos">3138</span></a>    <span class="n">polygon1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-3139"><a href="#L-3139"><span class="linenos">3139</span></a>    <span class="n">polygon2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-3140"><a href="#L-3140"><span class="linenos">3140</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-3141"><a href="#L-3141"><span class="linenos">3141</span></a>    <span class="n">area_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-3142"><a href="#L-3142"><span class="linenos">3142</span></a>    <span class="n">side_length_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-3143"><a href="#L-3143"><span class="linenos">3143</span></a>    <span class="n">angle_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-3144"><a href="#L-3144"><span class="linenos">3144</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-3145"><a href="#L-3145"><span class="linenos">3145</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3146"><a href="#L-3146"><span class="linenos">3146</span></a><span class="sd">    Return True if two polygons are congruent.</span>
</span><span id="L-3147"><a href="#L-3147"><span class="linenos">3147</span></a><span class="sd">    They can be translated, rotated and/or reflected.</span>
</span><span id="L-3148"><a href="#L-3148"><span class="linenos">3148</span></a>
</span><span id="L-3149"><a href="#L-3149"><span class="linenos">3149</span></a><span class="sd">    Args:</span>
</span><span id="L-3150"><a href="#L-3150"><span class="linenos">3150</span></a><span class="sd">        polygon1 (list[Point]): First polygon.</span>
</span><span id="L-3151"><a href="#L-3151"><span class="linenos">3151</span></a><span class="sd">        polygon2 (list[Point]): Second polygon.</span>
</span><span id="L-3152"><a href="#L-3152"><span class="linenos">3152</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="L-3153"><a href="#L-3153"><span class="linenos">3153</span></a><span class="sd">        area_tol (float, optional): Area tolerance. Defaults to None.</span>
</span><span id="L-3154"><a href="#L-3154"><span class="linenos">3154</span></a><span class="sd">        side_length_tol (float, optional): Side length tolerance. Defaults to None.</span>
</span><span id="L-3155"><a href="#L-3155"><span class="linenos">3155</span></a><span class="sd">        angle_tol (float, optional): Angle tolerance. Defaults to None.</span>
</span><span id="L-3156"><a href="#L-3156"><span class="linenos">3156</span></a>
</span><span id="L-3157"><a href="#L-3157"><span class="linenos">3157</span></a><span class="sd">    Returns:</span>
</span><span id="L-3158"><a href="#L-3158"><span class="linenos">3158</span></a><span class="sd">        bool: True if the polygons are congruent, False otherwise.</span>
</span><span id="L-3159"><a href="#L-3159"><span class="linenos">3159</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3160"><a href="#L-3160"><span class="linenos">3160</span></a>    <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_tol</span><span class="p">,</span> <span class="n">angle_tol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-3161"><a href="#L-3161"><span class="linenos">3161</span></a>        <span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;angle_rtol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_tol</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">]</span>
</span><span id="L-3162"><a href="#L-3162"><span class="linenos">3162</span></a>    <span class="p">)</span>
</span><span id="L-3163"><a href="#L-3163"><span class="linenos">3163</span></a>    <span class="k">if</span> <span class="n">side_length_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-3164"><a href="#L-3164"><span class="linenos">3164</span></a>        <span class="n">side_length_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span>
</span><span id="L-3165"><a href="#L-3165"><span class="linenos">3165</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="L-3166"><a href="#L-3166"><span class="linenos">3166</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="n">polygon1</span>
</span><span id="L-3167"><a href="#L-3167"><span class="linenos">3167</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="n">polygon2</span>
</span><span id="L-3168"><a href="#L-3168"><span class="linenos">3168</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-3169"><a href="#L-3169"><span class="linenos">3169</span></a>        <span class="n">poly1</span> <span class="o">=</span> <span class="n">poly1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3170"><a href="#L-3170"><span class="linenos">3170</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="L-3171"><a href="#L-3171"><span class="linenos">3171</span></a>        <span class="n">poly2</span> <span class="o">=</span> <span class="n">poly2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3172"><a href="#L-3172"><span class="linenos">3172</span></a>    <span class="n">len_poly1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="L-3173"><a href="#L-3173"><span class="linenos">3173</span></a>    <span class="n">len_poly2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="L-3174"><a href="#L-3174"><span class="linenos">3174</span></a>    <span class="k">if</span> <span class="n">len_poly1</span> <span class="o">!=</span> <span class="n">len_poly2</span><span class="p">:</span>
</span><span id="L-3175"><a href="#L-3175"><span class="linenos">3175</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3176"><a href="#L-3176"><span class="linenos">3176</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-3177"><a href="#L-3177"><span class="linenos">3177</span></a>        <span class="nb">abs</span><span class="p">(</span><span class="n">polygon_area</span><span class="p">(</span><span class="n">poly1</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">polygon_area</span><span class="p">(</span><span class="n">poly2</span><span class="p">)),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">area_tol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">area_tol</span>
</span><span id="L-3178"><a href="#L-3178"><span class="linenos">3178</span></a>    <span class="p">):</span>
</span><span id="L-3179"><a href="#L-3179"><span class="linenos">3179</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3180"><a href="#L-3180"><span class="linenos">3180</span></a>
</span><span id="L-3181"><a href="#L-3181"><span class="linenos">3181</span></a>    <span class="n">side_lengths1</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_poly1</span><span class="p">)]</span>
</span><span id="L-3182"><a href="#L-3182"><span class="linenos">3182</span></a>    <span class="n">side_lengths2</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_poly2</span><span class="p">)]</span>
</span><span id="L-3183"><a href="#L-3183"><span class="linenos">3183</span></a>    <span class="n">check1</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">side_lengths1</span><span class="p">,</span> <span class="n">side_lengths2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">side_length_tol</span><span class="p">)</span>
</span><span id="L-3184"><a href="#L-3184"><span class="linenos">3184</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">check1</span><span class="p">:</span>
</span><span id="L-3185"><a href="#L-3185"><span class="linenos">3185</span></a>        <span class="n">check_reverse</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span>
</span><span id="L-3186"><a href="#L-3186"><span class="linenos">3186</span></a>            <span class="n">side_lengths1</span><span class="p">,</span> <span class="n">side_lengths2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="n">side_length_tol</span>
</span><span id="L-3187"><a href="#L-3187"><span class="linenos">3187</span></a>        <span class="p">)</span>
</span><span id="L-3188"><a href="#L-3188"><span class="linenos">3188</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">check1</span> <span class="ow">or</span> <span class="n">check_reverse</span><span class="p">):</span>
</span><span id="L-3189"><a href="#L-3189"><span class="linenos">3189</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3190"><a href="#L-3190"><span class="linenos">3190</span></a>
</span><span id="L-3191"><a href="#L-3191"><span class="linenos">3191</span></a>    <span class="n">angles1</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="L-3192"><a href="#L-3192"><span class="linenos">3192</span></a>    <span class="n">angles2</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="L-3193"><a href="#L-3193"><span class="linenos">3193</span></a>    <span class="n">check1</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">angles1</span><span class="p">,</span> <span class="n">angles2</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">)</span>
</span><span id="L-3194"><a href="#L-3194"><span class="linenos">3194</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">check1</span><span class="p">:</span>
</span><span id="L-3195"><a href="#L-3195"><span class="linenos">3195</span></a>        <span class="n">poly2</span> <span class="o">=</span> <span class="n">poly2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3196"><a href="#L-3196"><span class="linenos">3196</span></a>        <span class="n">angles2</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="L-3197"><a href="#L-3197"><span class="linenos">3197</span></a>        <span class="n">check_reverse</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">angles1</span><span class="p">,</span> <span class="n">angles2</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">)</span>
</span><span id="L-3198"><a href="#L-3198"><span class="linenos">3198</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">check1</span> <span class="ow">or</span> <span class="n">check_reverse</span><span class="p">):</span>
</span><span id="L-3199"><a href="#L-3199"><span class="linenos">3199</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-3200"><a href="#L-3200"><span class="linenos">3200</span></a>
</span><span id="L-3201"><a href="#L-3201"><span class="linenos">3201</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3202"><a href="#L-3202"><span class="linenos">3202</span></a>
</span><span id="L-3203"><a href="#L-3203"><span class="linenos">3203</span></a>
</span><span id="L-3204"><a href="#L-3204"><span class="linenos">3204</span></a><span class="k">def</span> <span class="nf">positive_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">radians</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-3205"><a href="#L-3205"><span class="linenos">3205</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the positive angle in radians or degrees.</span>
</span><span id="L-3206"><a href="#L-3206"><span class="linenos">3206</span></a>
</span><span id="L-3207"><a href="#L-3207"><span class="linenos">3207</span></a><span class="sd">    Args:</span>
</span><span id="L-3208"><a href="#L-3208"><span class="linenos">3208</span></a><span class="sd">        angle (float): Input angle.</span>
</span><span id="L-3209"><a href="#L-3209"><span class="linenos">3209</span></a><span class="sd">        radians (bool, optional): Whether the angle is in radians. Defaults to True.</span>
</span><span id="L-3210"><a href="#L-3210"><span class="linenos">3210</span></a><span class="sd">        tol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="L-3211"><a href="#L-3211"><span class="linenos">3211</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="L-3212"><a href="#L-3212"><span class="linenos">3212</span></a>
</span><span id="L-3213"><a href="#L-3213"><span class="linenos">3213</span></a><span class="sd">    Returns:</span>
</span><span id="L-3214"><a href="#L-3214"><span class="linenos">3214</span></a><span class="sd">        float: Positive angle.</span>
</span><span id="L-3215"><a href="#L-3215"><span class="linenos">3215</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3216"><a href="#L-3216"><span class="linenos">3216</span></a>    <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;tol&quot;</span><span class="p">,</span> <span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="L-3217"><a href="#L-3217"><span class="linenos">3217</span></a>    <span class="k">if</span> <span class="n">radians</span><span class="p">:</span>
</span><span id="L-3218"><a href="#L-3218"><span class="linenos">3218</span></a>        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3219"><a href="#L-3219"><span class="linenos">3219</span></a>            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="L-3220"><a href="#L-3220"><span class="linenos">3220</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3221"><a href="#L-3221"><span class="linenos">3221</span></a>        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3222"><a href="#L-3222"><span class="linenos">3222</span></a>            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">360</span>
</span><span id="L-3223"><a href="#L-3223"><span class="linenos">3223</span></a>
</span><span id="L-3224"><a href="#L-3224"><span class="linenos">3224</span></a>    <span class="k">return</span> <span class="n">angle</span>
</span><span id="L-3225"><a href="#L-3225"><span class="linenos">3225</span></a>
</span><span id="L-3226"><a href="#L-3226"><span class="linenos">3226</span></a>
</span><span id="L-3227"><a href="#L-3227"><span class="linenos">3227</span></a><span class="k">def</span> <span class="nf">polygon_internal_angles</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="L-3228"><a href="#L-3228"><span class="linenos">3228</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the internal angles of a polygon.</span>
</span><span id="L-3229"><a href="#L-3229"><span class="linenos">3229</span></a>
</span><span id="L-3230"><a href="#L-3230"><span class="linenos">3230</span></a><span class="sd">    Args:</span>
</span><span id="L-3231"><a href="#L-3231"><span class="linenos">3231</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="L-3232"><a href="#L-3232"><span class="linenos">3232</span></a>
</span><span id="L-3233"><a href="#L-3233"><span class="linenos">3233</span></a><span class="sd">    Returns:</span>
</span><span id="L-3234"><a href="#L-3234"><span class="linenos">3234</span></a><span class="sd">        list[float]: List of internal angles of the polygon.</span>
</span><span id="L-3235"><a href="#L-3235"><span class="linenos">3235</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3236"><a href="#L-3236"><span class="linenos">3236</span></a>    <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3237"><a href="#L-3237"><span class="linenos">3237</span></a>    <span class="n">len_polygon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-3238"><a href="#L-3238"><span class="linenos">3238</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="L-3239"><a href="#L-3239"><span class="linenos">3239</span></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-3240"><a href="#L-3240"><span class="linenos">3240</span></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">pnt</span>
</span><span id="L-3241"><a href="#L-3241"><span class="linenos">3241</span></a>        <span class="n">p3</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">len_polygon</span><span class="p">]</span>
</span><span id="L-3242"><a href="#L-3242"><span class="linenos">3242</span></a>        <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">))</span>
</span><span id="L-3243"><a href="#L-3243"><span class="linenos">3243</span></a>
</span><span id="L-3244"><a href="#L-3244"><span class="linenos">3244</span></a>    <span class="k">return</span> <span class="n">angles</span>
</span><span id="L-3245"><a href="#L-3245"><span class="linenos">3245</span></a>
</span><span id="L-3246"><a href="#L-3246"><span class="linenos">3246</span></a>
</span><span id="L-3247"><a href="#L-3247"><span class="linenos">3247</span></a><span class="k">def</span> <span class="nf">bisector_line</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-3248"><a href="#L-3248"><span class="linenos">3248</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3249"><a href="#L-3249"><span class="linenos">3249</span></a><span class="sd">    Given three points that form two lines [a, b] and [b, c]</span>
</span><span id="L-3250"><a href="#L-3250"><span class="linenos">3250</span></a><span class="sd">    return the bisector line between them.</span>
</span><span id="L-3251"><a href="#L-3251"><span class="linenos">3251</span></a>
</span><span id="L-3252"><a href="#L-3252"><span class="linenos">3252</span></a><span class="sd">    Args:</span>
</span><span id="L-3253"><a href="#L-3253"><span class="linenos">3253</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="L-3254"><a href="#L-3254"><span class="linenos">3254</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="L-3255"><a href="#L-3255"><span class="linenos">3255</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="L-3256"><a href="#L-3256"><span class="linenos">3256</span></a>
</span><span id="L-3257"><a href="#L-3257"><span class="linenos">3257</span></a><span class="sd">    Returns:</span>
</span><span id="L-3258"><a href="#L-3258"><span class="linenos">3258</span></a><span class="sd">        Line: Bisector line.</span>
</span><span id="L-3259"><a href="#L-3259"><span class="linenos">3259</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3260"><a href="#L-3260"><span class="linenos">3260</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">mid_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="L-3261"><a href="#L-3261"><span class="linenos">3261</span></a>
</span><span id="L-3262"><a href="#L-3262"><span class="linenos">3262</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
</span><span id="L-3263"><a href="#L-3263"><span class="linenos">3263</span></a>
</span><span id="L-3264"><a href="#L-3264"><span class="linenos">3264</span></a>
</span><span id="L-3265"><a href="#L-3265"><span class="linenos">3265</span></a><span class="k">def</span> <span class="nf">between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="L-3266"><a href="#L-3266"><span class="linenos">3266</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if c is between a and b.</span>
</span><span id="L-3267"><a href="#L-3267"><span class="linenos">3267</span></a>
</span><span id="L-3268"><a href="#L-3268"><span class="linenos">3268</span></a><span class="sd">    Args:</span>
</span><span id="L-3269"><a href="#L-3269"><span class="linenos">3269</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="L-3270"><a href="#L-3270"><span class="linenos">3270</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="L-3271"><a href="#L-3271"><span class="linenos">3271</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="L-3272"><a href="#L-3272"><span class="linenos">3272</span></a>
</span><span id="L-3273"><a href="#L-3273"><span class="linenos">3273</span></a><span class="sd">    Returns:</span>
</span><span id="L-3274"><a href="#L-3274"><span class="linenos">3274</span></a><span class="sd">        bool: True if c is between a and b, False otherwise.</span>
</span><span id="L-3275"><a href="#L-3275"><span class="linenos">3275</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3276"><a href="#L-3276"><span class="linenos">3276</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="L-3277"><a href="#L-3277"><span class="linenos">3277</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-3278"><a href="#L-3278"><span class="linenos">3278</span></a>    <span class="k">elif</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-3279"><a href="#L-3279"><span class="linenos">3279</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-3280"><a href="#L-3280"><span class="linenos">3280</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3281"><a href="#L-3281"><span class="linenos">3281</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-3282"><a href="#L-3282"><span class="linenos">3282</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3283"><a href="#L-3283"><span class="linenos">3283</span></a>
</span><span id="L-3284"><a href="#L-3284"><span class="linenos">3284</span></a>
</span><span id="L-3285"><a href="#L-3285"><span class="linenos">3285</span></a><span class="k">def</span> <span class="nf">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-3286"><a href="#L-3286"><span class="linenos">3286</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if a, b, and c are collinear.</span>
</span><span id="L-3287"><a href="#L-3287"><span class="linenos">3287</span></a>
</span><span id="L-3288"><a href="#L-3288"><span class="linenos">3288</span></a><span class="sd">    Args:</span>
</span><span id="L-3289"><a href="#L-3289"><span class="linenos">3289</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="L-3290"><a href="#L-3290"><span class="linenos">3290</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="L-3291"><a href="#L-3291"><span class="linenos">3291</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="L-3292"><a href="#L-3292"><span class="linenos">3292</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="L-3293"><a href="#L-3293"><span class="linenos">3293</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="L-3294"><a href="#L-3294"><span class="linenos">3294</span></a>
</span><span id="L-3295"><a href="#L-3295"><span class="linenos">3295</span></a><span class="sd">    Returns:</span>
</span><span id="L-3296"><a href="#L-3296"><span class="linenos">3296</span></a><span class="sd">        bool: True if the points are collinear, False otherwise.</span>
</span><span id="L-3297"><a href="#L-3297"><span class="linenos">3297</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3298"><a href="#L-3298"><span class="linenos">3298</span></a>    <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="L-3299"><a href="#L-3299"><span class="linenos">3299</span></a>        <span class="p">[</span><span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="L-3300"><a href="#L-3300"><span class="linenos">3300</span></a>    <span class="p">)</span>
</span><span id="L-3301"><a href="#L-3301"><span class="linenos">3301</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">area_atol</span><span class="p">)</span>
</span><span id="L-3302"><a href="#L-3302"><span class="linenos">3302</span></a>
</span><span id="L-3303"><a href="#L-3303"><span class="linenos">3303</span></a>
</span><span id="L-3304"><a href="#L-3304"><span class="linenos">3304</span></a><span class="k">def</span> <span class="nf">polar_to_cartesian</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
</span><span id="L-3305"><a href="#L-3305"><span class="linenos">3305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert polar coordinates to cartesian coordinates.</span>
</span><span id="L-3306"><a href="#L-3306"><span class="linenos">3306</span></a>
</span><span id="L-3307"><a href="#L-3307"><span class="linenos">3307</span></a><span class="sd">    Args:</span>
</span><span id="L-3308"><a href="#L-3308"><span class="linenos">3308</span></a><span class="sd">        r (float): Radius.</span>
</span><span id="L-3309"><a href="#L-3309"><span class="linenos">3309</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="L-3310"><a href="#L-3310"><span class="linenos">3310</span></a>
</span><span id="L-3311"><a href="#L-3311"><span class="linenos">3311</span></a><span class="sd">    Returns:</span>
</span><span id="L-3312"><a href="#L-3312"><span class="linenos">3312</span></a><span class="sd">        Point: Cartesian coordinates.</span>
</span><span id="L-3313"><a href="#L-3313"><span class="linenos">3313</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3314"><a href="#L-3314"><span class="linenos">3314</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
</span><span id="L-3315"><a href="#L-3315"><span class="linenos">3315</span></a>
</span><span id="L-3316"><a href="#L-3316"><span class="linenos">3316</span></a>
</span><span id="L-3317"><a href="#L-3317"><span class="linenos">3317</span></a><span class="k">def</span> <span class="nf">cartesian_to_polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="L-3318"><a href="#L-3318"><span class="linenos">3318</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert cartesian coordinates to polar coordinates.</span>
</span><span id="L-3319"><a href="#L-3319"><span class="linenos">3319</span></a>
</span><span id="L-3320"><a href="#L-3320"><span class="linenos">3320</span></a><span class="sd">    Args:</span>
</span><span id="L-3321"><a href="#L-3321"><span class="linenos">3321</span></a><span class="sd">        x (float): x-coordinate.</span>
</span><span id="L-3322"><a href="#L-3322"><span class="linenos">3322</span></a><span class="sd">        y (float): y-coordinate.</span>
</span><span id="L-3323"><a href="#L-3323"><span class="linenos">3323</span></a>
</span><span id="L-3324"><a href="#L-3324"><span class="linenos">3324</span></a><span class="sd">    Returns:</span>
</span><span id="L-3325"><a href="#L-3325"><span class="linenos">3325</span></a><span class="sd">        tuple: Polar coordinates (r, theta).</span>
</span><span id="L-3326"><a href="#L-3326"><span class="linenos">3326</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3327"><a href="#L-3327"><span class="linenos">3327</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">hypot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-3328"><a href="#L-3328"><span class="linenos">3328</span></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">positive_angle</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span><span id="L-3329"><a href="#L-3329"><span class="linenos">3329</span></a>    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">theta</span>
</span><span id="L-3330"><a href="#L-3330"><span class="linenos">3330</span></a>
</span><span id="L-3331"><a href="#L-3331"><span class="linenos">3331</span></a>
</span><span id="L-3332"><a href="#L-3332"><span class="linenos">3332</span></a><span class="k">def</span> <span class="nf">fillet</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Line</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">Point</span><span class="p">]:</span>
</span><span id="L-3333"><a href="#L-3333"><span class="linenos">3333</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3334"><a href="#L-3334"><span class="linenos">3334</span></a><span class="sd">    Given three points that form two lines [a, b] and [b, c]</span>
</span><span id="L-3335"><a href="#L-3335"><span class="linenos">3335</span></a><span class="sd">    return the clipped lines [a, d], [e, c], center point</span>
</span><span id="L-3336"><a href="#L-3336"><span class="linenos">3336</span></a><span class="sd">    of the radius circle (tangent to both lines), and the arc</span>
</span><span id="L-3337"><a href="#L-3337"><span class="linenos">3337</span></a><span class="sd">    angle of the formed fillet.</span>
</span><span id="L-3338"><a href="#L-3338"><span class="linenos">3338</span></a>
</span><span id="L-3339"><a href="#L-3339"><span class="linenos">3339</span></a><span class="sd">    Args:</span>
</span><span id="L-3340"><a href="#L-3340"><span class="linenos">3340</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="L-3341"><a href="#L-3341"><span class="linenos">3341</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="L-3342"><a href="#L-3342"><span class="linenos">3342</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="L-3343"><a href="#L-3343"><span class="linenos">3343</span></a><span class="sd">        radius (float): Radius of the fillet.</span>
</span><span id="L-3344"><a href="#L-3344"><span class="linenos">3344</span></a>
</span><span id="L-3345"><a href="#L-3345"><span class="linenos">3345</span></a><span class="sd">    Returns:</span>
</span><span id="L-3346"><a href="#L-3346"><span class="linenos">3346</span></a><span class="sd">        tuple: Clipped lines [a, d], [e, c], center point of the radius circle, and the arc angle.</span>
</span><span id="L-3347"><a href="#L-3347"><span class="linenos">3347</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3348"><a href="#L-3348"><span class="linenos">3348</span></a>    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-3349"><a href="#L-3349"><span class="linenos">3349</span></a>    <span class="n">sin_alpha2</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha2</span><span class="p">)</span>
</span><span id="L-3350"><a href="#L-3350"><span class="linenos">3350</span></a>    <span class="n">cos_alpha2</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha2</span><span class="p">)</span>
</span><span id="L-3351"><a href="#L-3351"><span class="linenos">3351</span></a>    <span class="n">clip_length</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">cos_alpha2</span> <span class="o">/</span> <span class="n">sin_alpha2</span>
</span><span id="L-3352"><a href="#L-3352"><span class="linenos">3352</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">clip_length</span><span class="p">)</span>
</span><span id="L-3353"><a href="#L-3353"><span class="linenos">3353</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">clip_length</span><span class="p">)</span>
</span><span id="L-3354"><a href="#L-3354"><span class="linenos">3354</span></a>    <span class="n">mp</span> <span class="o">=</span> <span class="n">mid_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>  <span class="c1"># [b, mp] is the bisector line</span>
</span><span id="L-3355"><a href="#L-3355"><span class="linenos">3355</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">sin_alpha2</span><span class="p">)</span>
</span><span id="L-3356"><a href="#L-3356"><span class="linenos">3356</span></a>    <span class="n">arc_angle</span> <span class="o">=</span> <span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="L-3357"><a href="#L-3357"><span class="linenos">3357</span></a>
</span><span id="L-3358"><a href="#L-3358"><span class="linenos">3358</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">c</span><span class="p">],</span> <span class="n">center</span><span class="p">,</span> <span class="n">arc_angle</span>
</span><span id="L-3359"><a href="#L-3359"><span class="linenos">3359</span></a>
</span><span id="L-3360"><a href="#L-3360"><span class="linenos">3360</span></a>
</span><span id="L-3361"><a href="#L-3361"><span class="linenos">3361</span></a><span class="k">def</span> <span class="nf">line_by_point_angle_length</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">length_</span><span class="p">):</span>
</span><span id="L-3362"><a href="#L-3362"><span class="linenos">3362</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3363"><a href="#L-3363"><span class="linenos">3363</span></a><span class="sd">    Given a point, an angle, and a length, return the line</span>
</span><span id="L-3364"><a href="#L-3364"><span class="linenos">3364</span></a><span class="sd">    that starts at the point and has the given angle and length.</span>
</span><span id="L-3365"><a href="#L-3365"><span class="linenos">3365</span></a>
</span><span id="L-3366"><a href="#L-3366"><span class="linenos">3366</span></a><span class="sd">    Args:</span>
</span><span id="L-3367"><a href="#L-3367"><span class="linenos">3367</span></a><span class="sd">        point (Point): Start point of the line.</span>
</span><span id="L-3368"><a href="#L-3368"><span class="linenos">3368</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="L-3369"><a href="#L-3369"><span class="linenos">3369</span></a><span class="sd">        length_ (float): Length of the line.</span>
</span><span id="L-3370"><a href="#L-3370"><span class="linenos">3370</span></a>
</span><span id="L-3371"><a href="#L-3371"><span class="linenos">3371</span></a><span class="sd">    Returns:</span>
</span><span id="L-3372"><a href="#L-3372"><span class="linenos">3372</span></a><span class="sd">        Line: Line with the given angle and length.</span>
</span><span id="L-3373"><a href="#L-3373"><span class="linenos">3373</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3374"><a href="#L-3374"><span class="linenos">3374</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3375"><a href="#L-3375"><span class="linenos">3375</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-3376"><a href="#L-3376"><span class="linenos">3376</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-3377"><a href="#L-3377"><span class="linenos">3377</span></a>
</span><span id="L-3378"><a href="#L-3378"><span class="linenos">3378</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)]</span>
</span><span id="L-3379"><a href="#L-3379"><span class="linenos">3379</span></a>
</span><span id="L-3380"><a href="#L-3380"><span class="linenos">3380</span></a>
</span><span id="L-3381"><a href="#L-3381"><span class="linenos">3381</span></a><span class="k">def</span> <span class="nf">surface_normal</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p3</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="L-3382"><a href="#L-3382"><span class="linenos">3382</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3383"><a href="#L-3383"><span class="linenos">3383</span></a><span class="sd">    Calculates the surface normal of a triangle given its vertices.</span>
</span><span id="L-3384"><a href="#L-3384"><span class="linenos">3384</span></a>
</span><span id="L-3385"><a href="#L-3385"><span class="linenos">3385</span></a><span class="sd">    Args:</span>
</span><span id="L-3386"><a href="#L-3386"><span class="linenos">3386</span></a><span class="sd">        p1 (Point): First vertex.</span>
</span><span id="L-3387"><a href="#L-3387"><span class="linenos">3387</span></a><span class="sd">        p2 (Point): Second vertex.</span>
</span><span id="L-3388"><a href="#L-3388"><span class="linenos">3388</span></a><span class="sd">        p3 (Point): Third vertex.</span>
</span><span id="L-3389"><a href="#L-3389"><span class="linenos">3389</span></a>
</span><span id="L-3390"><a href="#L-3390"><span class="linenos">3390</span></a><span class="sd">    Returns:</span>
</span><span id="L-3391"><a href="#L-3391"><span class="linenos">3391</span></a><span class="sd">        VecType: Surface normal vector.</span>
</span><span id="L-3392"><a href="#L-3392"><span class="linenos">3392</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3393"><a href="#L-3393"><span class="linenos">3393</span></a>    <span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span><span id="L-3394"><a href="#L-3394"><span class="linenos">3394</span></a>    <span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</span><span id="L-3395"><a href="#L-3395"><span class="linenos">3395</span></a>    <span class="n">v3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
</span><span id="L-3396"><a href="#L-3396"><span class="linenos">3396</span></a>    <span class="c1"># Create two vectors from the vertices</span>
</span><span id="L-3397"><a href="#L-3397"><span class="linenos">3397</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">-</span> <span class="n">v1</span>
</span><span id="L-3398"><a href="#L-3398"><span class="linenos">3398</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="n">v1</span>
</span><span id="L-3399"><a href="#L-3399"><span class="linenos">3399</span></a>
</span><span id="L-3400"><a href="#L-3400"><span class="linenos">3400</span></a>    <span class="c1"># Calculate the cross product of the two vectors</span>
</span><span id="L-3401"><a href="#L-3401"><span class="linenos">3401</span></a>    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-3402"><a href="#L-3402"><span class="linenos">3402</span></a>
</span><span id="L-3403"><a href="#L-3403"><span class="linenos">3403</span></a>    <span class="c1"># Normalize the vector to get a unit normal vector</span>
</span><span id="L-3404"><a href="#L-3404"><span class="linenos">3404</span></a>    <span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
</span><span id="L-3405"><a href="#L-3405"><span class="linenos">3405</span></a>
</span><span id="L-3406"><a href="#L-3406"><span class="linenos">3406</span></a>    <span class="k">return</span> <span class="n">normal</span>
</span><span id="L-3407"><a href="#L-3407"><span class="linenos">3407</span></a>
</span><span id="L-3408"><a href="#L-3408"><span class="linenos">3408</span></a>
</span><span id="L-3409"><a href="#L-3409"><span class="linenos">3409</span></a><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">):</span>
</span><span id="L-3410"><a href="#L-3410"><span class="linenos">3410</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the normal vector of a line.</span>
</span><span id="L-3411"><a href="#L-3411"><span class="linenos">3411</span></a>
</span><span id="L-3412"><a href="#L-3412"><span class="linenos">3412</span></a><span class="sd">    Args:</span>
</span><span id="L-3413"><a href="#L-3413"><span class="linenos">3413</span></a><span class="sd">        point1 (Point): First point of the line.</span>
</span><span id="L-3414"><a href="#L-3414"><span class="linenos">3414</span></a><span class="sd">        point2 (Point): Second point of the line.</span>
</span><span id="L-3415"><a href="#L-3415"><span class="linenos">3415</span></a>
</span><span id="L-3416"><a href="#L-3416"><span class="linenos">3416</span></a><span class="sd">    Returns:</span>
</span><span id="L-3417"><a href="#L-3417"><span class="linenos">3417</span></a><span class="sd">        VecType: Normal vector of the line.</span>
</span><span id="L-3418"><a href="#L-3418"><span class="linenos">3418</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3419"><a href="#L-3419"><span class="linenos">3419</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point1</span>
</span><span id="L-3420"><a href="#L-3420"><span class="linenos">3420</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">point2</span>
</span><span id="L-3421"><a href="#L-3421"><span class="linenos">3421</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-3422"><a href="#L-3422"><span class="linenos">3422</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-3423"><a href="#L-3423"><span class="linenos">3423</span></a>    <span class="n">norm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-3424"><a href="#L-3424"><span class="linenos">3424</span></a>    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm</span><span class="p">]</span>
</span><span id="L-3425"><a href="#L-3425"><span class="linenos">3425</span></a>
</span><span id="L-3426"><a href="#L-3426"><span class="linenos">3426</span></a>
</span><span id="L-3427"><a href="#L-3427"><span class="linenos">3427</span></a><span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="L-3428"><a href="#L-3428"><span class="linenos">3428</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the area of a triangle given its vertices.</span>
</span><span id="L-3429"><a href="#L-3429"><span class="linenos">3429</span></a>
</span><span id="L-3430"><a href="#L-3430"><span class="linenos">3430</span></a><span class="sd">    Args:</span>
</span><span id="L-3431"><a href="#L-3431"><span class="linenos">3431</span></a><span class="sd">        a (Point): First vertex.</span>
</span><span id="L-3432"><a href="#L-3432"><span class="linenos">3432</span></a><span class="sd">        b (Point): Second vertex.</span>
</span><span id="L-3433"><a href="#L-3433"><span class="linenos">3433</span></a><span class="sd">        c (Point): Third vertex.</span>
</span><span id="L-3434"><a href="#L-3434"><span class="linenos">3434</span></a>
</span><span id="L-3435"><a href="#L-3435"><span class="linenos">3435</span></a><span class="sd">    Returns:</span>
</span><span id="L-3436"><a href="#L-3436"><span class="linenos">3436</span></a><span class="sd">        float: Area of the triangle.</span>
</span><span id="L-3437"><a href="#L-3437"><span class="linenos">3437</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3438"><a href="#L-3438"><span class="linenos">3438</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-3439"><a href="#L-3439"><span class="linenos">3439</span></a>
</span><span id="L-3440"><a href="#L-3440"><span class="linenos">3440</span></a>
</span><span id="L-3441"><a href="#L-3441"><span class="linenos">3441</span></a><span class="k">def</span> <span class="nf">calc_area</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-3442"><a href="#L-3442"><span class="linenos">3442</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a simple polygon (given by a list of its vertices).</span>
</span><span id="L-3443"><a href="#L-3443"><span class="linenos">3443</span></a>
</span><span id="L-3444"><a href="#L-3444"><span class="linenos">3444</span></a><span class="sd">    Args:</span>
</span><span id="L-3445"><a href="#L-3445"><span class="linenos">3445</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="L-3446"><a href="#L-3446"><span class="linenos">3446</span></a>
</span><span id="L-3447"><a href="#L-3447"><span class="linenos">3447</span></a><span class="sd">    Returns:</span>
</span><span id="L-3448"><a href="#L-3448"><span class="linenos">3448</span></a><span class="sd">        tuple: Area of the polygon and whether it is clockwise.</span>
</span><span id="L-3449"><a href="#L-3449"><span class="linenos">3449</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3450"><a href="#L-3450"><span class="linenos">3450</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-3451"><a href="#L-3451"><span class="linenos">3451</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3452"><a href="#L-3452"><span class="linenos">3452</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="L-3453"><a href="#L-3453"><span class="linenos">3453</span></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-3454"><a href="#L-3454"><span class="linenos">3454</span></a>        <span class="n">vnext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">]</span>
</span><span id="L-3455"><a href="#L-3455"><span class="linenos">3455</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">vnext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vnext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3456"><a href="#L-3456"><span class="linenos">3456</span></a>    <span class="n">clockwise</span> <span class="o">=</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-3457"><a href="#L-3457"><span class="linenos">3457</span></a>
</span><span id="L-3458"><a href="#L-3458"><span class="linenos">3458</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">area_</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">clockwise</span><span class="p">)</span>
</span><span id="L-3459"><a href="#L-3459"><span class="linenos">3459</span></a>
</span><span id="L-3460"><a href="#L-3460"><span class="linenos">3460</span></a>
</span><span id="L-3461"><a href="#L-3461"><span class="linenos">3461</span></a><span class="k">def</span> <span class="nf">remove_bad_points</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-3462"><a href="#L-3462"><span class="linenos">3462</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove redundant and collinear points from a list of points.</span>
</span><span id="L-3463"><a href="#L-3463"><span class="linenos">3463</span></a>
</span><span id="L-3464"><a href="#L-3464"><span class="linenos">3464</span></a><span class="sd">    Args:</span>
</span><span id="L-3465"><a href="#L-3465"><span class="linenos">3465</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="L-3466"><a href="#L-3466"><span class="linenos">3466</span></a>
</span><span id="L-3467"><a href="#L-3467"><span class="linenos">3467</span></a><span class="sd">    Returns:</span>
</span><span id="L-3468"><a href="#L-3468"><span class="linenos">3468</span></a><span class="sd">        list[Point]: List of points with redundant and collinear points removed.</span>
</span><span id="L-3469"><a href="#L-3469"><span class="linenos">3469</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3470"><a href="#L-3470"><span class="linenos">3470</span></a>    <span class="n">EPSILON</span> <span class="o">=</span> <span class="mf">1e-16</span>
</span><span id="L-3471"><a href="#L-3471"><span class="linenos">3471</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3472"><a href="#L-3472"><span class="linenos">3472</span></a>    <span class="c1"># check for redundant points</span>
</span><span id="L-3473"><a href="#L-3473"><span class="linenos">3473</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">[:]):</span>
</span><span id="L-3474"><a href="#L-3474"><span class="linenos">3474</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-3475"><a href="#L-3475"><span class="linenos">3475</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>  <span class="c1"># then remove the redundant point</span>
</span><span id="L-3476"><a href="#L-3476"><span class="linenos">3476</span></a>                <span class="c1"># maybe we should display a warning message here indicating</span>
</span><span id="L-3477"><a href="#L-3477"><span class="linenos">3477</span></a>                <span class="c1"># that redundant point is removed!!!</span>
</span><span id="L-3478"><a href="#L-3478"><span class="linenos">3478</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-3479"><a href="#L-3479"><span class="linenos">3479</span></a>
</span><span id="L-3480"><a href="#L-3480"><span class="linenos">3480</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3481"><a href="#L-3481"><span class="linenos">3481</span></a>    <span class="c1"># check for three consecutive points on a line</span>
</span><span id="L-3482"><a href="#L-3482"><span class="linenos">3482</span></a>    <span class="n">lin_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3483"><a href="#L-3483"><span class="linenos">3483</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-3484"><a href="#L-3484"><span class="linenos">3484</span></a>        <span class="k">if</span> <span class="n">EPSILON</span> <span class="o">&gt;</span> <span class="n">calc_area</span><span class="p">([</span><span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">EPSILON</span><span class="p">:</span>
</span><span id="L-3485"><a href="#L-3485"><span class="linenos">3485</span></a>            <span class="n">lin_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-3486"><a href="#L-3486"><span class="linenos">3486</span></a>
</span><span id="L-3487"><a href="#L-3487"><span class="linenos">3487</span></a>    <span class="k">if</span> <span class="n">EPSILON</span> <span class="o">&gt;</span> <span class="n">calc_area</span><span class="p">([</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">EPSILON</span><span class="p">:</span>
</span><span id="L-3488"><a href="#L-3488"><span class="linenos">3488</span></a>        <span class="n">lin_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-3489"><a href="#L-3489"><span class="linenos">3489</span></a>
</span><span id="L-3490"><a href="#L-3490"><span class="linenos">3490</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">lin_points</span><span class="p">:</span>
</span><span id="L-3491"><a href="#L-3491"><span class="linenos">3491</span></a>        <span class="c1"># maybe we should display a warning message here indicating that linear</span>
</span><span id="L-3492"><a href="#L-3492"><span class="linenos">3492</span></a>        <span class="c1"># point is removed!!!</span>
</span><span id="L-3493"><a href="#L-3493"><span class="linenos">3493</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-3494"><a href="#L-3494"><span class="linenos">3494</span></a>
</span><span id="L-3495"><a href="#L-3495"><span class="linenos">3495</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-3496"><a href="#L-3496"><span class="linenos">3496</span></a>
</span><span id="L-3497"><a href="#L-3497"><span class="linenos">3497</span></a>
</span><span id="L-3498"><a href="#L-3498"><span class="linenos">3498</span></a><span class="k">def</span> <span class="nf">is_convex</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-3499"><a href="#L-3499"><span class="linenos">3499</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the polygon is convex.</span>
</span><span id="L-3500"><a href="#L-3500"><span class="linenos">3500</span></a>
</span><span id="L-3501"><a href="#L-3501"><span class="linenos">3501</span></a><span class="sd">    Args:</span>
</span><span id="L-3502"><a href="#L-3502"><span class="linenos">3502</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="L-3503"><a href="#L-3503"><span class="linenos">3503</span></a>
</span><span id="L-3504"><a href="#L-3504"><span class="linenos">3504</span></a><span class="sd">    Returns:</span>
</span><span id="L-3505"><a href="#L-3505"><span class="linenos">3505</span></a><span class="sd">        bool: True if the polygon is convex, False otherwise.</span>
</span><span id="L-3506"><a href="#L-3506"><span class="linenos">3506</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3507"><a href="#L-3507"><span class="linenos">3507</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">remove_bad_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3508"><a href="#L-3508"><span class="linenos">3508</span></a>    <span class="n">n_checks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3509"><a href="#L-3509"><span class="linenos">3509</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">points</span> <span class="o">+</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-3510"><a href="#L-3510"><span class="linenos">3510</span></a>    <span class="n">senses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3511"><a href="#L-3511"><span class="linenos">3511</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_checks</span><span class="p">):</span>
</span><span id="L-3512"><a href="#L-3512"><span class="linenos">3512</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_checks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-3513"><a href="#L-3513"><span class="linenos">3513</span></a>            <span class="n">senses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_product_sense</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-3514"><a href="#L-3514"><span class="linenos">3514</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3515"><a href="#L-3515"><span class="linenos">3515</span></a>            <span class="n">senses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_product_sense</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]))</span>
</span><span id="L-3516"><a href="#L-3516"><span class="linenos">3516</span></a>    <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
</span><span id="L-3517"><a href="#L-3517"><span class="linenos">3517</span></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-3518"><a href="#L-3518"><span class="linenos">3518</span></a>
</span><span id="L-3519"><a href="#L-3519"><span class="linenos">3519</span></a>
</span><span id="L-3520"><a href="#L-3520"><span class="linenos">3520</span></a><span class="k">def</span> <span class="nf">set_vertices</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-3521"><a href="#L-3521"><span class="linenos">3521</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the next and previous vertices of a list of vertices.</span>
</span><span id="L-3522"><a href="#L-3522"><span class="linenos">3522</span></a>
</span><span id="L-3523"><a href="#L-3523"><span class="linenos">3523</span></a><span class="sd">    Args:</span>
</span><span id="L-3524"><a href="#L-3524"><span class="linenos">3524</span></a><span class="sd">        points (list[Vertex]): List of vertices.</span>
</span><span id="L-3525"><a href="#L-3525"><span class="linenos">3525</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3526"><a href="#L-3526"><span class="linenos">3526</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="L-3527"><a href="#L-3527"><span class="linenos">3527</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">[:])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="L-3528"><a href="#L-3528"><span class="linenos">3528</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3529"><a href="#L-3529"><span class="linenos">3529</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-3530"><a href="#L-3530"><span class="linenos">3530</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3531"><a href="#L-3531"><span class="linenos">3531</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3532"><a href="#L-3532"><span class="linenos">3532</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-3533"><a href="#L-3533"><span class="linenos">3533</span></a>        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-3534"><a href="#L-3534"><span class="linenos">3534</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-3535"><a href="#L-3535"><span class="linenos">3535</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-3536"><a href="#L-3536"><span class="linenos">3536</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3537"><a href="#L-3537"><span class="linenos">3537</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-3538"><a href="#L-3538"><span class="linenos">3538</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-3539"><a href="#L-3539"><span class="linenos">3539</span></a>        <span class="n">p</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">cross_product_sense</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">prev</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">next</span><span class="p">)</span>
</span><span id="L-3540"><a href="#L-3540"><span class="linenos">3540</span></a>
</span><span id="L-3541"><a href="#L-3541"><span class="linenos">3541</span></a>
</span><span id="L-3542"><a href="#L-3542"><span class="linenos">3542</span></a><span class="k">def</span> <span class="nf">circle_circle_intersections</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">radius1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">radius2</span><span class="p">):</span>
</span><span id="L-3543"><a href="#L-3543"><span class="linenos">3543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of two circles.</span>
</span><span id="L-3544"><a href="#L-3544"><span class="linenos">3544</span></a>
</span><span id="L-3545"><a href="#L-3545"><span class="linenos">3545</span></a><span class="sd">    Args:</span>
</span><span id="L-3546"><a href="#L-3546"><span class="linenos">3546</span></a><span class="sd">        point1 (Point): Center of the first circle.</span>
</span><span id="L-3547"><a href="#L-3547"><span class="linenos">3547</span></a><span class="sd">        radius1 (float): Radius of the first circle.</span>
</span><span id="L-3548"><a href="#L-3548"><span class="linenos">3548</span></a><span class="sd">        point2 (Point): Center of the second circle.</span>
</span><span id="L-3549"><a href="#L-3549"><span class="linenos">3549</span></a><span class="sd">        radius2 (float): Radius of the second circle.</span>
</span><span id="L-3550"><a href="#L-3550"><span class="linenos">3550</span></a>
</span><span id="L-3551"><a href="#L-3551"><span class="linenos">3551</span></a><span class="sd">    Returns:</span>
</span><span id="L-3552"><a href="#L-3552"><span class="linenos">3552</span></a><span class="sd">        tuple: Intersection points of the two circles.</span>
</span><span id="L-3553"><a href="#L-3553"><span class="linenos">3553</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3554"><a href="#L-3554"><span class="linenos">3554</span></a>    <span class="c1"># taken from https://stackoverflow.com/questions/55816902/finding-the-</span>
</span><span id="L-3555"><a href="#L-3555"><span class="linenos">3555</span></a>    <span class="c1"># intersection-of-two-circles</span>
</span><span id="L-3556"><a href="#L-3556"><span class="linenos">3556</span></a>    <span class="c1"># circle 1: (x0, y0), radius r0</span>
</span><span id="L-3557"><a href="#L-3557"><span class="linenos">3557</span></a>    <span class="c1"># circle 2: (x1, y1), radius r1</span>
</span><span id="L-3558"><a href="#L-3558"><span class="linenos">3558</span></a>
</span><span id="L-3559"><a href="#L-3559"><span class="linenos">3559</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point1</span>
</span><span id="L-3560"><a href="#L-3560"><span class="linenos">3560</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point2</span>
</span><span id="L-3561"><a href="#L-3561"><span class="linenos">3561</span></a>    <span class="n">r0</span> <span class="o">=</span> <span class="n">radius1</span>
</span><span id="L-3562"><a href="#L-3562"><span class="linenos">3562</span></a>    <span class="n">r1</span> <span class="o">=</span> <span class="n">radius2</span>
</span><span id="L-3563"><a href="#L-3563"><span class="linenos">3563</span></a>
</span><span id="L-3564"><a href="#L-3564"><span class="linenos">3564</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-3565"><a href="#L-3565"><span class="linenos">3565</span></a>
</span><span id="L-3566"><a href="#L-3566"><span class="linenos">3566</span></a>    <span class="c1"># non intersecting</span>
</span><span id="L-3567"><a href="#L-3567"><span class="linenos">3567</span></a>    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">r1</span><span class="p">:</span>
</span><span id="L-3568"><a href="#L-3568"><span class="linenos">3568</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-3569"><a href="#L-3569"><span class="linenos">3569</span></a>    <span class="c1"># One circle within other</span>
</span><span id="L-3570"><a href="#L-3570"><span class="linenos">3570</span></a>    <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r0</span> <span class="o">-</span> <span class="n">r1</span><span class="p">):</span>
</span><span id="L-3571"><a href="#L-3571"><span class="linenos">3571</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-3572"><a href="#L-3572"><span class="linenos">3572</span></a>    <span class="c1"># coincident circles</span>
</span><span id="L-3573"><a href="#L-3573"><span class="linenos">3573</span></a>    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r0</span> <span class="o">==</span> <span class="n">r1</span><span class="p">:</span>
</span><span id="L-3574"><a href="#L-3574"><span class="linenos">3574</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-3575"><a href="#L-3575"><span class="linenos">3575</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3576"><a href="#L-3576"><span class="linenos">3576</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
</span><span id="L-3577"><a href="#L-3577"><span class="linenos">3577</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-3578"><a href="#L-3578"><span class="linenos">3578</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3579"><a href="#L-3579"><span class="linenos">3579</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3580"><a href="#L-3580"><span class="linenos">3580</span></a>        <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3581"><a href="#L-3581"><span class="linenos">3581</span></a>        <span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3582"><a href="#L-3582"><span class="linenos">3582</span></a>        <span class="n">x4</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3583"><a href="#L-3583"><span class="linenos">3583</span></a>        <span class="n">y4</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="L-3584"><a href="#L-3584"><span class="linenos">3584</span></a>
</span><span id="L-3585"><a href="#L-3585"><span class="linenos">3585</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="L-3586"><a href="#L-3586"><span class="linenos">3586</span></a>
</span><span id="L-3587"><a href="#L-3587"><span class="linenos">3587</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3588"><a href="#L-3588"><span class="linenos">3588</span></a>
</span><span id="L-3589"><a href="#L-3589"><span class="linenos">3589</span></a>
</span><span id="L-3590"><a href="#L-3590"><span class="linenos">3590</span></a><span class="k">def</span> <span class="nf">circle_segment_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
</span><span id="L-3591"><a href="#L-3591"><span class="linenos">3591</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the circle and the line segment intersect.</span>
</span><span id="L-3592"><a href="#L-3592"><span class="linenos">3592</span></a>
</span><span id="L-3593"><a href="#L-3593"><span class="linenos">3593</span></a><span class="sd">    Args:</span>
</span><span id="L-3594"><a href="#L-3594"><span class="linenos">3594</span></a><span class="sd">        circle (Circle): Input circle.</span>
</span><span id="L-3595"><a href="#L-3595"><span class="linenos">3595</span></a><span class="sd">        p1 (Point): First point of the line segment.</span>
</span><span id="L-3596"><a href="#L-3596"><span class="linenos">3596</span></a><span class="sd">        p2 (Point): Second point of the line segment.</span>
</span><span id="L-3597"><a href="#L-3597"><span class="linenos">3597</span></a>
</span><span id="L-3598"><a href="#L-3598"><span class="linenos">3598</span></a><span class="sd">    Returns:</span>
</span><span id="L-3599"><a href="#L-3599"><span class="linenos">3599</span></a><span class="sd">        bool: True if the circle and the line segment intersect, False otherwise.</span>
</span><span id="L-3600"><a href="#L-3600"><span class="linenos">3600</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3601"><a href="#L-3601"><span class="linenos">3601</span></a>    <span class="c1"># if line seg and circle intersects returns true, false otherwise</span>
</span><span id="L-3602"><a href="#L-3602"><span class="linenos">3602</span></a>    <span class="c1"># c: circle</span>
</span><span id="L-3603"><a href="#L-3603"><span class="linenos">3603</span></a>    <span class="c1"># p1 and p2 are the endpoints of the line segment</span>
</span><span id="L-3604"><a href="#L-3604"><span class="linenos">3604</span></a>
</span><span id="L-3605"><a href="#L-3605"><span class="linenos">3605</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3606"><a href="#L-3606"><span class="linenos">3606</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3607"><a href="#L-3607"><span class="linenos">3607</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3608"><a href="#L-3608"><span class="linenos">3608</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="L-3609"><a href="#L-3609"><span class="linenos">3609</span></a>        <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span>
</span><span id="L-3610"><a href="#L-3610"><span class="linenos">3610</span></a>        <span class="ow">or</span> <span class="n">distance</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span>
</span><span id="L-3611"><a href="#L-3611"><span class="linenos">3611</span></a>    <span class="p">):</span>
</span><span id="L-3612"><a href="#L-3612"><span class="linenos">3612</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-3613"><a href="#L-3613"><span class="linenos">3613</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="L-3614"><a href="#L-3614"><span class="linenos">3614</span></a>        <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-3615"><a href="#L-3615"><span class="linenos">3615</span></a>    <span class="p">)</span>
</span><span id="L-3616"><a href="#L-3616"><span class="linenos">3616</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-3617"><a href="#L-3617"><span class="linenos">3617</span></a>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-3618"><a href="#L-3618"><span class="linenos">3618</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-3619"><a href="#L-3619"><span class="linenos">3619</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="L-3620"><a href="#L-3620"><span class="linenos">3620</span></a>        <span class="k">if</span> <span class="n">distance</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span><span class="p">:</span>
</span><span id="L-3621"><a href="#L-3621"><span class="linenos">3621</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-3622"><a href="#L-3622"><span class="linenos">3622</span></a>
</span><span id="L-3623"><a href="#L-3623"><span class="linenos">3623</span></a>    <span class="k">return</span> <span class="n">res</span>  <span class="c1"># p is not between lp1 and lp2</span>
</span><span id="L-3624"><a href="#L-3624"><span class="linenos">3624</span></a>
</span><span id="L-3625"><a href="#L-3625"><span class="linenos">3625</span></a>
</span><span id="L-3626"><a href="#L-3626"><span class="linenos">3626</span></a><span class="k">def</span> <span class="nf">r_polar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
</span><span id="L-3627"><a href="#L-3627"><span class="linenos">3627</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the radius (distance between the center and the intersection point)</span>
</span><span id="L-3628"><a href="#L-3628"><span class="linenos">3628</span></a><span class="sd">    of the ellipse at the given angle.</span>
</span><span id="L-3629"><a href="#L-3629"><span class="linenos">3629</span></a>
</span><span id="L-3630"><a href="#L-3630"><span class="linenos">3630</span></a><span class="sd">    Args:</span>
</span><span id="L-3631"><a href="#L-3631"><span class="linenos">3631</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3632"><a href="#L-3632"><span class="linenos">3632</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3633"><a href="#L-3633"><span class="linenos">3633</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="L-3634"><a href="#L-3634"><span class="linenos">3634</span></a>
</span><span id="L-3635"><a href="#L-3635"><span class="linenos">3635</span></a><span class="sd">    Returns:</span>
</span><span id="L-3636"><a href="#L-3636"><span class="linenos">3636</span></a><span class="sd">        float: Radius of the ellipse at the given angle.</span>
</span><span id="L-3637"><a href="#L-3637"><span class="linenos">3637</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3638"><a href="#L-3638"><span class="linenos">3638</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-3639"><a href="#L-3639"><span class="linenos">3639</span></a>
</span><span id="L-3640"><a href="#L-3640"><span class="linenos">3640</span></a>
</span><span id="L-3641"><a href="#L-3641"><span class="linenos">3641</span></a><span class="k">def</span> <span class="nf">ellipse_line_intersection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
</span><span id="L-3642"><a href="#L-3642"><span class="linenos">3642</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of an ellipse and a line segment</span>
</span><span id="L-3643"><a href="#L-3643"><span class="linenos">3643</span></a><span class="sd">    connecting the given point to the ellipse center at (0, 0).</span>
</span><span id="L-3644"><a href="#L-3644"><span class="linenos">3644</span></a>
</span><span id="L-3645"><a href="#L-3645"><span class="linenos">3645</span></a><span class="sd">    Args:</span>
</span><span id="L-3646"><a href="#L-3646"><span class="linenos">3646</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3647"><a href="#L-3647"><span class="linenos">3647</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3648"><a href="#L-3648"><span class="linenos">3648</span></a><span class="sd">        point (Point): Point on the line segment.</span>
</span><span id="L-3649"><a href="#L-3649"><span class="linenos">3649</span></a>
</span><span id="L-3650"><a href="#L-3650"><span class="linenos">3650</span></a><span class="sd">    Returns:</span>
</span><span id="L-3651"><a href="#L-3651"><span class="linenos">3651</span></a><span class="sd">        list[Point]: Intersection points of the ellipse and the line segment.</span>
</span><span id="L-3652"><a href="#L-3652"><span class="linenos">3652</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3653"><a href="#L-3653"><span class="linenos">3653</span></a>    <span class="c1"># adapted from http://mathworld.wolfram.com/Ellipse-LineIntersection.html</span>
</span><span id="L-3654"><a href="#L-3654"><span class="linenos">3654</span></a>    <span class="c1"># a, b is the ellipse width/2 and height/2 and (x_0, y_0) is the point</span>
</span><span id="L-3655"><a href="#L-3655"><span class="linenos">3655</span></a>
</span><span id="L-3656"><a href="#L-3656"><span class="linenos">3656</span></a>    <span class="n">x_0</span><span class="p">,</span> <span class="n">y_0</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3657"><a href="#L-3657"><span class="linenos">3657</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">x_0</span>
</span><span id="L-3658"><a href="#L-3658"><span class="linenos">3658</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">y_0</span>
</span><span id="L-3659"><a href="#L-3659"><span class="linenos">3659</span></a>
</span><span id="L-3660"><a href="#L-3660"><span class="linenos">3660</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)]</span>
</span><span id="L-3661"><a href="#L-3661"><span class="linenos">3661</span></a>
</span><span id="L-3662"><a href="#L-3662"><span class="linenos">3662</span></a>
</span><span id="L-3663"><a href="#L-3663"><span class="linenos">3663</span></a><span class="k">def</span> <span class="nf">ellipse_tangent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
</span><span id="L-3664"><a href="#L-3664"><span class="linenos">3664</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the slope of the tangent line to an ellipse at the point (x, y).</span>
</span><span id="L-3665"><a href="#L-3665"><span class="linenos">3665</span></a><span class="sd">    If point is not on the ellipse, return False.</span>
</span><span id="L-3666"><a href="#L-3666"><span class="linenos">3666</span></a>
</span><span id="L-3667"><a href="#L-3667"><span class="linenos">3667</span></a><span class="sd">    Args:</span>
</span><span id="L-3668"><a href="#L-3668"><span class="linenos">3668</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3669"><a href="#L-3669"><span class="linenos">3669</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3670"><a href="#L-3670"><span class="linenos">3670</span></a><span class="sd">        x (float): x-coordinate of the point.</span>
</span><span id="L-3671"><a href="#L-3671"><span class="linenos">3671</span></a><span class="sd">        y (float): y-coordinate of the point.</span>
</span><span id="L-3672"><a href="#L-3672"><span class="linenos">3672</span></a><span class="sd">        tol (float, optional): Tolerance. Defaults to 0.001.</span>
</span><span id="L-3673"><a href="#L-3673"><span class="linenos">3673</span></a>
</span><span id="L-3674"><a href="#L-3674"><span class="linenos">3674</span></a><span class="sd">    Returns:</span>
</span><span id="L-3675"><a href="#L-3675"><span class="linenos">3675</span></a><span class="sd">        float: Slope of the tangent line, or False if the point is not on the ellipse.</span>
</span><span id="L-3676"><a href="#L-3676"><span class="linenos">3676</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3677"><a href="#L-3677"><span class="linenos">3677</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
</span><span id="L-3678"><a href="#L-3678"><span class="linenos">3678</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-3679"><a href="#L-3679"><span class="linenos">3679</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3680"><a href="#L-3680"><span class="linenos">3680</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-3681"><a href="#L-3681"><span class="linenos">3681</span></a>
</span><span id="L-3682"><a href="#L-3682"><span class="linenos">3682</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3683"><a href="#L-3683"><span class="linenos">3683</span></a>
</span><span id="L-3684"><a href="#L-3684"><span class="linenos">3684</span></a>
</span><span id="L-3685"><a href="#L-3685"><span class="linenos">3685</span></a><span class="k">def</span> <span class="nf">elliptic_arclength</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="L-3686"><a href="#L-3686"><span class="linenos">3686</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the arclength of an ellipse between the given parametric angles.</span>
</span><span id="L-3687"><a href="#L-3687"><span class="linenos">3687</span></a><span class="sd">    The ellipse has semi-major axis a and semi-minor axis b.</span>
</span><span id="L-3688"><a href="#L-3688"><span class="linenos">3688</span></a>
</span><span id="L-3689"><a href="#L-3689"><span class="linenos">3689</span></a><span class="sd">    Args:</span>
</span><span id="L-3690"><a href="#L-3690"><span class="linenos">3690</span></a><span class="sd">        t_0 (float): Start parametric angle in radians.</span>
</span><span id="L-3691"><a href="#L-3691"><span class="linenos">3691</span></a><span class="sd">        t_1 (float): End parametric angle in radians.</span>
</span><span id="L-3692"><a href="#L-3692"><span class="linenos">3692</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3693"><a href="#L-3693"><span class="linenos">3693</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3694"><a href="#L-3694"><span class="linenos">3694</span></a>
</span><span id="L-3695"><a href="#L-3695"><span class="linenos">3695</span></a><span class="sd">    Returns:</span>
</span><span id="L-3696"><a href="#L-3696"><span class="linenos">3696</span></a><span class="sd">        float: Arclength of the ellipse between the given parametric angles.</span>
</span><span id="L-3697"><a href="#L-3697"><span class="linenos">3697</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3698"><a href="#L-3698"><span class="linenos">3698</span></a>    <span class="c1"># from: https://www.johndcook.com/blog/2022/11/02/elliptic-arc-length/</span>
</span><span id="L-3699"><a href="#L-3699"><span class="linenos">3699</span></a>    <span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">ellipeinc</span> <span class="c1"># this takes too long to import!!!</span>
</span><span id="L-3700"><a href="#L-3700"><span class="linenos">3700</span></a>    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-3701"><a href="#L-3701"><span class="linenos">3701</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="L-3702"><a href="#L-3702"><span class="linenos">3702</span></a>    <span class="n">t0</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="L-3703"><a href="#L-3703"><span class="linenos">3703</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>
</span><span id="L-3704"><a href="#L-3704"><span class="linenos">3704</span></a>
</span><span id="L-3705"><a href="#L-3705"><span class="linenos">3705</span></a>
</span><span id="L-3706"><a href="#L-3706"><span class="linenos">3706</span></a><span class="k">def</span> <span class="nf">central_to_parametric_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
</span><span id="L-3707"><a href="#L-3707"><span class="linenos">3707</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3708"><a href="#L-3708"><span class="linenos">3708</span></a><span class="sd">    Converts a central angle to a parametric angle on an ellipse.</span>
</span><span id="L-3709"><a href="#L-3709"><span class="linenos">3709</span></a>
</span><span id="L-3710"><a href="#L-3710"><span class="linenos">3710</span></a><span class="sd">    Args:</span>
</span><span id="L-3711"><a href="#L-3711"><span class="linenos">3711</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3712"><a href="#L-3712"><span class="linenos">3712</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3713"><a href="#L-3713"><span class="linenos">3713</span></a><span class="sd">        phi (float): Central angle in radians.</span>
</span><span id="L-3714"><a href="#L-3714"><span class="linenos">3714</span></a>
</span><span id="L-3715"><a href="#L-3715"><span class="linenos">3715</span></a><span class="sd">    Returns:</span>
</span><span id="L-3716"><a href="#L-3716"><span class="linenos">3716</span></a><span class="sd">        float: Parametric angle in radians.</span>
</span><span id="L-3717"><a href="#L-3717"><span class="linenos">3717</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3718"><a href="#L-3718"><span class="linenos">3718</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
</span><span id="L-3719"><a href="#L-3719"><span class="linenos">3719</span></a>    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3720"><a href="#L-3720"><span class="linenos">3720</span></a>        <span class="n">t</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="L-3721"><a href="#L-3721"><span class="linenos">3721</span></a>
</span><span id="L-3722"><a href="#L-3722"><span class="linenos">3722</span></a>    <span class="k">return</span> <span class="n">t</span>
</span><span id="L-3723"><a href="#L-3723"><span class="linenos">3723</span></a>
</span><span id="L-3724"><a href="#L-3724"><span class="linenos">3724</span></a>
</span><span id="L-3725"><a href="#L-3725"><span class="linenos">3725</span></a><span class="k">def</span> <span class="nf">parametric_to_central_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="L-3726"><a href="#L-3726"><span class="linenos">3726</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3727"><a href="#L-3727"><span class="linenos">3727</span></a><span class="sd">    Converts a parametric angle on an ellipse to a central angle.</span>
</span><span id="L-3728"><a href="#L-3728"><span class="linenos">3728</span></a>
</span><span id="L-3729"><a href="#L-3729"><span class="linenos">3729</span></a><span class="sd">    Args:</span>
</span><span id="L-3730"><a href="#L-3730"><span class="linenos">3730</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3731"><a href="#L-3731"><span class="linenos">3731</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3732"><a href="#L-3732"><span class="linenos">3732</span></a><span class="sd">        t (float): Parametric angle in radians.</span>
</span><span id="L-3733"><a href="#L-3733"><span class="linenos">3733</span></a>
</span><span id="L-3734"><a href="#L-3734"><span class="linenos">3734</span></a><span class="sd">    Returns:</span>
</span><span id="L-3735"><a href="#L-3735"><span class="linenos">3735</span></a><span class="sd">        float: Central angle in radians.</span>
</span><span id="L-3736"><a href="#L-3736"><span class="linenos">3736</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3737"><a href="#L-3737"><span class="linenos">3737</span></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</span><span id="L-3738"><a href="#L-3738"><span class="linenos">3738</span></a>    <span class="k">if</span> <span class="n">phi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3739"><a href="#L-3739"><span class="linenos">3739</span></a>        <span class="n">phi</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="L-3740"><a href="#L-3740"><span class="linenos">3740</span></a>
</span><span id="L-3741"><a href="#L-3741"><span class="linenos">3741</span></a>    <span class="k">return</span> <span class="n">phi</span>
</span><span id="L-3742"><a href="#L-3742"><span class="linenos">3742</span></a>
</span><span id="L-3743"><a href="#L-3743"><span class="linenos">3743</span></a>
</span><span id="L-3744"><a href="#L-3744"><span class="linenos">3744</span></a><span class="k">def</span> <span class="nf">ellipse_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n_points</span><span class="p">):</span>
</span><span id="L-3745"><a href="#L-3745"><span class="linenos">3745</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate points on an ellipse.</span>
</span><span id="L-3746"><a href="#L-3746"><span class="linenos">3746</span></a>
</span><span id="L-3747"><a href="#L-3747"><span class="linenos">3747</span></a><span class="sd">    Args:</span>
</span><span id="L-3748"><a href="#L-3748"><span class="linenos">3748</span></a><span class="sd">        center (tuple): (x, y) coordinates of the ellipse center.</span>
</span><span id="L-3749"><a href="#L-3749"><span class="linenos">3749</span></a><span class="sd">        a (float): Length of the semi-major axis.</span>
</span><span id="L-3750"><a href="#L-3750"><span class="linenos">3750</span></a><span class="sd">        b (float): Length of the semi-minor axis.</span>
</span><span id="L-3751"><a href="#L-3751"><span class="linenos">3751</span></a><span class="sd">        n_points (int): Number of points to generate.</span>
</span><span id="L-3752"><a href="#L-3752"><span class="linenos">3752</span></a>
</span><span id="L-3753"><a href="#L-3753"><span class="linenos">3753</span></a><span class="sd">    Returns:</span>
</span><span id="L-3754"><a href="#L-3754"><span class="linenos">3754</span></a><span class="sd">        np.ndarray: Array of (x, y) coordinates of the ellipse points.</span>
</span><span id="L-3755"><a href="#L-3755"><span class="linenos">3755</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3756"><a href="#L-3756"><span class="linenos">3756</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
</span><span id="L-3757"><a href="#L-3757"><span class="linenos">3757</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="L-3758"><a href="#L-3758"><span class="linenos">3758</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="L-3759"><a href="#L-3759"><span class="linenos">3759</span></a>
</span><span id="L-3760"><a href="#L-3760"><span class="linenos">3760</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-3761"><a href="#L-3761"><span class="linenos">3761</span></a>
</span><span id="L-3762"><a href="#L-3762"><span class="linenos">3762</span></a>
</span><span id="L-3763"><a href="#L-3763"><span class="linenos">3763</span></a><span class="k">def</span> <span class="nf">ellipse_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
</span><span id="L-3764"><a href="#L-3764"><span class="linenos">3764</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point on an ellipse with the given a=width/2, b=height/2, and angle.</span>
</span><span id="L-3765"><a href="#L-3765"><span class="linenos">3765</span></a>
</span><span id="L-3766"><a href="#L-3766"><span class="linenos">3766</span></a><span class="sd">    Args:</span>
</span><span id="L-3767"><a href="#L-3767"><span class="linenos">3767</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="L-3768"><a href="#L-3768"><span class="linenos">3768</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="L-3769"><a href="#L-3769"><span class="linenos">3769</span></a><span class="sd">        angle (float): Angle in radians.</span>
</span><span id="L-3770"><a href="#L-3770"><span class="linenos">3770</span></a>
</span><span id="L-3771"><a href="#L-3771"><span class="linenos">3771</span></a><span class="sd">    Returns:</span>
</span><span id="L-3772"><a href="#L-3772"><span class="linenos">3772</span></a><span class="sd">        Point: Point on the ellipse.</span>
</span><span id="L-3773"><a href="#L-3773"><span class="linenos">3773</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3774"><a href="#L-3774"><span class="linenos">3774</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">r_polar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="L-3775"><a href="#L-3775"><span class="linenos">3775</span></a>
</span><span id="L-3776"><a href="#L-3776"><span class="linenos">3776</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
</span><span id="L-3777"><a href="#L-3777"><span class="linenos">3777</span></a>
</span><span id="L-3778"><a href="#L-3778"><span class="linenos">3778</span></a>
</span><span id="L-3779"><a href="#L-3779"><span class="linenos">3779</span></a><span class="k">def</span> <span class="nf">circle_line_intersection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
</span><span id="L-3780"><a href="#L-3780"><span class="linenos">3780</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of a circle and a line segment.</span>
</span><span id="L-3781"><a href="#L-3781"><span class="linenos">3781</span></a>
</span><span id="L-3782"><a href="#L-3782"><span class="linenos">3782</span></a><span class="sd">    Args:</span>
</span><span id="L-3783"><a href="#L-3783"><span class="linenos">3783</span></a><span class="sd">        c (Circle): Input circle.</span>
</span><span id="L-3784"><a href="#L-3784"><span class="linenos">3784</span></a><span class="sd">        p1 (Point): First point of the line segment.</span>
</span><span id="L-3785"><a href="#L-3785"><span class="linenos">3785</span></a><span class="sd">        p2 (Point): Second point of the line segment.</span>
</span><span id="L-3786"><a href="#L-3786"><span class="linenos">3786</span></a>
</span><span id="L-3787"><a href="#L-3787"><span class="linenos">3787</span></a><span class="sd">    Returns:</span>
</span><span id="L-3788"><a href="#L-3788"><span class="linenos">3788</span></a><span class="sd">        tuple: Intersection points of the circle and the line segment.</span>
</span><span id="L-3789"><a href="#L-3789"><span class="linenos">3789</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3790"><a href="#L-3790"><span class="linenos">3790</span></a>
</span><span id="L-3791"><a href="#L-3791"><span class="linenos">3791</span></a>    <span class="c1"># adapted from http://mathworld.wolfram.com/Circle-LineIntersection.html</span>
</span><span id="L-3792"><a href="#L-3792"><span class="linenos">3792</span></a>    <span class="c1"># c is the circle and p1 and p2 are the line points</span>
</span><span id="L-3793"><a href="#L-3793"><span class="linenos">3793</span></a>    <span class="k">def</span> <span class="nf">sgn</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
</span><span id="L-3794"><a href="#L-3794"><span class="linenos">3794</span></a>        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3795"><a href="#L-3795"><span class="linenos">3795</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-3796"><a href="#L-3796"><span class="linenos">3796</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3797"><a href="#L-3797"><span class="linenos">3797</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-3798"><a href="#L-3798"><span class="linenos">3798</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3799"><a href="#L-3799"><span class="linenos">3799</span></a>
</span><span id="L-3800"><a href="#L-3800"><span class="linenos">3800</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3801"><a href="#L-3801"><span class="linenos">3801</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3802"><a href="#L-3802"><span class="linenos">3802</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">radius</span>
</span><span id="L-3803"><a href="#L-3803"><span class="linenos">3803</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3804"><a href="#L-3804"><span class="linenos">3804</span></a>
</span><span id="L-3805"><a href="#L-3805"><span class="linenos">3805</span></a>    <span class="n">x1</span> <span class="o">-=</span> <span class="n">x</span>
</span><span id="L-3806"><a href="#L-3806"><span class="linenos">3806</span></a>    <span class="n">x2</span> <span class="o">-=</span> <span class="n">x</span>
</span><span id="L-3807"><a href="#L-3807"><span class="linenos">3807</span></a>    <span class="n">y1</span> <span class="o">-=</span> <span class="n">y</span>
</span><span id="L-3808"><a href="#L-3808"><span class="linenos">3808</span></a>    <span class="n">y2</span> <span class="o">-=</span> <span class="n">y</span>
</span><span id="L-3809"><a href="#L-3809"><span class="linenos">3809</span></a>
</span><span id="L-3810"><a href="#L-3810"><span class="linenos">3810</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="L-3811"><a href="#L-3811"><span class="linenos">3811</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="L-3812"><a href="#L-3812"><span class="linenos">3812</span></a>    <span class="n">dr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-3813"><a href="#L-3813"><span class="linenos">3813</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="L-3814"><a href="#L-3814"><span class="linenos">3814</span></a>    <span class="n">d2</span> <span class="o">=</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-3815"><a href="#L-3815"><span class="linenos">3815</span></a>    <span class="n">r2</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-3816"><a href="#L-3816"><span class="linenos">3816</span></a>    <span class="n">dr2</span> <span class="o">=</span> <span class="n">dr</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-3817"><a href="#L-3817"><span class="linenos">3817</span></a>
</span><span id="L-3818"><a href="#L-3818"><span class="linenos">3818</span></a>    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">dr2</span> <span class="o">-</span> <span class="n">d2</span>
</span><span id="L-3819"><a href="#L-3819"><span class="linenos">3819</span></a>
</span><span id="L-3820"><a href="#L-3820"><span class="linenos">3820</span></a>    <span class="k">if</span> <span class="n">discriminant</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3821"><a href="#L-3821"><span class="linenos">3821</span></a>        <span class="n">ddy</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dy</span>
</span><span id="L-3822"><a href="#L-3822"><span class="linenos">3822</span></a>        <span class="n">ddx</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dx</span>
</span><span id="L-3823"><a href="#L-3823"><span class="linenos">3823</span></a>        <span class="n">sqrterm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">dr2</span> <span class="o">-</span> <span class="n">d2</span><span class="p">)</span>
</span><span id="L-3824"><a href="#L-3824"><span class="linenos">3824</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">sgn</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sqrterm</span>
</span><span id="L-3825"><a href="#L-3825"><span class="linenos">3825</span></a>
</span><span id="L-3826"><a href="#L-3826"><span class="linenos">3826</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">ddy</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="L-3827"><a href="#L-3827"><span class="linenos">3827</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ddx</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrterm</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="L-3828"><a href="#L-3828"><span class="linenos">3828</span></a>        <span class="k">if</span> <span class="n">discriminant</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3829"><a href="#L-3829"><span class="linenos">3829</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-3830"><a href="#L-3830"><span class="linenos">3830</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-3831"><a href="#L-3831"><span class="linenos">3831</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">ddy</span> <span class="o">-</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="L-3832"><a href="#L-3832"><span class="linenos">3832</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ddx</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrterm</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="L-3833"><a href="#L-3833"><span class="linenos">3833</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-3834"><a href="#L-3834"><span class="linenos">3834</span></a>
</span><span id="L-3835"><a href="#L-3835"><span class="linenos">3835</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-3836"><a href="#L-3836"><span class="linenos">3836</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-3837"><a href="#L-3837"><span class="linenos">3837</span></a>
</span><span id="L-3838"><a href="#L-3838"><span class="linenos">3838</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3839"><a href="#L-3839"><span class="linenos">3839</span></a>
</span><span id="L-3840"><a href="#L-3840"><span class="linenos">3840</span></a>
</span><span id="L-3841"><a href="#L-3841"><span class="linenos">3841</span></a><span class="k">def</span> <span class="nf">circle_poly_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
</span><span id="L-3842"><a href="#L-3842"><span class="linenos">3842</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the circle and the polygon intersect.</span>
</span><span id="L-3843"><a href="#L-3843"><span class="linenos">3843</span></a>
</span><span id="L-3844"><a href="#L-3844"><span class="linenos">3844</span></a><span class="sd">    Args:</span>
</span><span id="L-3845"><a href="#L-3845"><span class="linenos">3845</span></a><span class="sd">        circle (Circle): Input circle.</span>
</span><span id="L-3846"><a href="#L-3846"><span class="linenos">3846</span></a><span class="sd">        polygon (Polygon): Input polygon.</span>
</span><span id="L-3847"><a href="#L-3847"><span class="linenos">3847</span></a>
</span><span id="L-3848"><a href="#L-3848"><span class="linenos">3848</span></a><span class="sd">    Returns:</span>
</span><span id="L-3849"><a href="#L-3849"><span class="linenos">3849</span></a><span class="sd">        bool: True if the circle and the polygon intersect, False otherwise.</span>
</span><span id="L-3850"><a href="#L-3850"><span class="linenos">3850</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3851"><a href="#L-3851"><span class="linenos">3851</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-3852"><a href="#L-3852"><span class="linenos">3852</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-3853"><a href="#L-3853"><span class="linenos">3853</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-3854"><a href="#L-3854"><span class="linenos">3854</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-3855"><a href="#L-3855"><span class="linenos">3855</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-3856"><a href="#L-3856"><span class="linenos">3856</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3857"><a href="#L-3857"><span class="linenos">3857</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-3858"><a href="#L-3858"><span class="linenos">3858</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-3859"><a href="#L-3859"><span class="linenos">3859</span></a>        <span class="k">if</span> <span class="n">circle_segment_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)):</span>
</span><span id="L-3860"><a href="#L-3860"><span class="linenos">3860</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-3861"><a href="#L-3861"><span class="linenos">3861</span></a>            <span class="k">break</span>
</span><span id="L-3862"><a href="#L-3862"><span class="linenos">3862</span></a>    <span class="k">return</span> <span class="n">res</span>
</span><span id="L-3863"><a href="#L-3863"><span class="linenos">3863</span></a>
</span><span id="L-3864"><a href="#L-3864"><span class="linenos">3864</span></a>
</span><span id="L-3865"><a href="#L-3865"><span class="linenos">3865</span></a><span class="k">def</span> <span class="nf">point_to_circle_distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="L-3866"><a href="#L-3866"><span class="linenos">3866</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point, center point, and radius, returns distance</span>
</span><span id="L-3867"><a href="#L-3867"><span class="linenos">3867</span></a><span class="sd">    between the given point and the circle</span>
</span><span id="L-3868"><a href="#L-3868"><span class="linenos">3868</span></a>
</span><span id="L-3869"><a href="#L-3869"><span class="linenos">3869</span></a><span class="sd">    Args:</span>
</span><span id="L-3870"><a href="#L-3870"><span class="linenos">3870</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="L-3871"><a href="#L-3871"><span class="linenos">3871</span></a><span class="sd">        center (Point): Center of the circle.</span>
</span><span id="L-3872"><a href="#L-3872"><span class="linenos">3872</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="L-3873"><a href="#L-3873"><span class="linenos">3873</span></a>
</span><span id="L-3874"><a href="#L-3874"><span class="linenos">3874</span></a><span class="sd">    Returns:</span>
</span><span id="L-3875"><a href="#L-3875"><span class="linenos">3875</span></a><span class="sd">        float: Distance between the point and the circle.</span>
</span><span id="L-3876"><a href="#L-3876"><span class="linenos">3876</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3877"><a href="#L-3877"><span class="linenos">3877</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span><span class="p">)</span>
</span><span id="L-3878"><a href="#L-3878"><span class="linenos">3878</span></a>
</span><span id="L-3879"><a href="#L-3879"><span class="linenos">3879</span></a>
</span><span id="L-3880"><a href="#L-3880"><span class="linenos">3880</span></a><span class="k">def</span> <span class="nf">get_interior_points</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">n_points</span><span class="p">):</span>
</span><span id="L-3881"><a href="#L-3881"><span class="linenos">3881</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given start and end points and number of interior points</span>
</span><span id="L-3882"><a href="#L-3882"><span class="linenos">3882</span></a><span class="sd">    returns the positions of the interior points</span>
</span><span id="L-3883"><a href="#L-3883"><span class="linenos">3883</span></a>
</span><span id="L-3884"><a href="#L-3884"><span class="linenos">3884</span></a><span class="sd">    Args:</span>
</span><span id="L-3885"><a href="#L-3885"><span class="linenos">3885</span></a><span class="sd">        start (Point): Start point.</span>
</span><span id="L-3886"><a href="#L-3886"><span class="linenos">3886</span></a><span class="sd">        end (Point): End point.</span>
</span><span id="L-3887"><a href="#L-3887"><span class="linenos">3887</span></a><span class="sd">        n_points (int): Number of interior points.</span>
</span><span id="L-3888"><a href="#L-3888"><span class="linenos">3888</span></a>
</span><span id="L-3889"><a href="#L-3889"><span class="linenos">3889</span></a><span class="sd">    Returns:</span>
</span><span id="L-3890"><a href="#L-3890"><span class="linenos">3890</span></a><span class="sd">        list[Point]: List of interior points.</span>
</span><span id="L-3891"><a href="#L-3891"><span class="linenos">3891</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3892"><a href="#L-3892"><span class="linenos">3892</span></a>    <span class="n">rot_angle</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="L-3893"><a href="#L-3893"><span class="linenos">3893</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="L-3894"><a href="#L-3894"><span class="linenos">3894</span></a>    <span class="n">seg_length</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-3895"><a href="#L-3895"><span class="linenos">3895</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-3896"><a href="#L-3896"><span class="linenos">3896</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="L-3897"><a href="#L-3897"><span class="linenos">3897</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-3898"><a href="#L-3898"><span class="linenos">3898</span></a>            <span class="n">rotate_point</span><span class="p">([</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seg_length</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">start</span><span class="p">,</span> <span class="n">rot_angle</span><span class="p">)</span>
</span><span id="L-3899"><a href="#L-3899"><span class="linenos">3899</span></a>        <span class="p">)</span>
</span><span id="L-3900"><a href="#L-3900"><span class="linenos">3900</span></a>    <span class="k">return</span> <span class="n">points</span>
</span><span id="L-3901"><a href="#L-3901"><span class="linenos">3901</span></a>
</span><span id="L-3902"><a href="#L-3902"><span class="linenos">3902</span></a>
</span><span id="L-3903"><a href="#L-3903"><span class="linenos">3903</span></a><span class="k">def</span> <span class="nf">circle_3point</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">):</span>
</span><span id="L-3904"><a href="#L-3904"><span class="linenos">3904</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given three points, returns the center point and radius</span>
</span><span id="L-3905"><a href="#L-3905"><span class="linenos">3905</span></a>
</span><span id="L-3906"><a href="#L-3906"><span class="linenos">3906</span></a><span class="sd">    Args:</span>
</span><span id="L-3907"><a href="#L-3907"><span class="linenos">3907</span></a><span class="sd">        point1 (Point): First point.</span>
</span><span id="L-3908"><a href="#L-3908"><span class="linenos">3908</span></a><span class="sd">        point2 (Point): Second point.</span>
</span><span id="L-3909"><a href="#L-3909"><span class="linenos">3909</span></a><span class="sd">        point3 (Point): Third point.</span>
</span><span id="L-3910"><a href="#L-3910"><span class="linenos">3910</span></a>
</span><span id="L-3911"><a href="#L-3911"><span class="linenos">3911</span></a><span class="sd">    Returns:</span>
</span><span id="L-3912"><a href="#L-3912"><span class="linenos">3912</span></a><span class="sd">        tuple: Center point and radius of the circle.</span>
</span><span id="L-3913"><a href="#L-3913"><span class="linenos">3913</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3914"><a href="#L-3914"><span class="linenos">3914</span></a>    <span class="n">ax</span><span class="p">,</span> <span class="n">ay</span> <span class="o">=</span> <span class="n">point1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3915"><a href="#L-3915"><span class="linenos">3915</span></a>    <span class="n">bx</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">point2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3916"><a href="#L-3916"><span class="linenos">3916</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">point3</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3917"><a href="#L-3917"><span class="linenos">3917</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">bx</span> <span class="o">-</span> <span class="n">ax</span>
</span><span id="L-3918"><a href="#L-3918"><span class="linenos">3918</span></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">by</span> <span class="o">-</span> <span class="n">ay</span>
</span><span id="L-3919"><a href="#L-3919"><span class="linenos">3919</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">ax</span>
</span><span id="L-3920"><a href="#L-3920"><span class="linenos">3920</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">-</span> <span class="n">ay</span>
</span><span id="L-3921"><a href="#L-3921"><span class="linenos">3921</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">ax</span> <span class="o">+</span> <span class="n">bx</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">ay</span> <span class="o">+</span> <span class="n">by</span><span class="p">)</span>
</span><span id="L-3922"><a href="#L-3922"><span class="linenos">3922</span></a>    <span class="n">f</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">ax</span> <span class="o">+</span> <span class="n">cx</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">ay</span> <span class="o">+</span> <span class="n">cy</span><span class="p">)</span>
</span><span id="L-3923"><a href="#L-3923"><span class="linenos">3923</span></a>    <span class="n">g</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">by</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">bx</span><span class="p">))</span>
</span><span id="L-3924"><a href="#L-3924"><span class="linenos">3924</span></a>    <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-3925"><a href="#L-3925"><span class="linenos">3925</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Points are collinear!&quot;</span><span class="p">)</span>
</span><span id="L-3926"><a href="#L-3926"><span class="linenos">3926</span></a>
</span><span id="L-3927"><a href="#L-3927"><span class="linenos">3927</span></a>    <span class="n">px</span> <span class="o">=</span> <span class="p">((</span><span class="n">d</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">f</span><span class="p">))</span> <span class="o">/</span> <span class="n">g</span>
</span><span id="L-3928"><a href="#L-3928"><span class="linenos">3928</span></a>    <span class="n">py</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">e</span><span class="p">))</span> <span class="o">/</span> <span class="n">g</span>
</span><span id="L-3929"><a href="#L-3929"><span class="linenos">3929</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="n">ax</span> <span class="o">-</span> <span class="n">px</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ay</span> <span class="o">-</span> <span class="n">py</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="L-3930"><a href="#L-3930"><span class="linenos">3930</span></a>    <span class="k">return</span> <span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
</span><span id="L-3931"><a href="#L-3931"><span class="linenos">3931</span></a>
</span><span id="L-3932"><a href="#L-3932"><span class="linenos">3932</span></a>
</span><span id="L-3933"><a href="#L-3933"><span class="linenos">3933</span></a><span class="k">def</span> <span class="nf">project_point_on_line</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Vertex</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Edge</span><span class="p">):</span>
</span><span id="L-3934"><a href="#L-3934"><span class="linenos">3934</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point and a line, returns the projection of the point on the line</span>
</span><span id="L-3935"><a href="#L-3935"><span class="linenos">3935</span></a>
</span><span id="L-3936"><a href="#L-3936"><span class="linenos">3936</span></a><span class="sd">    Args:</span>
</span><span id="L-3937"><a href="#L-3937"><span class="linenos">3937</span></a><span class="sd">        point (Vertex): Input point.</span>
</span><span id="L-3938"><a href="#L-3938"><span class="linenos">3938</span></a><span class="sd">        line (Edge): Input line.</span>
</span><span id="L-3939"><a href="#L-3939"><span class="linenos">3939</span></a>
</span><span id="L-3940"><a href="#L-3940"><span class="linenos">3940</span></a><span class="sd">    Returns:</span>
</span><span id="L-3941"><a href="#L-3941"><span class="linenos">3941</span></a><span class="sd">        Vertex: Projection of the point on the line.</span>
</span><span id="L-3942"><a href="#L-3942"><span class="linenos">3942</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-3943"><a href="#L-3943"><span class="linenos">3943</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-3944"><a href="#L-3944"><span class="linenos">3944</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-3945"><a href="#L-3945"><span class="linenos">3945</span></a>
</span><span id="L-3946"><a href="#L-3946"><span class="linenos">3946</span></a>    <span class="n">av</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">a</span>
</span><span id="L-3947"><a href="#L-3947"><span class="linenos">3947</span></a>    <span class="n">ab</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span>
</span><span id="L-3948"><a href="#L-3948"><span class="linenos">3948</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">av</span> <span class="o">*</span> <span class="n">ab</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ab</span> <span class="o">*</span> <span class="n">ab</span><span class="p">)</span>
</span><span id="L-3949"><a href="#L-3949"><span class="linenos">3949</span></a>    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="L-3950"><a href="#L-3950"><span class="linenos">3950</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-3951"><a href="#L-3951"><span class="linenos">3951</span></a>    <span class="k">elif</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span><span id="L-3952"><a href="#L-3952"><span class="linenos">3952</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-3953"><a href="#L-3953"><span class="linenos">3953</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">ab</span> <span class="o">*</span> <span class="n">t</span>
</span><span id="L-3954"><a href="#L-3954"><span class="linenos">3954</span></a>
</span><span id="L-3955"><a href="#L-3955"><span class="linenos">3955</span></a>
</span><span id="L-3956"><a href="#L-3956"><span class="linenos">3956</span></a><span class="k">class</span> <span class="nc">Vertex</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-3957"><a href="#L-3957"><span class="linenos">3957</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A 3D vertex.&quot;&quot;&quot;</span>
</span><span id="L-3958"><a href="#L-3958"><span class="linenos">3958</span></a>
</span><span id="L-3959"><a href="#L-3959"><span class="linenos">3959</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-3960"><a href="#L-3960"><span class="linenos">3960</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-3961"><a href="#L-3961"><span class="linenos">3961</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="L-3962"><a href="#L-3962"><span class="linenos">3962</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
</span><span id="L-3963"><a href="#L-3963"><span class="linenos">3963</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">VERTEX</span>
</span><span id="L-3964"><a href="#L-3964"><span class="linenos">3964</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-3965"><a href="#L-3965"><span class="linenos">3965</span></a>
</span><span id="L-3966"><a href="#L-3966"><span class="linenos">3966</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3967"><a href="#L-3967"><span class="linenos">3967</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-3968"><a href="#L-3968"><span class="linenos">3968</span></a>
</span><span id="L-3969"><a href="#L-3969"><span class="linenos">3969</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-3970"><a href="#L-3970"><span class="linenos">3970</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-3971"><a href="#L-3971"><span class="linenos">3971</span></a>
</span><span id="L-3972"><a href="#L-3972"><span class="linenos">3972</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3973"><a href="#L-3973"><span class="linenos">3973</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-3974"><a href="#L-3974"><span class="linenos">3974</span></a>
</span><span id="L-3975"><a href="#L-3975"><span class="linenos">3975</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-3976"><a href="#L-3976"><span class="linenos">3976</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-3977"><a href="#L-3977"><span class="linenos">3977</span></a>
</span><span id="L-3978"><a href="#L-3978"><span class="linenos">3978</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-3979"><a href="#L-3979"><span class="linenos">3979</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-3980"><a href="#L-3980"><span class="linenos">3980</span></a>
</span><span id="L-3981"><a href="#L-3981"><span class="linenos">3981</span></a>    <span class="nd">@property</span>
</span><span id="L-3982"><a href="#L-3982"><span class="linenos">3982</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3983"><a href="#L-3983"><span class="linenos">3983</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the coordinates as a tuple.&quot;&quot;&quot;</span>
</span><span id="L-3984"><a href="#L-3984"><span class="linenos">3984</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-3985"><a href="#L-3985"><span class="linenos">3985</span></a>
</span><span id="L-3986"><a href="#L-3986"><span class="linenos">3986</span></a>    <span class="nd">@property</span>
</span><span id="L-3987"><a href="#L-3987"><span class="linenos">3987</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3988"><a href="#L-3988"><span class="linenos">3988</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-3989"><a href="#L-3989"><span class="linenos">3989</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-3990"><a href="#L-3990"><span class="linenos">3990</span></a>
</span><span id="L-3991"><a href="#L-3991"><span class="linenos">3991</span></a>    <span class="k">def</span> <span class="nf">v_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-3992"><a href="#L-3992"><span class="linenos">3992</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertex as a tuple.&quot;&quot;&quot;</span>
</span><span id="L-3993"><a href="#L-3993"><span class="linenos">3993</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-3994"><a href="#L-3994"><span class="linenos">3994</span></a>
</span><span id="L-3995"><a href="#L-3995"><span class="linenos">3995</span></a>    <span class="k">def</span> <span class="nf">below</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-3996"><a href="#L-3996"><span class="linenos">3996</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="L-3997"><a href="#L-3997"><span class="linenos">3997</span></a>
</span><span id="L-3998"><a href="#L-3998"><span class="linenos">3998</span></a><span class="sd">        Args:</span>
</span><span id="L-3999"><a href="#L-3999"><span class="linenos">3999</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="L-4000"><a href="#L-4000"><span class="linenos">4000</span></a>
</span><span id="L-4001"><a href="#L-4001"><span class="linenos">4001</span></a><span class="sd">        Returns:</span>
</span><span id="L-4002"><a href="#L-4002"><span class="linenos">4002</span></a><span class="sd">            bool: True if this vertex is below the other vertex, False otherwise.</span>
</span><span id="L-4003"><a href="#L-4003"><span class="linenos">4003</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-4004"><a href="#L-4004"><span class="linenos">4004</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-4005"><a href="#L-4005"><span class="linenos">4005</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="L-4006"><a href="#L-4006"><span class="linenos">4006</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-4007"><a href="#L-4007"><span class="linenos">4007</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="L-4008"><a href="#L-4008"><span class="linenos">4008</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="L-4009"><a href="#L-4009"><span class="linenos">4009</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-4010"><a href="#L-4010"><span class="linenos">4010</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-4011"><a href="#L-4011"><span class="linenos">4011</span></a>
</span><span id="L-4012"><a href="#L-4012"><span class="linenos">4012</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-4013"><a href="#L-4013"><span class="linenos">4013</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="L-4014"><a href="#L-4014"><span class="linenos">4014</span></a>
</span><span id="L-4015"><a href="#L-4015"><span class="linenos">4015</span></a><span class="sd">        Args:</span>
</span><span id="L-4016"><a href="#L-4016"><span class="linenos">4016</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="L-4017"><a href="#L-4017"><span class="linenos">4017</span></a>
</span><span id="L-4018"><a href="#L-4018"><span class="linenos">4018</span></a><span class="sd">        Returns:</span>
</span><span id="L-4019"><a href="#L-4019"><span class="linenos">4019</span></a><span class="sd">            bool: True if this vertex is above the other vertex, False otherwise.</span>
</span><span id="L-4020"><a href="#L-4020"><span class="linenos">4020</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-4021"><a href="#L-4021"><span class="linenos">4021</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="L-4022"><a href="#L-4022"><span class="linenos">4022</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-4023"><a href="#L-4023"><span class="linenos">4023</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="L-4024"><a href="#L-4024"><span class="linenos">4024</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-4025"><a href="#L-4025"><span class="linenos">4025</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-4026"><a href="#L-4026"><span class="linenos">4026</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-4027"><a href="#L-4027"><span class="linenos">4027</span></a>
</span><span id="L-4028"><a href="#L-4028"><span class="linenos">4028</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-4029"><a href="#L-4029"><span class="linenos">4029</span></a>
</span><span id="L-4030"><a href="#L-4030"><span class="linenos">4030</span></a>
</span><span id="L-4031"><a href="#L-4031"><span class="linenos">4031</span></a><span class="k">class</span> <span class="nc">Edge</span><span class="p">:</span>
</span><span id="L-4032"><a href="#L-4032"><span class="linenos">4032</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A 2D edge.&quot;&quot;&quot;</span>
</span><span id="L-4033"><a href="#L-4033"><span class="linenos">4033</span></a>
</span><span id="L-4034"><a href="#L-4034"><span class="linenos">4034</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-4035"><a href="#L-4035"><span class="linenos">4035</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">start_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">],</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">]</span>
</span><span id="L-4036"><a href="#L-4036"><span class="linenos">4036</span></a>    <span class="p">):</span>
</span><span id="L-4037"><a href="#L-4037"><span class="linenos">4037</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="L-4038"><a href="#L-4038"><span class="linenos">4038</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">start_point</span><span class="p">)</span>
</span><span id="L-4039"><a href="#L-4039"><span class="linenos">4039</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="L-4040"><a href="#L-4040"><span class="linenos">4040</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">start_point</span>
</span><span id="L-4041"><a href="#L-4041"><span class="linenos">4041</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-4042"><a href="#L-4042"><span class="linenos">4042</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Start point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="L-4043"><a href="#L-4043"><span class="linenos">4043</span></a>
</span><span id="L-4044"><a href="#L-4044"><span class="linenos">4044</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="L-4045"><a href="#L-4045"><span class="linenos">4045</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">end_point</span><span class="p">)</span>
</span><span id="L-4046"><a href="#L-4046"><span class="linenos">4046</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="L-4047"><a href="#L-4047"><span class="linenos">4047</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">end_point</span>
</span><span id="L-4048"><a href="#L-4048"><span class="linenos">4048</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-4049"><a href="#L-4049"><span class="linenos">4049</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;End point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="L-4050"><a href="#L-4050"><span class="linenos">4050</span></a>
</span><span id="L-4051"><a href="#L-4051"><span class="linenos">4051</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="L-4052"><a href="#L-4052"><span class="linenos">4052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="L-4053"><a href="#L-4053"><span class="linenos">4053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">EDGE</span>
</span><span id="L-4054"><a href="#L-4054"><span class="linenos">4054</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-4055"><a href="#L-4055"><span class="linenos">4055</span></a>
</span><span id="L-4056"><a href="#L-4056"><span class="linenos">4056</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4057"><a href="#L-4057"><span class="linenos">4057</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="L-4058"><a href="#L-4058"><span class="linenos">4058</span></a>
</span><span id="L-4059"><a href="#L-4059"><span class="linenos">4059</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4060"><a href="#L-4060"><span class="linenos">4060</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="L-4061"><a href="#L-4061"><span class="linenos">4061</span></a>
</span><span id="L-4062"><a href="#L-4062"><span class="linenos">4062</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-4063"><a href="#L-4063"><span class="linenos">4063</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-4064"><a href="#L-4064"><span class="linenos">4064</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-4065"><a href="#L-4065"><span class="linenos">4065</span></a>
</span><span id="L-4066"><a href="#L-4066"><span class="linenos">4066</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-4067"><a href="#L-4067"><span class="linenos">4067</span></a>            <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-4068"><a href="#L-4068"><span class="linenos">4068</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="L-4069"><a href="#L-4069"><span class="linenos">4069</span></a>            <span class="p">)</span>
</span><span id="L-4070"><a href="#L-4070"><span class="linenos">4070</span></a>            <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-4071"><a href="#L-4071"><span class="linenos">4071</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="L-4072"><a href="#L-4072"><span class="linenos">4072</span></a>            <span class="p">)</span>
</span><span id="L-4073"><a href="#L-4073"><span class="linenos">4073</span></a>        <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="L-4074"><a href="#L-4074"><span class="linenos">4074</span></a>            <span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">])</span>
</span><span id="L-4075"><a href="#L-4075"><span class="linenos">4075</span></a>            <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="L-4076"><a href="#L-4076"><span class="linenos">4076</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="L-4077"><a href="#L-4077"><span class="linenos">4077</span></a>            <span class="p">)</span>
</span><span id="L-4078"><a href="#L-4078"><span class="linenos">4078</span></a>        <span class="p">)</span>
</span><span id="L-4079"><a href="#L-4079"><span class="linenos">4079</span></a>
</span><span id="L-4080"><a href="#L-4080"><span class="linenos">4080</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscript</span><span class="p">):</span>
</span><span id="L-4081"><a href="#L-4081"><span class="linenos">4081</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-4082"><a href="#L-4082"><span class="linenos">4082</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="L-4083"><a href="#L-4083"><span class="linenos">4083</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">stop</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">step</span><span class="p">]</span>
</span><span id="L-4084"><a href="#L-4084"><span class="linenos">4084</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-4085"><a href="#L-4085"><span class="linenos">4085</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span>
</span><span id="L-4086"><a href="#L-4086"><span class="linenos">4086</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-4087"><a href="#L-4087"><span class="linenos">4087</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid subscript.&quot;</span><span class="p">)</span>
</span><span id="L-4088"><a href="#L-4088"><span class="linenos">4088</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-4089"><a href="#L-4089"><span class="linenos">4089</span></a>
</span><span id="L-4090"><a href="#L-4090"><span class="linenos">4090</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscript</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-4091"><a href="#L-4091"><span class="linenos">4091</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-4092"><a href="#L-4092"><span class="linenos">4092</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="L-4093"><a href="#L-4093"><span class="linenos">4093</span></a>            <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">stop</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-4094"><a href="#L-4094"><span class="linenos">4094</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-4095"><a href="#L-4095"><span class="linenos">4095</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="L-4096"><a href="#L-4096"><span class="linenos">4096</span></a>            <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-4097"><a href="#L-4097"><span class="linenos">4097</span></a>
</span><span id="L-4098"><a href="#L-4098"><span class="linenos">4098</span></a>    <span class="nd">@property</span>
</span><span id="L-4099"><a href="#L-4099"><span class="linenos">4099</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4100"><a href="#L-4100"><span class="linenos">4100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line slope. The slope of the line passing through the start and end points.&quot;&quot;&quot;</span>
</span><span id="L-4101"><a href="#L-4101"><span class="linenos">4101</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span><span id="L-4102"><a href="#L-4102"><span class="linenos">4102</span></a>
</span><span id="L-4103"><a href="#L-4103"><span class="linenos">4103</span></a>    <span class="nd">@property</span>
</span><span id="L-4104"><a href="#L-4104"><span class="linenos">4104</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4105"><a href="#L-4105"><span class="linenos">4105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line angle. Angle between the line and the x-axis.&quot;&quot;&quot;</span>
</span><span id="L-4106"><a href="#L-4106"><span class="linenos">4106</span></a>        <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span><span id="L-4107"><a href="#L-4107"><span class="linenos">4107</span></a>
</span><span id="L-4108"><a href="#L-4108"><span class="linenos">4108</span></a>    <span class="nd">@property</span>
</span><span id="L-4109"><a href="#L-4109"><span class="linenos">4109</span></a>    <span class="k">def</span> <span class="nf">inclination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4110"><a href="#L-4110"><span class="linenos">4110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inclination angle. Angle between the line and the x-axis converted to</span>
</span><span id="L-4111"><a href="#L-4111"><span class="linenos">4111</span></a><span class="sd">        a value between zero and pi.&quot;&quot;&quot;</span>
</span><span id="L-4112"><a href="#L-4112"><span class="linenos">4112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">%</span> <span class="n">pi</span>
</span><span id="L-4113"><a href="#L-4113"><span class="linenos">4113</span></a>
</span><span id="L-4114"><a href="#L-4114"><span class="linenos">4114</span></a>    <span class="nd">@property</span>
</span><span id="L-4115"><a href="#L-4115"><span class="linenos">4115</span></a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4116"><a href="#L-4116"><span class="linenos">4116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Length of the line segment.&quot;&quot;&quot;</span>
</span><span id="L-4117"><a href="#L-4117"><span class="linenos">4117</span></a>        <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-4118"><a href="#L-4118"><span class="linenos">4118</span></a>
</span><span id="L-4119"><a href="#L-4119"><span class="linenos">4119</span></a>    <span class="nd">@property</span>
</span><span id="L-4120"><a href="#L-4120"><span class="linenos">4120</span></a>    <span class="k">def</span> <span class="nf">x1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4121"><a href="#L-4121"><span class="linenos">4121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="L-4122"><a href="#L-4122"><span class="linenos">4122</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">x</span>
</span><span id="L-4123"><a href="#L-4123"><span class="linenos">4123</span></a>
</span><span id="L-4124"><a href="#L-4124"><span class="linenos">4124</span></a>    <span class="nd">@property</span>
</span><span id="L-4125"><a href="#L-4125"><span class="linenos">4125</span></a>    <span class="k">def</span> <span class="nf">y1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4126"><a href="#L-4126"><span class="linenos">4126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="L-4127"><a href="#L-4127"><span class="linenos">4127</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-4128"><a href="#L-4128"><span class="linenos">4128</span></a>
</span><span id="L-4129"><a href="#L-4129"><span class="linenos">4129</span></a>    <span class="nd">@property</span>
</span><span id="L-4130"><a href="#L-4130"><span class="linenos">4130</span></a>    <span class="k">def</span> <span class="nf">x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4131"><a href="#L-4131"><span class="linenos">4131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="L-4132"><a href="#L-4132"><span class="linenos">4132</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">x</span>
</span><span id="L-4133"><a href="#L-4133"><span class="linenos">4133</span></a>
</span><span id="L-4134"><a href="#L-4134"><span class="linenos">4134</span></a>    <span class="nd">@property</span>
</span><span id="L-4135"><a href="#L-4135"><span class="linenos">4135</span></a>    <span class="k">def</span> <span class="nf">y2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4136"><a href="#L-4136"><span class="linenos">4136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="L-4137"><a href="#L-4137"><span class="linenos">4137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-4138"><a href="#L-4138"><span class="linenos">4138</span></a>
</span><span id="L-4139"><a href="#L-4139"><span class="linenos">4139</span></a>    <span class="nd">@property</span>
</span><span id="L-4140"><a href="#L-4140"><span class="linenos">4140</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4141"><a href="#L-4141"><span class="linenos">4141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end&quot;&quot;&quot;</span>
</span><span id="L-4142"><a href="#L-4142"><span class="linenos">4142</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">]</span>
</span><span id="L-4143"><a href="#L-4143"><span class="linenos">4143</span></a>
</span><span id="L-4144"><a href="#L-4144"><span class="linenos">4144</span></a>    <span class="nd">@property</span>
</span><span id="L-4145"><a href="#L-4145"><span class="linenos">4145</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4146"><a href="#L-4146"><span class="linenos">4146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end vertices.&quot;&quot;&quot;</span>
</span><span id="L-4147"><a href="#L-4147"><span class="linenos">4147</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="L-4148"><a href="#L-4148"><span class="linenos">4148</span></a>
</span><span id="L-4149"><a href="#L-4149"><span class="linenos">4149</span></a>    <span class="nd">@property</span>
</span><span id="L-4150"><a href="#L-4150"><span class="linenos">4150</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-4151"><a href="#L-4151"><span class="linenos">4151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-4152"><a href="#L-4152"><span class="linenos">4152</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">array</span><span class="p">])</span>
</span><span id="L-4153"><a href="#L-4153"><span class="linenos">4153</span></a>
</span><span id="L-4154"><a href="#L-4154"><span class="linenos">4154</span></a>
</span><span id="L-4155"><a href="#L-4155"><span class="linenos">4155</span></a><span class="k">def</span> <span class="nf">rotate_point_3D</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="L-4156"><a href="#L-4156"><span class="linenos">4156</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a 2d point (out of paper) about a 2d line by the given angle.</span>
</span><span id="L-4157"><a href="#L-4157"><span class="linenos">4157</span></a><span class="sd">    This is used for animating mirror reflections.</span>
</span><span id="L-4158"><a href="#L-4158"><span class="linenos">4158</span></a><span class="sd">     Args:</span>
</span><span id="L-4159"><a href="#L-4159"><span class="linenos">4159</span></a><span class="sd">         point (Point): Point to rotate.</span>
</span><span id="L-4160"><a href="#L-4160"><span class="linenos">4160</span></a><span class="sd">         line (Line): Line to rotate about.</span>
</span><span id="L-4161"><a href="#L-4161"><span class="linenos">4161</span></a><span class="sd">         angle (float): Angle of rotation in radians.</span>
</span><span id="L-4162"><a href="#L-4162"><span class="linenos">4162</span></a>
</span><span id="L-4163"><a href="#L-4163"><span class="linenos">4163</span></a><span class="sd">     Returns:</span>
</span><span id="L-4164"><a href="#L-4164"><span class="linenos">4164</span></a><span class="sd">         Point: Rotated point.</span>
</span><span id="L-4165"><a href="#L-4165"><span class="linenos">4165</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-4166"><a href="#L-4166"><span class="linenos">4166</span></a>    <span class="kn">from</span> <span class="nn">..graphics.affine</span> <span class="kn">import</span> <span class="n">rotation_matrix</span><span class="p">,</span> <span class="n">translation_matrix</span>
</span><span id="L-4167"><a href="#L-4167"><span class="linenos">4167</span></a>
</span><span id="L-4168"><a href="#L-4168"><span class="linenos">4168</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="L-4169"><a href="#L-4169"><span class="linenos">4169</span></a>    <span class="n">line_angle_</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-4170"><a href="#L-4170"><span class="linenos">4170</span></a>    <span class="n">translation</span> <span class="o">=</span> <span class="n">translation_matrix</span><span class="p">(</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-4171"><a href="#L-4171"><span class="linenos">4171</span></a>    <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="o">-</span><span class="n">line_angle_</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-4172"><a href="#L-4172"><span class="linenos">4172</span></a>    <span class="n">xform</span> <span class="o">=</span> <span class="n">translation</span> <span class="o">@</span> <span class="n">rotation</span>
</span><span id="L-4173"><a href="#L-4173"><span class="linenos">4173</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-4174"><a href="#L-4174"><span class="linenos">4174</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">xform</span>
</span><span id="L-4175"><a href="#L-4175"><span class="linenos">4175</span></a>
</span><span id="L-4176"><a href="#L-4176"><span class="linenos">4176</span></a>    <span class="n">y</span> <span class="o">*=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-4177"><a href="#L-4177"><span class="linenos">4177</span></a>
</span><span id="L-4178"><a href="#L-4178"><span class="linenos">4178</span></a>    <span class="n">inv_translation</span> <span class="o">=</span> <span class="n">translation_matrix</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-4179"><a href="#L-4179"><span class="linenos">4179</span></a>    <span class="n">inv_rotation</span> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="n">line_angle_</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-4180"><a href="#L-4180"><span class="linenos">4180</span></a>    <span class="n">inv_xform</span> <span class="o">=</span> <span class="n">inv_rotation</span> <span class="o">@</span> <span class="n">inv_translation</span>
</span><span id="L-4181"><a href="#L-4181"><span class="linenos">4181</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">inv_xform</span>
</span><span id="L-4182"><a href="#L-4182"><span class="linenos">4182</span></a>
</span><span id="L-4183"><a href="#L-4183"><span class="linenos">4183</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-4184"><a href="#L-4184"><span class="linenos">4184</span></a>
</span><span id="L-4185"><a href="#L-4185"><span class="linenos">4185</span></a>
</span><span id="L-4186"><a href="#L-4186"><span class="linenos">4186</span></a><span class="k">def</span> <span class="nf">rotate_line_3D</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">about</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-4187"><a href="#L-4187"><span class="linenos">4187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a 3d line about a 3d line by the given angle</span>
</span><span id="L-4188"><a href="#L-4188"><span class="linenos">4188</span></a>
</span><span id="L-4189"><a href="#L-4189"><span class="linenos">4189</span></a><span class="sd">    Args:</span>
</span><span id="L-4190"><a href="#L-4190"><span class="linenos">4190</span></a><span class="sd">        line (Line): Line to rotate.</span>
</span><span id="L-4191"><a href="#L-4191"><span class="linenos">4191</span></a><span class="sd">        about (Line): Line to rotate about.</span>
</span><span id="L-4192"><a href="#L-4192"><span class="linenos">4192</span></a><span class="sd">        angle (float): Angle of rotation in radians.</span>
</span><span id="L-4193"><a href="#L-4193"><span class="linenos">4193</span></a>
</span><span id="L-4194"><a href="#L-4194"><span class="linenos">4194</span></a><span class="sd">    Returns:</span>
</span><span id="L-4195"><a href="#L-4195"><span class="linenos">4195</span></a><span class="sd">        Line: Rotated line.</span>
</span><span id="L-4196"><a href="#L-4196"><span class="linenos">4196</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-4197"><a href="#L-4197"><span class="linenos">4197</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">rotate_point_3D</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">about</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="L-4198"><a href="#L-4198"><span class="linenos">4198</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">rotate_point_3D</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">about</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="L-4199"><a href="#L-4199"><span class="linenos">4199</span></a>
</span><span id="L-4200"><a href="#L-4200"><span class="linenos">4200</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="array">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">array</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#array"></a>
    
            <div class="docstring"><p>array(object, dtype=None, *, copy=True, order='K', subok=False, ndmin=0,
      like=None)</p>

<p>Create an array.</p>

<h2 id="parameters">Parameters</h2>

<p>object : array_like
    An array, any object exposing the array interface, an object whose
    <code>__array__</code> method returns an array, or any (nested) sequence.
    If object is a scalar, a 0-dimensional array containing object is
    returned.
dtype : data-type, optional
    The desired data-type for the array. If not given, NumPy will try to use
    a default <code>dtype</code> that can represent the values (by applying promotion
    rules when necessary.)
copy : bool, optional
    If <code>True</code> (default), then the array data is copied. If <code>None</code>,
    a copy will only be made if <code>__array__</code> returns a copy, if obj is
    a nested sequence, or if a copy is needed to satisfy any of the other
    requirements (<code>dtype</code>, <code>order</code>, etc.). Note that any copy of
    the data is shallow, i.e., for arrays with object dtype, the new
    array will point to the same objects. See Examples for <code>ndarray.copy</code>.
    For <code>False</code> it raises a <code>ValueError</code> if a copy cannot be avoided.
    Default: <code>True</code>.
order : {'K', 'A', 'C', 'F'}, optional
    Specify the memory layout of the array. If object is not an array, the
    newly created array will be in C order (row major) unless 'F' is
    specified, in which case it will be in Fortran order (column major).
    If object is an array the following holds.</p>

<pre><code>===== ========= ===================================================
order  no copy                     copy=True
===== ========= ===================================================
'K'   unchanged F &amp; C order preserved, otherwise most similar order
'A'   unchanged F order if input is F and not C, otherwise C order
'C'   C order   C order
'F'   F order   F order
===== ========= ===================================================

When ``copy=None`` and a copy is made for other reasons, the result is
the same as if ``copy=True``, with some exceptions for 'A', see the
Notes section. The default order is 'K'.
</code></pre>

<p>subok : bool, optional
    If True, then sub-classes will be passed-through, otherwise
    the returned array will be forced to be a base-class array (default).
ndmin : int, optional
    Specifies the minimum number of dimensions that the resulting
    array should have.  Ones will be prepended to the shape as
    needed to meet this requirement.
like : array_like, optional
    Reference object to allow the creation of arrays which are not
    NumPy arrays. If an array-like passed in as <code>like</code> supports
    the <code>__array_function__</code> protocol, the result will be defined
    by it. In this case, it ensures the creation of an array object
    compatible with that passed in via this argument.</p>

<pre><code>.. versionadded:: 1.20.0
</code></pre>

<h2 id="returns">Returns</h2>

<p>out : ndarray
    An array object satisfying the specified requirements.</p>

<h2 id="see-also">See Also</h2>

<p>empty_like : Return an empty array with shape and type of input.
ones_like : Return an array of ones with shape and type of input.
zeros_like : Return an array of zeros with shape and type of input.
full_like : Return a new array with shape of input filled with value.
empty : Return a new uninitialized array.
ones : Return a new array setting values to one.
zeros : Return a new array setting values to zero.
full : Return a new array of given shape filled with value.
copy: Return an array copy of the given object.</p>

<h2 id="notes">Notes</h2>

<p>When order is 'A' and <code>object</code> is an array in neither 'C' nor 'F' order,
and a copy is forced by a change in dtype, then the order of the result is
not necessarily 'C' as expected. This is likely a bug.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">array([1, 2, 3])</span>
</code></pre>
</div>

<p>Upcasting:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">array([ 1.,  2.,  3.])</span>
</code></pre>
</div>

<p>More than one dimension:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>
</code></pre>
</div>

<p>Minimum dimensions 2:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[1, 2, 3]])</span>
</code></pre>
</div>

<p>Type provided:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="go">array([ 1.+0.j,  2.+0.j,  3.+0.j])</span>
</code></pre>
</div>

<p>Data-type consisting of more than one element:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">),(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">array([1, 3])</span>
</code></pre>
</div>

<p>Creating an array from sub-classes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">))</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [3, 4]])</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="s1">&#39;1 2; 3 4&#39;</span><span class="p">),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">matrix([[1, 2],</span>
<span class="go">        [3, 4]])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="around">
                            <input id="around-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-array_function_dispatch">@array_function_dispatch(_round_dispatcher)</div>

        <span class="def">def</span>
        <span class="name">around</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">decimals</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">out</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="around-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#around"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="around-3455"><a href="#around-3455"><span class="linenos">3455</span></a><span class="nd">@array_function_dispatch</span><span class="p">(</span><span class="n">_round_dispatcher</span><span class="p">)</span>
</span><span id="around-3456"><a href="#around-3456"><span class="linenos">3456</span></a><span class="k">def</span> <span class="nf">around</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="around-3457"><a href="#around-3457"><span class="linenos">3457</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="around-3458"><a href="#around-3458"><span class="linenos">3458</span></a><span class="sd">    Round an array to the given number of decimals.</span>
</span><span id="around-3459"><a href="#around-3459"><span class="linenos">3459</span></a>
</span><span id="around-3460"><a href="#around-3460"><span class="linenos">3460</span></a><span class="sd">    `around` is an alias of `~numpy.round`.</span>
</span><span id="around-3461"><a href="#around-3461"><span class="linenos">3461</span></a>
</span><span id="around-3462"><a href="#around-3462"><span class="linenos">3462</span></a><span class="sd">    See Also</span>
</span><span id="around-3463"><a href="#around-3463"><span class="linenos">3463</span></a><span class="sd">    --------</span>
</span><span id="around-3464"><a href="#around-3464"><span class="linenos">3464</span></a><span class="sd">    ndarray.round : equivalent method</span>
</span><span id="around-3465"><a href="#around-3465"><span class="linenos">3465</span></a><span class="sd">    round : alias for this function</span>
</span><span id="around-3466"><a href="#around-3466"><span class="linenos">3466</span></a><span class="sd">    ceil, fix, floor, rint, trunc</span>
</span><span id="around-3467"><a href="#around-3467"><span class="linenos">3467</span></a>
</span><span id="around-3468"><a href="#around-3468"><span class="linenos">3468</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="around-3469"><a href="#around-3469"><span class="linenos">3469</span></a>    <span class="k">return</span> <span class="n">_wrapfunc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Round an array to the given number of decimals.</p>

<p><code><a href="#around">around</a></code> is an alias of <code>~numpy.round</code>.</p>

<h2 id="see-also">See Also</h2>

<p>ndarray.round : equivalent method
round : alias for this function
ceil, fix, floor, rint, trunc</p>
</div>


                </section>
                <section id="tau">
                    <div class="attr variable">
            <span class="name">tau</span>        =
<span class="default_value">6.283185307179586</span>

        
    </div>
    <a class="headerlink" href="#tau"></a>
    
    

                </section>
                <section id="is_number">
                            <input id="is_number-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_number-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_number"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_number-49"><a href="#is_number-49"><span class="linenos">49</span></a><span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_number-50"><a href="#is_number-50"><span class="linenos">50</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="is_number-51"><a href="#is_number-51"><span class="linenos">51</span></a><span class="sd">    Return True if x is a number.</span>
</span><span id="is_number-52"><a href="#is_number-52"><span class="linenos">52</span></a>
</span><span id="is_number-53"><a href="#is_number-53"><span class="linenos">53</span></a><span class="sd">    Args:</span>
</span><span id="is_number-54"><a href="#is_number-54"><span class="linenos">54</span></a><span class="sd">        x (Any): The input value to check.</span>
</span><span id="is_number-55"><a href="#is_number-55"><span class="linenos">55</span></a>
</span><span id="is_number-56"><a href="#is_number-56"><span class="linenos">56</span></a><span class="sd">    Returns:</span>
</span><span id="is_number-57"><a href="#is_number-57"><span class="linenos">57</span></a><span class="sd">        bool: True if x is a number, False otherwise.</span>
</span><span id="is_number-58"><a href="#is_number-58"><span class="linenos">58</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_number-59"><a href="#is_number-59"><span class="linenos">59</span></a>    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if x is a number.</p>

<p>Args:
    x (Any): The input value to check.</p>

<p>Returns:
    bool: True if x is a number, False otherwise.</p>
</div>


                </section>
                <section id="bbox_overlap">
                            <input id="bbox_overlap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bbox_overlap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">min_x1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">min_y1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">max_x2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">max_y2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">min_x3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">min_y3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">max_x4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">max_y4</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="bbox_overlap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bbox_overlap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bbox_overlap-62"><a href="#bbox_overlap-62"><span class="linenos">62</span></a><span class="k">def</span> <span class="nf">bbox_overlap</span><span class="p">(</span>
</span><span id="bbox_overlap-63"><a href="#bbox_overlap-63"><span class="linenos">63</span></a>    <span class="n">min_x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-64"><a href="#bbox_overlap-64"><span class="linenos">64</span></a>    <span class="n">min_y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-65"><a href="#bbox_overlap-65"><span class="linenos">65</span></a>    <span class="n">max_x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-66"><a href="#bbox_overlap-66"><span class="linenos">66</span></a>    <span class="n">max_y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-67"><a href="#bbox_overlap-67"><span class="linenos">67</span></a>    <span class="n">min_x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-68"><a href="#bbox_overlap-68"><span class="linenos">68</span></a>    <span class="n">min_y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-69"><a href="#bbox_overlap-69"><span class="linenos">69</span></a>    <span class="n">max_x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-70"><a href="#bbox_overlap-70"><span class="linenos">70</span></a>    <span class="n">max_y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="bbox_overlap-71"><a href="#bbox_overlap-71"><span class="linenos">71</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="bbox_overlap-72"><a href="#bbox_overlap-72"><span class="linenos">72</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bbox_overlap-73"><a href="#bbox_overlap-73"><span class="linenos">73</span></a><span class="sd">    Given two bounding boxes, return True if they overlap.</span>
</span><span id="bbox_overlap-74"><a href="#bbox_overlap-74"><span class="linenos">74</span></a>
</span><span id="bbox_overlap-75"><a href="#bbox_overlap-75"><span class="linenos">75</span></a><span class="sd">    Args:</span>
</span><span id="bbox_overlap-76"><a href="#bbox_overlap-76"><span class="linenos">76</span></a><span class="sd">        min_x1 (float): Minimum x-coordinate of the first bounding box.</span>
</span><span id="bbox_overlap-77"><a href="#bbox_overlap-77"><span class="linenos">77</span></a><span class="sd">        min_y1 (float): Minimum y-coordinate of the first bounding box.</span>
</span><span id="bbox_overlap-78"><a href="#bbox_overlap-78"><span class="linenos">78</span></a><span class="sd">        max_x2 (float): Maximum x-coordinate of the first bounding box.</span>
</span><span id="bbox_overlap-79"><a href="#bbox_overlap-79"><span class="linenos">79</span></a><span class="sd">        max_y2 (float): Maximum y-coordinate of the first bounding box.</span>
</span><span id="bbox_overlap-80"><a href="#bbox_overlap-80"><span class="linenos">80</span></a><span class="sd">        min_x3 (float): Minimum x-coordinate of the second bounding box.</span>
</span><span id="bbox_overlap-81"><a href="#bbox_overlap-81"><span class="linenos">81</span></a><span class="sd">        min_y3 (float): Minimum y-coordinate of the second bounding box.</span>
</span><span id="bbox_overlap-82"><a href="#bbox_overlap-82"><span class="linenos">82</span></a><span class="sd">        max_x4 (float): Maximum x-coordinate of the second bounding box.</span>
</span><span id="bbox_overlap-83"><a href="#bbox_overlap-83"><span class="linenos">83</span></a><span class="sd">        max_y4 (float): Maximum y-coordinate of the second bounding box.</span>
</span><span id="bbox_overlap-84"><a href="#bbox_overlap-84"><span class="linenos">84</span></a>
</span><span id="bbox_overlap-85"><a href="#bbox_overlap-85"><span class="linenos">85</span></a><span class="sd">    Returns:</span>
</span><span id="bbox_overlap-86"><a href="#bbox_overlap-86"><span class="linenos">86</span></a><span class="sd">        bool: True if the bounding boxes overlap, False otherwise.</span>
</span><span id="bbox_overlap-87"><a href="#bbox_overlap-87"><span class="linenos">87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bbox_overlap-88"><a href="#bbox_overlap-88"><span class="linenos">88</span></a>    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="bbox_overlap-89"><a href="#bbox_overlap-89"><span class="linenos">89</span></a>        <span class="n">max_x2</span> <span class="o">&lt;</span> <span class="n">min_x3</span> <span class="ow">or</span> <span class="n">max_x4</span> <span class="o">&lt;</span> <span class="n">min_x1</span> <span class="ow">or</span> <span class="n">max_y2</span> <span class="o">&lt;</span> <span class="n">min_y3</span> <span class="ow">or</span> <span class="n">max_y4</span> <span class="o">&lt;</span> <span class="n">min_y1</span>
</span><span id="bbox_overlap-90"><a href="#bbox_overlap-90"><span class="linenos">90</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given two bounding boxes, return True if they overlap.</p>

<p>Args:
    min_x1 (float): Minimum x-coordinate of the first bounding box.
    min_y1 (float): Minimum y-coordinate of the first bounding box.
    max_x2 (float): Maximum x-coordinate of the first bounding box.
    max_y2 (float): Maximum y-coordinate of the first bounding box.
    min_x3 (float): Minimum x-coordinate of the second bounding box.
    min_y3 (float): Minimum y-coordinate of the second bounding box.
    max_x4 (float): Maximum x-coordinate of the second bounding box.
    max_y4 (float): Maximum y-coordinate of the second bounding box.</p>

<p>Returns:
    bool: True if the bounding boxes overlap, False otherwise.</p>
</div>


                </section>
                <section id="sine_wave">
                            <input id="sine_wave-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sine_wave</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">phase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="s2">&quot;&#39;ndarray&#39;&quot;</span>:</span></span>

                <label class="view-source-button" for="sine_wave-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sine_wave"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sine_wave-93"><a href="#sine_wave-93"><span class="linenos"> 93</span></a><span class="k">def</span> <span class="nf">sine_wave</span><span class="p">(</span>
</span><span id="sine_wave-94"><a href="#sine_wave-94"><span class="linenos"> 94</span></a>    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="sine_wave-95"><a href="#sine_wave-95"><span class="linenos"> 95</span></a>    <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="sine_wave-96"><a href="#sine_wave-96"><span class="linenos"> 96</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="sine_wave-97"><a href="#sine_wave-97"><span class="linenos"> 97</span></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="sine_wave-98"><a href="#sine_wave-98"><span class="linenos"> 98</span></a>    <span class="n">phase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="sine_wave-99"><a href="#sine_wave-99"><span class="linenos"> 99</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="sine_wave-100"><a href="#sine_wave-100"><span class="linenos">100</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sine_wave-101"><a href="#sine_wave-101"><span class="linenos">101</span></a><span class="sd">    Generate a sine wave.</span>
</span><span id="sine_wave-102"><a href="#sine_wave-102"><span class="linenos">102</span></a>
</span><span id="sine_wave-103"><a href="#sine_wave-103"><span class="linenos">103</span></a><span class="sd">    Args:</span>
</span><span id="sine_wave-104"><a href="#sine_wave-104"><span class="linenos">104</span></a><span class="sd">        amplitude (float): Amplitude of the wave.</span>
</span><span id="sine_wave-105"><a href="#sine_wave-105"><span class="linenos">105</span></a><span class="sd">        frequency (float): Frequency of the wave.</span>
</span><span id="sine_wave-106"><a href="#sine_wave-106"><span class="linenos">106</span></a><span class="sd">        duration (float): Duration of the wave.</span>
</span><span id="sine_wave-107"><a href="#sine_wave-107"><span class="linenos">107</span></a><span class="sd">        sample_rate (float): Sample rate.</span>
</span><span id="sine_wave-108"><a href="#sine_wave-108"><span class="linenos">108</span></a><span class="sd">        phase (float, optional): Phase angle of the wave. Defaults to 0.</span>
</span><span id="sine_wave-109"><a href="#sine_wave-109"><span class="linenos">109</span></a>
</span><span id="sine_wave-110"><a href="#sine_wave-110"><span class="linenos">110</span></a><span class="sd">    Returns:</span>
</span><span id="sine_wave-111"><a href="#sine_wave-111"><span class="linenos">111</span></a><span class="sd">        np.ndarray: Time and signal arrays representing the sine wave.</span>
</span><span id="sine_wave-112"><a href="#sine_wave-112"><span class="linenos">112</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sine_wave-113"><a href="#sine_wave-113"><span class="linenos">113</span></a>    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span> <span class="o">*</span> <span class="n">duration</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="sine_wave-114"><a href="#sine_wave-114"><span class="linenos">114</span></a>    <span class="n">signal</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">time</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="sine_wave-115"><a href="#sine_wave-115"><span class="linenos">115</span></a>    <span class="c1"># plt.plot(time, signal)</span>
</span><span id="sine_wave-116"><a href="#sine_wave-116"><span class="linenos">116</span></a>    <span class="c1"># plt.xlabel(&#39;Time (s)&#39;)</span>
</span><span id="sine_wave-117"><a href="#sine_wave-117"><span class="linenos">117</span></a>    <span class="c1"># plt.ylabel(&#39;Amplitude&#39;)</span>
</span><span id="sine_wave-118"><a href="#sine_wave-118"><span class="linenos">118</span></a>    <span class="c1"># plt.title(&#39;Discretized Sine Wave&#39;)</span>
</span><span id="sine_wave-119"><a href="#sine_wave-119"><span class="linenos">119</span></a>    <span class="c1"># plt.grid(True)</span>
</span><span id="sine_wave-120"><a href="#sine_wave-120"><span class="linenos">120</span></a>    <span class="c1"># plt.show()</span>
</span><span id="sine_wave-121"><a href="#sine_wave-121"><span class="linenos">121</span></a>    <span class="k">return</span> <span class="n">time</span><span class="p">,</span> <span class="n">signal</span>
</span></pre></div>


            <div class="docstring"><p>Generate a sine wave.</p>

<p>Args:
    amplitude (float): Amplitude of the wave.
    frequency (float): Frequency of the wave.
    duration (float): Duration of the wave.
    sample_rate (float): Sample rate.
    phase (float, optional): Phase angle of the wave. Defaults to 0.</p>

<p>Returns:
    np.ndarray: Time and signal arrays representing the sine wave.</p>
</div>


                </section>
                <section id="damping_function">
                            <input id="damping_function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">damping_function</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">amplitude</span>, </span><span class="param"><span class="n">duration</span>, </span><span class="param"><span class="n">sample_rate</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="damping_function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#damping_function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="damping_function-124"><a href="#damping_function-124"><span class="linenos">124</span></a><span class="k">def</span> <span class="nf">damping_function</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">):</span>
</span><span id="damping_function-125"><a href="#damping_function-125"><span class="linenos">125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="damping_function-126"><a href="#damping_function-126"><span class="linenos">126</span></a><span class="sd">    Generates a damping function based on the given amplitude, duration, and sample rate.</span>
</span><span id="damping_function-127"><a href="#damping_function-127"><span class="linenos">127</span></a>
</span><span id="damping_function-128"><a href="#damping_function-128"><span class="linenos">128</span></a><span class="sd">    Args:</span>
</span><span id="damping_function-129"><a href="#damping_function-129"><span class="linenos">129</span></a><span class="sd">        amplitude (float): The initial amplitude of the damping function.</span>
</span><span id="damping_function-130"><a href="#damping_function-130"><span class="linenos">130</span></a><span class="sd">        duration (float): The duration over which the damping occurs, in seconds.</span>
</span><span id="damping_function-131"><a href="#damping_function-131"><span class="linenos">131</span></a><span class="sd">        sample_rate (float): The number of samples per second.</span>
</span><span id="damping_function-132"><a href="#damping_function-132"><span class="linenos">132</span></a>
</span><span id="damping_function-133"><a href="#damping_function-133"><span class="linenos">133</span></a><span class="sd">    Returns:</span>
</span><span id="damping_function-134"><a href="#damping_function-134"><span class="linenos">134</span></a><span class="sd">        list: A list of float values representing the damping function over time.</span>
</span><span id="damping_function-135"><a href="#damping_function-135"><span class="linenos">135</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="damping_function-136"><a href="#damping_function-136"><span class="linenos">136</span></a>    <span class="n">damping</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="damping_function-137"><a href="#damping_function-137"><span class="linenos">137</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)):</span>
</span><span id="damping_function-138"><a href="#damping_function-138"><span class="linenos">138</span></a>        <span class="n">damping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)))</span>
</span><span id="damping_function-139"><a href="#damping_function-139"><span class="linenos">139</span></a>    <span class="k">return</span> <span class="n">damping</span>
</span></pre></div>


            <div class="docstring"><p>Generates a damping function based on the given amplitude, duration, and sample rate.</p>

<p>Args:
    amplitude (float): The initial amplitude of the damping function.
    duration (float): The duration over which the damping occurs, in seconds.
    sample_rate (float): The number of samples per second.</p>

<p>Returns:
    list: A list of float values representing the damping function over time.</p>
</div>


                </section>
                <section id="sine_points">
                            <input id="sine_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sine_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span>,</span><span class="param">	<span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span>,</span><span class="param">	<span class="n">n_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">phase_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">damping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="s2">&quot;&#39;ndarray&#39;&quot;</span>:</span></span>

                <label class="view-source-button" for="sine_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sine_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sine_points-141"><a href="#sine_points-141"><span class="linenos">141</span></a><span class="k">def</span> <span class="nf">sine_points</span><span class="p">(</span>
</span><span id="sine_points-142"><a href="#sine_points-142"><span class="linenos">142</span></a>    <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="sine_points-143"><a href="#sine_points-143"><span class="linenos">143</span></a>    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
</span><span id="sine_points-144"><a href="#sine_points-144"><span class="linenos">144</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="sine_points-145"><a href="#sine_points-145"><span class="linenos">145</span></a>    <span class="n">n_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="sine_points-146"><a href="#sine_points-146"><span class="linenos">146</span></a>    <span class="n">phase_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="sine_points-147"><a href="#sine_points-147"><span class="linenos">147</span></a>    <span class="n">damping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="sine_points-148"><a href="#sine_points-148"><span class="linenos">148</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="sine_points-149"><a href="#sine_points-149"><span class="linenos">149</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sine_points-150"><a href="#sine_points-150"><span class="linenos">150</span></a><span class="sd">    Generate sine wave points.</span>
</span><span id="sine_points-151"><a href="#sine_points-151"><span class="linenos">151</span></a>
</span><span id="sine_points-152"><a href="#sine_points-152"><span class="linenos">152</span></a><span class="sd">    Args:</span>
</span><span id="sine_points-153"><a href="#sine_points-153"><span class="linenos">153</span></a><span class="sd">        amplitude (float): Amplitude of the wave.</span>
</span><span id="sine_points-154"><a href="#sine_points-154"><span class="linenos">154</span></a><span class="sd">        frequency (float): Frequency of the wave.</span>
</span><span id="sine_points-155"><a href="#sine_points-155"><span class="linenos">155</span></a><span class="sd">        duration (float): Duration of the wave.</span>
</span><span id="sine_points-156"><a href="#sine_points-156"><span class="linenos">156</span></a><span class="sd">        sample_rate (float): Sample rate.</span>
</span><span id="sine_points-157"><a href="#sine_points-157"><span class="linenos">157</span></a><span class="sd">        phase (float, optional): Phase angle of the wave. Defaults to 0.</span>
</span><span id="sine_points-158"><a href="#sine_points-158"><span class="linenos">158</span></a><span class="sd">        damping (float, optional): Damping coefficient. Defaults to 0.</span>
</span><span id="sine_points-159"><a href="#sine_points-159"><span class="linenos">159</span></a><span class="sd">    Returns:</span>
</span><span id="sine_points-160"><a href="#sine_points-160"><span class="linenos">160</span></a><span class="sd">        np.ndarray: Array of points representing the sine wave.</span>
</span><span id="sine_points-161"><a href="#sine_points-161"><span class="linenos">161</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sine_points-162"><a href="#sine_points-162"><span class="linenos">162</span></a>    <span class="n">phase</span> <span class="o">=</span> <span class="n">phase_angle</span>
</span><span id="sine_points-163"><a href="#sine_points-163"><span class="linenos">163</span></a>    <span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">period</span>
</span><span id="sine_points-164"><a href="#sine_points-164"><span class="linenos">164</span></a>    <span class="n">n_cycles</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="n">period</span>
</span><span id="sine_points-165"><a href="#sine_points-165"><span class="linenos">165</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_points</span> <span class="o">*</span> <span class="n">n_cycles</span><span class="p">))</span>
</span><span id="sine_points-166"><a href="#sine_points-166"><span class="linenos">166</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="sine_points-167"><a href="#sine_points-167"><span class="linenos">167</span></a>    <span class="k">if</span> <span class="n">damping</span><span class="p">:</span>
</span><span id="sine_points-168"><a href="#sine_points-168"><span class="linenos">168</span></a>        <span class="n">y</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">damping</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="sine_points-169"><a href="#sine_points-169"><span class="linenos">169</span></a>    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="sine_points-170"><a href="#sine_points-170"><span class="linenos">170</span></a>
</span><span id="sine_points-171"><a href="#sine_points-171"><span class="linenos">171</span></a>    <span class="k">return</span> <span class="n">vertices</span>
</span></pre></div>


            <div class="docstring"><p>Generate sine wave points.</p>

<p>Args:
    amplitude (float): Amplitude of the wave.
    frequency (float): Frequency of the wave.
    duration (float): Duration of the wave.
    sample_rate (float): Sample rate.
    phase (float, optional): Phase angle of the wave. Defaults to 0.
    damping (float, optional): Damping coefficient. Defaults to 0.
Returns:
    np.ndarray: Array of points representing the sine wave.</p>
</div>


                </section>
                <section id="check_consecutive_duplicates">
                            <input id="check_consecutive_duplicates-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_consecutive_duplicates</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">rtol</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="check_consecutive_duplicates-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#check_consecutive_duplicates"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="check_consecutive_duplicates-174"><a href="#check_consecutive_duplicates-174"><span class="linenos">174</span></a><span class="k">def</span> <span class="nf">check_consecutive_duplicates</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="check_consecutive_duplicates-175"><a href="#check_consecutive_duplicates-175"><span class="linenos">175</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for consecutive duplicate points in a list of points.</span>
</span><span id="check_consecutive_duplicates-176"><a href="#check_consecutive_duplicates-176"><span class="linenos">176</span></a>
</span><span id="check_consecutive_duplicates-177"><a href="#check_consecutive_duplicates-177"><span class="linenos">177</span></a><span class="sd">        Args:</span>
</span><span id="check_consecutive_duplicates-178"><a href="#check_consecutive_duplicates-178"><span class="linenos">178</span></a><span class="sd">            points (list): List of points to check.</span>
</span><span id="check_consecutive_duplicates-179"><a href="#check_consecutive_duplicates-179"><span class="linenos">179</span></a><span class="sd">            rtol (float, optional): Relative tolerance. Defaults to 0.</span>
</span><span id="check_consecutive_duplicates-180"><a href="#check_consecutive_duplicates-180"><span class="linenos">180</span></a><span class="sd">            atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="check_consecutive_duplicates-181"><a href="#check_consecutive_duplicates-181"><span class="linenos">181</span></a>
</span><span id="check_consecutive_duplicates-182"><a href="#check_consecutive_duplicates-182"><span class="linenos">182</span></a><span class="sd">        Returns:</span>
</span><span id="check_consecutive_duplicates-183"><a href="#check_consecutive_duplicates-183"><span class="linenos">183</span></a><span class="sd">            bool: True if consecutive duplicate points are found, False otherwise.</span>
</span><span id="check_consecutive_duplicates-184"><a href="#check_consecutive_duplicates-184"><span class="linenos">184</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="check_consecutive_duplicates-185"><a href="#check_consecutive_duplicates-185"><span class="linenos">185</span></a>    <span class="k">if</span> <span class="n">atol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="check_consecutive_duplicates-186"><a href="#check_consecutive_duplicates-186"><span class="linenos">186</span></a>        <span class="n">atol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="check_consecutive_duplicates-187"><a href="#check_consecutive_duplicates-187"><span class="linenos">187</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="check_consecutive_duplicates-188"><a href="#check_consecutive_duplicates-188"><span class="linenos">188</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="check_consecutive_duplicates-189"><a href="#check_consecutive_duplicates-189"><span class="linenos">189</span></a>    <span class="k">if</span> <span class="n">points</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="check_consecutive_duplicates-190"><a href="#check_consecutive_duplicates-190"><span class="linenos">190</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="check_consecutive_duplicates-191"><a href="#check_consecutive_duplicates-191"><span class="linenos">191</span></a>            <span class="n">next_pnt</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="check_consecutive_duplicates-192"><a href="#check_consecutive_duplicates-192"><span class="linenos">192</span></a>            <span class="n">val1</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="check_consecutive_duplicates-193"><a href="#check_consecutive_duplicates-193"><span class="linenos">193</span></a>            <span class="n">val2</span> <span class="o">=</span> <span class="n">next_pnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">next_pnt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="check_consecutive_duplicates-194"><a href="#check_consecutive_duplicates-194"><span class="linenos">194</span></a>            <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="check_consecutive_duplicates-195"><a href="#check_consecutive_duplicates-195"><span class="linenos">195</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pnt</span><span class="p">,</span> <span class="n">next_pnt</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="check_consecutive_duplicates-196"><a href="#check_consecutive_duplicates-196"><span class="linenos">196</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="check_consecutive_duplicates-197"><a href="#check_consecutive_duplicates-197"><span class="linenos">197</span></a>
</span><span id="check_consecutive_duplicates-198"><a href="#check_consecutive_duplicates-198"><span class="linenos">198</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check for consecutive duplicate points in a list of points.</p>

<p>Args:
    points (list): List of points to check.
    rtol (float, optional): Relative tolerance. Defaults to 0.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if consecutive duplicate points are found, False otherwise.</p>
</div>


                </section>
                <section id="circle_inversion">
                            <input id="circle_inversion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_inversion</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span>, </span><span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_inversion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_inversion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_inversion-200"><a href="#circle_inversion-200"><span class="linenos">200</span></a><span class="k">def</span> <span class="nf">circle_inversion</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="circle_inversion-201"><a href="#circle_inversion-201"><span class="linenos">201</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="circle_inversion-202"><a href="#circle_inversion-202"><span class="linenos">202</span></a><span class="sd">    Inverts a point with respect to a circle.</span>
</span><span id="circle_inversion-203"><a href="#circle_inversion-203"><span class="linenos">203</span></a>
</span><span id="circle_inversion-204"><a href="#circle_inversion-204"><span class="linenos">204</span></a><span class="sd">    Args:</span>
</span><span id="circle_inversion-205"><a href="#circle_inversion-205"><span class="linenos">205</span></a><span class="sd">        point (tuple): The point to invert, represented as a tuple (x, y).</span>
</span><span id="circle_inversion-206"><a href="#circle_inversion-206"><span class="linenos">206</span></a><span class="sd">        center (tuple): The center of the circle, represented as a tuple (x, y).</span>
</span><span id="circle_inversion-207"><a href="#circle_inversion-207"><span class="linenos">207</span></a><span class="sd">        radius (float): The radius of the circle.</span>
</span><span id="circle_inversion-208"><a href="#circle_inversion-208"><span class="linenos">208</span></a>
</span><span id="circle_inversion-209"><a href="#circle_inversion-209"><span class="linenos">209</span></a><span class="sd">    Returns:</span>
</span><span id="circle_inversion-210"><a href="#circle_inversion-210"><span class="linenos">210</span></a><span class="sd">        tuple: The inverted point, represented as a tuple (x, y).</span>
</span><span id="circle_inversion-211"><a href="#circle_inversion-211"><span class="linenos">211</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_inversion-212"><a href="#circle_inversion-212"><span class="linenos">212</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_inversion-213"><a href="#circle_inversion-213"><span class="linenos">213</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_inversion-214"><a href="#circle_inversion-214"><span class="linenos">214</span></a>    <span class="c1"># Calculate the distance from the point to the center of the circle</span>
</span><span id="circle_inversion-215"><a href="#circle_inversion-215"><span class="linenos">215</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="circle_inversion-216"><a href="#circle_inversion-216"><span class="linenos">216</span></a>    <span class="c1"># If the point is at the center of the circle, return the point at infinity</span>
</span><span id="circle_inversion-217"><a href="#circle_inversion-217"><span class="linenos">217</span></a>    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="circle_inversion-218"><a href="#circle_inversion-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="circle_inversion-219"><a href="#circle_inversion-219"><span class="linenos">219</span></a>    <span class="c1"># Calculate the distance from the inverted point to the center of the circle</span>
</span><span id="circle_inversion-220"><a href="#circle_inversion-220"><span class="linenos">220</span></a>    <span class="n">inv_dist</span> <span class="o">=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="circle_inversion-221"><a href="#circle_inversion-221"><span class="linenos">221</span></a>    <span class="c1"># Calculate the inverted point</span>
</span><span id="circle_inversion-222"><a href="#circle_inversion-222"><span class="linenos">222</span></a>    <span class="n">inv_x</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">inv_dist</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="circle_inversion-223"><a href="#circle_inversion-223"><span class="linenos">223</span></a>    <span class="n">inv_y</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">inv_dist</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">/</span> <span class="n">dist</span>
</span><span id="circle_inversion-224"><a href="#circle_inversion-224"><span class="linenos">224</span></a>    <span class="k">return</span> <span class="n">inv_x</span><span class="p">,</span> <span class="n">inv_y</span>
</span></pre></div>


            <div class="docstring"><p>Inverts a point with respect to a circle.</p>

<p>Args:
    point (tuple): The point to invert, represented as a tuple (x, y).
    center (tuple): The center of the circle, represented as a tuple (x, y).
    radius (float): The radius of the circle.</p>

<p>Returns:
    tuple: The inverted point, represented as a tuple (x, y).</p>
</div>


                </section>
                <section id="line_segment_bbox">
                            <input id="line_segment_bbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_segment_bbox</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y2</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="line_segment_bbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_segment_bbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_segment_bbox-227"><a href="#line_segment_bbox-227"><span class="linenos">227</span></a><span class="k">def</span> <span class="nf">line_segment_bbox</span><span class="p">(</span>
</span><span id="line_segment_bbox-228"><a href="#line_segment_bbox-228"><span class="linenos">228</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="line_segment_bbox-229"><a href="#line_segment_bbox-229"><span class="linenos">229</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="line_segment_bbox-230"><a href="#line_segment_bbox-230"><span class="linenos">230</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line_segment_bbox-231"><a href="#line_segment_bbox-231"><span class="linenos">231</span></a><span class="sd">    Return the bounding box of a line segment.</span>
</span><span id="line_segment_bbox-232"><a href="#line_segment_bbox-232"><span class="linenos">232</span></a>
</span><span id="line_segment_bbox-233"><a href="#line_segment_bbox-233"><span class="linenos">233</span></a><span class="sd">    Args:</span>
</span><span id="line_segment_bbox-234"><a href="#line_segment_bbox-234"><span class="linenos">234</span></a><span class="sd">        x1 (float): Segment start point x-coordinate.</span>
</span><span id="line_segment_bbox-235"><a href="#line_segment_bbox-235"><span class="linenos">235</span></a><span class="sd">        y1 (float): Segment start point y-coordinate.</span>
</span><span id="line_segment_bbox-236"><a href="#line_segment_bbox-236"><span class="linenos">236</span></a><span class="sd">        x2 (float): Segment end point x-coordinate.</span>
</span><span id="line_segment_bbox-237"><a href="#line_segment_bbox-237"><span class="linenos">237</span></a><span class="sd">        y2 (float): Segment end point y-coordinate.</span>
</span><span id="line_segment_bbox-238"><a href="#line_segment_bbox-238"><span class="linenos">238</span></a>
</span><span id="line_segment_bbox-239"><a href="#line_segment_bbox-239"><span class="linenos">239</span></a><span class="sd">    Returns:</span>
</span><span id="line_segment_bbox-240"><a href="#line_segment_bbox-240"><span class="linenos">240</span></a><span class="sd">        tuple: Bounding box as (min_x, min_y, max_x, max_y).</span>
</span><span id="line_segment_bbox-241"><a href="#line_segment_bbox-241"><span class="linenos">241</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_segment_bbox-242"><a href="#line_segment_bbox-242"><span class="linenos">242</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return the bounding box of a line segment.</p>

<p>Args:
    x1 (float): Segment start point x-coordinate.
    y1 (float): Segment start point y-coordinate.
    x2 (float): Segment end point x-coordinate.
    y2 (float): Segment end point y-coordinate.</p>

<p>Returns:
    tuple: Bounding box as (min_x, min_y, max_x, max_y).</p>
</div>


                </section>
                <section id="line_segment_bbox_check">
                            <input id="line_segment_bbox_check-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_segment_bbox_check</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">seg1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">seg2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="line_segment_bbox_check-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_segment_bbox_check"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_segment_bbox_check-245"><a href="#line_segment_bbox_check-245"><span class="linenos">245</span></a><span class="k">def</span> <span class="nf">line_segment_bbox_check</span><span class="p">(</span><span class="n">seg1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">seg2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="line_segment_bbox_check-246"><a href="#line_segment_bbox_check-246"><span class="linenos">246</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line_segment_bbox_check-247"><a href="#line_segment_bbox_check-247"><span class="linenos">247</span></a><span class="sd">    Given two line segments, return True if their bounding boxes overlap.</span>
</span><span id="line_segment_bbox_check-248"><a href="#line_segment_bbox_check-248"><span class="linenos">248</span></a>
</span><span id="line_segment_bbox_check-249"><a href="#line_segment_bbox_check-249"><span class="linenos">249</span></a><span class="sd">    Args:</span>
</span><span id="line_segment_bbox_check-250"><a href="#line_segment_bbox_check-250"><span class="linenos">250</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="line_segment_bbox_check-251"><a href="#line_segment_bbox_check-251"><span class="linenos">251</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="line_segment_bbox_check-252"><a href="#line_segment_bbox_check-252"><span class="linenos">252</span></a>
</span><span id="line_segment_bbox_check-253"><a href="#line_segment_bbox_check-253"><span class="linenos">253</span></a><span class="sd">    Returns:</span>
</span><span id="line_segment_bbox_check-254"><a href="#line_segment_bbox_check-254"><span class="linenos">254</span></a><span class="sd">        bool: True if the bounding boxes overlap, False otherwise.</span>
</span><span id="line_segment_bbox_check-255"><a href="#line_segment_bbox_check-255"><span class="linenos">255</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_segment_bbox_check-256"><a href="#line_segment_bbox_check-256"><span class="linenos">256</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">seg1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line_segment_bbox_check-257"><a href="#line_segment_bbox_check-257"><span class="linenos">257</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">seg1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="line_segment_bbox_check-258"><a href="#line_segment_bbox_check-258"><span class="linenos">258</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">seg2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line_segment_bbox_check-259"><a href="#line_segment_bbox_check-259"><span class="linenos">259</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">seg2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="line_segment_bbox_check-260"><a href="#line_segment_bbox_check-260"><span class="linenos">260</span></a>    <span class="k">return</span> <span class="n">bbox_overlap</span><span class="p">(</span>
</span><span id="line_segment_bbox_check-261"><a href="#line_segment_bbox_check-261"><span class="linenos">261</span></a>        <span class="o">*</span><span class="n">line_segment_bbox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="o">*</span><span class="n">line_segment_bbox</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="line_segment_bbox_check-262"><a href="#line_segment_bbox_check-262"><span class="linenos">262</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given two line segments, return True if their bounding boxes overlap.</p>

<p>Args:
    seg1 (Line): First line segment.
    seg2 (Line): Second line segment.</p>

<p>Returns:
    bool: True if the bounding boxes overlap, False otherwise.</p>
</div>


                </section>
                <section id="all_close_points">
                            <input id="all_close_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">all_close_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">with_dist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="all_close_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#all_close_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="all_close_points-265"><a href="#all_close_points-265"><span class="linenos">265</span></a><span class="k">def</span> <span class="nf">all_close_points</span><span class="p">(</span>
</span><span id="all_close_points-266"><a href="#all_close_points-266"><span class="linenos">266</span></a>    <span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">],</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_dist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="all_close_points-267"><a href="#all_close_points-267"><span class="linenos">267</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]:</span>
</span><span id="all_close_points-268"><a href="#all_close_points-268"><span class="linenos">268</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="all_close_points-269"><a href="#all_close_points-269"><span class="linenos">269</span></a><span class="sd">    Find all close points in a list of points along with their ids.</span>
</span><span id="all_close_points-270"><a href="#all_close_points-270"><span class="linenos">270</span></a>
</span><span id="all_close_points-271"><a href="#all_close_points-271"><span class="linenos">271</span></a><span class="sd">    Args:</span>
</span><span id="all_close_points-272"><a href="#all_close_points-272"><span class="linenos">272</span></a><span class="sd">        points (Sequence[Sequence]): List of points with ids [[x1, y1, id1], [x2, y2, id2], ...].</span>
</span><span id="all_close_points-273"><a href="#all_close_points-273"><span class="linenos">273</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="all_close_points-274"><a href="#all_close_points-274"><span class="linenos">274</span></a><span class="sd">        with_dist (bool, optional): Whether to include distances in the result. Defaults to False.</span>
</span><span id="all_close_points-275"><a href="#all_close_points-275"><span class="linenos">275</span></a>
</span><span id="all_close_points-276"><a href="#all_close_points-276"><span class="linenos">276</span></a><span class="sd">    Returns:</span>
</span><span id="all_close_points-277"><a href="#all_close_points-277"><span class="linenos">277</span></a><span class="sd">        dict: Dictionary of the form {id1: [id2, id3, ...], ...}.</span>
</span><span id="all_close_points-278"><a href="#all_close_points-278"><span class="linenos">278</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="all_close_points-279"><a href="#all_close_points-279"><span class="linenos">279</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="all_close_points-280"><a href="#all_close_points-280"><span class="linenos">280</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="all_close_points-281"><a href="#all_close_points-281"><span class="linenos">281</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>  <span class="c1"># points array [[x1, y1, id1], ...]]</span>
</span><span id="all_close_points-282"><a href="#all_close_points-282"><span class="linenos">282</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="all_close_points-283"><a href="#all_close_points-283"><span class="linenos">283</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>  <span class="c1"># sort by x values in the</span>
</span><span id="all_close_points-284"><a href="#all_close_points-284"><span class="linenos">284</span></a>    <span class="c1"># first column</span>
</span><span id="all_close_points-285"><a href="#all_close_points-285"><span class="linenos">285</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="all_close_points-286"><a href="#all_close_points-286"><span class="linenos">286</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_close_points-287"><a href="#all_close_points-287"><span class="linenos">287</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="all_close_points-288"><a href="#all_close_points-288"><span class="linenos">288</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_close_points-289"><a href="#all_close_points-289"><span class="linenos">289</span></a>    <span class="n">point_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">point_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># [x, y, id, xmin, xmax]</span>
</span><span id="all_close_points-290"><a href="#all_close_points-290"><span class="linenos">290</span></a>
</span><span id="all_close_points-291"><a href="#all_close_points-291"><span class="linenos">291</span></a>    <span class="n">i_id</span><span class="p">,</span> <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_xmax</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>  <span class="c1"># column indices</span>
</span><span id="all_close_points-292"><a href="#all_close_points-292"><span class="linenos">292</span></a>    <span class="n">d_connections</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="all_close_points-293"><a href="#all_close_points-293"><span class="linenos">293</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="all_close_points-294"><a href="#all_close_points-294"><span class="linenos">294</span></a>        <span class="n">d_connections</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_close_points-295"><a href="#all_close_points-295"><span class="linenos">295</span></a>    <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_close_points-296"><a href="#all_close_points-296"><span class="linenos">296</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="all_close_points-297"><a href="#all_close_points-297"><span class="linenos">297</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="all_close_points-298"><a href="#all_close_points-298"><span class="linenos">298</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_xmax</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="all_close_points-299"><a href="#all_close_points-299"><span class="linenos">299</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="all_close_points-300"><a href="#all_close_points-300"><span class="linenos">300</span></a>        <span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="all_close_points-301"><a href="#all_close_points-301"><span class="linenos">301</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="all_close_points-302"><a href="#all_close_points-302"><span class="linenos">302</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="all_close_points-303"><a href="#all_close_points-303"><span class="linenos">303</span></a>            <span class="p">(</span>
</span><span id="all_close_points-304"><a href="#all_close_points-304"><span class="linenos">304</span></a>                <span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="all_close_points-305"><a href="#all_close_points-305"><span class="linenos">305</span></a>                <span class="o">&amp;</span> <span class="p">(</span><span class="n">point_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="all_close_points-306"><a href="#all_close_points-306"><span class="linenos">306</span></a>            <span class="p">)</span>
</span><span id="all_close_points-307"><a href="#all_close_points-307"><span class="linenos">307</span></a>        <span class="p">]</span>
</span><span id="all_close_points-308"><a href="#all_close_points-308"><span class="linenos">308</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="all_close_points-309"><a href="#all_close_points-309"><span class="linenos">309</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="all_close_points-310"><a href="#all_close_points-310"><span class="linenos">310</span></a>            <span class="n">point2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="all_close_points-311"><a href="#all_close_points-311"><span class="linenos">311</span></a>            <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="all_close_points-312"><a href="#all_close_points-312"><span class="linenos">312</span></a>                <span class="n">d_connections</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>
</span><span id="all_close_points-313"><a href="#all_close_points-313"><span class="linenos">313</span></a>                <span class="n">d_connections</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="all_close_points-314"><a href="#all_close_points-314"><span class="linenos">314</span></a>                <span class="k">if</span> <span class="n">with_dist</span><span class="p">:</span>
</span><span id="all_close_points-315"><a href="#all_close_points-315"><span class="linenos">315</span></a>                    <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point2</span><span class="p">)))</span>
</span><span id="all_close_points-316"><a href="#all_close_points-316"><span class="linenos">316</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="all_close_points-317"><a href="#all_close_points-317"><span class="linenos">317</span></a>                    <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="all_close_points-318"><a href="#all_close_points-318"><span class="linenos">318</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="all_close_points-319"><a href="#all_close_points-319"><span class="linenos">319</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_connections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="all_close_points-320"><a href="#all_close_points-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="all_close_points-321"><a href="#all_close_points-321"><span class="linenos">321</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="all_close_points-322"><a href="#all_close_points-322"><span class="linenos">322</span></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">pairs</span>
</span></pre></div>


            <div class="docstring"><p>Find all close points in a list of points along with their ids.</p>

<p>Args:
    points (Sequence[Sequence]): List of points with ids [[x1, y1, id1], [x2, y2, id2], ...].
    dist_tol (float, optional): Distance tolerance. Defaults to None.
    with_dist (bool, optional): Whether to include distances in the result. Defaults to False.</p>

<p>Returns:
    dict: Dictionary of the form {id1: [id2, id3, ...], ...}.</p>
</div>


                </section>
                <section id="is_simple">
                            <input id="is_simple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_simple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span>, </span><span class="param"><span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_simple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_simple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_simple-325"><a href="#is_simple-325"><span class="linenos">325</span></a><span class="k">def</span> <span class="nf">is_simple</span><span class="p">(</span>
</span><span id="is_simple-326"><a href="#is_simple-326"><span class="linenos">326</span></a>    <span class="n">polygon</span><span class="p">,</span>
</span><span id="is_simple-327"><a href="#is_simple-327"><span class="linenos">327</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="is_simple-328"><a href="#is_simple-328"><span class="linenos">328</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="is_simple-329"><a href="#is_simple-329"><span class="linenos">329</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_simple-330"><a href="#is_simple-330"><span class="linenos">330</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="is_simple-331"><a href="#is_simple-331"><span class="linenos">331</span></a><span class="sd">    Return True if the polygon is simple.</span>
</span><span id="is_simple-332"><a href="#is_simple-332"><span class="linenos">332</span></a>
</span><span id="is_simple-333"><a href="#is_simple-333"><span class="linenos">333</span></a><span class="sd">    Args:</span>
</span><span id="is_simple-334"><a href="#is_simple-334"><span class="linenos">334</span></a><span class="sd">        polygon (list): List of points representing the polygon.</span>
</span><span id="is_simple-335"><a href="#is_simple-335"><span class="linenos">335</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="is_simple-336"><a href="#is_simple-336"><span class="linenos">336</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="is_simple-337"><a href="#is_simple-337"><span class="linenos">337</span></a>
</span><span id="is_simple-338"><a href="#is_simple-338"><span class="linenos">338</span></a><span class="sd">    Returns:</span>
</span><span id="is_simple-339"><a href="#is_simple-339"><span class="linenos">339</span></a><span class="sd">        bool: True if the polygon is simple, False otherwise.</span>
</span><span id="is_simple-340"><a href="#is_simple-340"><span class="linenos">340</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_simple-341"><a href="#is_simple-341"><span class="linenos">341</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="is_simple-342"><a href="#is_simple-342"><span class="linenos">342</span></a>
</span><span id="is_simple-343"><a href="#is_simple-343"><span class="linenos">343</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="is_simple-344"><a href="#is_simple-344"><span class="linenos">344</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="is_simple-345"><a href="#is_simple-345"><span class="linenos">345</span></a>    <span class="n">segments</span> <span class="o">=</span> <span class="p">[[</span><span class="n">polygon</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="is_simple-346"><a href="#is_simple-346"><span class="linenos">346</span></a>
</span><span id="is_simple-347"><a href="#is_simple-347"><span class="linenos">347</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="is_simple-348"><a href="#is_simple-348"><span class="linenos">348</span></a>    <span class="n">segment_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="is_simple-349"><a href="#is_simple-349"><span class="linenos">349</span></a>    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
</span><span id="is_simple-350"><a href="#is_simple-350"><span class="linenos">350</span></a>        <span class="n">segment_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="is_simple-351"><a href="#is_simple-351"><span class="linenos">351</span></a>            <span class="p">[</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="is_simple-352"><a href="#is_simple-352"><span class="linenos">352</span></a>        <span class="p">)</span>
</span><span id="is_simple-353"><a href="#is_simple-353"><span class="linenos">353</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segment_coords</span><span class="p">)</span>  <span class="c1"># segments array</span>
</span><span id="is_simple-354"><a href="#is_simple-354"><span class="linenos">354</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="is_simple-355"><a href="#is_simple-355"><span class="linenos">355</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-356"><a href="#is_simple-356"><span class="linenos">356</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-357"><a href="#is_simple-357"><span class="linenos">357</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-358"><a href="#is_simple-358"><span class="linenos">358</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-359"><a href="#is_simple-359"><span class="linenos">359</span></a>    <span class="n">id_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-360"><a href="#is_simple-360"><span class="linenos">360</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">seg_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">id_</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="is_simple-361"><a href="#is_simple-361"><span class="linenos">361</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="is_simple-362"><a href="#is_simple-362"><span class="linenos">362</span></a>    <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="is_simple-363"><a href="#is_simple-363"><span class="linenos">363</span></a>
</span><span id="is_simple-364"><a href="#is_simple-364"><span class="linenos">364</span></a>    <span class="n">s_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># set of processed segment pairs</span>
</span><span id="is_simple-365"><a href="#is_simple-365"><span class="linenos">365</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="is_simple-366"><a href="#is_simple-366"><span class="linenos">366</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span><span class="p">,</span> <span class="n">id1</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="is_simple-367"><a href="#is_simple-367"><span class="linenos">367</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="is_simple-368"><a href="#is_simple-368"><span class="linenos">368</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="is_simple-369"><a href="#is_simple-369"><span class="linenos">369</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># keep pushing the sweep line forward</span>
</span><span id="is_simple-370"><a href="#is_simple-370"><span class="linenos">370</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="is_simple-371"><a href="#is_simple-371"><span class="linenos">371</span></a>            <span class="p">(</span>
</span><span id="is_simple-372"><a href="#is_simple-372"><span class="linenos">372</span></a>                <span class="p">(</span>
</span><span id="is_simple-373"><a href="#is_simple-373"><span class="linenos">373</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="is_simple-374"><a href="#is_simple-374"><span class="linenos">374</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="is_simple-375"><a href="#is_simple-375"><span class="linenos">375</span></a>                <span class="p">)</span>
</span><span id="is_simple-376"><a href="#is_simple-376"><span class="linenos">376</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="is_simple-377"><a href="#is_simple-377"><span class="linenos">377</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="is_simple-378"><a href="#is_simple-378"><span class="linenos">378</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="is_simple-379"><a href="#is_simple-379"><span class="linenos">379</span></a>                <span class="p">)</span>
</span><span id="is_simple-380"><a href="#is_simple-380"><span class="linenos">380</span></a>            <span class="p">)</span>
</span><span id="is_simple-381"><a href="#is_simple-381"><span class="linenos">381</span></a>        <span class="p">]</span>
</span><span id="is_simple-382"><a href="#is_simple-382"><span class="linenos">382</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="is_simple-383"><a href="#is_simple-383"><span class="linenos">383</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="is_simple-384"><a href="#is_simple-384"><span class="linenos">384</span></a>            <span class="n">pair</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="is_simple-385"><a href="#is_simple-385"><span class="linenos">385</span></a>            <span class="k">if</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">s_processed</span><span class="p">:</span>
</span><span id="is_simple-386"><a href="#is_simple-386"><span class="linenos">386</span></a>                <span class="k">continue</span>
</span><span id="is_simple-387"><a href="#is_simple-387"><span class="linenos">387</span></a>            <span class="n">s_processed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</span><span id="is_simple-388"><a href="#is_simple-388"><span class="linenos">388</span></a>            <span class="n">seg2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="is_simple-389"><a href="#is_simple-389"><span class="linenos">389</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">segment</span>
</span><span id="is_simple-390"><a href="#is_simple-390"><span class="linenos">390</span></a>            <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="is_simple-391"><a href="#is_simple-391"><span class="linenos">391</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">intersection3</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="is_simple-392"><a href="#is_simple-392"><span class="linenos">392</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">:</span>
</span><span id="is_simple-393"><a href="#is_simple-393"><span class="linenos">393</span></a>                <span class="n">length1</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="is_simple-394"><a href="#is_simple-394"><span class="linenos">394</span></a>                <span class="n">length2</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="is_simple-395"><a href="#is_simple-395"><span class="linenos">395</span></a>                <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</span><span id="is_simple-396"><a href="#is_simple-396"><span class="linenos">396</span></a>                <span class="n">chain_length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="is_simple-397"><a href="#is_simple-397"><span class="linenos">397</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span><span class="p">,</span> <span class="n">chain_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="is_simple-398"><a href="#is_simple-398"><span class="linenos">398</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="is_simple-399"><a href="#is_simple-399"><span class="linenos">399</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="is_simple-400"><a href="#is_simple-400"><span class="linenos">400</span></a>                    <span class="k">continue</span>
</span><span id="is_simple-401"><a href="#is_simple-401"><span class="linenos">401</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">):</span>
</span><span id="is_simple-402"><a href="#is_simple-402"><span class="linenos">402</span></a>                <span class="k">continue</span>
</span><span id="is_simple-403"><a href="#is_simple-403"><span class="linenos">403</span></a>            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">:</span>
</span><span id="is_simple-404"><a href="#is_simple-404"><span class="linenos">404</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="is_simple-405"><a href="#is_simple-405"><span class="linenos">405</span></a>
</span><span id="is_simple-406"><a href="#is_simple-406"><span class="linenos">406</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the polygon is simple.</p>

<p>Args:
    polygon (list): List of points representing the polygon.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the polygon is simple, False otherwise.</p>
</div>


                </section>
                <section id="all_intersections">
                            <input id="all_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">all_intersections</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">segments</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]]</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">use_intersection3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="all_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#all_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="all_intersections-409"><a href="#all_intersections-409"><span class="linenos">409</span></a><span class="k">def</span> <span class="nf">all_intersections</span><span class="p">(</span>
</span><span id="all_intersections-410"><a href="#all_intersections-410"><span class="linenos">410</span></a>    <span class="n">segments</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span>
</span><span id="all_intersections-411"><a href="#all_intersections-411"><span class="linenos">411</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="all_intersections-412"><a href="#all_intersections-412"><span class="linenos">412</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="all_intersections-413"><a href="#all_intersections-413"><span class="linenos">413</span></a>    <span class="n">use_intersection3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="all_intersections-414"><a href="#all_intersections-414"><span class="linenos">414</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]:</span>
</span><span id="all_intersections-415"><a href="#all_intersections-415"><span class="linenos">415</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="all_intersections-416"><a href="#all_intersections-416"><span class="linenos">416</span></a><span class="sd">    Find all intersection points of the given list of segments</span>
</span><span id="all_intersections-417"><a href="#all_intersections-417"><span class="linenos">417</span></a><span class="sd">    (sweep line algorithm variant)</span>
</span><span id="all_intersections-418"><a href="#all_intersections-418"><span class="linenos">418</span></a>
</span><span id="all_intersections-419"><a href="#all_intersections-419"><span class="linenos">419</span></a><span class="sd">    Args:</span>
</span><span id="all_intersections-420"><a href="#all_intersections-420"><span class="linenos">420</span></a><span class="sd">        segments (Sequence[Line]): List of line segments [[[x1, y1], [x2, y2]], [[x1, y1], [x2, y2]], ...].</span>
</span><span id="all_intersections-421"><a href="#all_intersections-421"><span class="linenos">421</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="all_intersections-422"><a href="#all_intersections-422"><span class="linenos">422</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="all_intersections-423"><a href="#all_intersections-423"><span class="linenos">423</span></a><span class="sd">        use_intersection3 (bool, optional): Whether to use intersection3 function. Defaults to False.</span>
</span><span id="all_intersections-424"><a href="#all_intersections-424"><span class="linenos">424</span></a>
</span><span id="all_intersections-425"><a href="#all_intersections-425"><span class="linenos">425</span></a><span class="sd">    Returns:</span>
</span><span id="all_intersections-426"><a href="#all_intersections-426"><span class="linenos">426</span></a><span class="sd">        dict: Dictionary of the form {segment_id: [[id1, (x1, y1)], [id2, (x2, y2)]], ...}.</span>
</span><span id="all_intersections-427"><a href="#all_intersections-427"><span class="linenos">427</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="all_intersections-428"><a href="#all_intersections-428"><span class="linenos">428</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="all_intersections-429"><a href="#all_intersections-429"><span class="linenos">429</span></a>    <span class="n">segment_coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_intersections-430"><a href="#all_intersections-430"><span class="linenos">430</span></a>    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
</span><span id="all_intersections-431"><a href="#all_intersections-431"><span class="linenos">431</span></a>        <span class="n">segment_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="all_intersections-432"><a href="#all_intersections-432"><span class="linenos">432</span></a>            <span class="p">[</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="all_intersections-433"><a href="#all_intersections-433"><span class="linenos">433</span></a>        <span class="p">)</span>
</span><span id="all_intersections-434"><a href="#all_intersections-434"><span class="linenos">434</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segment_coords</span><span class="p">)</span>  <span class="c1"># segments array</span>
</span><span id="all_intersections-435"><a href="#all_intersections-435"><span class="linenos">435</span></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="all_intersections-436"><a href="#all_intersections-436"><span class="linenos">436</span></a>    <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-437"><a href="#all_intersections-437"><span class="linenos">437</span></a>    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-438"><a href="#all_intersections-438"><span class="linenos">438</span></a>    <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-439"><a href="#all_intersections-439"><span class="linenos">439</span></a>    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-440"><a href="#all_intersections-440"><span class="linenos">440</span></a>    <span class="n">id_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-441"><a href="#all_intersections-441"><span class="linenos">441</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">seg_arr</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">id_</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="all_intersections-442"><a href="#all_intersections-442"><span class="linenos">442</span></a>    <span class="n">seg_arr</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">seg_arr</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="all_intersections-443"><a href="#all_intersections-443"><span class="linenos">443</span></a>    <span class="n">i_xmin</span><span class="p">,</span> <span class="n">i_ymin</span><span class="p">,</span> <span class="n">i_xmax</span><span class="p">,</span> <span class="n">i_ymax</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># column indices</span>
</span><span id="all_intersections-444"><a href="#all_intersections-444"><span class="linenos">444</span></a>    <span class="c1"># ind1, ind2 are indexes of segments in the list of segments</span>
</span><span id="all_intersections-445"><a href="#all_intersections-445"><span class="linenos">445</span></a>    <span class="n">d_ind1_x_point_ind2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {id1: [((x, y), id2), ...], ...}</span>
</span><span id="all_intersections-446"><a href="#all_intersections-446"><span class="linenos">446</span></a>    <span class="n">d_ind1_conn_type_x_res_ind2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {id1: [(conn_type, x_res, id2), ...], ...}</span>
</span><span id="all_intersections-447"><a href="#all_intersections-447"><span class="linenos">447</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="all_intersections-448"><a href="#all_intersections-448"><span class="linenos">448</span></a>        <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="all_intersections-449"><a href="#all_intersections-449"><span class="linenos">449</span></a>            <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_intersections-450"><a href="#all_intersections-450"><span class="linenos">450</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="all_intersections-451"><a href="#all_intersections-451"><span class="linenos">451</span></a>            <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="all_intersections-452"><a href="#all_intersections-452"><span class="linenos">452</span></a>    <span class="n">x_points</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># intersection points</span>
</span><span id="all_intersections-453"><a href="#all_intersections-453"><span class="linenos">453</span></a>    <span class="n">s_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># set of processed segment pairs</span>
</span><span id="all_intersections-454"><a href="#all_intersections-454"><span class="linenos">454</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="all_intersections-455"><a href="#all_intersections-455"><span class="linenos">455</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">sl_xmin</span><span class="p">,</span> <span class="n">sl_ymin</span><span class="p">,</span> <span class="n">sl_xmax</span><span class="p">,</span> <span class="n">sl_ymax</span><span class="p">,</span> <span class="n">id1</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="all_intersections-456"><a href="#all_intersections-456"><span class="linenos">456</span></a>        <span class="n">id1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
</span><span id="all_intersections-457"><a href="#all_intersections-457"><span class="linenos">457</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</span><span id="all_intersections-458"><a href="#all_intersections-458"><span class="linenos">458</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># keep pushing the sweep line forward</span>
</span><span id="all_intersections-459"><a href="#all_intersections-459"><span class="linenos">459</span></a>        <span class="c1"># filter by overlap of the bounding boxes of the segments with the</span>
</span><span id="all_intersections-460"><a href="#all_intersections-460"><span class="linenos">460</span></a>        <span class="c1"># sweep line&#39;s active segment. If the bounding boxes do not overlap,</span>
</span><span id="all_intersections-461"><a href="#all_intersections-461"><span class="linenos">461</span></a>        <span class="c1"># the segments cannot intersect. If the bounding boxes overlap,</span>
</span><span id="all_intersections-462"><a href="#all_intersections-462"><span class="linenos">462</span></a>        <span class="c1"># the segments may intersect.</span>
</span><span id="all_intersections-463"><a href="#all_intersections-463"><span class="linenos">463</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="p">:][</span>
</span><span id="all_intersections-464"><a href="#all_intersections-464"><span class="linenos">464</span></a>            <span class="p">(</span>
</span><span id="all_intersections-465"><a href="#all_intersections-465"><span class="linenos">465</span></a>                <span class="p">(</span>
</span><span id="all_intersections-466"><a href="#all_intersections-466"><span class="linenos">466</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_xmin</span><span class="p">)</span>
</span><span id="all_intersections-467"><a href="#all_intersections-467"><span class="linenos">467</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_xmin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_xmax</span><span class="p">)</span>
</span><span id="all_intersections-468"><a href="#all_intersections-468"><span class="linenos">468</span></a>                <span class="p">)</span>
</span><span id="all_intersections-469"><a href="#all_intersections-469"><span class="linenos">469</span></a>                <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="all_intersections-470"><a href="#all_intersections-470"><span class="linenos">470</span></a>                    <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymax</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">sl_ymin</span><span class="p">)</span>
</span><span id="all_intersections-471"><a href="#all_intersections-471"><span class="linenos">471</span></a>                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">seg_arr</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span> <span class="n">i_ymin</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sl_ymax</span><span class="p">)</span>
</span><span id="all_intersections-472"><a href="#all_intersections-472"><span class="linenos">472</span></a>                <span class="p">)</span>
</span><span id="all_intersections-473"><a href="#all_intersections-473"><span class="linenos">473</span></a>            <span class="p">)</span>
</span><span id="all_intersections-474"><a href="#all_intersections-474"><span class="linenos">474</span></a>        <span class="p">]</span>
</span><span id="all_intersections-475"><a href="#all_intersections-475"><span class="linenos">475</span></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="all_intersections-476"><a href="#all_intersections-476"><span class="linenos">476</span></a>            <span class="n">id2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="n">i_id</span><span class="p">])</span>
</span><span id="all_intersections-477"><a href="#all_intersections-477"><span class="linenos">477</span></a>            <span class="n">pair</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="all_intersections-478"><a href="#all_intersections-478"><span class="linenos">478</span></a>            <span class="k">if</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">s_processed</span><span class="p">:</span>
</span><span id="all_intersections-479"><a href="#all_intersections-479"><span class="linenos">479</span></a>                <span class="k">continue</span>
</span><span id="all_intersections-480"><a href="#all_intersections-480"><span class="linenos">480</span></a>            <span class="n">s_processed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</span><span id="all_intersections-481"><a href="#all_intersections-481"><span class="linenos">481</span></a>            <span class="n">seg2</span> <span class="o">=</span> <span class="n">cand</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="all_intersections-482"><a href="#all_intersections-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="all_intersections-483"><a href="#all_intersections-483"><span class="linenos">483</span></a>                <span class="c1"># connection type, point/segment</span>
</span><span id="all_intersections-484"><a href="#all_intersections-484"><span class="linenos">484</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">intersection3</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">,</span> <span class="o">*</span><span class="n">seg2</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="all_intersections-485"><a href="#all_intersections-485"><span class="linenos">485</span></a>                <span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span> <span class="o">=</span> <span class="n">res</span>  <span class="c1"># x_res can be a segment or a point</span>
</span><span id="all_intersections-486"><a href="#all_intersections-486"><span class="linenos">486</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="all_intersections-487"><a href="#all_intersections-487"><span class="linenos">487</span></a>                <span class="c1"># connection type, point</span>
</span><span id="all_intersections-488"><a href="#all_intersections-488"><span class="linenos">488</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">intersection2</span><span class="p">(</span><span class="o">*</span><span class="n">segment</span><span class="p">,</span> <span class="o">*</span><span class="n">seg2</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="all_intersections-489"><a href="#all_intersections-489"><span class="linenos">489</span></a>                <span class="n">conn_type</span><span class="p">,</span> <span class="n">x_point</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="all_intersections-490"><a href="#all_intersections-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="all_intersections-491"><a href="#all_intersections-491"><span class="linenos">491</span></a>                <span class="k">if</span> <span class="n">conn_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">]:</span>
</span><span id="all_intersections-492"><a href="#all_intersections-492"><span class="linenos">492</span></a>                    <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="all_intersections-493"><a href="#all_intersections-493"><span class="linenos">493</span></a>                    <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">conn_type</span><span class="p">,</span> <span class="n">x_res</span><span class="p">,</span> <span class="n">id1</span><span class="p">))</span>
</span><span id="all_intersections-494"><a href="#all_intersections-494"><span class="linenos">494</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="all_intersections-495"><a href="#all_intersections-495"><span class="linenos">495</span></a>                <span class="k">if</span> <span class="n">conn_type</span> <span class="o">==</span> <span class="n">Connection</span><span class="o">.</span><span class="n">INTERSECT</span><span class="p">:</span>
</span><span id="all_intersections-496"><a href="#all_intersections-496"><span class="linenos">496</span></a>                    <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_point</span><span class="p">,</span> <span class="n">id2</span><span class="p">))</span>
</span><span id="all_intersections-497"><a href="#all_intersections-497"><span class="linenos">497</span></a>                    <span class="n">d_ind1_x_point_ind2</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_point</span><span class="p">,</span> <span class="n">id1</span><span class="p">))</span>
</span><span id="all_intersections-498"><a href="#all_intersections-498"><span class="linenos">498</span></a>                    <span class="n">x_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="all_intersections-499"><a href="#all_intersections-499"><span class="linenos">499</span></a>
</span><span id="all_intersections-500"><a href="#all_intersections-500"><span class="linenos">500</span></a>    <span class="n">d_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="all_intersections-501"><a href="#all_intersections-501"><span class="linenos">501</span></a>    <span class="k">if</span> <span class="n">use_intersection3</span><span class="p">:</span>
</span><span id="all_intersections-502"><a href="#all_intersections-502"><span class="linenos">502</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_ind1_conn_type_x_res_ind2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="all_intersections-503"><a href="#all_intersections-503"><span class="linenos">503</span></a>            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="all_intersections-504"><a href="#all_intersections-504"><span class="linenos">504</span></a>                <span class="n">d_results</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="all_intersections-505"><a href="#all_intersections-505"><span class="linenos">505</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">d_results</span>
</span><span id="all_intersections-506"><a href="#all_intersections-506"><span class="linenos">506</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="all_intersections-507"><a href="#all_intersections-507"><span class="linenos">507</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_ind1_x_point_ind2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="all_intersections-508"><a href="#all_intersections-508"><span class="linenos">508</span></a>            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
</span><span id="all_intersections-509"><a href="#all_intersections-509"><span class="linenos">509</span></a>                <span class="n">d_results</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="all_intersections-510"><a href="#all_intersections-510"><span class="linenos">510</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">d_results</span><span class="p">,</span> <span class="n">x_points</span>
</span><span id="all_intersections-511"><a href="#all_intersections-511"><span class="linenos">511</span></a>
</span><span id="all_intersections-512"><a href="#all_intersections-512"><span class="linenos">512</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Find all intersection points of the given list of segments
(sweep line algorithm variant)</p>

<p>Args:
    segments (Sequence[Line]): List of line segments [[[x1, y1], [x2, y2]], [[x1, y1], [x2, y2]], ...].
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.
    use_intersection3 (bool, optional): Whether to use intersection3 function. Defaults to False.</p>

<p>Returns:
    dict: Dictionary of the form {segment_id: [[id1, (x1, y1)], [id2, (x2, y2)]], ...}.</p>
</div>


                </section>
                <section id="dot_product2">
                            <input id="dot_product2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dot_product2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="dot_product2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dot_product2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dot_product2-515"><a href="#dot_product2-515"><span class="linenos">515</span></a><span class="k">def</span> <span class="nf">dot_product2</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="dot_product2-516"><a href="#dot_product2-516"><span class="linenos">516</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dot product of two vectors. AB and BC</span>
</span><span id="dot_product2-517"><a href="#dot_product2-517"><span class="linenos">517</span></a><span class="sd">    Args:</span>
</span><span id="dot_product2-518"><a href="#dot_product2-518"><span class="linenos">518</span></a><span class="sd">        a (Point): First point, creating vector BA</span>
</span><span id="dot_product2-519"><a href="#dot_product2-519"><span class="linenos">519</span></a><span class="sd">        b (Point): Second point, common point for both vectors</span>
</span><span id="dot_product2-520"><a href="#dot_product2-520"><span class="linenos">520</span></a><span class="sd">        c (Point): Third point, creating vector BC</span>
</span><span id="dot_product2-521"><a href="#dot_product2-521"><span class="linenos">521</span></a>
</span><span id="dot_product2-522"><a href="#dot_product2-522"><span class="linenos">522</span></a><span class="sd">    Returns:</span>
</span><span id="dot_product2-523"><a href="#dot_product2-523"><span class="linenos">523</span></a><span class="sd">        float: The dot product of vectors BA and BC</span>
</span><span id="dot_product2-524"><a href="#dot_product2-524"><span class="linenos">524</span></a><span class="sd">    Note:</span>
</span><span id="dot_product2-525"><a href="#dot_product2-525"><span class="linenos">525</span></a><span class="sd">        The function calculates (a-b)·(c-b) which is the dot product of vectors BA and BC.</span>
</span><span id="dot_product2-526"><a href="#dot_product2-526"><span class="linenos">526</span></a><span class="sd">        This is useful for finding angles between segments that share a common point.</span>
</span><span id="dot_product2-527"><a href="#dot_product2-527"><span class="linenos">527</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="dot_product2-528"><a href="#dot_product2-528"><span class="linenos">528</span></a>    <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="dot_product2-529"><a href="#dot_product2-529"><span class="linenos">529</span></a>    <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="dot_product2-530"><a href="#dot_product2-530"><span class="linenos">530</span></a>    <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="dot_product2-531"><a href="#dot_product2-531"><span class="linenos">531</span></a>    <span class="n">b_a_x</span> <span class="o">=</span> <span class="n">a_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="dot_product2-532"><a href="#dot_product2-532"><span class="linenos">532</span></a>    <span class="n">b_a_y</span> <span class="o">=</span> <span class="n">a_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="dot_product2-533"><a href="#dot_product2-533"><span class="linenos">533</span></a>    <span class="n">b_c_x</span> <span class="o">=</span> <span class="n">c_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="dot_product2-534"><a href="#dot_product2-534"><span class="linenos">534</span></a>    <span class="n">b_c_y</span> <span class="o">=</span> <span class="n">c_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="dot_product2-535"><a href="#dot_product2-535"><span class="linenos">535</span></a>    <span class="k">return</span> <span class="n">b_a_x</span> <span class="o">*</span> <span class="n">b_c_x</span> <span class="o">+</span> <span class="n">b_a_y</span> <span class="o">*</span> <span class="n">b_c_y</span>
</span></pre></div>


            <div class="docstring"><p>Dot product of two vectors. AB and BC
Args:
    a (Point): First point, creating vector BA
    b (Point): Second point, common point for both vectors
    c (Point): Third point, creating vector BC</p>

<p>Returns:
    float: The dot product of vectors BA and BC
Note:
    The function calculates (a-b)·(c-b) which is the dot product of vectors BA and BC.
    This is useful for finding angles between segments that share a common point.</p>
</div>


                </section>
                <section id="cross_product2">
                            <input id="cross_product2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cross_product2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="cross_product2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cross_product2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cross_product2-538"><a href="#cross_product2-538"><span class="linenos">538</span></a><span class="k">def</span> <span class="nf">cross_product2</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="cross_product2-539"><a href="#cross_product2-539"><span class="linenos">539</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="cross_product2-540"><a href="#cross_product2-540"><span class="linenos">540</span></a><span class="sd">    Return the cross product of two vectors: BA and BC.</span>
</span><span id="cross_product2-541"><a href="#cross_product2-541"><span class="linenos">541</span></a>
</span><span id="cross_product2-542"><a href="#cross_product2-542"><span class="linenos">542</span></a><span class="sd">    Args:</span>
</span><span id="cross_product2-543"><a href="#cross_product2-543"><span class="linenos">543</span></a><span class="sd">        a (Point): First point, creating vector BA</span>
</span><span id="cross_product2-544"><a href="#cross_product2-544"><span class="linenos">544</span></a><span class="sd">        b (Point): Second point, common point for both vectors</span>
</span><span id="cross_product2-545"><a href="#cross_product2-545"><span class="linenos">545</span></a><span class="sd">        c (Point): Third point, creating vector BC</span>
</span><span id="cross_product2-546"><a href="#cross_product2-546"><span class="linenos">546</span></a>
</span><span id="cross_product2-547"><a href="#cross_product2-547"><span class="linenos">547</span></a><span class="sd">    Returns:</span>
</span><span id="cross_product2-548"><a href="#cross_product2-548"><span class="linenos">548</span></a><span class="sd">        float: The z-component of cross product between vectors BA and BC</span>
</span><span id="cross_product2-549"><a href="#cross_product2-549"><span class="linenos">549</span></a>
</span><span id="cross_product2-550"><a href="#cross_product2-550"><span class="linenos">550</span></a><span class="sd">    Note:</span>
</span><span id="cross_product2-551"><a href="#cross_product2-551"><span class="linenos">551</span></a><span class="sd">        This gives the signed area of the parallelogram formed by the vectors BA and BC.</span>
</span><span id="cross_product2-552"><a href="#cross_product2-552"><span class="linenos">552</span></a><span class="sd">        The sign indicates the orientation (positive for counter-clockwise, negative for clockwise).</span>
</span><span id="cross_product2-553"><a href="#cross_product2-553"><span class="linenos">553</span></a><span class="sd">        It is useful for determining the orientation of three points and calculating angles.</span>
</span><span id="cross_product2-554"><a href="#cross_product2-554"><span class="linenos">554</span></a>
</span><span id="cross_product2-555"><a href="#cross_product2-555"><span class="linenos">555</span></a><span class="sd">    vec1 = b - a</span>
</span><span id="cross_product2-556"><a href="#cross_product2-556"><span class="linenos">556</span></a><span class="sd">    vec2 = c - b</span>
</span><span id="cross_product2-557"><a href="#cross_product2-557"><span class="linenos">557</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cross_product2-558"><a href="#cross_product2-558"><span class="linenos">558</span></a>    <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="cross_product2-559"><a href="#cross_product2-559"><span class="linenos">559</span></a>    <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="cross_product2-560"><a href="#cross_product2-560"><span class="linenos">560</span></a>    <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="cross_product2-561"><a href="#cross_product2-561"><span class="linenos">561</span></a>    <span class="n">b_a_x</span> <span class="o">=</span> <span class="n">a_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="cross_product2-562"><a href="#cross_product2-562"><span class="linenos">562</span></a>    <span class="n">b_a_y</span> <span class="o">=</span> <span class="n">a_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="cross_product2-563"><a href="#cross_product2-563"><span class="linenos">563</span></a>    <span class="n">b_c_x</span> <span class="o">=</span> <span class="n">c_x</span> <span class="o">-</span> <span class="n">b_x</span>
</span><span id="cross_product2-564"><a href="#cross_product2-564"><span class="linenos">564</span></a>    <span class="n">b_c_y</span> <span class="o">=</span> <span class="n">c_y</span> <span class="o">-</span> <span class="n">b_y</span>
</span><span id="cross_product2-565"><a href="#cross_product2-565"><span class="linenos">565</span></a>    <span class="k">return</span> <span class="n">b_a_x</span> <span class="o">*</span> <span class="n">b_c_y</span> <span class="o">-</span> <span class="n">b_a_y</span> <span class="o">*</span> <span class="n">b_c_x</span>
</span></pre></div>


            <div class="docstring"><p>Return the cross product of two vectors: BA and BC.</p>

<p>Args:
    a (Point): First point, creating vector BA
    b (Point): Second point, common point for both vectors
    c (Point): Third point, creating vector BC</p>

<p>Returns:
    float: The z-component of cross product between vectors BA and BC</p>

<p>Note:
    This gives the signed area of the parallelogram formed by the vectors BA and BC.
    The sign indicates the orientation (positive for counter-clockwise, negative for clockwise).
    It is useful for determining the orientation of three points and calculating angles.</p>

<p>vec1 = b - a
vec2 = c - b</p>
</div>


                </section>
                <section id="triangle_angles_from_sides">
                            <input id="triangle_angles_from_sides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">triangle_angles_from_sides</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="triangle_angles_from_sides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#triangle_angles_from_sides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="triangle_angles_from_sides-568"><a href="#triangle_angles_from_sides-568"><span class="linenos">568</span></a><span class="k">def</span> <span class="nf">triangle_angles_from_sides</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="triangle_angles_from_sides-569"><a href="#triangle_angles_from_sides-569"><span class="linenos">569</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="triangle_angles_from_sides-570"><a href="#triangle_angles_from_sides-570"><span class="linenos">570</span></a><span class="sd">    Calculates the inner angles of a triangle given its side lengths.</span>
</span><span id="triangle_angles_from_sides-571"><a href="#triangle_angles_from_sides-571"><span class="linenos">571</span></a>
</span><span id="triangle_angles_from_sides-572"><a href="#triangle_angles_from_sides-572"><span class="linenos">572</span></a><span class="sd">    Args:</span>
</span><span id="triangle_angles_from_sides-573"><a href="#triangle_angles_from_sides-573"><span class="linenos">573</span></a><span class="sd">        a float: Length of side a.</span>
</span><span id="triangle_angles_from_sides-574"><a href="#triangle_angles_from_sides-574"><span class="linenos">574</span></a><span class="sd">        b float: Length of side b.</span>
</span><span id="triangle_angles_from_sides-575"><a href="#triangle_angles_from_sides-575"><span class="linenos">575</span></a><span class="sd">        c float: Length of side c.</span>
</span><span id="triangle_angles_from_sides-576"><a href="#triangle_angles_from_sides-576"><span class="linenos">576</span></a>
</span><span id="triangle_angles_from_sides-577"><a href="#triangle_angles_from_sides-577"><span class="linenos">577</span></a><span class="sd">    Returns:</span>
</span><span id="triangle_angles_from_sides-578"><a href="#triangle_angles_from_sides-578"><span class="linenos">578</span></a><span class="sd">        tuple[float, float, float]: A tuple containing the angles (A, B, C) in degrees.</span>
</span><span id="triangle_angles_from_sides-579"><a href="#triangle_angles_from_sides-579"><span class="linenos">579</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="triangle_angles_from_sides-580"><a href="#triangle_angles_from_sides-580"><span class="linenos">580</span></a>    <span class="n">a2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span>
</span><span id="triangle_angles_from_sides-581"><a href="#triangle_angles_from_sides-581"><span class="linenos">581</span></a>    <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="triangle_angles_from_sides-582"><a href="#triangle_angles_from_sides-582"><span class="linenos">582</span></a>    <span class="n">c2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span>
</span><span id="triangle_angles_from_sides-583"><a href="#triangle_angles_from_sides-583"><span class="linenos">583</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">b2</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">a2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span><span id="triangle_angles_from_sides-584"><a href="#triangle_angles_from_sides-584"><span class="linenos">584</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">a2</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span><span id="triangle_angles_from_sides-585"><a href="#triangle_angles_from_sides-585"><span class="linenos">585</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="n">acos</span><span class="p">((</span><span class="n">a2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">))</span>
</span><span id="triangle_angles_from_sides-586"><a href="#triangle_angles_from_sides-586"><span class="linenos">586</span></a>
</span><span id="triangle_angles_from_sides-587"><a href="#triangle_angles_from_sides-587"><span class="linenos">587</span></a>    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the inner angles of a triangle given its side lengths.</p>

<p>Args:
    a float: Length of side a.
    b float: Length of side b.
    c float: Length of side c.</p>

<p>Returns:
    tuple[float, float, float]: A tuple containing the angles (A, B, C) in degrees.</p>
</div>


                </section>
                <section id="angle_between_lines2">
                            <input id="angle_between_lines2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_between_lines2</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">point2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">point3</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="angle_between_lines2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#angle_between_lines2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="angle_between_lines2-589"><a href="#angle_between_lines2-589"><span class="linenos">589</span></a><span class="k">def</span> <span class="nf">angle_between_lines2</span><span class="p">(</span><span class="n">point1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point3</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="angle_between_lines2-590"><a href="#angle_between_lines2-590"><span class="linenos">590</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="angle_between_lines2-591"><a href="#angle_between_lines2-591"><span class="linenos">591</span></a><span class="sd">    Given line1 as point1 and point2, and line2 as point2 and point3</span>
</span><span id="angle_between_lines2-592"><a href="#angle_between_lines2-592"><span class="linenos">592</span></a><span class="sd">    return the angle between two lines</span>
</span><span id="angle_between_lines2-593"><a href="#angle_between_lines2-593"><span class="linenos">593</span></a><span class="sd">    (point2 is the corner point)</span>
</span><span id="angle_between_lines2-594"><a href="#angle_between_lines2-594"><span class="linenos">594</span></a>
</span><span id="angle_between_lines2-595"><a href="#angle_between_lines2-595"><span class="linenos">595</span></a><span class="sd">    Args:</span>
</span><span id="angle_between_lines2-596"><a href="#angle_between_lines2-596"><span class="linenos">596</span></a><span class="sd">        point1 (Point): First point of the first line.</span>
</span><span id="angle_between_lines2-597"><a href="#angle_between_lines2-597"><span class="linenos">597</span></a><span class="sd">        point2 (Point): Second point of the first line and first point of the second line.</span>
</span><span id="angle_between_lines2-598"><a href="#angle_between_lines2-598"><span class="linenos">598</span></a><span class="sd">        point3 (Point): Second point of the second line.</span>
</span><span id="angle_between_lines2-599"><a href="#angle_between_lines2-599"><span class="linenos">599</span></a>
</span><span id="angle_between_lines2-600"><a href="#angle_between_lines2-600"><span class="linenos">600</span></a><span class="sd">    Returns:</span>
</span><span id="angle_between_lines2-601"><a href="#angle_between_lines2-601"><span class="linenos">601</span></a><span class="sd">        float: Angle between the two lines in radians.</span>
</span><span id="angle_between_lines2-602"><a href="#angle_between_lines2-602"><span class="linenos">602</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="angle_between_lines2-603"><a href="#angle_between_lines2-603"><span class="linenos">603</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span>
</span><span id="angle_between_lines2-604"><a href="#angle_between_lines2-604"><span class="linenos">604</span></a>        <span class="n">cross_product2</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">),</span> <span class="n">dot_product2</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">)</span>
</span><span id="angle_between_lines2-605"><a href="#angle_between_lines2-605"><span class="linenos">605</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given line1 as point1 and point2, and line2 as point2 and point3
return the angle between two lines
(point2 is the corner point)</p>

<p>Args:
    point1 (Point): First point of the first line.
    point2 (Point): Second point of the first line and first point of the second line.
    point3 (Point): Second point of the second line.</p>

<p>Returns:
    float: Angle between the two lines in radians.</p>
</div>


                </section>
                <section id="angled_line">
                            <input id="angled_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angled_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">theta</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="angled_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#angled_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="angled_line-608"><a href="#angled_line-608"><span class="linenos">608</span></a><span class="k">def</span> <span class="nf">angled_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="angled_line-609"><a href="#angled_line-609"><span class="linenos">609</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="angled_line-610"><a href="#angled_line-610"><span class="linenos">610</span></a><span class="sd">    Given a line find another line with theta radians between them.</span>
</span><span id="angled_line-611"><a href="#angled_line-611"><span class="linenos">611</span></a>
</span><span id="angled_line-612"><a href="#angled_line-612"><span class="linenos">612</span></a><span class="sd">    Args:</span>
</span><span id="angled_line-613"><a href="#angled_line-613"><span class="linenos">613</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="angled_line-614"><a href="#angled_line-614"><span class="linenos">614</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="angled_line-615"><a href="#angled_line-615"><span class="linenos">615</span></a>
</span><span id="angled_line-616"><a href="#angled_line-616"><span class="linenos">616</span></a><span class="sd">    Returns:</span>
</span><span id="angled_line-617"><a href="#angled_line-617"><span class="linenos">617</span></a><span class="sd">        Line: New line with the given angle.</span>
</span><span id="angled_line-618"><a href="#angled_line-618"><span class="linenos">618</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="angled_line-619"><a href="#angled_line-619"><span class="linenos">619</span></a>    <span class="c1"># find the angle of the line</span>
</span><span id="angled_line-620"><a href="#angled_line-620"><span class="linenos">620</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="angled_line-621"><a href="#angled_line-621"><span class="linenos">621</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="angled_line-622"><a href="#angled_line-622"><span class="linenos">622</span></a>    <span class="n">theta1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="angled_line-623"><a href="#angled_line-623"><span class="linenos">623</span></a>    <span class="n">theta2</span> <span class="o">=</span> <span class="n">theta1</span> <span class="o">+</span> <span class="n">theta</span>
</span><span id="angled_line-624"><a href="#angled_line-624"><span class="linenos">624</span></a>    <span class="c1"># find the length of the line</span>
</span><span id="angled_line-625"><a href="#angled_line-625"><span class="linenos">625</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="angled_line-626"><a href="#angled_line-626"><span class="linenos">626</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="angled_line-627"><a href="#angled_line-627"><span class="linenos">627</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="angled_line-628"><a href="#angled_line-628"><span class="linenos">628</span></a>    <span class="c1"># find the new line</span>
</span><span id="angled_line-629"><a href="#angled_line-629"><span class="linenos">629</span></a>    <span class="n">x3</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
</span><span id="angled_line-630"><a href="#angled_line-630"><span class="linenos">630</span></a>    <span class="n">y3</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
</span><span id="angled_line-631"><a href="#angled_line-631"><span class="linenos">631</span></a>
</span><span id="angled_line-632"><a href="#angled_line-632"><span class="linenos">632</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Given a line find another line with theta radians between them.</p>

<p>Args:
    line (Line): Input line.
    theta (float): Angle in radians.</p>

<p>Returns:
    Line: New line with the given angle.</p>
</div>


                </section>
                <section id="angled_vector">
                            <input id="angled_vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angled_vector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="angled_vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#angled_vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="angled_vector-635"><a href="#angled_vector-635"><span class="linenos">635</span></a><span class="k">def</span> <span class="nf">angled_vector</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="angled_vector-636"><a href="#angled_vector-636"><span class="linenos">636</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="angled_vector-637"><a href="#angled_vector-637"><span class="linenos">637</span></a><span class="sd">    Return a vector with the given angle</span>
</span><span id="angled_vector-638"><a href="#angled_vector-638"><span class="linenos">638</span></a>
</span><span id="angled_vector-639"><a href="#angled_vector-639"><span class="linenos">639</span></a><span class="sd">    Args:</span>
</span><span id="angled_vector-640"><a href="#angled_vector-640"><span class="linenos">640</span></a><span class="sd">        angle (float): Angle in radians.</span>
</span><span id="angled_vector-641"><a href="#angled_vector-641"><span class="linenos">641</span></a>
</span><span id="angled_vector-642"><a href="#angled_vector-642"><span class="linenos">642</span></a><span class="sd">    Returns:</span>
</span><span id="angled_vector-643"><a href="#angled_vector-643"><span class="linenos">643</span></a><span class="sd">        Sequence[float]: Vector with the given angle.</span>
</span><span id="angled_vector-644"><a href="#angled_vector-644"><span class="linenos">644</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="angled_vector-645"><a href="#angled_vector-645"><span class="linenos">645</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Return a vector with the given angle</p>

<p>Args:
    angle (float): Angle in radians.</p>

<p>Returns:
    Sequence[float]: Vector with the given angle.</p>
</div>


                </section>
                <section id="close_points2">
                            <input id="close_points2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close_points2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">dist2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="close_points2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#close_points2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="close_points2-648"><a href="#close_points2-648"><span class="linenos">648</span></a><span class="k">def</span> <span class="nf">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">dist2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="close_points2-649"><a href="#close_points2-649"><span class="linenos">649</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="close_points2-650"><a href="#close_points2-650"><span class="linenos">650</span></a><span class="sd">    Return True if two points are close to each other.</span>
</span><span id="close_points2-651"><a href="#close_points2-651"><span class="linenos">651</span></a>
</span><span id="close_points2-652"><a href="#close_points2-652"><span class="linenos">652</span></a><span class="sd">    Args:</span>
</span><span id="close_points2-653"><a href="#close_points2-653"><span class="linenos">653</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="close_points2-654"><a href="#close_points2-654"><span class="linenos">654</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="close_points2-655"><a href="#close_points2-655"><span class="linenos">655</span></a><span class="sd">        dist2 (float, optional): Square of the threshold distance. Defaults to 0.01.</span>
</span><span id="close_points2-656"><a href="#close_points2-656"><span class="linenos">656</span></a>
</span><span id="close_points2-657"><a href="#close_points2-657"><span class="linenos">657</span></a><span class="sd">    Returns:</span>
</span><span id="close_points2-658"><a href="#close_points2-658"><span class="linenos">658</span></a><span class="sd">        bool: True if the points are close to each other, False otherwise.</span>
</span><span id="close_points2-659"><a href="#close_points2-659"><span class="linenos">659</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="close_points2-660"><a href="#close_points2-660"><span class="linenos">660</span></a>    <span class="k">return</span> <span class="n">distance2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dist2</span>
</span></pre></div>


            <div class="docstring"><p>Return True if two points are close to each other.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.
    dist2 (float, optional): Square of the threshold distance. Defaults to 0.01.</p>

<p>Returns:
    bool: True if the points are close to each other, False otherwise.</p>
</div>


                </section>
                <section id="close_angles">
                            <input id="close_angles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close_angles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle1</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">angle2</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">angtol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="close_angles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#close_angles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="close_angles-663"><a href="#close_angles-663"><span class="linenos">663</span></a><span class="k">def</span> <span class="nf">close_angles</span><span class="p">(</span><span class="n">angle1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angle2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angtol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="close_angles-664"><a href="#close_angles-664"><span class="linenos">664</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="close_angles-665"><a href="#close_angles-665"><span class="linenos">665</span></a><span class="sd">    Return True if two angles are close to each other.</span>
</span><span id="close_angles-666"><a href="#close_angles-666"><span class="linenos">666</span></a>
</span><span id="close_angles-667"><a href="#close_angles-667"><span class="linenos">667</span></a><span class="sd">    Args:</span>
</span><span id="close_angles-668"><a href="#close_angles-668"><span class="linenos">668</span></a><span class="sd">        angle1 (float): First angle in radians.</span>
</span><span id="close_angles-669"><a href="#close_angles-669"><span class="linenos">669</span></a><span class="sd">        angle2 (float): Second angle in radians.</span>
</span><span id="close_angles-670"><a href="#close_angles-670"><span class="linenos">670</span></a><span class="sd">        angtol (float, optional): Angle tolerance. Defaults to None.</span>
</span><span id="close_angles-671"><a href="#close_angles-671"><span class="linenos">671</span></a>
</span><span id="close_angles-672"><a href="#close_angles-672"><span class="linenos">672</span></a><span class="sd">    Returns:</span>
</span><span id="close_angles-673"><a href="#close_angles-673"><span class="linenos">673</span></a><span class="sd">        bool: True if the angles are close to each other, False otherwise.</span>
</span><span id="close_angles-674"><a href="#close_angles-674"><span class="linenos">674</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="close_angles-675"><a href="#close_angles-675"><span class="linenos">675</span></a>    <span class="k">if</span> <span class="n">angtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="close_angles-676"><a href="#close_angles-676"><span class="linenos">676</span></a>        <span class="n">angtol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;angtol&quot;</span><span class="p">]</span>
</span><span id="close_angles-677"><a href="#close_angles-677"><span class="linenos">677</span></a>
</span><span id="close_angles-678"><a href="#close_angles-678"><span class="linenos">678</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">angle1</span> <span class="o">-</span> <span class="n">angle2</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">angtol</span>
</span></pre></div>


            <div class="docstring"><p>Return True if two angles are close to each other.</p>

<p>Args:
    angle1 (float): First angle in radians.
    angle2 (float): Second angle in radians.
    angtol (float, optional): Angle tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the angles are close to each other, False otherwise.</p>
</div>


                </section>
                <section id="distance">
                            <input id="distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="distance-681"><a href="#distance-681"><span class="linenos">681</span></a><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="distance-682"><a href="#distance-682"><span class="linenos">682</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="distance-683"><a href="#distance-683"><span class="linenos">683</span></a><span class="sd">    Return the distance between two points.</span>
</span><span id="distance-684"><a href="#distance-684"><span class="linenos">684</span></a>
</span><span id="distance-685"><a href="#distance-685"><span class="linenos">685</span></a><span class="sd">    Args:</span>
</span><span id="distance-686"><a href="#distance-686"><span class="linenos">686</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="distance-687"><a href="#distance-687"><span class="linenos">687</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="distance-688"><a href="#distance-688"><span class="linenos">688</span></a>
</span><span id="distance-689"><a href="#distance-689"><span class="linenos">689</span></a><span class="sd">    Returns:</span>
</span><span id="distance-690"><a href="#distance-690"><span class="linenos">690</span></a><span class="sd">        float: Distance between the two points.</span>
</span><span id="distance-691"><a href="#distance-691"><span class="linenos">691</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="distance-692"><a href="#distance-692"><span class="linenos">692</span></a>    <span class="k">return</span> <span class="n">hypot</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the distance between two points.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.</p>

<p>Returns:
    float: Distance between the two points.</p>
</div>


                </section>
                <section id="distance2">
                            <input id="distance2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="distance2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#distance2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="distance2-695"><a href="#distance2-695"><span class="linenos">695</span></a><span class="k">def</span> <span class="nf">distance2</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="distance2-696"><a href="#distance2-696"><span class="linenos">696</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="distance2-697"><a href="#distance2-697"><span class="linenos">697</span></a><span class="sd">    Return the squared distance between two points.</span>
</span><span id="distance2-698"><a href="#distance2-698"><span class="linenos">698</span></a><span class="sd">    Useful for comparing distances without the need to</span>
</span><span id="distance2-699"><a href="#distance2-699"><span class="linenos">699</span></a><span class="sd">    compute the square root.</span>
</span><span id="distance2-700"><a href="#distance2-700"><span class="linenos">700</span></a>
</span><span id="distance2-701"><a href="#distance2-701"><span class="linenos">701</span></a><span class="sd">    Args:</span>
</span><span id="distance2-702"><a href="#distance2-702"><span class="linenos">702</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="distance2-703"><a href="#distance2-703"><span class="linenos">703</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="distance2-704"><a href="#distance2-704"><span class="linenos">704</span></a>
</span><span id="distance2-705"><a href="#distance2-705"><span class="linenos">705</span></a><span class="sd">    Returns:</span>
</span><span id="distance2-706"><a href="#distance2-706"><span class="linenos">706</span></a><span class="sd">        float: Squared distance between the two points.</span>
</span><span id="distance2-707"><a href="#distance2-707"><span class="linenos">707</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="distance2-708"><a href="#distance2-708"><span class="linenos">708</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Return the squared distance between two points.
Useful for comparing distances without the need to
compute the square root.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.</p>

<p>Returns:
    float: Squared distance between the two points.</p>
</div>


                </section>
                <section id="connect2">
                            <input id="connect2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connect2</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">poly_point1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">poly_point2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="connect2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#connect2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="connect2-711"><a href="#connect2-711"><span class="linenos">711</span></a><span class="k">def</span> <span class="nf">connect2</span><span class="p">(</span>
</span><span id="connect2-712"><a href="#connect2-712"><span class="linenos">712</span></a>    <span class="n">poly_point1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="connect2-713"><a href="#connect2-713"><span class="linenos">713</span></a>    <span class="n">poly_point2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="connect2-714"><a href="#connect2-714"><span class="linenos">714</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="connect2-715"><a href="#connect2-715"><span class="linenos">715</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="connect2-716"><a href="#connect2-716"><span class="linenos">716</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="connect2-717"><a href="#connect2-717"><span class="linenos">717</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="connect2-718"><a href="#connect2-718"><span class="linenos">718</span></a><span class="sd">    Connect two polypoints together.</span>
</span><span id="connect2-719"><a href="#connect2-719"><span class="linenos">719</span></a>
</span><span id="connect2-720"><a href="#connect2-720"><span class="linenos">720</span></a><span class="sd">    Args:</span>
</span><span id="connect2-721"><a href="#connect2-721"><span class="linenos">721</span></a><span class="sd">        poly_point1 (list[Point]): First list of points.</span>
</span><span id="connect2-722"><a href="#connect2-722"><span class="linenos">722</span></a><span class="sd">        poly_point2 (list[Point]): Second list of points.</span>
</span><span id="connect2-723"><a href="#connect2-723"><span class="linenos">723</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="connect2-724"><a href="#connect2-724"><span class="linenos">724</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="connect2-725"><a href="#connect2-725"><span class="linenos">725</span></a>
</span><span id="connect2-726"><a href="#connect2-726"><span class="linenos">726</span></a><span class="sd">    Returns:</span>
</span><span id="connect2-727"><a href="#connect2-727"><span class="linenos">727</span></a><span class="sd">        list[Point]: Connected list of points.</span>
</span><span id="connect2-728"><a href="#connect2-728"><span class="linenos">728</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="connect2-729"><a href="#connect2-729"><span class="linenos">729</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;dist_tol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">])</span>
</span><span id="connect2-730"><a href="#connect2-730"><span class="linenos">730</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="connect2-731"><a href="#connect2-731"><span class="linenos">731</span></a>    <span class="n">start1</span><span class="p">,</span> <span class="n">end1</span> <span class="o">=</span> <span class="n">poly_point1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly_point1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="connect2-732"><a href="#connect2-732"><span class="linenos">732</span></a>    <span class="n">start2</span><span class="p">,</span> <span class="n">end2</span> <span class="o">=</span> <span class="n">poly_point2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly_point2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="connect2-733"><a href="#connect2-733"><span class="linenos">733</span></a>    <span class="n">pp1</span> <span class="o">=</span> <span class="n">poly_point1</span><span class="p">[:]</span>
</span><span id="connect2-734"><a href="#connect2-734"><span class="linenos">734</span></a>    <span class="n">pp2</span> <span class="o">=</span> <span class="n">poly_point2</span><span class="p">[:]</span>
</span><span id="connect2-735"><a href="#connect2-735"><span class="linenos">735</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="connect2-736"><a href="#connect2-736"><span class="linenos">736</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="connect2-737"><a href="#connect2-737"><span class="linenos">737</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="connect2-738"><a href="#connect2-738"><span class="linenos">738</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="connect2-739"><a href="#connect2-739"><span class="linenos">739</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="n">end2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="connect2-740"><a href="#connect2-740"><span class="linenos">740</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="connect2-741"><a href="#connect2-741"><span class="linenos">741</span></a>        <span class="n">pp2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="connect2-742"><a href="#connect2-742"><span class="linenos">742</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="connect2-743"><a href="#connect2-743"><span class="linenos">743</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="connect2-744"><a href="#connect2-744"><span class="linenos">744</span></a>        <span class="n">pp1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="connect2-745"><a href="#connect2-745"><span class="linenos">745</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="connect2-746"><a href="#connect2-746"><span class="linenos">746</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="connect2-747"><a href="#connect2-747"><span class="linenos">747</span></a>    <span class="k">elif</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">end2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="connect2-748"><a href="#connect2-748"><span class="linenos">748</span></a>        <span class="n">pp1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="connect2-749"><a href="#connect2-749"><span class="linenos">749</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp1</span><span class="p">)</span>
</span><span id="connect2-750"><a href="#connect2-750"><span class="linenos">750</span></a>        <span class="n">pp2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="connect2-751"><a href="#connect2-751"><span class="linenos">751</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="connect2-752"><a href="#connect2-752"><span class="linenos">752</span></a>
</span><span id="connect2-753"><a href="#connect2-753"><span class="linenos">753</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>Connect two polypoints together.</p>

<p>Args:
    poly_point1 (list[Point]): First list of points.
    poly_point2 (list[Point]): Second list of points.
    dist_tol (float, optional): Distance tolerance. Defaults to None.
    rtol (float, optional): Relative tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: Connected list of points.</p>
</div>


                </section>
                <section id="stitch">
                            <input id="stitch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stitch</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">]]</span>,</span><span class="param">	<span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">return_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="stitch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#stitch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="stitch-756"><a href="#stitch-756"><span class="linenos">756</span></a><span class="k">def</span> <span class="nf">stitch</span><span class="p">(</span>
</span><span id="stitch-757"><a href="#stitch-757"><span class="linenos">757</span></a>    <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span>
</span><span id="stitch-758"><a href="#stitch-758"><span class="linenos">758</span></a>    <span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="stitch-759"><a href="#stitch-759"><span class="linenos">759</span></a>    <span class="n">return_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="stitch-760"><a href="#stitch-760"><span class="linenos">760</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="stitch-761"><a href="#stitch-761"><span class="linenos">761</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="stitch-762"><a href="#stitch-762"><span class="linenos">762</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="stitch-763"><a href="#stitch-763"><span class="linenos">763</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="stitch-764"><a href="#stitch-764"><span class="linenos">764</span></a><span class="sd">    Stitches a list of lines together.</span>
</span><span id="stitch-765"><a href="#stitch-765"><span class="linenos">765</span></a>
</span><span id="stitch-766"><a href="#stitch-766"><span class="linenos">766</span></a><span class="sd">    Args:</span>
</span><span id="stitch-767"><a href="#stitch-767"><span class="linenos">767</span></a><span class="sd">        lines (list[Line]): List of lines to stitch.</span>
</span><span id="stitch-768"><a href="#stitch-768"><span class="linenos">768</span></a><span class="sd">        closed (bool, optional): Whether the lines form a closed shape. Defaults to True.</span>
</span><span id="stitch-769"><a href="#stitch-769"><span class="linenos">769</span></a><span class="sd">        return_points (bool, optional): Whether to return points or lines. Defaults to True.</span>
</span><span id="stitch-770"><a href="#stitch-770"><span class="linenos">770</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="stitch-771"><a href="#stitch-771"><span class="linenos">771</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="stitch-772"><a href="#stitch-772"><span class="linenos">772</span></a>
</span><span id="stitch-773"><a href="#stitch-773"><span class="linenos">773</span></a><span class="sd">    Returns:</span>
</span><span id="stitch-774"><a href="#stitch-774"><span class="linenos">774</span></a><span class="sd">        list[Point]: Stitched list of points or lines.</span>
</span><span id="stitch-775"><a href="#stitch-775"><span class="linenos">775</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="stitch-776"><a href="#stitch-776"><span class="linenos">776</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="stitch-777"><a href="#stitch-777"><span class="linenos">777</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="stitch-778"><a href="#stitch-778"><span class="linenos">778</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="stitch-779"><a href="#stitch-779"><span class="linenos">779</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="stitch-780"><a href="#stitch-780"><span class="linenos">780</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="stitch-781"><a href="#stitch-781"><span class="linenos">781</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="stitch-782"><a href="#stitch-782"><span class="linenos">782</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="stitch-783"><a href="#stitch-783"><span class="linenos">783</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="stitch-784"><a href="#stitch-784"><span class="linenos">784</span></a>        <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="stitch-785"><a href="#stitch-785"><span class="linenos">785</span></a>        <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="stitch-786"><a href="#stitch-786"><span class="linenos">786</span></a>        <span class="n">x_point</span> <span class="o">=</span> <span class="n">intersect2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="stitch-787"><a href="#stitch-787"><span class="linenos">787</span></a>        <span class="k">if</span> <span class="n">x_point</span><span class="p">:</span>
</span><span id="stitch-788"><a href="#stitch-788"><span class="linenos">788</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_point</span><span class="p">)</span>
</span><span id="stitch-789"><a href="#stitch-789"><span class="linenos">789</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="stitch-790"><a href="#stitch-790"><span class="linenos">790</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="stitch-791"><a href="#stitch-791"><span class="linenos">791</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="stitch-792"><a href="#stitch-792"><span class="linenos">792</span></a>        <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="stitch-793"><a href="#stitch-793"><span class="linenos">793</span></a>        <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="stitch-794"><a href="#stitch-794"><span class="linenos">794</span></a>        <span class="n">final_x</span> <span class="o">=</span> <span class="n">intersect2</span><span class="p">(</span>
</span><span id="stitch-795"><a href="#stitch-795"><span class="linenos">795</span></a>            <span class="n">x1</span><span class="p">,</span>
</span><span id="stitch-796"><a href="#stitch-796"><span class="linenos">796</span></a>            <span class="n">y1</span><span class="p">,</span>
</span><span id="stitch-797"><a href="#stitch-797"><span class="linenos">797</span></a>            <span class="n">x2</span><span class="p">,</span>
</span><span id="stitch-798"><a href="#stitch-798"><span class="linenos">798</span></a>            <span class="n">y2</span><span class="p">,</span>
</span><span id="stitch-799"><a href="#stitch-799"><span class="linenos">799</span></a>            <span class="n">x3</span><span class="p">,</span>
</span><span id="stitch-800"><a href="#stitch-800"><span class="linenos">800</span></a>            <span class="n">y3</span><span class="p">,</span>
</span><span id="stitch-801"><a href="#stitch-801"><span class="linenos">801</span></a>            <span class="n">x4</span><span class="p">,</span>
</span><span id="stitch-802"><a href="#stitch-802"><span class="linenos">802</span></a>            <span class="n">y4</span><span class="p">,</span>
</span><span id="stitch-803"><a href="#stitch-803"><span class="linenos">803</span></a>        <span class="p">)</span>
</span><span id="stitch-804"><a href="#stitch-804"><span class="linenos">804</span></a>        <span class="k">if</span> <span class="n">final_x</span><span class="p">:</span>
</span><span id="stitch-805"><a href="#stitch-805"><span class="linenos">805</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_x</span><span class="p">)</span>
</span><span id="stitch-806"><a href="#stitch-806"><span class="linenos">806</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_x</span><span class="p">)</span>
</span><span id="stitch-807"><a href="#stitch-807"><span class="linenos">807</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="stitch-808"><a href="#stitch-808"><span class="linenos">808</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="stitch-809"><a href="#stitch-809"><span class="linenos">809</span></a>    <span class="k">if</span> <span class="n">return_points</span><span class="p">:</span>
</span><span id="stitch-810"><a href="#stitch-810"><span class="linenos">810</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">points</span>
</span><span id="stitch-811"><a href="#stitch-811"><span class="linenos">811</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="stitch-812"><a href="#stitch-812"><span class="linenos">812</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">connected_pairs</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="stitch-813"><a href="#stitch-813"><span class="linenos">813</span></a>
</span><span id="stitch-814"><a href="#stitch-814"><span class="linenos">814</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Stitches a list of lines together.</p>

<p>Args:
    lines (list[Line]): List of lines to stitch.
    closed (bool, optional): Whether the lines form a closed shape. Defaults to True.
    return_points (bool, optional): Whether to return points or lines. Defaults to True.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: Stitched list of points or lines.</p>
</div>


                </section>
                <section id="double_offset_polylines">
                            <input id="double_offset_polylines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">double_offset_polylines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="double_offset_polylines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#double_offset_polylines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="double_offset_polylines-817"><a href="#double_offset_polylines-817"><span class="linenos">817</span></a><span class="k">def</span> <span class="nf">double_offset_polylines</span><span class="p">(</span>
</span><span id="double_offset_polylines-818"><a href="#double_offset_polylines-818"><span class="linenos">818</span></a>    <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="double_offset_polylines-819"><a href="#double_offset_polylines-819"><span class="linenos">819</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="double_offset_polylines-820"><a href="#double_offset_polylines-820"><span class="linenos">820</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="double_offset_polylines-821"><a href="#double_offset_polylines-821"><span class="linenos">821</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="double_offset_polylines-822"><a href="#double_offset_polylines-822"><span class="linenos">822</span></a>
</span><span id="double_offset_polylines-823"><a href="#double_offset_polylines-823"><span class="linenos">823</span></a><span class="sd">    Args:</span>
</span><span id="double_offset_polylines-824"><a href="#double_offset_polylines-824"><span class="linenos">824</span></a><span class="sd">        lines (list[Point]): List of points representing the lines.</span>
</span><span id="double_offset_polylines-825"><a href="#double_offset_polylines-825"><span class="linenos">825</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="double_offset_polylines-826"><a href="#double_offset_polylines-826"><span class="linenos">826</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="double_offset_polylines-827"><a href="#double_offset_polylines-827"><span class="linenos">827</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="double_offset_polylines-828"><a href="#double_offset_polylines-828"><span class="linenos">828</span></a>
</span><span id="double_offset_polylines-829"><a href="#double_offset_polylines-829"><span class="linenos">829</span></a><span class="sd">    Returns:</span>
</span><span id="double_offset_polylines-830"><a href="#double_offset_polylines-830"><span class="linenos">830</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="double_offset_polylines-831"><a href="#double_offset_polylines-831"><span class="linenos">831</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="double_offset_polylines-832"><a href="#double_offset_polylines-832"><span class="linenos">832</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="double_offset_polylines-833"><a href="#double_offset_polylines-833"><span class="linenos">833</span></a>    <span class="n">lines1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="double_offset_polylines-834"><a href="#double_offset_polylines-834"><span class="linenos">834</span></a>    <span class="n">lines2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="double_offset_polylines-835"><a href="#double_offset_polylines-835"><span class="linenos">835</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="double_offset_polylines-836"><a href="#double_offset_polylines-836"><span class="linenos">836</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="double_offset_polylines-837"><a href="#double_offset_polylines-837"><span class="linenos">837</span></a>        <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="double_offset_polylines-838"><a href="#double_offset_polylines-838"><span class="linenos">838</span></a>        <span class="n">lines1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="double_offset_polylines-839"><a href="#double_offset_polylines-839"><span class="linenos">839</span></a>        <span class="n">lines2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
</span><span id="double_offset_polylines-840"><a href="#double_offset_polylines-840"><span class="linenos">840</span></a>    <span class="n">lines1</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">lines1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="double_offset_polylines-841"><a href="#double_offset_polylines-841"><span class="linenos">841</span></a>    <span class="n">lines2</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">lines2</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="double_offset_polylines-842"><a href="#double_offset_polylines-842"><span class="linenos">842</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">lines1</span><span class="p">,</span> <span class="n">lines2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of double offset lines from a list of lines.</p>

<p>Args:
    lines (list[Point]): List of points representing the lines.
    offset (float, optional): Offset distance. Defaults to 1.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of double offset lines.</p>
</div>


                </section>
                <section id="polygon_cg">
                            <input id="polygon_cg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_cg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="polygon_cg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_cg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_cg-845"><a href="#polygon_cg-845"><span class="linenos">845</span></a><span class="k">def</span> <span class="nf">polygon_cg</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="polygon_cg-846"><a href="#polygon_cg-846"><span class="linenos">846</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="polygon_cg-847"><a href="#polygon_cg-847"><span class="linenos">847</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="polygon_cg-848"><a href="#polygon_cg-848"><span class="linenos">848</span></a>
</span><span id="polygon_cg-849"><a href="#polygon_cg-849"><span class="linenos">849</span></a><span class="sd">    Args:</span>
</span><span id="polygon_cg-850"><a href="#polygon_cg-850"><span class="linenos">850</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="polygon_cg-851"><a href="#polygon_cg-851"><span class="linenos">851</span></a>
</span><span id="polygon_cg-852"><a href="#polygon_cg-852"><span class="linenos">852</span></a><span class="sd">    Returns:</span>
</span><span id="polygon_cg-853"><a href="#polygon_cg-853"><span class="linenos">853</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="polygon_cg-854"><a href="#polygon_cg-854"><span class="linenos">854</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_cg-855"><a href="#polygon_cg-855"><span class="linenos">855</span></a>    <span class="n">cx</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_cg-856"><a href="#polygon_cg-856"><span class="linenos">856</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="polygon_cg-857"><a href="#polygon_cg-857"><span class="linenos">857</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="polygon_cg-858"><a href="#polygon_cg-858"><span class="linenos">858</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="polygon_cg-859"><a href="#polygon_cg-859"><span class="linenos">859</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="polygon_cg-860"><a href="#polygon_cg-860"><span class="linenos">860</span></a>        <span class="n">xnext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="polygon_cg-861"><a href="#polygon_cg-861"><span class="linenos">861</span></a>        <span class="n">ynext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="polygon_cg-862"><a href="#polygon_cg-862"><span class="linenos">862</span></a>
</span><span id="polygon_cg-863"><a href="#polygon_cg-863"><span class="linenos">863</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">ynext</span> <span class="o">-</span> <span class="n">xnext</span> <span class="o">*</span> <span class="n">y</span>
</span><span id="polygon_cg-864"><a href="#polygon_cg-864"><span class="linenos">864</span></a>        <span class="n">cx</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">xnext</span><span class="p">)</span> <span class="o">*</span> <span class="n">temp</span>
</span><span id="polygon_cg-865"><a href="#polygon_cg-865"><span class="linenos">865</span></a>        <span class="n">cy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">ynext</span><span class="p">)</span> <span class="o">*</span> <span class="n">temp</span>
</span><span id="polygon_cg-866"><a href="#polygon_cg-866"><span class="linenos">866</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="polygon_cg-867"><a href="#polygon_cg-867"><span class="linenos">867</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="n">area_</span> <span class="o">*</span> <span class="mi">6</span>
</span><span id="polygon_cg-868"><a href="#polygon_cg-868"><span class="linenos">868</span></a>    <span class="k">if</span> <span class="n">denom</span><span class="p">:</span>
</span><span id="polygon_cg-869"><a href="#polygon_cg-869"><span class="linenos">869</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">cx</span> <span class="o">/</span> <span class="n">denom</span><span class="p">,</span> <span class="n">cy</span> <span class="o">/</span> <span class="n">denom</span><span class="p">]</span>
</span><span id="polygon_cg-870"><a href="#polygon_cg-870"><span class="linenos">870</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="polygon_cg-871"><a href="#polygon_cg-871"><span class="linenos">871</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="polygon_cg-872"><a href="#polygon_cg-872"><span class="linenos">872</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Given a list of points that define a polygon, return the center point.</p>

<p>Args:
    points (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    Point: Center point of the polygon.</p>
</div>


                </section>
                <section id="polygon_center2">
                            <input id="polygon_center2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_center2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="polygon_center2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_center2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_center2-875"><a href="#polygon_center2-875"><span class="linenos">875</span></a><span class="k">def</span> <span class="nf">polygon_center2</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="polygon_center2-876"><a href="#polygon_center2-876"><span class="linenos">876</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="polygon_center2-877"><a href="#polygon_center2-877"><span class="linenos">877</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="polygon_center2-878"><a href="#polygon_center2-878"><span class="linenos">878</span></a>
</span><span id="polygon_center2-879"><a href="#polygon_center2-879"><span class="linenos">879</span></a><span class="sd">    Args:</span>
</span><span id="polygon_center2-880"><a href="#polygon_center2-880"><span class="linenos">880</span></a><span class="sd">        polygon_points (list[Point]): List of points representing the polygon.</span>
</span><span id="polygon_center2-881"><a href="#polygon_center2-881"><span class="linenos">881</span></a>
</span><span id="polygon_center2-882"><a href="#polygon_center2-882"><span class="linenos">882</span></a><span class="sd">    Returns:</span>
</span><span id="polygon_center2-883"><a href="#polygon_center2-883"><span class="linenos">883</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="polygon_center2-884"><a href="#polygon_center2-884"><span class="linenos">884</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_center2-885"><a href="#polygon_center2-885"><span class="linenos">885</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">)</span>
</span><span id="polygon_center2-886"><a href="#polygon_center2-886"><span class="linenos">886</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_center2-887"><a href="#polygon_center2-887"><span class="linenos">887</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_center2-888"><a href="#polygon_center2-888"><span class="linenos">888</span></a>    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">polygon_points</span><span class="p">:</span>
</span><span id="polygon_center2-889"><a href="#polygon_center2-889"><span class="linenos">889</span></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="polygon_center2-890"><a href="#polygon_center2-890"><span class="linenos">890</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="polygon_center2-891"><a href="#polygon_center2-891"><span class="linenos">891</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="polygon_center2-892"><a href="#polygon_center2-892"><span class="linenos">892</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="polygon_center2-893"><a href="#polygon_center2-893"><span class="linenos">893</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Given a list of points that define a polygon, return the center point.</p>

<p>Args:
    polygon_points (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    Point: Center point of the polygon.</p>
</div>


                </section>
                <section id="polygon_center">
                            <input id="polygon_center-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_center</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="polygon_center-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_center"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_center-896"><a href="#polygon_center-896"><span class="linenos">896</span></a><span class="k">def</span> <span class="nf">polygon_center</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="polygon_center-897"><a href="#polygon_center-897"><span class="linenos">897</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="polygon_center-898"><a href="#polygon_center-898"><span class="linenos">898</span></a><span class="sd">    Given a list of points that define a polygon, return the center point.</span>
</span><span id="polygon_center-899"><a href="#polygon_center-899"><span class="linenos">899</span></a>
</span><span id="polygon_center-900"><a href="#polygon_center-900"><span class="linenos">900</span></a><span class="sd">    Args:</span>
</span><span id="polygon_center-901"><a href="#polygon_center-901"><span class="linenos">901</span></a><span class="sd">        polygon_points (list[Point]): List of points representing the polygon.</span>
</span><span id="polygon_center-902"><a href="#polygon_center-902"><span class="linenos">902</span></a>
</span><span id="polygon_center-903"><a href="#polygon_center-903"><span class="linenos">903</span></a><span class="sd">    Returns:</span>
</span><span id="polygon_center-904"><a href="#polygon_center-904"><span class="linenos">904</span></a><span class="sd">        Point: Center point of the polygon.</span>
</span><span id="polygon_center-905"><a href="#polygon_center-905"><span class="linenos">905</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_center-906"><a href="#polygon_center-906"><span class="linenos">906</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_center-907"><a href="#polygon_center-907"><span class="linenos">907</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_center-908"><a href="#polygon_center-908"><span class="linenos">908</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="polygon_center-909"><a href="#polygon_center-909"><span class="linenos">909</span></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="polygon_center-910"><a href="#polygon_center-910"><span class="linenos">910</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">polygon_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="polygon_center-911"><a href="#polygon_center-911"><span class="linenos">911</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">polygon_points</span><span class="p">)</span>
</span><span id="polygon_center-912"><a href="#polygon_center-912"><span class="linenos">912</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area_</span><span class="p">),</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area_</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Given a list of points that define a polygon, return the center point.</p>

<p>Args:
    polygon_points (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    Point: Center point of the polygon.</p>
</div>


                </section>
                <section id="offset_polygon">
                            <input id="offset_polygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_polygon</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="offset_polygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_polygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_polygon-915"><a href="#offset_polygon-915"><span class="linenos">915</span></a><span class="k">def</span> <span class="nf">offset_polygon</span><span class="p">(</span>
</span><span id="offset_polygon-916"><a href="#offset_polygon-916"><span class="linenos">916</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="offset_polygon-917"><a href="#offset_polygon-917"><span class="linenos">917</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="offset_polygon-918"><a href="#offset_polygon-918"><span class="linenos">918</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="offset_polygon-919"><a href="#offset_polygon-919"><span class="linenos">919</span></a><span class="sd">    Return a list of offset lines from a list of lines.</span>
</span><span id="offset_polygon-920"><a href="#offset_polygon-920"><span class="linenos">920</span></a>
</span><span id="offset_polygon-921"><a href="#offset_polygon-921"><span class="linenos">921</span></a><span class="sd">    Args:</span>
</span><span id="offset_polygon-922"><a href="#offset_polygon-922"><span class="linenos">922</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="offset_polygon-923"><a href="#offset_polygon-923"><span class="linenos">923</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to -1.</span>
</span><span id="offset_polygon-924"><a href="#offset_polygon-924"><span class="linenos">924</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="offset_polygon-925"><a href="#offset_polygon-925"><span class="linenos">925</span></a>
</span><span id="offset_polygon-926"><a href="#offset_polygon-926"><span class="linenos">926</span></a><span class="sd">    Returns:</span>
</span><span id="offset_polygon-927"><a href="#offset_polygon-927"><span class="linenos">927</span></a><span class="sd">        list[Point]: List of offset lines.</span>
</span><span id="offset_polygon-928"><a href="#offset_polygon-928"><span class="linenos">928</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_polygon-929"><a href="#offset_polygon-929"><span class="linenos">929</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="offset_polygon-930"><a href="#offset_polygon-930"><span class="linenos">930</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="offset_polygon-931"><a href="#offset_polygon-931"><span class="linenos">931</span></a>    <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:])</span>
</span><span id="offset_polygon-932"><a href="#offset_polygon-932"><span class="linenos">932</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="offset_polygon-933"><a href="#offset_polygon-933"><span class="linenos">933</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="offset_polygon-934"><a href="#offset_polygon-934"><span class="linenos">934</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="offset_polygon-935"><a href="#offset_polygon-935"><span class="linenos">935</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="offset_polygon-936"><a href="#offset_polygon-936"><span class="linenos">936</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="offset_polygon-937"><a href="#offset_polygon-937"><span class="linenos">937</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="offset_polygon-938"><a href="#offset_polygon-938"><span class="linenos">938</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="offset_polygon-939"><a href="#offset_polygon-939"><span class="linenos">939</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="offset_polygon-940"><a href="#offset_polygon-940"><span class="linenos">940</span></a>        <span class="n">offset_edge</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">-</span><span class="n">offset</span><span class="p">)</span>
</span><span id="offset_polygon-941"><a href="#offset_polygon-941"><span class="linenos">941</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_edge</span><span class="p">)</span>
</span><span id="offset_polygon-942"><a href="#offset_polygon-942"><span class="linenos">942</span></a>
</span><span id="offset_polygon-943"><a href="#offset_polygon-943"><span class="linenos">943</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="offset_polygon-944"><a href="#offset_polygon-944"><span class="linenos">944</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of offset lines from a list of lines.</p>

<p>Args:
    polygon (list[Point]): List of points representing the polygon.
    offset (float, optional): Offset distance. Defaults to -1.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of offset lines.</p>
</div>


                </section>
                <section id="double_offset_polygons">
                            <input id="double_offset_polygons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">double_offset_polygons</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="double_offset_polygons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#double_offset_polygons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="double_offset_polygons-947"><a href="#double_offset_polygons-947"><span class="linenos">947</span></a><span class="k">def</span> <span class="nf">double_offset_polygons</span><span class="p">(</span>
</span><span id="double_offset_polygons-948"><a href="#double_offset_polygons-948"><span class="linenos">948</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="double_offset_polygons-949"><a href="#double_offset_polygons-949"><span class="linenos">949</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="double_offset_polygons-950"><a href="#double_offset_polygons-950"><span class="linenos">950</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="double_offset_polygons-951"><a href="#double_offset_polygons-951"><span class="linenos">951</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="double_offset_polygons-952"><a href="#double_offset_polygons-952"><span class="linenos">952</span></a>
</span><span id="double_offset_polygons-953"><a href="#double_offset_polygons-953"><span class="linenos">953</span></a><span class="sd">    Args:</span>
</span><span id="double_offset_polygons-954"><a href="#double_offset_polygons-954"><span class="linenos">954</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="double_offset_polygons-955"><a href="#double_offset_polygons-955"><span class="linenos">955</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="double_offset_polygons-956"><a href="#double_offset_polygons-956"><span class="linenos">956</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="double_offset_polygons-957"><a href="#double_offset_polygons-957"><span class="linenos">957</span></a>
</span><span id="double_offset_polygons-958"><a href="#double_offset_polygons-958"><span class="linenos">958</span></a><span class="sd">    Returns:</span>
</span><span id="double_offset_polygons-959"><a href="#double_offset_polygons-959"><span class="linenos">959</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="double_offset_polygons-960"><a href="#double_offset_polygons-960"><span class="linenos">960</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="double_offset_polygons-961"><a href="#double_offset_polygons-961"><span class="linenos">961</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="double_offset_polygons-962"><a href="#double_offset_polygons-962"><span class="linenos">962</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="double_offset_polygons-963"><a href="#double_offset_polygons-963"><span class="linenos">963</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="double_offset_polygons-964"><a href="#double_offset_polygons-964"><span class="linenos">964</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="double_offset_polygons-965"><a href="#double_offset_polygons-965"><span class="linenos">965</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="double_offset_polygons-966"><a href="#double_offset_polygons-966"><span class="linenos">966</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="double_offset_polygons-967"><a href="#double_offset_polygons-967"><span class="linenos">967</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="double_offset_polygons-968"><a href="#double_offset_polygons-968"><span class="linenos">968</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="double_offset_polygons-969"><a href="#double_offset_polygons-969"><span class="linenos">969</span></a>        <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="double_offset_polygons-970"><a href="#double_offset_polygons-970"><span class="linenos">970</span></a>        <span class="n">poly1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="double_offset_polygons-971"><a href="#double_offset_polygons-971"><span class="linenos">971</span></a>        <span class="n">poly2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
</span><span id="double_offset_polygons-972"><a href="#double_offset_polygons-972"><span class="linenos">972</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="double_offset_polygons-973"><a href="#double_offset_polygons-973"><span class="linenos">973</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="double_offset_polygons-974"><a href="#double_offset_polygons-974"><span class="linenos">974</span></a>    <span class="k">if</span> <span class="s2">&quot;canvas&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="double_offset_polygons-975"><a href="#double_offset_polygons-975"><span class="linenos">975</span></a>        <span class="n">canvas</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;canvas&quot;</span><span class="p">]</span>
</span><span id="double_offset_polygons-976"><a href="#double_offset_polygons-976"><span class="linenos">976</span></a>        <span class="k">if</span> <span class="n">canvas</span><span class="p">:</span>
</span><span id="double_offset_polygons-977"><a href="#double_offset_polygons-977"><span class="linenos">977</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
</span><span id="double_offset_polygons-978"><a href="#double_offset_polygons-978"><span class="linenos">978</span></a>            <span class="kn">from</span> <span class="nn">..graphics.shape</span> <span class="kn">import</span> <span class="n">Shape</span>
</span><span id="double_offset_polygons-979"><a href="#double_offset_polygons-979"><span class="linenos">979</span></a>
</span><span id="double_offset_polygons-980"><a href="#double_offset_polygons-980"><span class="linenos">980</span></a>            <span class="n">closed</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="double_offset_polygons-981"><a href="#double_offset_polygons-981"><span class="linenos">981</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Shape</span><span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="double_offset_polygons-982"><a href="#double_offset_polygons-982"><span class="linenos">982</span></a>            <span class="n">closed</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="double_offset_polygons-983"><a href="#double_offset_polygons-983"><span class="linenos">983</span></a>            <span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Shape</span><span class="p">(</span><span class="n">poly2</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">closed</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="double_offset_polygons-984"><a href="#double_offset_polygons-984"><span class="linenos">984</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of double offset lines from a list of lines.</p>

<p>Args:
    polygon (list[Point]): List of points representing the polygon.
    offset (float, optional): Offset distance. Defaults to 1.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of double offset lines.</p>
</div>


                </section>
                <section id="offset_polygon_points">
                            <input id="offset_polygon_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_polygon_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="offset_polygon_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_polygon_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_polygon_points-987"><a href="#offset_polygon_points-987"><span class="linenos"> 987</span></a><span class="k">def</span> <span class="nf">offset_polygon_points</span><span class="p">(</span>
</span><span id="offset_polygon_points-988"><a href="#offset_polygon_points-988"><span class="linenos"> 988</span></a>    <span class="n">polygon</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="offset_polygon_points-989"><a href="#offset_polygon_points-989"><span class="linenos"> 989</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="offset_polygon_points-990"><a href="#offset_polygon_points-990"><span class="linenos"> 990</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="offset_polygon_points-991"><a href="#offset_polygon_points-991"><span class="linenos"> 991</span></a><span class="sd">    Return a list of double offset lines from a list of lines.</span>
</span><span id="offset_polygon_points-992"><a href="#offset_polygon_points-992"><span class="linenos"> 992</span></a>
</span><span id="offset_polygon_points-993"><a href="#offset_polygon_points-993"><span class="linenos"> 993</span></a><span class="sd">    Args:</span>
</span><span id="offset_polygon_points-994"><a href="#offset_polygon_points-994"><span class="linenos"> 994</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="offset_polygon_points-995"><a href="#offset_polygon_points-995"><span class="linenos"> 995</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="offset_polygon_points-996"><a href="#offset_polygon_points-996"><span class="linenos"> 996</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="offset_polygon_points-997"><a href="#offset_polygon_points-997"><span class="linenos"> 997</span></a>
</span><span id="offset_polygon_points-998"><a href="#offset_polygon_points-998"><span class="linenos"> 998</span></a><span class="sd">    Returns:</span>
</span><span id="offset_polygon_points-999"><a href="#offset_polygon_points-999"><span class="linenos"> 999</span></a><span class="sd">        list[Point]: List of double offset lines.</span>
</span><span id="offset_polygon_points-1000"><a href="#offset_polygon_points-1000"><span class="linenos">1000</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_polygon_points-1001"><a href="#offset_polygon_points-1001"><span class="linenos">1001</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="offset_polygon_points-1002"><a href="#offset_polygon_points-1002"><span class="linenos">1002</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="offset_polygon_points-1003"><a href="#offset_polygon_points-1003"><span class="linenos">1003</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="offset_polygon_points-1004"><a href="#offset_polygon_points-1004"><span class="linenos">1004</span></a>    <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="offset_polygon_points-1005"><a href="#offset_polygon_points-1005"><span class="linenos">1005</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="offset_polygon_points-1006"><a href="#offset_polygon_points-1006"><span class="linenos">1006</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="offset_polygon_points-1007"><a href="#offset_polygon_points-1007"><span class="linenos">1007</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="offset_polygon_points-1008"><a href="#offset_polygon_points-1008"><span class="linenos">1008</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="offset_polygon_points-1009"><a href="#offset_polygon_points-1009"><span class="linenos">1009</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="offset_polygon_points-1010"><a href="#offset_polygon_points-1010"><span class="linenos">1010</span></a>        <span class="n">offset_edge</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="offset_polygon_points-1011"><a href="#offset_polygon_points-1011"><span class="linenos">1011</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_edge</span><span class="p">)</span>
</span><span id="offset_polygon_points-1012"><a href="#offset_polygon_points-1012"><span class="linenos">1012</span></a>
</span><span id="offset_polygon_points-1013"><a href="#offset_polygon_points-1013"><span class="linenos">1013</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
</span><span id="offset_polygon_points-1014"><a href="#offset_polygon_points-1014"><span class="linenos">1014</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">right_handed</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
</span><span id="offset_polygon_points-1015"><a href="#offset_polygon_points-1015"><span class="linenos">1015</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="offset_polygon_points-1016"><a href="#offset_polygon_points-1016"><span class="linenos">1016</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of double offset lines from a list of lines.</p>

<p>Args:
    polygon (list[Point]): List of points representing the polygon.
    offset (float, optional): Offset distance. Defaults to 1.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of double offset lines.</p>
</div>


                </section>
                <section id="double_offset_lines">
                            <input id="double_offset_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">double_offset_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="double_offset_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#double_offset_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="double_offset_lines-1019"><a href="#double_offset_lines-1019"><span class="linenos">1019</span></a><span class="k">def</span> <span class="nf">double_offset_lines</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Line</span><span class="p">,</span> <span class="n">Line</span><span class="p">]:</span>
</span><span id="double_offset_lines-1020"><a href="#double_offset_lines-1020"><span class="linenos">1020</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="double_offset_lines-1021"><a href="#double_offset_lines-1021"><span class="linenos">1021</span></a><span class="sd">    Return two offset lines to a given line segment with the given offset amount.</span>
</span><span id="double_offset_lines-1022"><a href="#double_offset_lines-1022"><span class="linenos">1022</span></a>
</span><span id="double_offset_lines-1023"><a href="#double_offset_lines-1023"><span class="linenos">1023</span></a><span class="sd">    Args:</span>
</span><span id="double_offset_lines-1024"><a href="#double_offset_lines-1024"><span class="linenos">1024</span></a><span class="sd">        line (Line): Input line segment.</span>
</span><span id="double_offset_lines-1025"><a href="#double_offset_lines-1025"><span class="linenos">1025</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="double_offset_lines-1026"><a href="#double_offset_lines-1026"><span class="linenos">1026</span></a>
</span><span id="double_offset_lines-1027"><a href="#double_offset_lines-1027"><span class="linenos">1027</span></a><span class="sd">    Returns:</span>
</span><span id="double_offset_lines-1028"><a href="#double_offset_lines-1028"><span class="linenos">1028</span></a><span class="sd">        tuple[Line, Line]: Two offset lines.</span>
</span><span id="double_offset_lines-1029"><a href="#double_offset_lines-1029"><span class="linenos">1029</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="double_offset_lines-1030"><a href="#double_offset_lines-1030"><span class="linenos">1030</span></a>    <span class="n">line1</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="double_offset_lines-1031"><a href="#double_offset_lines-1031"><span class="linenos">1031</span></a>    <span class="n">line2</span> <span class="o">=</span> <span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">-</span><span class="n">offset</span><span class="p">)</span>
</span><span id="double_offset_lines-1032"><a href="#double_offset_lines-1032"><span class="linenos">1032</span></a>
</span><span id="double_offset_lines-1033"><a href="#double_offset_lines-1033"><span class="linenos">1033</span></a>    <span class="k">return</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span>
</span></pre></div>


            <div class="docstring"><p>Return two offset lines to a given line segment with the given offset amount.</p>

<p>Args:
    line (Line): Input line segment.
    offset (float, optional): Offset distance. Defaults to 1.</p>

<p>Returns:
    tuple[Line, Line]: Two offset lines.</p>
</div>


                </section>
                <section id="equal_lines">
                            <input id="equal_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equal_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">line2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="equal_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#equal_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="equal_lines-1036"><a href="#equal_lines-1036"><span class="linenos">1036</span></a><span class="k">def</span> <span class="nf">equal_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="equal_lines-1037"><a href="#equal_lines-1037"><span class="linenos">1037</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="equal_lines-1038"><a href="#equal_lines-1038"><span class="linenos">1038</span></a><span class="sd">    Return True if two lines are close enough.</span>
</span><span id="equal_lines-1039"><a href="#equal_lines-1039"><span class="linenos">1039</span></a>
</span><span id="equal_lines-1040"><a href="#equal_lines-1040"><span class="linenos">1040</span></a><span class="sd">    Args:</span>
</span><span id="equal_lines-1041"><a href="#equal_lines-1041"><span class="linenos">1041</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="equal_lines-1042"><a href="#equal_lines-1042"><span class="linenos">1042</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="equal_lines-1043"><a href="#equal_lines-1043"><span class="linenos">1043</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="equal_lines-1044"><a href="#equal_lines-1044"><span class="linenos">1044</span></a>
</span><span id="equal_lines-1045"><a href="#equal_lines-1045"><span class="linenos">1045</span></a><span class="sd">    Returns:</span>
</span><span id="equal_lines-1046"><a href="#equal_lines-1046"><span class="linenos">1046</span></a><span class="sd">        bool: True if the lines are close enough, False otherwise.</span>
</span><span id="equal_lines-1047"><a href="#equal_lines-1047"><span class="linenos">1047</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="equal_lines-1048"><a href="#equal_lines-1048"><span class="linenos">1048</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="equal_lines-1049"><a href="#equal_lines-1049"><span class="linenos">1049</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="equal_lines-1050"><a href="#equal_lines-1050"><span class="linenos">1050</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="equal_lines-1051"><a href="#equal_lines-1051"><span class="linenos">1051</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line1</span>
</span><span id="equal_lines-1052"><a href="#equal_lines-1052"><span class="linenos">1052</span></a>    <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="equal_lines-1053"><a href="#equal_lines-1053"><span class="linenos">1053</span></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="equal_lines-1054"><a href="#equal_lines-1054"><span class="linenos">1054</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="equal_lines-1055"><a href="#equal_lines-1055"><span class="linenos">1055</span></a>        <span class="ow">and</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="equal_lines-1056"><a href="#equal_lines-1056"><span class="linenos">1056</span></a>    <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="equal_lines-1057"><a href="#equal_lines-1057"><span class="linenos">1057</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="equal_lines-1058"><a href="#equal_lines-1058"><span class="linenos">1058</span></a>        <span class="ow">and</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="equal_lines-1059"><a href="#equal_lines-1059"><span class="linenos">1059</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if two lines are close enough.</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the lines are close enough, False otherwise.</p>
</div>


                </section>
                <section id="equal_polygons">
                            <input id="equal_polygons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equal_polygons</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">poly1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">poly2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="equal_polygons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#equal_polygons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="equal_polygons-1062"><a href="#equal_polygons-1062"><span class="linenos">1062</span></a><span class="k">def</span> <span class="nf">equal_polygons</span><span class="p">(</span>
</span><span id="equal_polygons-1063"><a href="#equal_polygons-1063"><span class="linenos">1063</span></a>    <span class="n">poly1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">poly2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="equal_polygons-1064"><a href="#equal_polygons-1064"><span class="linenos">1064</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="equal_polygons-1065"><a href="#equal_polygons-1065"><span class="linenos">1065</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="equal_polygons-1066"><a href="#equal_polygons-1066"><span class="linenos">1066</span></a><span class="sd">    Return True if two polygons are close enough.</span>
</span><span id="equal_polygons-1067"><a href="#equal_polygons-1067"><span class="linenos">1067</span></a>
</span><span id="equal_polygons-1068"><a href="#equal_polygons-1068"><span class="linenos">1068</span></a><span class="sd">    Args:</span>
</span><span id="equal_polygons-1069"><a href="#equal_polygons-1069"><span class="linenos">1069</span></a><span class="sd">        poly1 (Sequence[Point]): First polygon.</span>
</span><span id="equal_polygons-1070"><a href="#equal_polygons-1070"><span class="linenos">1070</span></a><span class="sd">        poly2 (Sequence[Point]): Second polygon.</span>
</span><span id="equal_polygons-1071"><a href="#equal_polygons-1071"><span class="linenos">1071</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="equal_polygons-1072"><a href="#equal_polygons-1072"><span class="linenos">1072</span></a>
</span><span id="equal_polygons-1073"><a href="#equal_polygons-1073"><span class="linenos">1073</span></a><span class="sd">    Returns:</span>
</span><span id="equal_polygons-1074"><a href="#equal_polygons-1074"><span class="linenos">1074</span></a><span class="sd">        bool: True if the polygons are close enough, False otherwise.</span>
</span><span id="equal_polygons-1075"><a href="#equal_polygons-1075"><span class="linenos">1075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="equal_polygons-1076"><a href="#equal_polygons-1076"><span class="linenos">1076</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="equal_polygons-1077"><a href="#equal_polygons-1077"><span class="linenos">1077</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="equal_polygons-1078"><a href="#equal_polygons-1078"><span class="linenos">1078</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly2</span><span class="p">):</span>
</span><span id="equal_polygons-1079"><a href="#equal_polygons-1079"><span class="linenos">1079</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_polygons-1080"><a href="#equal_polygons-1080"><span class="linenos">1080</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="equal_polygons-1081"><a href="#equal_polygons-1081"><span class="linenos">1081</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">poly1</span><span class="p">):</span>
</span><span id="equal_polygons-1082"><a href="#equal_polygons-1082"><span class="linenos">1082</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">pnt</span><span class="p">,</span> <span class="n">poly2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="equal_polygons-1083"><a href="#equal_polygons-1083"><span class="linenos">1083</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_polygons-1084"><a href="#equal_polygons-1084"><span class="linenos">1084</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Return True if two polygons are close enough.</p>

<p>Args:
    poly1 (Sequence[Point]): First polygon.
    poly2 (Sequence[Point]): Second polygon.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the polygons are close enough, False otherwise.</p>
</div>


                </section>
                <section id="extended_line">
                            <input id="extended_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extended_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dist</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">extend_both</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="extended_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#extended_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="extended_line-1087"><a href="#extended_line-1087"><span class="linenos">1087</span></a><span class="k">def</span> <span class="nf">extended_line</span><span class="p">(</span><span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">extend_both</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="extended_line-1088"><a href="#extended_line-1088"><span class="linenos">1088</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="extended_line-1089"><a href="#extended_line-1089"><span class="linenos">1089</span></a><span class="sd">    Given a line ((x1, y1), (x2, y2)) and a distance,</span>
</span><span id="extended_line-1090"><a href="#extended_line-1090"><span class="linenos">1090</span></a><span class="sd">    the given line is extended by distance units.</span>
</span><span id="extended_line-1091"><a href="#extended_line-1091"><span class="linenos">1091</span></a><span class="sd">    Return a new line ((x1, y1), (x2&#39;, y2&#39;)).</span>
</span><span id="extended_line-1092"><a href="#extended_line-1092"><span class="linenos">1092</span></a>
</span><span id="extended_line-1093"><a href="#extended_line-1093"><span class="linenos">1093</span></a><span class="sd">    Args:</span>
</span><span id="extended_line-1094"><a href="#extended_line-1094"><span class="linenos">1094</span></a><span class="sd">        dist (float): Distance to extend the line.</span>
</span><span id="extended_line-1095"><a href="#extended_line-1095"><span class="linenos">1095</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="extended_line-1096"><a href="#extended_line-1096"><span class="linenos">1096</span></a><span class="sd">        extend_both (bool, optional): Whether to extend both ends of the line. Defaults to False.</span>
</span><span id="extended_line-1097"><a href="#extended_line-1097"><span class="linenos">1097</span></a>
</span><span id="extended_line-1098"><a href="#extended_line-1098"><span class="linenos">1098</span></a><span class="sd">    Returns:</span>
</span><span id="extended_line-1099"><a href="#extended_line-1099"><span class="linenos">1099</span></a><span class="sd">        Line: Extended line.</span>
</span><span id="extended_line-1100"><a href="#extended_line-1100"><span class="linenos">1100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="extended_line-1101"><a href="#extended_line-1101"><span class="linenos">1101</span></a>
</span><span id="extended_line-1102"><a href="#extended_line-1102"><span class="linenos">1102</span></a>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
</span><span id="extended_line-1103"><a href="#extended_line-1103"><span class="linenos">1103</span></a>        <span class="c1"># p = (1-t)*p1 + t*p2 : parametric equation of a line segment (p1, p2)</span>
</span><span id="extended_line-1104"><a href="#extended_line-1104"><span class="linenos">1104</span></a>        <span class="n">line_length</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="extended_line-1105"><a href="#extended_line-1105"><span class="linenos">1105</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_length</span> <span class="o">+</span> <span class="n">dist</span><span class="p">)</span> <span class="o">/</span> <span class="n">line_length</span>
</span><span id="extended_line-1106"><a href="#extended_line-1106"><span class="linenos">1106</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="extended_line-1107"><a href="#extended_line-1107"><span class="linenos">1107</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="extended_line-1108"><a href="#extended_line-1108"><span class="linenos">1108</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="extended_line-1109"><a href="#extended_line-1109"><span class="linenos">1109</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span>
</span><span id="extended_line-1110"><a href="#extended_line-1110"><span class="linenos">1110</span></a>
</span><span id="extended_line-1111"><a href="#extended_line-1111"><span class="linenos">1111</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">x2</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">y2</span><span class="p">)]</span>
</span><span id="extended_line-1112"><a href="#extended_line-1112"><span class="linenos">1112</span></a>
</span><span id="extended_line-1113"><a href="#extended_line-1113"><span class="linenos">1113</span></a>    <span class="k">if</span> <span class="n">extend_both</span><span class="p">:</span>
</span><span id="extended_line-1114"><a href="#extended_line-1114"><span class="linenos">1114</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="extended_line-1115"><a href="#extended_line-1115"><span class="linenos">1115</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">])</span>
</span><span id="extended_line-1116"><a href="#extended_line-1116"><span class="linenos">1116</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">]</span>
</span><span id="extended_line-1117"><a href="#extended_line-1117"><span class="linenos">1117</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="extended_line-1118"><a href="#extended_line-1118"><span class="linenos">1118</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">extend</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="extended_line-1119"><a href="#extended_line-1119"><span class="linenos">1119</span></a>
</span><span id="extended_line-1120"><a href="#extended_line-1120"><span class="linenos">1120</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Given a line ((x1, y1), (x2, y2)) and a distance,
the given line is extended by distance units.
Return a new line ((x1, y1), (x2', y2')).</p>

<p>Args:
    dist (float): Distance to extend the line.
    line (Line): Input line.
    extend_both (bool, optional): Whether to extend both ends of the line. Defaults to False.</p>

<p>Returns:
    Line: Extended line.</p>
</div>


                </section>
                <section id="line_through_point_angle">
                            <input id="line_through_point_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_through_point_angle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">length_</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">both_sides</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="line_through_point_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_through_point_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_through_point_angle-1123"><a href="#line_through_point_angle-1123"><span class="linenos">1123</span></a><span class="k">def</span> <span class="nf">line_through_point_angle</span><span class="p">(</span>
</span><span id="line_through_point_angle-1124"><a href="#line_through_point_angle-1124"><span class="linenos">1124</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">length_</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">both_sides</span><span class="o">=</span><span class="kc">False</span>
</span><span id="line_through_point_angle-1125"><a href="#line_through_point_angle-1125"><span class="linenos">1125</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="line_through_point_angle-1126"><a href="#line_through_point_angle-1126"><span class="linenos">1126</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line_through_point_angle-1127"><a href="#line_through_point_angle-1127"><span class="linenos">1127</span></a><span class="sd">    Return a line that passes through the given point</span>
</span><span id="line_through_point_angle-1128"><a href="#line_through_point_angle-1128"><span class="linenos">1128</span></a><span class="sd">    with the given angle and length.</span>
</span><span id="line_through_point_angle-1129"><a href="#line_through_point_angle-1129"><span class="linenos">1129</span></a><span class="sd">    If both_side is True, the line is extended on both sides by the given</span>
</span><span id="line_through_point_angle-1130"><a href="#line_through_point_angle-1130"><span class="linenos">1130</span></a><span class="sd">    length.</span>
</span><span id="line_through_point_angle-1131"><a href="#line_through_point_angle-1131"><span class="linenos">1131</span></a>
</span><span id="line_through_point_angle-1132"><a href="#line_through_point_angle-1132"><span class="linenos">1132</span></a><span class="sd">    Args:</span>
</span><span id="line_through_point_angle-1133"><a href="#line_through_point_angle-1133"><span class="linenos">1133</span></a><span class="sd">        point (Point): Point through which the line passes.</span>
</span><span id="line_through_point_angle-1134"><a href="#line_through_point_angle-1134"><span class="linenos">1134</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="line_through_point_angle-1135"><a href="#line_through_point_angle-1135"><span class="linenos">1135</span></a><span class="sd">        length_ (float): Length of the line.</span>
</span><span id="line_through_point_angle-1136"><a href="#line_through_point_angle-1136"><span class="linenos">1136</span></a><span class="sd">        both_sides (bool, optional): Whether to extend the line on both sides. Defaults to False.</span>
</span><span id="line_through_point_angle-1137"><a href="#line_through_point_angle-1137"><span class="linenos">1137</span></a>
</span><span id="line_through_point_angle-1138"><a href="#line_through_point_angle-1138"><span class="linenos">1138</span></a><span class="sd">    Returns:</span>
</span><span id="line_through_point_angle-1139"><a href="#line_through_point_angle-1139"><span class="linenos">1139</span></a><span class="sd">        Line: Line passing through the given point with the given angle and length.</span>
</span><span id="line_through_point_angle-1140"><a href="#line_through_point_angle-1140"><span class="linenos">1140</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_through_point_angle-1141"><a href="#line_through_point_angle-1141"><span class="linenos">1141</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="line_through_point_angle-1142"><a href="#line_through_point_angle-1142"><span class="linenos">1142</span></a>    <span class="n">line</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))]</span>
</span><span id="line_through_point_angle-1143"><a href="#line_through_point_angle-1143"><span class="linenos">1143</span></a>    <span class="k">if</span> <span class="n">both_sides</span><span class="p">:</span>
</span><span id="line_through_point_angle-1144"><a href="#line_through_point_angle-1144"><span class="linenos">1144</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="line_through_point_angle-1145"><a href="#line_through_point_angle-1145"><span class="linenos">1145</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="n">extended_line</span><span class="p">(</span><span class="n">length_</span><span class="p">,</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">])</span>
</span><span id="line_through_point_angle-1146"><a href="#line_through_point_angle-1146"><span class="linenos">1146</span></a>
</span><span id="line_through_point_angle-1147"><a href="#line_through_point_angle-1147"><span class="linenos">1147</span></a>    <span class="k">return</span> <span class="n">line</span>
</span></pre></div>


            <div class="docstring"><p>Return a line that passes through the given point
with the given angle and length.
If both_side is True, the line is extended on both sides by the given
length.</p>

<p>Args:
    point (Point): Point through which the line passes.
    angle (float): Angle of the line in radians.
    length_ (float): Length of the line.
    both_sides (bool, optional): Whether to extend the line on both sides. Defaults to False.</p>

<p>Returns:
    Line: Line passing through the given point with the given angle and length.</p>
</div>


                </section>
                <section id="remove_duplicate_points">
                            <input id="remove_duplicate_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_duplicate_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="remove_duplicate_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_duplicate_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_duplicate_points-1150"><a href="#remove_duplicate_points-1150"><span class="linenos">1150</span></a><span class="k">def</span> <span class="nf">remove_duplicate_points</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="remove_duplicate_points-1151"><a href="#remove_duplicate_points-1151"><span class="linenos">1151</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="remove_duplicate_points-1152"><a href="#remove_duplicate_points-1152"><span class="linenos">1152</span></a><span class="sd">    Return a list of points with duplicate points removed.</span>
</span><span id="remove_duplicate_points-1153"><a href="#remove_duplicate_points-1153"><span class="linenos">1153</span></a>
</span><span id="remove_duplicate_points-1154"><a href="#remove_duplicate_points-1154"><span class="linenos">1154</span></a><span class="sd">    Args:</span>
</span><span id="remove_duplicate_points-1155"><a href="#remove_duplicate_points-1155"><span class="linenos">1155</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="remove_duplicate_points-1156"><a href="#remove_duplicate_points-1156"><span class="linenos">1156</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="remove_duplicate_points-1157"><a href="#remove_duplicate_points-1157"><span class="linenos">1157</span></a>
</span><span id="remove_duplicate_points-1158"><a href="#remove_duplicate_points-1158"><span class="linenos">1158</span></a><span class="sd">    Returns:</span>
</span><span id="remove_duplicate_points-1159"><a href="#remove_duplicate_points-1159"><span class="linenos">1159</span></a><span class="sd">        list[Point]: List of points with duplicate points removed.</span>
</span><span id="remove_duplicate_points-1160"><a href="#remove_duplicate_points-1160"><span class="linenos">1160</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="remove_duplicate_points-1161"><a href="#remove_duplicate_points-1161"><span class="linenos">1161</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="remove_duplicate_points-1162"><a href="#remove_duplicate_points-1162"><span class="linenos">1162</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="remove_duplicate_points-1163"><a href="#remove_duplicate_points-1163"><span class="linenos">1163</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="remove_duplicate_points-1164"><a href="#remove_duplicate_points-1164"><span class="linenos">1164</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="remove_duplicate_points-1165"><a href="#remove_duplicate_points-1165"><span class="linenos">1165</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="remove_duplicate_points-1166"><a href="#remove_duplicate_points-1166"><span class="linenos">1166</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="remove_duplicate_points-1167"><a href="#remove_duplicate_points-1167"><span class="linenos">1167</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="remove_duplicate_points-1168"><a href="#remove_duplicate_points-1168"><span class="linenos">1168</span></a>            <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="remove_duplicate_points-1169"><a href="#remove_duplicate_points-1169"><span class="linenos">1169</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="remove_duplicate_points-1170"><a href="#remove_duplicate_points-1170"><span class="linenos">1170</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="remove_duplicate_points-1171"><a href="#remove_duplicate_points-1171"><span class="linenos">1171</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of points with duplicate points removed.</p>

<p>Args:
    points (list[Point]): List of points.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of points with duplicate points removed.</p>
</div>


                </section>
                <section id="remove_collinear_points">
                            <input id="remove_collinear_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_collinear_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="remove_collinear_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_collinear_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_collinear_points-1174"><a href="#remove_collinear_points-1174"><span class="linenos">1174</span></a><span class="k">def</span> <span class="nf">remove_collinear_points</span><span class="p">(</span>
</span><span id="remove_collinear_points-1175"><a href="#remove_collinear_points-1175"><span class="linenos">1175</span></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="remove_collinear_points-1176"><a href="#remove_collinear_points-1176"><span class="linenos">1176</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="remove_collinear_points-1177"><a href="#remove_collinear_points-1177"><span class="linenos">1177</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="remove_collinear_points-1178"><a href="#remove_collinear_points-1178"><span class="linenos">1178</span></a><span class="sd">    Return a list of points with collinear points removed.</span>
</span><span id="remove_collinear_points-1179"><a href="#remove_collinear_points-1179"><span class="linenos">1179</span></a>
</span><span id="remove_collinear_points-1180"><a href="#remove_collinear_points-1180"><span class="linenos">1180</span></a><span class="sd">    Args:</span>
</span><span id="remove_collinear_points-1181"><a href="#remove_collinear_points-1181"><span class="linenos">1181</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="remove_collinear_points-1182"><a href="#remove_collinear_points-1182"><span class="linenos">1182</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="remove_collinear_points-1183"><a href="#remove_collinear_points-1183"><span class="linenos">1183</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="remove_collinear_points-1184"><a href="#remove_collinear_points-1184"><span class="linenos">1184</span></a>
</span><span id="remove_collinear_points-1185"><a href="#remove_collinear_points-1185"><span class="linenos">1185</span></a><span class="sd">    Returns:</span>
</span><span id="remove_collinear_points-1186"><a href="#remove_collinear_points-1186"><span class="linenos">1186</span></a><span class="sd">        list[Point]: List of points with collinear points removed.</span>
</span><span id="remove_collinear_points-1187"><a href="#remove_collinear_points-1187"><span class="linenos">1187</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="remove_collinear_points-1188"><a href="#remove_collinear_points-1188"><span class="linenos">1188</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="remove_collinear_points-1189"><a href="#remove_collinear_points-1189"><span class="linenos">1189</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="remove_collinear_points-1190"><a href="#remove_collinear_points-1190"><span class="linenos">1190</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="remove_collinear_points-1191"><a href="#remove_collinear_points-1191"><span class="linenos">1191</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="remove_collinear_points-1192"><a href="#remove_collinear_points-1192"><span class="linenos">1192</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="remove_collinear_points-1193"><a href="#remove_collinear_points-1193"><span class="linenos">1193</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="remove_collinear_points-1194"><a href="#remove_collinear_points-1194"><span class="linenos">1194</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">collinear</span><span class="p">(</span>
</span><span id="remove_collinear_points-1195"><a href="#remove_collinear_points-1195"><span class="linenos">1195</span></a>                <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">,</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)],</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="remove_collinear_points-1196"><a href="#remove_collinear_points-1196"><span class="linenos">1196</span></a>            <span class="p">):</span>
</span><span id="remove_collinear_points-1197"><a href="#remove_collinear_points-1197"><span class="linenos">1197</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="remove_collinear_points-1198"><a href="#remove_collinear_points-1198"><span class="linenos">1198</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of points with collinear points removed.</p>

<p>Args:
    points (list[Point]): List of points.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    list[Point]: List of points with collinear points removed.</p>
</div>


                </section>
                <section id="fix_degen_points">
                            <input id="fix_degen_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fix_degen_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">loop</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">closed</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">area_rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">check_collinear</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="fix_degen_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fix_degen_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fix_degen_points-1201"><a href="#fix_degen_points-1201"><span class="linenos">1201</span></a><span class="k">def</span> <span class="nf">fix_degen_points</span><span class="p">(</span>
</span><span id="fix_degen_points-1202"><a href="#fix_degen_points-1202"><span class="linenos">1202</span></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="fix_degen_points-1203"><a href="#fix_degen_points-1203"><span class="linenos">1203</span></a>    <span class="n">loop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="fix_degen_points-1204"><a href="#fix_degen_points-1204"><span class="linenos">1204</span></a>    <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="fix_degen_points-1205"><a href="#fix_degen_points-1205"><span class="linenos">1205</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="fix_degen_points-1206"><a href="#fix_degen_points-1206"><span class="linenos">1206</span></a>    <span class="n">area_rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="fix_degen_points-1207"><a href="#fix_degen_points-1207"><span class="linenos">1207</span></a>    <span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="fix_degen_points-1208"><a href="#fix_degen_points-1208"><span class="linenos">1208</span></a>    <span class="n">check_collinear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="fix_degen_points-1209"><a href="#fix_degen_points-1209"><span class="linenos">1209</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="fix_degen_points-1210"><a href="#fix_degen_points-1210"><span class="linenos">1210</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="fix_degen_points-1211"><a href="#fix_degen_points-1211"><span class="linenos">1211</span></a><span class="sd">    Return a list of points with duplicate points removed.</span>
</span><span id="fix_degen_points-1212"><a href="#fix_degen_points-1212"><span class="linenos">1212</span></a><span class="sd">    Remove the middle point from the collinear points.</span>
</span><span id="fix_degen_points-1213"><a href="#fix_degen_points-1213"><span class="linenos">1213</span></a>
</span><span id="fix_degen_points-1214"><a href="#fix_degen_points-1214"><span class="linenos">1214</span></a><span class="sd">    Args:</span>
</span><span id="fix_degen_points-1215"><a href="#fix_degen_points-1215"><span class="linenos">1215</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="fix_degen_points-1216"><a href="#fix_degen_points-1216"><span class="linenos">1216</span></a><span class="sd">        loop (bool, optional): Whether to loop the points. Defaults to False.</span>
</span><span id="fix_degen_points-1217"><a href="#fix_degen_points-1217"><span class="linenos">1217</span></a><span class="sd">        closed (bool, optional): Whether the points form a closed shape. Defaults to False.</span>
</span><span id="fix_degen_points-1218"><a href="#fix_degen_points-1218"><span class="linenos">1218</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="fix_degen_points-1219"><a href="#fix_degen_points-1219"><span class="linenos">1219</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="fix_degen_points-1220"><a href="#fix_degen_points-1220"><span class="linenos">1220</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="fix_degen_points-1221"><a href="#fix_degen_points-1221"><span class="linenos">1221</span></a><span class="sd">        check_collinear (bool, optional): Whether to check for collinear points. Defaults to True.</span>
</span><span id="fix_degen_points-1222"><a href="#fix_degen_points-1222"><span class="linenos">1222</span></a>
</span><span id="fix_degen_points-1223"><a href="#fix_degen_points-1223"><span class="linenos">1223</span></a><span class="sd">    Returns:</span>
</span><span id="fix_degen_points-1224"><a href="#fix_degen_points-1224"><span class="linenos">1224</span></a><span class="sd">        list[Point]: List of points with duplicate and collinear points removed.</span>
</span><span id="fix_degen_points-1225"><a href="#fix_degen_points-1225"><span class="linenos">1225</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="fix_degen_points-1226"><a href="#fix_degen_points-1226"><span class="linenos">1226</span></a>    <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="fix_degen_points-1227"><a href="#fix_degen_points-1227"><span class="linenos">1227</span></a>        <span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="fix_degen_points-1228"><a href="#fix_degen_points-1228"><span class="linenos">1228</span></a>    <span class="p">)</span>
</span><span id="fix_degen_points-1229"><a href="#fix_degen_points-1229"><span class="linenos">1229</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="fix_degen_points-1230"><a href="#fix_degen_points-1230"><span class="linenos">1230</span></a>    <span class="n">new_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="fix_degen_points-1231"><a href="#fix_degen_points-1231"><span class="linenos">1231</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="fix_degen_points-1232"><a href="#fix_degen_points-1232"><span class="linenos">1232</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="fix_degen_points-1233"><a href="#fix_degen_points-1233"><span class="linenos">1233</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="fix_degen_points-1234"><a href="#fix_degen_points-1234"><span class="linenos">1234</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="fix_degen_points-1235"><a href="#fix_degen_points-1235"><span class="linenos">1235</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="fix_degen_points-1236"><a href="#fix_degen_points-1236"><span class="linenos">1236</span></a>                <span class="n">new_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="fix_degen_points-1237"><a href="#fix_degen_points-1237"><span class="linenos">1237</span></a>    <span class="k">if</span> <span class="n">loop</span><span class="p">:</span>
</span><span id="fix_degen_points-1238"><a href="#fix_degen_points-1238"><span class="linenos">1238</span></a>        <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">new_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="fix_degen_points-1239"><a href="#fix_degen_points-1239"><span class="linenos">1239</span></a>            <span class="n">new_points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="fix_degen_points-1240"><a href="#fix_degen_points-1240"><span class="linenos">1240</span></a>
</span><span id="fix_degen_points-1241"><a href="#fix_degen_points-1241"><span class="linenos">1241</span></a>    <span class="k">if</span> <span class="n">check_collinear</span><span class="p">:</span>
</span><span id="fix_degen_points-1242"><a href="#fix_degen_points-1242"><span class="linenos">1242</span></a>        <span class="c1"># Check for collinear points and remove the middle one.</span>
</span><span id="fix_degen_points-1243"><a href="#fix_degen_points-1243"><span class="linenos">1243</span></a>        <span class="n">new_points</span> <span class="o">=</span> <span class="n">merge_consecutive_collinear_edges</span><span class="p">(</span>
</span><span id="fix_degen_points-1244"><a href="#fix_degen_points-1244"><span class="linenos">1244</span></a>            <span class="n">new_points</span><span class="p">,</span> <span class="n">closed</span><span class="p">,</span> <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span>
</span><span id="fix_degen_points-1245"><a href="#fix_degen_points-1245"><span class="linenos">1245</span></a>        <span class="p">)</span>
</span><span id="fix_degen_points-1246"><a href="#fix_degen_points-1246"><span class="linenos">1246</span></a>
</span><span id="fix_degen_points-1247"><a href="#fix_degen_points-1247"><span class="linenos">1247</span></a>    <span class="k">return</span> <span class="n">new_points</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of points with duplicate points removed.
Remove the middle point from the collinear points.</p>

<p>Args:
    points (list[Point]): List of points.
    loop (bool, optional): Whether to loop the points. Defaults to False.
    closed (bool, optional): Whether the points form a closed shape. Defaults to False.
    dist_tol (float, optional): Distance tolerance. Defaults to None.
    area_rtol (float, optional): Relative tolerance for area. Defaults to None.
    area_atol (float, optional): Absolute tolerance for area. Defaults to None.
    check_collinear (bool, optional): Whether to check for collinear points. Defaults to True.</p>

<p>Returns:
    list[Point]: List of points with duplicate and collinear points removed.</p>
</div>


                </section>
                <section id="clockwise">
                            <input id="clockwise-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clockwise</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">q</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">r</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="clockwise-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#clockwise"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="clockwise-1250"><a href="#clockwise-1250"><span class="linenos">1250</span></a><span class="k">def</span> <span class="nf">clockwise</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="clockwise-1251"><a href="#clockwise-1251"><span class="linenos">1251</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return 1 if the points p, q, and r are in clockwise order,</span>
</span><span id="clockwise-1252"><a href="#clockwise-1252"><span class="linenos">1252</span></a><span class="sd">    return -1 if the points are in counter-clockwise order,</span>
</span><span id="clockwise-1253"><a href="#clockwise-1253"><span class="linenos">1253</span></a><span class="sd">    return 0 if the points are collinear</span>
</span><span id="clockwise-1254"><a href="#clockwise-1254"><span class="linenos">1254</span></a>
</span><span id="clockwise-1255"><a href="#clockwise-1255"><span class="linenos">1255</span></a><span class="sd">    Args:</span>
</span><span id="clockwise-1256"><a href="#clockwise-1256"><span class="linenos">1256</span></a><span class="sd">        p (Point): First point.</span>
</span><span id="clockwise-1257"><a href="#clockwise-1257"><span class="linenos">1257</span></a><span class="sd">        q (Point): Second point.</span>
</span><span id="clockwise-1258"><a href="#clockwise-1258"><span class="linenos">1258</span></a><span class="sd">        r (Point): Third point.</span>
</span><span id="clockwise-1259"><a href="#clockwise-1259"><span class="linenos">1259</span></a>
</span><span id="clockwise-1260"><a href="#clockwise-1260"><span class="linenos">1260</span></a><span class="sd">    Returns:</span>
</span><span id="clockwise-1261"><a href="#clockwise-1261"><span class="linenos">1261</span></a><span class="sd">        int: 1 if the points are in clockwise order, -1 if counter-clockwise, 0 if collinear.</span>
</span><span id="clockwise-1262"><a href="#clockwise-1262"><span class="linenos">1262</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="clockwise-1263"><a href="#clockwise-1263"><span class="linenos">1263</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="n">area</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span><span id="clockwise-1264"><a href="#clockwise-1264"><span class="linenos">1264</span></a>    <span class="k">if</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="clockwise-1265"><a href="#clockwise-1265"><span class="linenos">1265</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="clockwise-1266"><a href="#clockwise-1266"><span class="linenos">1266</span></a>    <span class="k">elif</span> <span class="n">area_</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="clockwise-1267"><a href="#clockwise-1267"><span class="linenos">1267</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="clockwise-1268"><a href="#clockwise-1268"><span class="linenos">1268</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="clockwise-1269"><a href="#clockwise-1269"><span class="linenos">1269</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="clockwise-1270"><a href="#clockwise-1270"><span class="linenos">1270</span></a>
</span><span id="clockwise-1271"><a href="#clockwise-1271"><span class="linenos">1271</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return 1 if the points p, q, and r are in clockwise order,
return -1 if the points are in counter-clockwise order,
return 0 if the points are collinear</p>

<p>Args:
    p (Point): First point.
    q (Point): Second point.
    r (Point): Third point.</p>

<p>Returns:
    int: 1 if the points are in clockwise order, -1 if counter-clockwise, 0 if collinear.</p>
</div>


                </section>
                <section id="intersects">
                            <input id="intersects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersects</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">seg1</span>, </span><span class="param"><span class="n">seg2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="intersects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersects-1274"><a href="#intersects-1274"><span class="linenos">1274</span></a><span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">):</span>
</span><span id="intersects-1275"><a href="#intersects-1275"><span class="linenos">1275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the line segments intersect.</span>
</span><span id="intersects-1276"><a href="#intersects-1276"><span class="linenos">1276</span></a><span class="sd">    If they are chained together, they are considered as intersecting.</span>
</span><span id="intersects-1277"><a href="#intersects-1277"><span class="linenos">1277</span></a><span class="sd">    Returns True if the segments intersect, False otherwise.</span>
</span><span id="intersects-1278"><a href="#intersects-1278"><span class="linenos">1278</span></a>
</span><span id="intersects-1279"><a href="#intersects-1279"><span class="linenos">1279</span></a><span class="sd">    Args:</span>
</span><span id="intersects-1280"><a href="#intersects-1280"><span class="linenos">1280</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="intersects-1281"><a href="#intersects-1281"><span class="linenos">1281</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="intersects-1282"><a href="#intersects-1282"><span class="linenos">1282</span></a>
</span><span id="intersects-1283"><a href="#intersects-1283"><span class="linenos">1283</span></a><span class="sd">    Returns:</span>
</span><span id="intersects-1284"><a href="#intersects-1284"><span class="linenos">1284</span></a><span class="sd">        bool: True if the segments intersect, False otherwise.</span>
</span><span id="intersects-1285"><a href="#intersects-1285"><span class="linenos">1285</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersects-1286"><a href="#intersects-1286"><span class="linenos">1286</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="intersects-1287"><a href="#intersects-1287"><span class="linenos">1287</span></a>    <span class="n">p2</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="intersects-1288"><a href="#intersects-1288"><span class="linenos">1288</span></a>    <span class="n">o1</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="intersects-1289"><a href="#intersects-1289"><span class="linenos">1289</span></a>    <span class="n">o2</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="intersects-1290"><a href="#intersects-1290"><span class="linenos">1290</span></a>    <span class="n">o3</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
</span><span id="intersects-1291"><a href="#intersects-1291"><span class="linenos">1291</span></a>    <span class="n">o4</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
</span><span id="intersects-1292"><a href="#intersects-1292"><span class="linenos">1292</span></a>
</span><span id="intersects-1293"><a href="#intersects-1293"><span class="linenos">1293</span></a>    <span class="k">if</span> <span class="n">o1</span> <span class="o">!=</span> <span class="n">o2</span> <span class="ow">and</span> <span class="n">o3</span> <span class="o">!=</span> <span class="n">o4</span><span class="p">:</span>
</span><span id="intersects-1294"><a href="#intersects-1294"><span class="linenos">1294</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="intersects-1295"><a href="#intersects-1295"><span class="linenos">1295</span></a>
</span><span id="intersects-1296"><a href="#intersects-1296"><span class="linenos">1296</span></a>    <span class="k">if</span> <span class="n">o1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
</span><span id="intersects-1297"><a href="#intersects-1297"><span class="linenos">1297</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="intersects-1298"><a href="#intersects-1298"><span class="linenos">1298</span></a>    <span class="k">if</span> <span class="n">o2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
</span><span id="intersects-1299"><a href="#intersects-1299"><span class="linenos">1299</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="intersects-1300"><a href="#intersects-1300"><span class="linenos">1300</span></a>    <span class="k">if</span> <span class="n">o3</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="intersects-1301"><a href="#intersects-1301"><span class="linenos">1301</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="intersects-1302"><a href="#intersects-1302"><span class="linenos">1302</span></a>    <span class="k">if</span> <span class="n">o4</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">between</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="intersects-1303"><a href="#intersects-1303"><span class="linenos">1303</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="intersects-1304"><a href="#intersects-1304"><span class="linenos">1304</span></a>
</span><span id="intersects-1305"><a href="#intersects-1305"><span class="linenos">1305</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Checks if the line segments intersect.
If they are chained together, they are considered as intersecting.
Returns True if the segments intersect, False otherwise.</p>

<p>Args:
    seg1 (Line): First line segment.
    seg2 (Line): Second line segment.</p>

<p>Returns:
    bool: True if the segments intersect, False otherwise.</p>
</div>


                </section>
                <section id="is_chained">
                            <input id="is_chained-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_chained</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">seg1</span>, </span><span class="param"><span class="n">seg2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="is_chained-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_chained"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_chained-1308"><a href="#is_chained-1308"><span class="linenos">1308</span></a><span class="k">def</span> <span class="nf">is_chained</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span> <span class="n">seg2</span><span class="p">):</span>
</span><span id="is_chained-1309"><a href="#is_chained-1309"><span class="linenos">1309</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the line segments are chained together.</span>
</span><span id="is_chained-1310"><a href="#is_chained-1310"><span class="linenos">1310</span></a>
</span><span id="is_chained-1311"><a href="#is_chained-1311"><span class="linenos">1311</span></a><span class="sd">    Args:</span>
</span><span id="is_chained-1312"><a href="#is_chained-1312"><span class="linenos">1312</span></a><span class="sd">        seg1 (Line): First line segment.</span>
</span><span id="is_chained-1313"><a href="#is_chained-1313"><span class="linenos">1313</span></a><span class="sd">        seg2 (Line): Second line segment.</span>
</span><span id="is_chained-1314"><a href="#is_chained-1314"><span class="linenos">1314</span></a>
</span><span id="is_chained-1315"><a href="#is_chained-1315"><span class="linenos">1315</span></a><span class="sd">    Returns:</span>
</span><span id="is_chained-1316"><a href="#is_chained-1316"><span class="linenos">1316</span></a><span class="sd">        bool: True if the segments are chained together, False otherwise.</span>
</span><span id="is_chained-1317"><a href="#is_chained-1317"><span class="linenos">1317</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_chained-1318"><a href="#is_chained-1318"><span class="linenos">1318</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="is_chained-1319"><a href="#is_chained-1319"><span class="linenos">1319</span></a>    <span class="n">p2</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="is_chained-1320"><a href="#is_chained-1320"><span class="linenos">1320</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="is_chained-1321"><a href="#is_chained-1321"><span class="linenos">1321</span></a>        <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="is_chained-1322"><a href="#is_chained-1322"><span class="linenos">1322</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="is_chained-1323"><a href="#is_chained-1323"><span class="linenos">1323</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="is_chained-1324"><a href="#is_chained-1324"><span class="linenos">1324</span></a>        <span class="ow">or</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
</span><span id="is_chained-1325"><a href="#is_chained-1325"><span class="linenos">1325</span></a>    <span class="p">):</span>
</span><span id="is_chained-1326"><a href="#is_chained-1326"><span class="linenos">1326</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="is_chained-1327"><a href="#is_chained-1327"><span class="linenos">1327</span></a>
</span><span id="is_chained-1328"><a href="#is_chained-1328"><span class="linenos">1328</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Checks if the line segments are chained together.</p>

<p>Args:
    seg1 (Line): First line segment.
    seg2 (Line): Second line segment.</p>

<p>Returns:
    bool: True if the segments are chained together, False otherwise.</p>
</div>


                </section>
                <section id="direction">
                            <input id="direction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">direction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p</span>, </span><span class="param"><span class="n">q</span>, </span><span class="param"><span class="n">r</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="direction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#direction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="direction-1331"><a href="#direction-1331"><span class="linenos">1331</span></a><span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span><span id="direction-1332"><a href="#direction-1332"><span class="linenos">1332</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="direction-1333"><a href="#direction-1333"><span class="linenos">1333</span></a><span class="sd">    Checks the orientation of three points (p, q, r).</span>
</span><span id="direction-1334"><a href="#direction-1334"><span class="linenos">1334</span></a>
</span><span id="direction-1335"><a href="#direction-1335"><span class="linenos">1335</span></a><span class="sd">    Args:</span>
</span><span id="direction-1336"><a href="#direction-1336"><span class="linenos">1336</span></a><span class="sd">        p (Point): First point.</span>
</span><span id="direction-1337"><a href="#direction-1337"><span class="linenos">1337</span></a><span class="sd">        q (Point): Second point.</span>
</span><span id="direction-1338"><a href="#direction-1338"><span class="linenos">1338</span></a><span class="sd">        r (Point): Third point.</span>
</span><span id="direction-1339"><a href="#direction-1339"><span class="linenos">1339</span></a>
</span><span id="direction-1340"><a href="#direction-1340"><span class="linenos">1340</span></a><span class="sd">    Returns:</span>
</span><span id="direction-1341"><a href="#direction-1341"><span class="linenos">1341</span></a><span class="sd">        int: 0 if collinear, &gt;0 if counter-clockwise, &lt;0 if clockwise.</span>
</span><span id="direction-1342"><a href="#direction-1342"><span class="linenos">1342</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="direction-1343"><a href="#direction-1343"><span class="linenos">1343</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Checks the orientation of three points (p, q, r).</p>

<p>Args:
    p (Point): First point.
    q (Point): Second point.
    r (Point): Third point.</p>

<p>Returns:
    int: 0 if collinear, &gt;0 if counter-clockwise, &lt;0 if clockwise.</p>
</div>


                </section>
                <section id="collinear_segments">
                            <input id="collinear_segments-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collinear_segments</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">segment1</span>, </span><span class="param"><span class="n">segment2</span>, </span><span class="param"><span class="n">tol</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="collinear_segments-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#collinear_segments"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="collinear_segments-1346"><a href="#collinear_segments-1346"><span class="linenos">1346</span></a><span class="k">def</span> <span class="nf">collinear_segments</span><span class="p">(</span><span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="collinear_segments-1347"><a href="#collinear_segments-1347"><span class="linenos">1347</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="collinear_segments-1348"><a href="#collinear_segments-1348"><span class="linenos">1348</span></a><span class="sd">    Checks if two line segments (a1, b1) and (a2, b2) are collinear.</span>
</span><span id="collinear_segments-1349"><a href="#collinear_segments-1349"><span class="linenos">1349</span></a>
</span><span id="collinear_segments-1350"><a href="#collinear_segments-1350"><span class="linenos">1350</span></a><span class="sd">    Args:</span>
</span><span id="collinear_segments-1351"><a href="#collinear_segments-1351"><span class="linenos">1351</span></a><span class="sd">        segment1 (Line): First line segment.</span>
</span><span id="collinear_segments-1352"><a href="#collinear_segments-1352"><span class="linenos">1352</span></a><span class="sd">        segment2 (Line): Second line segment.</span>
</span><span id="collinear_segments-1353"><a href="#collinear_segments-1353"><span class="linenos">1353</span></a><span class="sd">        tol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="collinear_segments-1354"><a href="#collinear_segments-1354"><span class="linenos">1354</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="collinear_segments-1355"><a href="#collinear_segments-1355"><span class="linenos">1355</span></a>
</span><span id="collinear_segments-1356"><a href="#collinear_segments-1356"><span class="linenos">1356</span></a><span class="sd">    Returns:</span>
</span><span id="collinear_segments-1357"><a href="#collinear_segments-1357"><span class="linenos">1357</span></a><span class="sd">        bool: True if the segments are collinear, False otherwise.</span>
</span><span id="collinear_segments-1358"><a href="#collinear_segments-1358"><span class="linenos">1358</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="collinear_segments-1359"><a href="#collinear_segments-1359"><span class="linenos">1359</span></a>    <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;tol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="collinear_segments-1360"><a href="#collinear_segments-1360"><span class="linenos">1360</span></a>    <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">segment1</span>
</span><span id="collinear_segments-1361"><a href="#collinear_segments-1361"><span class="linenos">1361</span></a>    <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">segment2</span>
</span><span id="collinear_segments-1362"><a href="#collinear_segments-1362"><span class="linenos">1362</span></a>
</span><span id="collinear_segments-1363"><a href="#collinear_segments-1363"><span class="linenos">1363</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">direction</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">a2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="collinear_segments-1364"><a href="#collinear_segments-1364"><span class="linenos">1364</span></a>        <span class="n">direction</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="collinear_segments-1365"><a href="#collinear_segments-1365"><span class="linenos">1365</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks if two line segments (a1, b1) and (a2, b2) are collinear.</p>

<p>Args:
    segment1 (Line): First line segment.
    segment2 (Line): Second line segment.
    tol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the segments are collinear, False otherwise.</p>
</div>


                </section>
                <section id="global_to_local">
                            <input id="global_to_local-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">global_to_local</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">xi</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">yi</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="global_to_local-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#global_to_local"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="global_to_local-1368"><a href="#global_to_local-1368"><span class="linenos">1368</span></a><span class="k">def</span> <span class="nf">global_to_local</span><span class="p">(</span>
</span><span id="global_to_local-1369"><a href="#global_to_local-1369"><span class="linenos">1369</span></a>    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">yi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="global_to_local-1370"><a href="#global_to_local-1370"><span class="linenos">1370</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="global_to_local-1371"><a href="#global_to_local-1371"><span class="linenos">1371</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point(x, y) in global coordinates</span>
</span><span id="global_to_local-1372"><a href="#global_to_local-1372"><span class="linenos">1372</span></a><span class="sd">    and local CS position and orientation,</span>
</span><span id="global_to_local-1373"><a href="#global_to_local-1373"><span class="linenos">1373</span></a><span class="sd">    return a point(ksi, eta) in local coordinates</span>
</span><span id="global_to_local-1374"><a href="#global_to_local-1374"><span class="linenos">1374</span></a>
</span><span id="global_to_local-1375"><a href="#global_to_local-1375"><span class="linenos">1375</span></a><span class="sd">    Args:</span>
</span><span id="global_to_local-1376"><a href="#global_to_local-1376"><span class="linenos">1376</span></a><span class="sd">        x (float): Global x-coordinate.</span>
</span><span id="global_to_local-1377"><a href="#global_to_local-1377"><span class="linenos">1377</span></a><span class="sd">        y (float): Global y-coordinate.</span>
</span><span id="global_to_local-1378"><a href="#global_to_local-1378"><span class="linenos">1378</span></a><span class="sd">        xi (float): Local x-coordinate.</span>
</span><span id="global_to_local-1379"><a href="#global_to_local-1379"><span class="linenos">1379</span></a><span class="sd">        yi (float): Local y-coordinate.</span>
</span><span id="global_to_local-1380"><a href="#global_to_local-1380"><span class="linenos">1380</span></a><span class="sd">        theta (float, optional): Angle in radians. Defaults to 0.</span>
</span><span id="global_to_local-1381"><a href="#global_to_local-1381"><span class="linenos">1381</span></a>
</span><span id="global_to_local-1382"><a href="#global_to_local-1382"><span class="linenos">1382</span></a><span class="sd">    Returns:</span>
</span><span id="global_to_local-1383"><a href="#global_to_local-1383"><span class="linenos">1383</span></a><span class="sd">        Point: Local coordinates (ksi, eta).</span>
</span><span id="global_to_local-1384"><a href="#global_to_local-1384"><span class="linenos">1384</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="global_to_local-1385"><a href="#global_to_local-1385"><span class="linenos">1385</span></a>    <span class="n">sin_theta</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="global_to_local-1386"><a href="#global_to_local-1386"><span class="linenos">1386</span></a>    <span class="n">cos_theta</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="global_to_local-1387"><a href="#global_to_local-1387"><span class="linenos">1387</span></a>    <span class="n">ksi</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_theta</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">yi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin_theta</span>
</span><span id="global_to_local-1388"><a href="#global_to_local-1388"><span class="linenos">1388</span></a>    <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">yi</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_theta</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin_theta</span>
</span><span id="global_to_local-1389"><a href="#global_to_local-1389"><span class="linenos">1389</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ksi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given a point(x, y) in global coordinates
and local CS position and orientation,
return a point(ksi, eta) in local coordinates</p>

<p>Args:
    x (float): Global x-coordinate.
    y (float): Global y-coordinate.
    xi (float): Local x-coordinate.
    yi (float): Local y-coordinate.
    theta (float, optional): Angle in radians. Defaults to 0.</p>

<p>Returns:
    Point: Local coordinates (ksi, eta).</p>
</div>


                </section>
                <section id="stitch_lines">
                            <input id="stitch_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stitch_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">line2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="stitch_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#stitch_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="stitch_lines-1392"><a href="#stitch_lines-1392"><span class="linenos">1392</span></a><span class="k">def</span> <span class="nf">stitch_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="stitch_lines-1393"><a href="#stitch_lines-1393"><span class="linenos">1393</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;if the lines intersect, trim the lines</span>
</span><span id="stitch_lines-1394"><a href="#stitch_lines-1394"><span class="linenos">1394</span></a><span class="sd">    if the lines don&#39;t intersect, extend the lines</span>
</span><span id="stitch_lines-1395"><a href="#stitch_lines-1395"><span class="linenos">1395</span></a>
</span><span id="stitch_lines-1396"><a href="#stitch_lines-1396"><span class="linenos">1396</span></a><span class="sd">    Args:</span>
</span><span id="stitch_lines-1397"><a href="#stitch_lines-1397"><span class="linenos">1397</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="stitch_lines-1398"><a href="#stitch_lines-1398"><span class="linenos">1398</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="stitch_lines-1399"><a href="#stitch_lines-1399"><span class="linenos">1399</span></a>
</span><span id="stitch_lines-1400"><a href="#stitch_lines-1400"><span class="linenos">1400</span></a><span class="sd">    Returns:</span>
</span><span id="stitch_lines-1401"><a href="#stitch_lines-1401"><span class="linenos">1401</span></a><span class="sd">        Sequence[Line]: Trimmed or extended lines.</span>
</span><span id="stitch_lines-1402"><a href="#stitch_lines-1402"><span class="linenos">1402</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="stitch_lines-1403"><a href="#stitch_lines-1403"><span class="linenos">1403</span></a>    <span class="n">intersection_</span> <span class="o">=</span> <span class="n">intersect</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="stitch_lines-1404"><a href="#stitch_lines-1404"><span class="linenos">1404</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="stitch_lines-1405"><a href="#stitch_lines-1405"><span class="linenos">1405</span></a>    <span class="k">if</span> <span class="n">intersection_</span><span class="p">:</span>
</span><span id="stitch_lines-1406"><a href="#stitch_lines-1406"><span class="linenos">1406</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">line1</span>
</span><span id="stitch_lines-1407"><a href="#stitch_lines-1407"><span class="linenos">1407</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="stitch_lines-1408"><a href="#stitch_lines-1408"><span class="linenos">1408</span></a>        <span class="n">line1</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">]</span>
</span><span id="stitch_lines-1409"><a href="#stitch_lines-1409"><span class="linenos">1409</span></a>        <span class="n">line2</span> <span class="o">=</span> <span class="p">[</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span><span id="stitch_lines-1410"><a href="#stitch_lines-1410"><span class="linenos">1410</span></a>
</span><span id="stitch_lines-1411"><a href="#stitch_lines-1411"><span class="linenos">1411</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="stitch_lines-1412"><a href="#stitch_lines-1412"><span class="linenos">1412</span></a>
</span><span id="stitch_lines-1413"><a href="#stitch_lines-1413"><span class="linenos">1413</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>if the lines intersect, trim the lines
if the lines don't intersect, extend the lines</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.</p>

<p>Returns:
    Sequence[Line]: Trimmed or extended lines.</p>
</div>


                </section>
                <section id="get_quadrant">
                            <input id="get_quadrant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_quadrant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">y</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="get_quadrant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_quadrant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_quadrant-1416"><a href="#get_quadrant-1416"><span class="linenos">1416</span></a><span class="k">def</span> <span class="nf">get_quadrant</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="get_quadrant-1417"><a href="#get_quadrant-1417"><span class="linenos">1417</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;quadrants:</span>
</span><span id="get_quadrant-1418"><a href="#get_quadrant-1418"><span class="linenos">1418</span></a><span class="sd">    +x, +y = 1st</span>
</span><span id="get_quadrant-1419"><a href="#get_quadrant-1419"><span class="linenos">1419</span></a><span class="sd">    +x, -y = 2nd</span>
</span><span id="get_quadrant-1420"><a href="#get_quadrant-1420"><span class="linenos">1420</span></a><span class="sd">    -x, -y = 3rd</span>
</span><span id="get_quadrant-1421"><a href="#get_quadrant-1421"><span class="linenos">1421</span></a><span class="sd">    +x, -y = 4th</span>
</span><span id="get_quadrant-1422"><a href="#get_quadrant-1422"><span class="linenos">1422</span></a>
</span><span id="get_quadrant-1423"><a href="#get_quadrant-1423"><span class="linenos">1423</span></a><span class="sd">    Args:</span>
</span><span id="get_quadrant-1424"><a href="#get_quadrant-1424"><span class="linenos">1424</span></a><span class="sd">        x (float): x-coordinate.</span>
</span><span id="get_quadrant-1425"><a href="#get_quadrant-1425"><span class="linenos">1425</span></a><span class="sd">        y (float): y-coordinate.</span>
</span><span id="get_quadrant-1426"><a href="#get_quadrant-1426"><span class="linenos">1426</span></a>
</span><span id="get_quadrant-1427"><a href="#get_quadrant-1427"><span class="linenos">1427</span></a><span class="sd">    Returns:</span>
</span><span id="get_quadrant-1428"><a href="#get_quadrant-1428"><span class="linenos">1428</span></a><span class="sd">        int: Quadrant number.</span>
</span><span id="get_quadrant-1429"><a href="#get_quadrant-1429"><span class="linenos">1429</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_quadrant-1430"><a href="#get_quadrant-1430"><span class="linenos">1430</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">((</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>quadrants:
+x, +y = 1st
+x, -y = 2nd
-x, -y = 3rd
+x, -y = 4th</p>

<p>Args:
    x (float): x-coordinate.
    y (float): y-coordinate.</p>

<p>Returns:
    int: Quadrant number.</p>
</div>


                </section>
                <section id="get_quadrant_from_deg_angle">
                            <input id="get_quadrant_from_deg_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_quadrant_from_deg_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">deg_angle</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="get_quadrant_from_deg_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_quadrant_from_deg_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_quadrant_from_deg_angle-1433"><a href="#get_quadrant_from_deg_angle-1433"><span class="linenos">1433</span></a><span class="k">def</span> <span class="nf">get_quadrant_from_deg_angle</span><span class="p">(</span><span class="n">deg_angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="get_quadrant_from_deg_angle-1434"><a href="#get_quadrant_from_deg_angle-1434"><span class="linenos">1434</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;quadrants:</span>
</span><span id="get_quadrant_from_deg_angle-1435"><a href="#get_quadrant_from_deg_angle-1435"><span class="linenos">1435</span></a><span class="sd">    (0, 90) = 1st</span>
</span><span id="get_quadrant_from_deg_angle-1436"><a href="#get_quadrant_from_deg_angle-1436"><span class="linenos">1436</span></a><span class="sd">    (90, 180) = 2nd</span>
</span><span id="get_quadrant_from_deg_angle-1437"><a href="#get_quadrant_from_deg_angle-1437"><span class="linenos">1437</span></a><span class="sd">    (180, 270) = 3rd</span>
</span><span id="get_quadrant_from_deg_angle-1438"><a href="#get_quadrant_from_deg_angle-1438"><span class="linenos">1438</span></a><span class="sd">    (270, 360) = 4th</span>
</span><span id="get_quadrant_from_deg_angle-1439"><a href="#get_quadrant_from_deg_angle-1439"><span class="linenos">1439</span></a>
</span><span id="get_quadrant_from_deg_angle-1440"><a href="#get_quadrant_from_deg_angle-1440"><span class="linenos">1440</span></a><span class="sd">    Args:</span>
</span><span id="get_quadrant_from_deg_angle-1441"><a href="#get_quadrant_from_deg_angle-1441"><span class="linenos">1441</span></a><span class="sd">        deg_angle (float): Angle in degrees.</span>
</span><span id="get_quadrant_from_deg_angle-1442"><a href="#get_quadrant_from_deg_angle-1442"><span class="linenos">1442</span></a>
</span><span id="get_quadrant_from_deg_angle-1443"><a href="#get_quadrant_from_deg_angle-1443"><span class="linenos">1443</span></a><span class="sd">    Returns:</span>
</span><span id="get_quadrant_from_deg_angle-1444"><a href="#get_quadrant_from_deg_angle-1444"><span class="linenos">1444</span></a><span class="sd">        int: Quadrant number.</span>
</span><span id="get_quadrant_from_deg_angle-1445"><a href="#get_quadrant_from_deg_angle-1445"><span class="linenos">1445</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_quadrant_from_deg_angle-1446"><a href="#get_quadrant_from_deg_angle-1446"><span class="linenos">1446</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">deg_angle</span> <span class="o">/</span> <span class="mf">90.0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>quadrants:
(0, 90) = 1st
(90, 180) = 2nd
(180, 270) = 3rd
(270, 360) = 4th</p>

<p>Args:
    deg_angle (float): Angle in degrees.</p>

<p>Returns:
    int: Quadrant number.</p>
</div>


                </section>
                <section id="homogenize">
                            <input id="homogenize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">homogenize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="s2">&quot;&#39;ndarray&#39;&quot;</span>:</span></span>

                <label class="view-source-button" for="homogenize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#homogenize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="homogenize-1449"><a href="#homogenize-1449"><span class="linenos">1449</span></a><span class="k">def</span> <span class="nf">homogenize</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">:</span>
</span><span id="homogenize-1450"><a href="#homogenize-1450"><span class="linenos">1450</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="homogenize-1451"><a href="#homogenize-1451"><span class="linenos">1451</span></a><span class="sd">    Convert a list of points to homogeneous coordinates.</span>
</span><span id="homogenize-1452"><a href="#homogenize-1452"><span class="linenos">1452</span></a>
</span><span id="homogenize-1453"><a href="#homogenize-1453"><span class="linenos">1453</span></a><span class="sd">    Args:</span>
</span><span id="homogenize-1454"><a href="#homogenize-1454"><span class="linenos">1454</span></a><span class="sd">        points (Sequence[Point]): List of points.</span>
</span><span id="homogenize-1455"><a href="#homogenize-1455"><span class="linenos">1455</span></a>
</span><span id="homogenize-1456"><a href="#homogenize-1456"><span class="linenos">1456</span></a><span class="sd">    Returns:</span>
</span><span id="homogenize-1457"><a href="#homogenize-1457"><span class="linenos">1457</span></a><span class="sd">        np.ndarray: Homogeneous coordinates.</span>
</span><span id="homogenize-1458"><a href="#homogenize-1458"><span class="linenos">1458</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="homogenize-1459"><a href="#homogenize-1459"><span class="linenos">1459</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="homogenize-1460"><a href="#homogenize-1460"><span class="linenos">1460</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="homogenize-1461"><a href="#homogenize-1461"><span class="linenos">1461</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="homogenize-1462"><a href="#homogenize-1462"><span class="linenos">1462</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="homogenize-1463"><a href="#homogenize-1463"><span class="linenos">1463</span></a>    <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">xy_array</span><span class="o">.</span><span class="n">shape</span>
</span><span id="homogenize-1464"><a href="#homogenize-1464"><span class="linenos">1464</span></a>    <span class="k">if</span> <span class="n">n_cols</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="homogenize-1465"><a href="#homogenize-1465"><span class="linenos">1465</span></a>        <span class="n">xy_array</span> <span class="o">=</span> <span class="n">xy_array</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="homogenize-1466"><a href="#homogenize-1466"><span class="linenos">1466</span></a>    <span class="n">ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="homogenize-1467"><a href="#homogenize-1467"><span class="linenos">1467</span></a>    <span class="n">homogeneous_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_array</span><span class="p">,</span> <span class="n">ones</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="homogenize-1468"><a href="#homogenize-1468"><span class="linenos">1468</span></a>
</span><span id="homogenize-1469"><a href="#homogenize-1469"><span class="linenos">1469</span></a>    <span class="k">return</span> <span class="n">homogeneous_array</span>
</span></pre></div>


            <div class="docstring"><p>Convert a list of points to homogeneous coordinates.</p>

<p>Args:
    points (Sequence[Point]): List of points.</p>

<p>Returns:
    np.ndarray: Homogeneous coordinates.</p>
</div>


                </section>
                <section id="intersect2">
                            <input id="intersect2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect2</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="intersect2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersect2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersect2-1493"><a href="#intersect2-1493"><span class="linenos">1493</span></a><span class="k">def</span> <span class="nf">intersect2</span><span class="p">(</span>
</span><span id="intersect2-1494"><a href="#intersect2-1494"><span class="linenos">1494</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1495"><a href="#intersect2-1495"><span class="linenos">1495</span></a>    <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1496"><a href="#intersect2-1496"><span class="linenos">1496</span></a>    <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1497"><a href="#intersect2-1497"><span class="linenos">1497</span></a>    <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1498"><a href="#intersect2-1498"><span class="linenos">1498</span></a>    <span class="n">x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1499"><a href="#intersect2-1499"><span class="linenos">1499</span></a>    <span class="n">y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1500"><a href="#intersect2-1500"><span class="linenos">1500</span></a>    <span class="n">x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1501"><a href="#intersect2-1501"><span class="linenos">1501</span></a>    <span class="n">y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersect2-1502"><a href="#intersect2-1502"><span class="linenos">1502</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersect2-1503"><a href="#intersect2-1503"><span class="linenos">1503</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersect2-1504"><a href="#intersect2-1504"><span class="linenos">1504</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="intersect2-1505"><a href="#intersect2-1505"><span class="linenos">1505</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection point of two lines.</span>
</span><span id="intersect2-1506"><a href="#intersect2-1506"><span class="linenos">1506</span></a><span class="sd">    line1: (x1, y1), (x2, y2)</span>
</span><span id="intersect2-1507"><a href="#intersect2-1507"><span class="linenos">1507</span></a><span class="sd">    line2: (x3, y3), (x4, y4)</span>
</span><span id="intersect2-1508"><a href="#intersect2-1508"><span class="linenos">1508</span></a><span class="sd">    To find the intersection point of two line segments use the</span>
</span><span id="intersect2-1509"><a href="#intersect2-1509"><span class="linenos">1509</span></a><span class="sd">    &quot;intersection&quot; function</span>
</span><span id="intersect2-1510"><a href="#intersect2-1510"><span class="linenos">1510</span></a>
</span><span id="intersect2-1511"><a href="#intersect2-1511"><span class="linenos">1511</span></a><span class="sd">    Args:</span>
</span><span id="intersect2-1512"><a href="#intersect2-1512"><span class="linenos">1512</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line.</span>
</span><span id="intersect2-1513"><a href="#intersect2-1513"><span class="linenos">1513</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line.</span>
</span><span id="intersect2-1514"><a href="#intersect2-1514"><span class="linenos">1514</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line.</span>
</span><span id="intersect2-1515"><a href="#intersect2-1515"><span class="linenos">1515</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line.</span>
</span><span id="intersect2-1516"><a href="#intersect2-1516"><span class="linenos">1516</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line.</span>
</span><span id="intersect2-1517"><a href="#intersect2-1517"><span class="linenos">1517</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line.</span>
</span><span id="intersect2-1518"><a href="#intersect2-1518"><span class="linenos">1518</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line.</span>
</span><span id="intersect2-1519"><a href="#intersect2-1519"><span class="linenos">1519</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line.</span>
</span><span id="intersect2-1520"><a href="#intersect2-1520"><span class="linenos">1520</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="intersect2-1521"><a href="#intersect2-1521"><span class="linenos">1521</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="intersect2-1522"><a href="#intersect2-1522"><span class="linenos">1522</span></a>
</span><span id="intersect2-1523"><a href="#intersect2-1523"><span class="linenos">1523</span></a><span class="sd">    Returns:</span>
</span><span id="intersect2-1524"><a href="#intersect2-1524"><span class="linenos">1524</span></a><span class="sd">        Point: Intersection point of the two lines.</span>
</span><span id="intersect2-1525"><a href="#intersect2-1525"><span class="linenos">1525</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersect2-1526"><a href="#intersect2-1526"><span class="linenos">1526</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="intersect2-1527"><a href="#intersect2-1527"><span class="linenos">1527</span></a>    <span class="n">x1_x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>
</span><span id="intersect2-1528"><a href="#intersect2-1528"><span class="linenos">1528</span></a>    <span class="n">y1_y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span>
</span><span id="intersect2-1529"><a href="#intersect2-1529"><span class="linenos">1529</span></a>    <span class="n">x3_x4</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">-</span> <span class="n">x4</span>
</span><span id="intersect2-1530"><a href="#intersect2-1530"><span class="linenos">1530</span></a>    <span class="n">y3_y4</span> <span class="o">=</span> <span class="n">y3</span> <span class="o">-</span> <span class="n">y4</span>
</span><span id="intersect2-1531"><a href="#intersect2-1531"><span class="linenos">1531</span></a>
</span><span id="intersect2-1532"><a href="#intersect2-1532"><span class="linenos">1532</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3_y4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1_y2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3_x4</span><span class="p">)</span>
</span><span id="intersect2-1533"><a href="#intersect2-1533"><span class="linenos">1533</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="intersect2-1534"><a href="#intersect2-1534"><span class="linenos">1534</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># parallel lines</span>
</span><span id="intersect2-1535"><a href="#intersect2-1535"><span class="linenos">1535</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="intersect2-1536"><a href="#intersect2-1536"><span class="linenos">1536</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3_x4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span> <span class="o">*</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">x4</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="intersect2-1537"><a href="#intersect2-1537"><span class="linenos">1537</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3_y4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1_y2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span> <span class="o">*</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">x4</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="intersect2-1538"><a href="#intersect2-1538"><span class="linenos">1538</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="intersect2-1539"><a href="#intersect2-1539"><span class="linenos">1539</span></a>
</span><span id="intersect2-1540"><a href="#intersect2-1540"><span class="linenos">1540</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection point of two lines.
line1: (x1, y1), (x2, y2)
line2: (x3, y3), (x4, y4)
To find the intersection point of two line segments use the
"intersection" function</p>

<p>Args:
    x1 (float): x-coordinate of the first point of the first line.
    y1 (float): y-coordinate of the first point of the first line.
    x2 (float): x-coordinate of the second point of the first line.
    y2 (float): y-coordinate of the second point of the first line.
    x3 (float): x-coordinate of the first point of the second line.
    y3 (float): y-coordinate of the first point of the second line.
    x4 (float): x-coordinate of the second point of the second line.
    y4 (float): y-coordinate of the second point of the second line.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    Point: Intersection point of the two lines.</p>
</div>


                </section>
                <section id="intersect">
                            <input id="intersect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">line2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="intersect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersect-1543"><a href="#intersect-1543"><span class="linenos">1543</span></a><span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="intersect-1544"><a href="#intersect-1544"><span class="linenos">1544</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection point of two lines.</span>
</span><span id="intersect-1545"><a href="#intersect-1545"><span class="linenos">1545</span></a><span class="sd">    line1: [(x1, y1), (x2, y2)]</span>
</span><span id="intersect-1546"><a href="#intersect-1546"><span class="linenos">1546</span></a><span class="sd">    line2: [(x3, y3), (x4, y4)]</span>
</span><span id="intersect-1547"><a href="#intersect-1547"><span class="linenos">1547</span></a><span class="sd">    To find the intersection point of two line segments use the</span>
</span><span id="intersect-1548"><a href="#intersect-1548"><span class="linenos">1548</span></a><span class="sd">    &quot;intersection&quot; function</span>
</span><span id="intersect-1549"><a href="#intersect-1549"><span class="linenos">1549</span></a>
</span><span id="intersect-1550"><a href="#intersect-1550"><span class="linenos">1550</span></a><span class="sd">    Args:</span>
</span><span id="intersect-1551"><a href="#intersect-1551"><span class="linenos">1551</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="intersect-1552"><a href="#intersect-1552"><span class="linenos">1552</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="intersect-1553"><a href="#intersect-1553"><span class="linenos">1553</span></a>
</span><span id="intersect-1554"><a href="#intersect-1554"><span class="linenos">1554</span></a><span class="sd">    Returns:</span>
</span><span id="intersect-1555"><a href="#intersect-1555"><span class="linenos">1555</span></a><span class="sd">        Point: Intersection point of the two lines.</span>
</span><span id="intersect-1556"><a href="#intersect-1556"><span class="linenos">1556</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersect-1557"><a href="#intersect-1557"><span class="linenos">1557</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="intersect-1558"><a href="#intersect-1558"><span class="linenos">1558</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="intersect-1559"><a href="#intersect-1559"><span class="linenos">1559</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="intersect-1560"><a href="#intersect-1560"><span class="linenos">1560</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="intersect-1561"><a href="#intersect-1561"><span class="linenos">1561</span></a>    <span class="k">return</span> <span class="n">intersect2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection point of two lines.
line1: [(x1, y1), (x2, y2)]
line2: [(x3, y3), (x4, y4)]
To find the intersection point of two line segments use the
"intersection" function</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.</p>

<p>Returns:
    Point: Intersection point of the two lines.</p>
</div>


                </section>
                <section id="intersection2">
                            <input id="intersection2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersection2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">x3</span>, </span><span class="param"><span class="n">y3</span>, </span><span class="param"><span class="n">x4</span>, </span><span class="param"><span class="n">y4</span>, </span><span class="param"><span class="n">rtol</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="intersection2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersection2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersection2-1564"><a href="#intersection2-1564"><span class="linenos">1564</span></a><span class="k">def</span> <span class="nf">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="intersection2-1565"><a href="#intersection2-1565"><span class="linenos">1565</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the intersection of two line segments. See the documentation</span>
</span><span id="intersection2-1566"><a href="#intersection2-1566"><span class="linenos">1566</span></a>
</span><span id="intersection2-1567"><a href="#intersection2-1567"><span class="linenos">1567</span></a><span class="sd">    Args:</span>
</span><span id="intersection2-1568"><a href="#intersection2-1568"><span class="linenos">1568</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line segment.</span>
</span><span id="intersection2-1569"><a href="#intersection2-1569"><span class="linenos">1569</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line segment.</span>
</span><span id="intersection2-1570"><a href="#intersection2-1570"><span class="linenos">1570</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line segment.</span>
</span><span id="intersection2-1571"><a href="#intersection2-1571"><span class="linenos">1571</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line segment.</span>
</span><span id="intersection2-1572"><a href="#intersection2-1572"><span class="linenos">1572</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line segment.</span>
</span><span id="intersection2-1573"><a href="#intersection2-1573"><span class="linenos">1573</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line segment.</span>
</span><span id="intersection2-1574"><a href="#intersection2-1574"><span class="linenos">1574</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line segment.</span>
</span><span id="intersection2-1575"><a href="#intersection2-1575"><span class="linenos">1575</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line segment.</span>
</span><span id="intersection2-1576"><a href="#intersection2-1576"><span class="linenos">1576</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="intersection2-1577"><a href="#intersection2-1577"><span class="linenos">1577</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="intersection2-1578"><a href="#intersection2-1578"><span class="linenos">1578</span></a>
</span><span id="intersection2-1579"><a href="#intersection2-1579"><span class="linenos">1579</span></a><span class="sd">    Returns:</span>
</span><span id="intersection2-1580"><a href="#intersection2-1580"><span class="linenos">1580</span></a><span class="sd">        tuple: Connection type and intersection point.</span>
</span><span id="intersection2-1581"><a href="#intersection2-1581"><span class="linenos">1581</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersection2-1582"><a href="#intersection2-1582"><span class="linenos">1582</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="intersection2-1583"><a href="#intersection2-1583"><span class="linenos">1583</span></a>    <span class="n">x2_x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="intersection2-1584"><a href="#intersection2-1584"><span class="linenos">1584</span></a>    <span class="n">y2_y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="intersection2-1585"><a href="#intersection2-1585"><span class="linenos">1585</span></a>    <span class="n">x4_x3</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="intersection2-1586"><a href="#intersection2-1586"><span class="linenos">1586</span></a>    <span class="n">y4_y3</span> <span class="o">=</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="intersection2-1587"><a href="#intersection2-1587"><span class="linenos">1587</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="intersection2-1588"><a href="#intersection2-1588"><span class="linenos">1588</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>  <span class="c1"># parallel</span>
</span><span id="intersection2-1589"><a href="#intersection2-1589"><span class="linenos">1589</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="intersection2-1590"><a href="#intersection2-1590"><span class="linenos">1590</span></a>    <span class="n">x1_x3</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="intersection2-1591"><a href="#intersection2-1591"><span class="linenos">1591</span></a>    <span class="n">y1_y3</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="intersection2-1592"><a href="#intersection2-1592"><span class="linenos">1592</span></a>    <span class="n">ua</span> <span class="o">=</span> <span class="p">((</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1_y3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x3</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="intersection2-1593"><a href="#intersection2-1593"><span class="linenos">1593</span></a>    <span class="k">if</span> <span class="n">ua</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ua</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="intersection2-1594"><a href="#intersection2-1594"><span class="linenos">1594</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="intersection2-1595"><a href="#intersection2-1595"><span class="linenos">1595</span></a>    <span class="n">ub</span> <span class="o">=</span> <span class="p">((</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1_y3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x3</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="intersection2-1596"><a href="#intersection2-1596"><span class="linenos">1596</span></a>    <span class="k">if</span> <span class="n">ub</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ub</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="intersection2-1597"><a href="#intersection2-1597"><span class="linenos">1597</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="intersection2-1598"><a href="#intersection2-1598"><span class="linenos">1598</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">ua</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span>
</span><span id="intersection2-1599"><a href="#intersection2-1599"><span class="linenos">1599</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ua</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="intersection2-1600"><a href="#intersection2-1600"><span class="linenos">1600</span></a>    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">INTERSECT</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check the intersection of two line segments. See the documentation</p>

<p>Args:
    x1 (float): x-coordinate of the first point of the first line segment.
    y1 (float): y-coordinate of the first point of the first line segment.
    x2 (float): x-coordinate of the second point of the first line segment.
    y2 (float): y-coordinate of the second point of the first line segment.
    x3 (float): x-coordinate of the first point of the second line segment.
    y3 (float): y-coordinate of the first point of the second line segment.
    x4 (float): x-coordinate of the second point of the second line segment.
    y4 (float): y-coordinate of the second point of the second line segment.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    tuple: Connection type and intersection point.</p>
</div>


                </section>
                <section id="intersection3">
                            <input id="intersection3-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersection3</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">x4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n"><a href="../graphics/all_enums.html#Connection">simetri.graphics.all_enums.Connection</a></span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="intersection3-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersection3"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersection3-1603"><a href="#intersection3-1603"><span class="linenos">1603</span></a><span class="k">def</span> <span class="nf">intersection3</span><span class="p">(</span>
</span><span id="intersection3-1604"><a href="#intersection3-1604"><span class="linenos">1604</span></a>    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1605"><a href="#intersection3-1605"><span class="linenos">1605</span></a>    <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1606"><a href="#intersection3-1606"><span class="linenos">1606</span></a>    <span class="n">x2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1607"><a href="#intersection3-1607"><span class="linenos">1607</span></a>    <span class="n">y2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1608"><a href="#intersection3-1608"><span class="linenos">1608</span></a>    <span class="n">x3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1609"><a href="#intersection3-1609"><span class="linenos">1609</span></a>    <span class="n">y3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1610"><a href="#intersection3-1610"><span class="linenos">1610</span></a>    <span class="n">x4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1611"><a href="#intersection3-1611"><span class="linenos">1611</span></a>    <span class="n">y4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="intersection3-1612"><a href="#intersection3-1612"><span class="linenos">1612</span></a>    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersection3-1613"><a href="#intersection3-1613"><span class="linenos">1613</span></a>    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersection3-1614"><a href="#intersection3-1614"><span class="linenos">1614</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersection3-1615"><a href="#intersection3-1615"><span class="linenos">1615</span></a>    <span class="n">area_atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="intersection3-1616"><a href="#intersection3-1616"><span class="linenos">1616</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Connection</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="intersection3-1617"><a href="#intersection3-1617"><span class="linenos">1617</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the intersection of two line segments. See the documentation</span>
</span><span id="intersection3-1618"><a href="#intersection3-1618"><span class="linenos">1618</span></a><span class="sd">    for more details.</span>
</span><span id="intersection3-1619"><a href="#intersection3-1619"><span class="linenos">1619</span></a>
</span><span id="intersection3-1620"><a href="#intersection3-1620"><span class="linenos">1620</span></a><span class="sd">    Args:</span>
</span><span id="intersection3-1621"><a href="#intersection3-1621"><span class="linenos">1621</span></a><span class="sd">        x1 (float): x-coordinate of the first point of the first line segment.</span>
</span><span id="intersection3-1622"><a href="#intersection3-1622"><span class="linenos">1622</span></a><span class="sd">        y1 (float): y-coordinate of the first point of the first line segment.</span>
</span><span id="intersection3-1623"><a href="#intersection3-1623"><span class="linenos">1623</span></a><span class="sd">        x2 (float): x-coordinate of the second point of the first line segment.</span>
</span><span id="intersection3-1624"><a href="#intersection3-1624"><span class="linenos">1624</span></a><span class="sd">        y2 (float): y-coordinate of the second point of the first line segment.</span>
</span><span id="intersection3-1625"><a href="#intersection3-1625"><span class="linenos">1625</span></a><span class="sd">        x3 (float): x-coordinate of the first point of the second line segment.</span>
</span><span id="intersection3-1626"><a href="#intersection3-1626"><span class="linenos">1626</span></a><span class="sd">        y3 (float): y-coordinate of the first point of the second line segment.</span>
</span><span id="intersection3-1627"><a href="#intersection3-1627"><span class="linenos">1627</span></a><span class="sd">        x4 (float): x-coordinate of the second point of the second line segment.</span>
</span><span id="intersection3-1628"><a href="#intersection3-1628"><span class="linenos">1628</span></a><span class="sd">        y4 (float): y-coordinate of the second point of the second line segment.</span>
</span><span id="intersection3-1629"><a href="#intersection3-1629"><span class="linenos">1629</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="intersection3-1630"><a href="#intersection3-1630"><span class="linenos">1630</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="intersection3-1631"><a href="#intersection3-1631"><span class="linenos">1631</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="intersection3-1632"><a href="#intersection3-1632"><span class="linenos">1632</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="intersection3-1633"><a href="#intersection3-1633"><span class="linenos">1633</span></a>
</span><span id="intersection3-1634"><a href="#intersection3-1634"><span class="linenos">1634</span></a><span class="sd">    Returns:</span>
</span><span id="intersection3-1635"><a href="#intersection3-1635"><span class="linenos">1635</span></a><span class="sd">        tuple: Connection type and intersection result.</span>
</span><span id="intersection3-1636"><a href="#intersection3-1636"><span class="linenos">1636</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersection3-1637"><a href="#intersection3-1637"><span class="linenos">1637</span></a>    <span class="c1"># collinear check uses area_atol</span>
</span><span id="intersection3-1638"><a href="#intersection3-1638"><span class="linenos">1638</span></a>
</span><span id="intersection3-1639"><a href="#intersection3-1639"><span class="linenos">1639</span></a>    <span class="c1"># s1: start1 = (x1, y1)</span>
</span><span id="intersection3-1640"><a href="#intersection3-1640"><span class="linenos">1640</span></a>    <span class="c1"># e1: end1 = (x2, y2)</span>
</span><span id="intersection3-1641"><a href="#intersection3-1641"><span class="linenos">1641</span></a>    <span class="c1"># s2: start2 = (x3, y3)</span>
</span><span id="intersection3-1642"><a href="#intersection3-1642"><span class="linenos">1642</span></a>    <span class="c1"># e2: end2 = (x4, y4)</span>
</span><span id="intersection3-1643"><a href="#intersection3-1643"><span class="linenos">1643</span></a>    <span class="c1"># s1s2: start1 and start2 is connected</span>
</span><span id="intersection3-1644"><a href="#intersection3-1644"><span class="linenos">1644</span></a>    <span class="c1"># s1e2: start1 and end2 is connected</span>
</span><span id="intersection3-1645"><a href="#intersection3-1645"><span class="linenos">1645</span></a>    <span class="c1"># e1s2: end1 and start2 is connected</span>
</span><span id="intersection3-1646"><a href="#intersection3-1646"><span class="linenos">1646</span></a>    <span class="c1"># e1e2: end1 and end2 is connected</span>
</span><span id="intersection3-1647"><a href="#intersection3-1647"><span class="linenos">1647</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="intersection3-1648"><a href="#intersection3-1648"><span class="linenos">1648</span></a>        <span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">,</span> <span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="intersection3-1649"><a href="#intersection3-1649"><span class="linenos">1649</span></a>    <span class="p">)</span>
</span><span id="intersection3-1650"><a href="#intersection3-1650"><span class="linenos">1650</span></a>
</span><span id="intersection3-1651"><a href="#intersection3-1651"><span class="linenos">1651</span></a>    <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="intersection3-1652"><a href="#intersection3-1652"><span class="linenos">1652</span></a>    <span class="n">e1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</span><span id="intersection3-1653"><a href="#intersection3-1653"><span class="linenos">1653</span></a>    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
</span><span id="intersection3-1654"><a href="#intersection3-1654"><span class="linenos">1654</span></a>    <span class="n">e2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="intersection3-1655"><a href="#intersection3-1655"><span class="linenos">1655</span></a>    <span class="n">segment1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
</span><span id="intersection3-1656"><a href="#intersection3-1656"><span class="linenos">1656</span></a>    <span class="n">segment2</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)]</span>
</span><span id="intersection3-1657"><a href="#intersection3-1657"><span class="linenos">1657</span></a>
</span><span id="intersection3-1658"><a href="#intersection3-1658"><span class="linenos">1658</span></a>    <span class="c1"># check if the segments&#39; bounding boxes overlap</span>
</span><span id="intersection3-1659"><a href="#intersection3-1659"><span class="linenos">1659</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">line_segment_bbox_check</span><span class="p">(</span><span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">):</span>
</span><span id="intersection3-1660"><a href="#intersection3-1660"><span class="linenos">1660</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="intersection3-1661"><a href="#intersection3-1661"><span class="linenos">1661</span></a>
</span><span id="intersection3-1662"><a href="#intersection3-1662"><span class="linenos">1662</span></a>    <span class="c1"># Check if the segments are parallel</span>
</span><span id="intersection3-1663"><a href="#intersection3-1663"><span class="linenos">1663</span></a>    <span class="n">x2_x1</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="intersection3-1664"><a href="#intersection3-1664"><span class="linenos">1664</span></a>    <span class="n">y2_y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="intersection3-1665"><a href="#intersection3-1665"><span class="linenos">1665</span></a>    <span class="n">x4_x3</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">-</span> <span class="n">x3</span>
</span><span id="intersection3-1666"><a href="#intersection3-1666"><span class="linenos">1666</span></a>    <span class="n">y4_y3</span> <span class="o">=</span> <span class="n">y4</span> <span class="o">-</span> <span class="n">y3</span>
</span><span id="intersection3-1667"><a href="#intersection3-1667"><span class="linenos">1667</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">y4_y3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2_x1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x4_x3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2_y1</span><span class="p">)</span>
</span><span id="intersection3-1668"><a href="#intersection3-1668"><span class="linenos">1668</span></a>    <span class="n">parallel</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1669"><a href="#intersection3-1669"><span class="linenos">1669</span></a>    <span class="c1"># angle1 = atan2(y2 - y1, x2 - x1) % pi</span>
</span><span id="intersection3-1670"><a href="#intersection3-1670"><span class="linenos">1670</span></a>    <span class="c1"># angle2 = atan2(y4 - y3, x4 - x3) % pi</span>
</span><span id="intersection3-1671"><a href="#intersection3-1671"><span class="linenos">1671</span></a>    <span class="c1"># parallel = close_angles(angle1, angle2, angtol=defaults[&#39;angtol&#39;])</span>
</span><span id="intersection3-1672"><a href="#intersection3-1672"><span class="linenos">1672</span></a>
</span><span id="intersection3-1673"><a href="#intersection3-1673"><span class="linenos">1673</span></a>    <span class="c1"># Coincident end points</span>
</span><span id="intersection3-1674"><a href="#intersection3-1674"><span class="linenos">1674</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="intersection3-1675"><a href="#intersection3-1675"><span class="linenos">1675</span></a>    <span class="n">s1s2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="intersection3-1676"><a href="#intersection3-1676"><span class="linenos">1676</span></a>    <span class="n">s1e2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="intersection3-1677"><a href="#intersection3-1677"><span class="linenos">1677</span></a>    <span class="n">e1s2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="intersection3-1678"><a href="#intersection3-1678"><span class="linenos">1678</span></a>    <span class="n">e1e2</span> <span class="o">=</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">)</span>
</span><span id="intersection3-1679"><a href="#intersection3-1679"><span class="linenos">1679</span></a>    <span class="n">connected</span> <span class="o">=</span> <span class="n">s1s2</span> <span class="ow">or</span> <span class="n">s1e2</span> <span class="ow">or</span> <span class="n">e1s2</span> <span class="ow">or</span> <span class="n">e1e2</span>
</span><span id="intersection3-1680"><a href="#intersection3-1680"><span class="linenos">1680</span></a>    <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="intersection3-1681"><a href="#intersection3-1681"><span class="linenos">1681</span></a>        <span class="n">length1</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</span><span id="intersection3-1682"><a href="#intersection3-1682"><span class="linenos">1682</span></a>        <span class="n">length2</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="intersection3-1683"><a href="#intersection3-1683"><span class="linenos">1683</span></a>        <span class="n">min_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</span><span id="intersection3-1684"><a href="#intersection3-1684"><span class="linenos">1684</span></a>        <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</span><span id="intersection3-1685"><a href="#intersection3-1685"><span class="linenos">1685</span></a>        <span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="intersection3-1686"><a href="#intersection3-1686"><span class="linenos">1686</span></a>        <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span><span id="intersection3-1687"><a href="#intersection3-1687"><span class="linenos">1687</span></a>        <span class="n">total_length</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">),</span> <span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">))</span>
</span><span id="intersection3-1688"><a href="#intersection3-1688"><span class="linenos">1688</span></a>        <span class="n">l1_eq_l2</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span><span class="p">,</span> <span class="n">length2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1689"><a href="#intersection3-1689"><span class="linenos">1689</span></a>        <span class="n">l1_eq_total</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1690"><a href="#intersection3-1690"><span class="linenos">1690</span></a>        <span class="n">l2_eq_total</span> <span class="o">=</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length2</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1691"><a href="#intersection3-1691"><span class="linenos">1691</span></a>        <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
</span><span id="intersection3-1692"><a href="#intersection3-1692"><span class="linenos">1692</span></a>            <span class="k">if</span> <span class="n">l1_eq_l2</span> <span class="ow">and</span> <span class="n">l1_eq_total</span><span class="p">:</span>
</span><span id="intersection3-1693"><a href="#intersection3-1693"><span class="linenos">1693</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CONGRUENT</span><span class="p">,</span> <span class="n">segment1</span>
</span><span id="intersection3-1694"><a href="#intersection3-1694"><span class="linenos">1694</span></a>
</span><span id="intersection3-1695"><a href="#intersection3-1695"><span class="linenos">1695</span></a>            <span class="k">if</span> <span class="n">l1_eq_total</span><span class="p">:</span>
</span><span id="intersection3-1696"><a href="#intersection3-1696"><span class="linenos">1696</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CONTAINS</span><span class="p">,</span> <span class="n">segment1</span>
</span><span id="intersection3-1697"><a href="#intersection3-1697"><span class="linenos">1697</span></a>            <span class="k">if</span> <span class="n">l2_eq_total</span><span class="p">:</span>
</span><span id="intersection3-1698"><a href="#intersection3-1698"><span class="linenos">1698</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">WITHIN</span><span class="p">,</span> <span class="n">segment2</span>
</span><span id="intersection3-1699"><a href="#intersection3-1699"><span class="linenos">1699</span></a>            <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">):</span>
</span><span id="intersection3-1700"><a href="#intersection3-1700"><span class="linenos">1700</span></a>                <span class="c1"># chained and collienar</span>
</span><span id="intersection3-1701"><a href="#intersection3-1701"><span class="linenos">1701</span></a>                <span class="k">if</span> <span class="n">s1s2</span><span class="p">:</span>
</span><span id="intersection3-1702"><a href="#intersection3-1702"><span class="linenos">1702</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="intersection3-1703"><a href="#intersection3-1703"><span class="linenos">1703</span></a>                <span class="k">if</span> <span class="n">s1e2</span><span class="p">:</span>
</span><span id="intersection3-1704"><a href="#intersection3-1704"><span class="linenos">1704</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="intersection3-1705"><a href="#intersection3-1705"><span class="linenos">1705</span></a>                <span class="k">if</span> <span class="n">e1s2</span><span class="p">:</span>
</span><span id="intersection3-1706"><a href="#intersection3-1706"><span class="linenos">1706</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="intersection3-1707"><a href="#intersection3-1707"><span class="linenos">1707</span></a>                <span class="k">if</span> <span class="n">e1e2</span><span class="p">:</span>
</span><span id="intersection3-1708"><a href="#intersection3-1708"><span class="linenos">1708</span></a>                    <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="intersection3-1709"><a href="#intersection3-1709"><span class="linenos">1709</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="intersection3-1710"><a href="#intersection3-1710"><span class="linenos">1710</span></a>            <span class="k">if</span> <span class="n">total_length</span> <span class="o">&lt;</span> <span class="n">length1</span> <span class="o">+</span> <span class="n">length2</span> <span class="ow">and</span> <span class="n">collinear_segments</span><span class="p">(</span>
</span><span id="intersection3-1711"><a href="#intersection3-1711"><span class="linenos">1711</span></a>                <span class="n">segment1</span><span class="p">,</span> <span class="n">segment2</span><span class="p">,</span> <span class="n">atol</span>
</span><span id="intersection3-1712"><a href="#intersection3-1712"><span class="linenos">1712</span></a>            <span class="p">):</span>
</span><span id="intersection3-1713"><a href="#intersection3-1713"><span class="linenos">1713</span></a>                <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">)</span>
</span><span id="intersection3-1714"><a href="#intersection3-1714"><span class="linenos">1714</span></a>                <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
</span><span id="intersection3-1715"><a href="#intersection3-1715"><span class="linenos">1715</span></a>                <span class="n">seg</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span><span id="intersection3-1716"><a href="#intersection3-1716"><span class="linenos">1716</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">OVERLAPS</span><span class="p">,</span> <span class="n">seg</span>
</span><span id="intersection3-1717"><a href="#intersection3-1717"><span class="linenos">1717</span></a>
</span><span id="intersection3-1718"><a href="#intersection3-1718"><span class="linenos">1718</span></a>            <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1719"><a href="#intersection3-1719"><span class="linenos">1719</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="intersection3-1720"><a href="#intersection3-1720"><span class="linenos">1720</span></a>        <span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
</span><span id="intersection3-1721"><a href="#intersection3-1721"><span class="linenos">1721</span></a>            <span class="k">if</span> <span class="n">s1s2</span><span class="p">:</span>
</span><span id="intersection3-1722"><a href="#intersection3-1722"><span class="linenos">1722</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="intersection3-1723"><a href="#intersection3-1723"><span class="linenos">1723</span></a>            <span class="k">if</span> <span class="n">s1e2</span><span class="p">:</span>
</span><span id="intersection3-1724"><a href="#intersection3-1724"><span class="linenos">1724</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="intersection3-1725"><a href="#intersection3-1725"><span class="linenos">1725</span></a>            <span class="k">if</span> <span class="n">e1s2</span><span class="p">:</span>
</span><span id="intersection3-1726"><a href="#intersection3-1726"><span class="linenos">1726</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</span><span id="intersection3-1727"><a href="#intersection3-1727"><span class="linenos">1727</span></a>            <span class="k">if</span> <span class="n">e1e2</span><span class="p">:</span>
</span><span id="intersection3-1728"><a href="#intersection3-1728"><span class="linenos">1728</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">,</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span><span id="intersection3-1729"><a href="#intersection3-1729"><span class="linenos">1729</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="intersection3-1730"><a href="#intersection3-1730"><span class="linenos">1730</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">):</span>
</span><span id="intersection3-1731"><a href="#intersection3-1731"><span class="linenos">1731</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">e1</span>
</span><span id="intersection3-1732"><a href="#intersection3-1732"><span class="linenos">1732</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span><span id="intersection3-1733"><a href="#intersection3-1733"><span class="linenos">1733</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">s1</span>
</span><span id="intersection3-1734"><a href="#intersection3-1734"><span class="linenos">1734</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
</span><span id="intersection3-1735"><a href="#intersection3-1735"><span class="linenos">1735</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">e2</span>
</span><span id="intersection3-1736"><a href="#intersection3-1736"><span class="linenos">1736</span></a>            <span class="k">if</span> <span class="n">between</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">s1</span><span class="p">):</span>
</span><span id="intersection3-1737"><a href="#intersection3-1737"><span class="linenos">1737</span></a>                <span class="k">return</span> <span class="n">Connection</span><span class="o">.</span><span class="n">YJOINT</span><span class="p">,</span> <span class="n">s2</span>
</span><span id="intersection3-1738"><a href="#intersection3-1738"><span class="linenos">1738</span></a>
</span><span id="intersection3-1739"><a href="#intersection3-1739"><span class="linenos">1739</span></a>            <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">)</span>
</span><span id="intersection3-1740"><a href="#intersection3-1740"><span class="linenos">1740</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">Connection</span><span class="o">.</span><span class="n">DISJOINT</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check the intersection of two line segments. See the documentation
for more details.</p>

<p>Args:
    x1 (float): x-coordinate of the first point of the first line segment.
    y1 (float): y-coordinate of the first point of the first line segment.
    x2 (float): x-coordinate of the second point of the first line segment.
    y2 (float): y-coordinate of the second point of the first line segment.
    x3 (float): x-coordinate of the first point of the second line segment.
    y3 (float): y-coordinate of the first point of the second line segment.
    x4 (float): x-coordinate of the second point of the second line segment.
    y4 (float): y-coordinate of the second point of the second line segment.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.
    dist_tol (float, optional): Distance tolerance. Defaults to None.
    area_atol (float, optional): Absolute tolerance for area. Defaults to None.</p>

<p>Returns:
    tuple: Connection type and intersection result.</p>
</div>


                </section>
                <section id="merge_consecutive_collinear_edges">
                            <input id="merge_consecutive_collinear_edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merge_consecutive_collinear_edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">closed</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="merge_consecutive_collinear_edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#merge_consecutive_collinear_edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="merge_consecutive_collinear_edges-1743"><a href="#merge_consecutive_collinear_edges-1743"><span class="linenos">1743</span></a><span class="k">def</span> <span class="nf">merge_consecutive_collinear_edges</span><span class="p">(</span>
</span><span id="merge_consecutive_collinear_edges-1744"><a href="#merge_consecutive_collinear_edges-1744"><span class="linenos">1744</span></a>    <span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span>
</span><span id="merge_consecutive_collinear_edges-1745"><a href="#merge_consecutive_collinear_edges-1745"><span class="linenos">1745</span></a><span class="p">):</span>
</span><span id="merge_consecutive_collinear_edges-1746"><a href="#merge_consecutive_collinear_edges-1746"><span class="linenos">1746</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove the middle points from collinear edges.</span>
</span><span id="merge_consecutive_collinear_edges-1747"><a href="#merge_consecutive_collinear_edges-1747"><span class="linenos">1747</span></a>
</span><span id="merge_consecutive_collinear_edges-1748"><a href="#merge_consecutive_collinear_edges-1748"><span class="linenos">1748</span></a><span class="sd">    Args:</span>
</span><span id="merge_consecutive_collinear_edges-1749"><a href="#merge_consecutive_collinear_edges-1749"><span class="linenos">1749</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="merge_consecutive_collinear_edges-1750"><a href="#merge_consecutive_collinear_edges-1750"><span class="linenos">1750</span></a><span class="sd">        closed (bool, optional): Whether the points form a closed shape. Defaults to False.</span>
</span><span id="merge_consecutive_collinear_edges-1751"><a href="#merge_consecutive_collinear_edges-1751"><span class="linenos">1751</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="merge_consecutive_collinear_edges-1752"><a href="#merge_consecutive_collinear_edges-1752"><span class="linenos">1752</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="merge_consecutive_collinear_edges-1753"><a href="#merge_consecutive_collinear_edges-1753"><span class="linenos">1753</span></a>
</span><span id="merge_consecutive_collinear_edges-1754"><a href="#merge_consecutive_collinear_edges-1754"><span class="linenos">1754</span></a><span class="sd">    Returns:</span>
</span><span id="merge_consecutive_collinear_edges-1755"><a href="#merge_consecutive_collinear_edges-1755"><span class="linenos">1755</span></a><span class="sd">        list[Point]: List of points with collinear points removed.</span>
</span><span id="merge_consecutive_collinear_edges-1756"><a href="#merge_consecutive_collinear_edges-1756"><span class="linenos">1756</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="merge_consecutive_collinear_edges-1757"><a href="#merge_consecutive_collinear_edges-1757"><span class="linenos">1757</span></a>    <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="merge_consecutive_collinear_edges-1758"><a href="#merge_consecutive_collinear_edges-1758"><span class="linenos">1758</span></a>        <span class="p">[</span><span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="merge_consecutive_collinear_edges-1759"><a href="#merge_consecutive_collinear_edges-1759"><span class="linenos">1759</span></a>    <span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1760"><a href="#merge_consecutive_collinear_edges-1760"><span class="linenos">1760</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:]</span>
</span><span id="merge_consecutive_collinear_edges-1761"><a href="#merge_consecutive_collinear_edges-1761"><span class="linenos">1761</span></a>
</span><span id="merge_consecutive_collinear_edges-1762"><a href="#merge_consecutive_collinear_edges-1762"><span class="linenos">1762</span></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="merge_consecutive_collinear_edges-1763"><a href="#merge_consecutive_collinear_edges-1763"><span class="linenos">1763</span></a>        <span class="n">cyc</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1764"><a href="#merge_consecutive_collinear_edges-1764"><span class="linenos">1764</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1765"><a href="#merge_consecutive_collinear_edges-1765"><span class="linenos">1765</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1766"><a href="#merge_consecutive_collinear_edges-1766"><span class="linenos">1766</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1767"><a href="#merge_consecutive_collinear_edges-1767"><span class="linenos">1767</span></a>        <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="merge_consecutive_collinear_edges-1768"><a href="#merge_consecutive_collinear_edges-1768"><span class="linenos">1768</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="merge_consecutive_collinear_edges-1769"><a href="#merge_consecutive_collinear_edges-1769"><span class="linenos">1769</span></a>        <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="merge_consecutive_collinear_edges-1770"><a href="#merge_consecutive_collinear_edges-1770"><span class="linenos">1770</span></a>            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="merge_consecutive_collinear_edges-1771"><a href="#merge_consecutive_collinear_edges-1771"><span class="linenos">1771</span></a>        <span class="n">discarded</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="merge_consecutive_collinear_edges-1772"><a href="#merge_consecutive_collinear_edges-1772"><span class="linenos">1772</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="merge_consecutive_collinear_edges-1773"><a href="#merge_consecutive_collinear_edges-1773"><span class="linenos">1773</span></a>            <span class="k">if</span> <span class="n">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="n">area_atol</span><span class="p">):</span>
</span><span id="merge_consecutive_collinear_edges-1774"><a href="#merge_consecutive_collinear_edges-1774"><span class="linenos">1774</span></a>                <span class="n">discarded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1775"><a href="#merge_consecutive_collinear_edges-1775"><span class="linenos">1775</span></a>                <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="merge_consecutive_collinear_edges-1776"><a href="#merge_consecutive_collinear_edges-1776"><span class="linenos">1776</span></a>                <span class="k">break</span>
</span><span id="merge_consecutive_collinear_edges-1777"><a href="#merge_consecutive_collinear_edges-1777"><span class="linenos">1777</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
</span><span id="merge_consecutive_collinear_edges-1778"><a href="#merge_consecutive_collinear_edges-1778"><span class="linenos">1778</span></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="merge_consecutive_collinear_edges-1779"><a href="#merge_consecutive_collinear_edges-1779"><span class="linenos">1779</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cyc</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1780"><a href="#merge_consecutive_collinear_edges-1780"><span class="linenos">1780</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">discarded</span><span class="p">:</span>
</span><span id="merge_consecutive_collinear_edges-1781"><a href="#merge_consecutive_collinear_edges-1781"><span class="linenos">1781</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="merge_consecutive_collinear_edges-1782"><a href="#merge_consecutive_collinear_edges-1782"><span class="linenos">1782</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">looping</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="merge_consecutive_collinear_edges-1783"><a href="#merge_consecutive_collinear_edges-1783"><span class="linenos">1783</span></a>            <span class="k">break</span>
</span><span id="merge_consecutive_collinear_edges-1784"><a href="#merge_consecutive_collinear_edges-1784"><span class="linenos">1784</span></a>
</span><span id="merge_consecutive_collinear_edges-1785"><a href="#merge_consecutive_collinear_edges-1785"><span class="linenos">1785</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>Remove the middle points from collinear edges.</p>

<p>Args:
    points (list[Point]): List of points.
    closed (bool, optional): Whether the points form a closed shape. Defaults to False.
    area_rtol (float, optional): Relative tolerance for area. Defaults to None.
    area_atol (float, optional): Absolute tolerance for area. Defaults to None.</p>

<p>Returns:
    list[Point]: List of points with collinear points removed.</p>
</div>


                </section>
                <section id="intersection">
                            <input id="intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">line2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersection-1788"><a href="#intersection-1788"><span class="linenos">1788</span></a><span class="k">def</span> <span class="nf">intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="intersection-1789"><a href="#intersection-1789"><span class="linenos">1789</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;return the intersection point of two line segments.</span>
</span><span id="intersection-1790"><a href="#intersection-1790"><span class="linenos">1790</span></a><span class="sd">    segment1: ((x1, y1), (x2, y2))</span>
</span><span id="intersection-1791"><a href="#intersection-1791"><span class="linenos">1791</span></a><span class="sd">    segment2: ((x3, y3), (x4, y4))</span>
</span><span id="intersection-1792"><a href="#intersection-1792"><span class="linenos">1792</span></a><span class="sd">    if line segments do not intersect return -1</span>
</span><span id="intersection-1793"><a href="#intersection-1793"><span class="linenos">1793</span></a><span class="sd">    if line segments are parallel return 0</span>
</span><span id="intersection-1794"><a href="#intersection-1794"><span class="linenos">1794</span></a><span class="sd">    if line segments are connected (share a point) return 1</span>
</span><span id="intersection-1795"><a href="#intersection-1795"><span class="linenos">1795</span></a><span class="sd">    To find the intersection point of two lines use the &quot;intersect&quot; function</span>
</span><span id="intersection-1796"><a href="#intersection-1796"><span class="linenos">1796</span></a>
</span><span id="intersection-1797"><a href="#intersection-1797"><span class="linenos">1797</span></a><span class="sd">    Args:</span>
</span><span id="intersection-1798"><a href="#intersection-1798"><span class="linenos">1798</span></a><span class="sd">        line1 (Line): First line segment.</span>
</span><span id="intersection-1799"><a href="#intersection-1799"><span class="linenos">1799</span></a><span class="sd">        line2 (Line): Second line segment.</span>
</span><span id="intersection-1800"><a href="#intersection-1800"><span class="linenos">1800</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="intersection-1801"><a href="#intersection-1801"><span class="linenos">1801</span></a>
</span><span id="intersection-1802"><a href="#intersection-1802"><span class="linenos">1802</span></a><span class="sd">    Returns:</span>
</span><span id="intersection-1803"><a href="#intersection-1803"><span class="linenos">1803</span></a><span class="sd">        int: Intersection type.</span>
</span><span id="intersection-1804"><a href="#intersection-1804"><span class="linenos">1804</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersection-1805"><a href="#intersection-1805"><span class="linenos">1805</span></a>    <span class="k">if</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="intersection-1806"><a href="#intersection-1806"><span class="linenos">1806</span></a>        <span class="n">rtol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span>
</span><span id="intersection-1807"><a href="#intersection-1807"><span class="linenos">1807</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="intersection-1808"><a href="#intersection-1808"><span class="linenos">1808</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="intersection-1809"><a href="#intersection-1809"><span class="linenos">1809</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="intersection-1810"><a href="#intersection-1810"><span class="linenos">1810</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="intersection-1811"><a href="#intersection-1811"><span class="linenos">1811</span></a>    <span class="k">return</span> <span class="n">intersection2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the intersection point of two line segments.
segment1: ((x1, y1), (x2, y2))
segment2: ((x3, y3), (x4, y4))
if line segments do not intersect return -1
if line segments are parallel return 0
if line segments are connected (share a point) return 1
To find the intersection point of two lines use the "intersect" function</p>

<p>Args:
    line1 (Line): First line segment.
    line2 (Line): Second line segment.
    rtol (float, optional): Relative tolerance. Defaults to None.</p>

<p>Returns:
    int: Intersection type.</p>
</div>


                </section>
                <section id="merge_segments">
                            <input id="merge_segments-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merge_segments</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">seg1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">seg2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="merge_segments-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#merge_segments"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="merge_segments-1814"><a href="#merge_segments-1814"><span class="linenos">1814</span></a><span class="k">def</span> <span class="nf">merge_segments</span><span class="p">(</span><span class="n">seg1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">seg2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="merge_segments-1815"><a href="#merge_segments-1815"><span class="linenos">1815</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge two segments into one segment if they are connected.</span>
</span><span id="merge_segments-1816"><a href="#merge_segments-1816"><span class="linenos">1816</span></a><span class="sd">    They need to be overlapping or simply connected to each other,</span>
</span><span id="merge_segments-1817"><a href="#merge_segments-1817"><span class="linenos">1817</span></a><span class="sd">    otherwise they will not be merged. Order doesn&#39;t matter.</span>
</span><span id="merge_segments-1818"><a href="#merge_segments-1818"><span class="linenos">1818</span></a>
</span><span id="merge_segments-1819"><a href="#merge_segments-1819"><span class="linenos">1819</span></a><span class="sd">    Args:</span>
</span><span id="merge_segments-1820"><a href="#merge_segments-1820"><span class="linenos">1820</span></a><span class="sd">        seg1 (Sequence[Point]): First segment.</span>
</span><span id="merge_segments-1821"><a href="#merge_segments-1821"><span class="linenos">1821</span></a><span class="sd">        seg2 (Sequence[Point]): Second segment.</span>
</span><span id="merge_segments-1822"><a href="#merge_segments-1822"><span class="linenos">1822</span></a>
</span><span id="merge_segments-1823"><a href="#merge_segments-1823"><span class="linenos">1823</span></a><span class="sd">    Returns:</span>
</span><span id="merge_segments-1824"><a href="#merge_segments-1824"><span class="linenos">1824</span></a><span class="sd">        Sequence[Point]: Merged segment.</span>
</span><span id="merge_segments-1825"><a href="#merge_segments-1825"><span class="linenos">1825</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="merge_segments-1826"><a href="#merge_segments-1826"><span class="linenos">1826</span></a>    <span class="n">Conn</span> <span class="o">=</span> <span class="n">Connection</span>
</span><span id="merge_segments-1827"><a href="#merge_segments-1827"><span class="linenos">1827</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">seg1</span>
</span><span id="merge_segments-1828"><a href="#merge_segments-1828"><span class="linenos">1828</span></a>    <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">seg2</span>
</span><span id="merge_segments-1829"><a href="#merge_segments-1829"><span class="linenos">1829</span></a>
</span><span id="merge_segments-1830"><a href="#merge_segments-1830"><span class="linenos">1830</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">all_intersections</span><span class="p">([(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)],</span> <span class="n">use_intersection3</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="merge_segments-1831"><a href="#merge_segments-1831"><span class="linenos">1831</span></a>    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
</span><span id="merge_segments-1832"><a href="#merge_segments-1832"><span class="linenos">1832</span></a>        <span class="n">conn_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="merge_segments-1833"><a href="#merge_segments-1833"><span class="linenos">1833</span></a>        <span class="n">verts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="merge_segments-1834"><a href="#merge_segments-1834"><span class="linenos">1834</span></a>        <span class="k">if</span> <span class="n">conn_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Conn</span><span class="o">.</span><span class="n">OVERLAPS</span><span class="p">,</span> <span class="n">Conn</span><span class="o">.</span><span class="n">CONGRUENT</span><span class="p">,</span> <span class="n">Conn</span><span class="o">.</span><span class="n">CHAIN</span><span class="p">]:</span>
</span><span id="merge_segments-1835"><a href="#merge_segments-1835"><span class="linenos">1835</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">verts</span>
</span><span id="merge_segments-1836"><a href="#merge_segments-1836"><span class="linenos">1836</span></a>        <span class="k">elif</span> <span class="n">conn_type</span> <span class="o">==</span> <span class="n">Conn</span><span class="o">.</span><span class="n">COLL_CHAIN</span><span class="p">:</span>
</span><span id="merge_segments-1837"><a href="#merge_segments-1837"><span class="linenos">1837</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="merge_segments-1838"><a href="#merge_segments-1838"><span class="linenos">1838</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="merge_segments-1839"><a href="#merge_segments-1839"><span class="linenos">1839</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="merge_segments-1840"><a href="#merge_segments-1840"><span class="linenos">1840</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="merge_segments-1841"><a href="#merge_segments-1841"><span class="linenos">1841</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># need this to avoid returning an empty dict</span>
</span><span id="merge_segments-1842"><a href="#merge_segments-1842"><span class="linenos">1842</span></a>
</span><span id="merge_segments-1843"><a href="#merge_segments-1843"><span class="linenos">1843</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Merge two segments into one segment if they are connected.
They need to be overlapping or simply connected to each other,
otherwise they will not be merged. Order doesn't matter.</p>

<p>Args:
    seg1 (Sequence[Point]): First segment.
    seg2 (Sequence[Point]): Second segment.</p>

<p>Returns:
    Sequence[Point]: Merged segment.</p>
</div>


                </section>
                <section id="invert">
                            <input id="invert-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">invert</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p</span>, </span><span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="invert-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#invert"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="invert-1846"><a href="#invert-1846"><span class="linenos">1846</span></a><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="invert-1847"><a href="#invert-1847"><span class="linenos">1847</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverts p about a circle at the given center and radius</span>
</span><span id="invert-1848"><a href="#invert-1848"><span class="linenos">1848</span></a>
</span><span id="invert-1849"><a href="#invert-1849"><span class="linenos">1849</span></a><span class="sd">    Args:</span>
</span><span id="invert-1850"><a href="#invert-1850"><span class="linenos">1850</span></a><span class="sd">        p (Point): Point to invert.</span>
</span><span id="invert-1851"><a href="#invert-1851"><span class="linenos">1851</span></a><span class="sd">        center (Point): Center of the circle.</span>
</span><span id="invert-1852"><a href="#invert-1852"><span class="linenos">1852</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="invert-1853"><a href="#invert-1853"><span class="linenos">1853</span></a>
</span><span id="invert-1854"><a href="#invert-1854"><span class="linenos">1854</span></a><span class="sd">    Returns:</span>
</span><span id="invert-1855"><a href="#invert-1855"><span class="linenos">1855</span></a><span class="sd">        Point: Inverted point.</span>
</span><span id="invert-1856"><a href="#invert-1856"><span class="linenos">1856</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="invert-1857"><a href="#invert-1857"><span class="linenos">1857</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span><span id="invert-1858"><a href="#invert-1858"><span class="linenos">1858</span></a>    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="invert-1859"><a href="#invert-1859"><span class="linenos">1859</span></a>        <span class="k">return</span> <span class="n">p</span>
</span><span id="invert-1860"><a href="#invert-1860"><span class="linenos">1860</span></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="invert-1861"><a href="#invert-1861"><span class="linenos">1861</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</span><span id="invert-1862"><a href="#invert-1862"><span class="linenos">1862</span></a>    <span class="k">return</span> <span class="n">center</span> <span class="o">+</span> <span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dist</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span>
</span><span id="invert-1863"><a href="#invert-1863"><span class="linenos">1863</span></a>    <span class="c1"># return radius**2 * (p - center) / dist</span>
</span></pre></div>


            <div class="docstring"><p>Inverts p about a circle at the given center and radius</p>

<p>Args:
    p (Point): Point to invert.
    center (Point): Center of the circle.
    radius (float): Radius of the circle.</p>

<p>Returns:
    Point: Inverted point.</p>
</div>


                </section>
                <section id="is_horizontal">
                            <input id="is_horizontal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_horizontal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_horizontal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_horizontal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_horizontal-1866"><a href="#is_horizontal-1866"><span class="linenos">1866</span></a><span class="k">def</span> <span class="nf">is_horizontal</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_horizontal-1867"><a href="#is_horizontal-1867"><span class="linenos">1867</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the line is horizontal.</span>
</span><span id="is_horizontal-1868"><a href="#is_horizontal-1868"><span class="linenos">1868</span></a>
</span><span id="is_horizontal-1869"><a href="#is_horizontal-1869"><span class="linenos">1869</span></a><span class="sd">    Args:</span>
</span><span id="is_horizontal-1870"><a href="#is_horizontal-1870"><span class="linenos">1870</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="is_horizontal-1871"><a href="#is_horizontal-1871"><span class="linenos">1871</span></a><span class="sd">        eps (float, optional): Tolerance. Defaults to 0.0001.</span>
</span><span id="is_horizontal-1872"><a href="#is_horizontal-1872"><span class="linenos">1872</span></a>
</span><span id="is_horizontal-1873"><a href="#is_horizontal-1873"><span class="linenos">1873</span></a><span class="sd">    Returns:</span>
</span><span id="is_horizontal-1874"><a href="#is_horizontal-1874"><span class="linenos">1874</span></a><span class="sd">        bool: True if the line is horizontal, False otherwise.</span>
</span><span id="is_horizontal-1875"><a href="#is_horizontal-1875"><span class="linenos">1875</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_horizontal-1876"><a href="#is_horizontal-1876"><span class="linenos">1876</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j_vec</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">eps</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the line is horizontal.</p>

<p>Args:
    line (Line): Input line.
    eps (float, optional): Tolerance. Defaults to 0.0001.</p>

<p>Returns:
    bool: True if the line is horizontal, False otherwise.</p>
</div>


                </section>
                <section id="is_line">
                            <input id="is_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line_</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_line-1879"><a href="#is_line-1879"><span class="linenos">1879</span></a><span class="k">def</span> <span class="nf">is_line</span><span class="p">(</span><span class="n">line_</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_line-1880"><a href="#is_line-1880"><span class="linenos">1880</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the input is a line.</span>
</span><span id="is_line-1881"><a href="#is_line-1881"><span class="linenos">1881</span></a>
</span><span id="is_line-1882"><a href="#is_line-1882"><span class="linenos">1882</span></a><span class="sd">    Args:</span>
</span><span id="is_line-1883"><a href="#is_line-1883"><span class="linenos">1883</span></a><span class="sd">        line_ (Any): Input value.</span>
</span><span id="is_line-1884"><a href="#is_line-1884"><span class="linenos">1884</span></a>
</span><span id="is_line-1885"><a href="#is_line-1885"><span class="linenos">1885</span></a><span class="sd">    Returns:</span>
</span><span id="is_line-1886"><a href="#is_line-1886"><span class="linenos">1886</span></a><span class="sd">        bool: True if the input is a line, False otherwise.</span>
</span><span id="is_line-1887"><a href="#is_line-1887"><span class="linenos">1887</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_line-1888"><a href="#is_line-1888"><span class="linenos">1888</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="is_line-1889"><a href="#is_line-1889"><span class="linenos">1889</span></a>        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line_</span>
</span><span id="is_line-1890"><a href="#is_line-1890"><span class="linenos">1890</span></a>        <span class="k">return</span> <span class="n">is_point</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_point</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</span><span id="is_line-1891"><a href="#is_line-1891"><span class="linenos">1891</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="is_line-1892"><a href="#is_line-1892"><span class="linenos">1892</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the input is a line.</p>

<p>Args:
    line_ (Any): Input value.</p>

<p>Returns:
    bool: True if the input is a line, False otherwise.</p>
</div>


                </section>
                <section id="is_point">
                            <input id="is_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pnt</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_point-1895"><a href="#is_point-1895"><span class="linenos">1895</span></a><span class="k">def</span> <span class="nf">is_point</span><span class="p">(</span><span class="n">pnt</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_point-1896"><a href="#is_point-1896"><span class="linenos">1896</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the input is a point.</span>
</span><span id="is_point-1897"><a href="#is_point-1897"><span class="linenos">1897</span></a>
</span><span id="is_point-1898"><a href="#is_point-1898"><span class="linenos">1898</span></a><span class="sd">    Args:</span>
</span><span id="is_point-1899"><a href="#is_point-1899"><span class="linenos">1899</span></a><span class="sd">        pnt (Any): Input value.</span>
</span><span id="is_point-1900"><a href="#is_point-1900"><span class="linenos">1900</span></a>
</span><span id="is_point-1901"><a href="#is_point-1901"><span class="linenos">1901</span></a><span class="sd">    Returns:</span>
</span><span id="is_point-1902"><a href="#is_point-1902"><span class="linenos">1902</span></a><span class="sd">        bool: True if the input is a point, False otherwise.</span>
</span><span id="is_point-1903"><a href="#is_point-1903"><span class="linenos">1903</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_point-1904"><a href="#is_point-1904"><span class="linenos">1904</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="is_point-1905"><a href="#is_point-1905"><span class="linenos">1905</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="is_point-1906"><a href="#is_point-1906"><span class="linenos">1906</span></a>        <span class="k">return</span> <span class="n">is_number</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_number</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="is_point-1907"><a href="#is_point-1907"><span class="linenos">1907</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="is_point-1908"><a href="#is_point-1908"><span class="linenos">1908</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the input is a point.</p>

<p>Args:
    pnt (Any): Input value.</p>

<p>Returns:
    bool: True if the input is a point, False otherwise.</p>
</div>


                </section>
                <section id="is_vertical">
                            <input id="is_vertical-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_vertical</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="is_vertical-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_vertical"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_vertical-1911"><a href="#is_vertical-1911"><span class="linenos">1911</span></a><span class="k">def</span> <span class="nf">is_vertical</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_vertical-1912"><a href="#is_vertical-1912"><span class="linenos">1912</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the line is vertical.</span>
</span><span id="is_vertical-1913"><a href="#is_vertical-1913"><span class="linenos">1913</span></a>
</span><span id="is_vertical-1914"><a href="#is_vertical-1914"><span class="linenos">1914</span></a><span class="sd">    Args:</span>
</span><span id="is_vertical-1915"><a href="#is_vertical-1915"><span class="linenos">1915</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="is_vertical-1916"><a href="#is_vertical-1916"><span class="linenos">1916</span></a><span class="sd">        eps (float, optional): Tolerance. Defaults to 0.0001.</span>
</span><span id="is_vertical-1917"><a href="#is_vertical-1917"><span class="linenos">1917</span></a>
</span><span id="is_vertical-1918"><a href="#is_vertical-1918"><span class="linenos">1918</span></a><span class="sd">    Returns:</span>
</span><span id="is_vertical-1919"><a href="#is_vertical-1919"><span class="linenos">1919</span></a><span class="sd">        bool: True if the line is vertical, False otherwise.</span>
</span><span id="is_vertical-1920"><a href="#is_vertical-1920"><span class="linenos">1920</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_vertical-1921"><a href="#is_vertical-1921"><span class="linenos">1921</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i_vec</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">eps</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the line is vertical.</p>

<p>Args:
    line (Line): Input line.
    eps (float, optional): Tolerance. Defaults to 0.0001.</p>

<p>Returns:
    bool: True if the line is vertical, False otherwise.</p>
</div>


                </section>
                <section id="length">
                            <input id="length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="length-1924"><a href="#length-1924"><span class="linenos">1924</span></a><span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="length-1925"><a href="#length-1925"><span class="linenos">1925</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the length of a line.</span>
</span><span id="length-1926"><a href="#length-1926"><span class="linenos">1926</span></a>
</span><span id="length-1927"><a href="#length-1927"><span class="linenos">1927</span></a><span class="sd">    Args:</span>
</span><span id="length-1928"><a href="#length-1928"><span class="linenos">1928</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="length-1929"><a href="#length-1929"><span class="linenos">1929</span></a>
</span><span id="length-1930"><a href="#length-1930"><span class="linenos">1930</span></a><span class="sd">    Returns:</span>
</span><span id="length-1931"><a href="#length-1931"><span class="linenos">1931</span></a><span class="sd">        float: Length of the line.</span>
</span><span id="length-1932"><a href="#length-1932"><span class="linenos">1932</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="length-1933"><a href="#length-1933"><span class="linenos">1933</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="length-1934"><a href="#length-1934"><span class="linenos">1934</span></a>    <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the length of a line.</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    float: Length of the line.</p>
</div>


                </section>
                <section id="lerp_point">
                            <input id="lerp_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lerp_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">t</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="lerp_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#lerp_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="lerp_point-1937"><a href="#lerp_point-1937"><span class="linenos">1937</span></a><span class="k">def</span> <span class="nf">lerp_point</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="lerp_point-1938"><a href="#lerp_point-1938"><span class="linenos">1938</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear interpolation of two points.</span>
</span><span id="lerp_point-1939"><a href="#lerp_point-1939"><span class="linenos">1939</span></a>
</span><span id="lerp_point-1940"><a href="#lerp_point-1940"><span class="linenos">1940</span></a><span class="sd">    Args:</span>
</span><span id="lerp_point-1941"><a href="#lerp_point-1941"><span class="linenos">1941</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="lerp_point-1942"><a href="#lerp_point-1942"><span class="linenos">1942</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="lerp_point-1943"><a href="#lerp_point-1943"><span class="linenos">1943</span></a><span class="sd">        t (float): Interpolation parameter. t = 0 =&gt; p1, t = 1 =&gt; p2.</span>
</span><span id="lerp_point-1944"><a href="#lerp_point-1944"><span class="linenos">1944</span></a>
</span><span id="lerp_point-1945"><a href="#lerp_point-1945"><span class="linenos">1945</span></a><span class="sd">    Returns:</span>
</span><span id="lerp_point-1946"><a href="#lerp_point-1946"><span class="linenos">1946</span></a><span class="sd">        Point: Interpolated point.</span>
</span><span id="lerp_point-1947"><a href="#lerp_point-1947"><span class="linenos">1947</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="lerp_point-1948"><a href="#lerp_point-1948"><span class="linenos">1948</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="lerp_point-1949"><a href="#lerp_point-1949"><span class="linenos">1949</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="lerp_point-1950"><a href="#lerp_point-1950"><span class="linenos">1950</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">lerp</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">lerp</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Linear interpolation of two points.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.
    t (float): Interpolation parameter. t = 0 =&gt; p1, t = 1 =&gt; p2.</p>

<p>Returns:
    Point: Interpolated point.</p>
</div>


                </section>
                <section id="slope">
                            <input id="slope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">slope</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">end_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">rtol</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="slope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#slope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="slope-1953"><a href="#slope-1953"><span class="linenos">1953</span></a><span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="slope-1954"><a href="#slope-1954"><span class="linenos">1954</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the slope of a line given by two points.</span>
</span><span id="slope-1955"><a href="#slope-1955"><span class="linenos">1955</span></a><span class="sd">    Order makes a difference.</span>
</span><span id="slope-1956"><a href="#slope-1956"><span class="linenos">1956</span></a>
</span><span id="slope-1957"><a href="#slope-1957"><span class="linenos">1957</span></a><span class="sd">    Args:</span>
</span><span id="slope-1958"><a href="#slope-1958"><span class="linenos">1958</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="slope-1959"><a href="#slope-1959"><span class="linenos">1959</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="slope-1960"><a href="#slope-1960"><span class="linenos">1960</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="slope-1961"><a href="#slope-1961"><span class="linenos">1961</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="slope-1962"><a href="#slope-1962"><span class="linenos">1962</span></a>
</span><span id="slope-1963"><a href="#slope-1963"><span class="linenos">1963</span></a><span class="sd">    Returns:</span>
</span><span id="slope-1964"><a href="#slope-1964"><span class="linenos">1964</span></a><span class="sd">        float: Slope of the line.</span>
</span><span id="slope-1965"><a href="#slope-1965"><span class="linenos">1965</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="slope-1966"><a href="#slope-1966"><span class="linenos">1966</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="slope-1967"><a href="#slope-1967"><span class="linenos">1967</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">start_point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="slope-1968"><a href="#slope-1968"><span class="linenos">1968</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">end_point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="slope-1969"><a href="#slope-1969"><span class="linenos">1969</span></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
</span><span id="slope-1970"><a href="#slope-1970"><span class="linenos">1970</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;INF&quot;</span><span class="p">]</span>
</span><span id="slope-1971"><a href="#slope-1971"><span class="linenos">1971</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="slope-1972"><a href="#slope-1972"><span class="linenos">1972</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="slope-1973"><a href="#slope-1973"><span class="linenos">1973</span></a>
</span><span id="slope-1974"><a href="#slope-1974"><span class="linenos">1974</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the slope of a line given by two points.
Order makes a difference.</p>

<p>Args:
    start_point (Point): Start point of the line.
    end_point (Point): End point of the line.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    float: Slope of the line.</p>
</div>


                </section>
                <section id="segmentize_line">
                            <input id="segmentize_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">segmentize_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">segment_length</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="segmentize_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#segmentize_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="segmentize_line-1977"><a href="#segmentize_line-1977"><span class="linenos">1977</span></a><span class="k">def</span> <span class="nf">segmentize_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">segment_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="segmentize_line-1978"><a href="#segmentize_line-1978"><span class="linenos">1978</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of points that would form segments with the given length.</span>
</span><span id="segmentize_line-1979"><a href="#segmentize_line-1979"><span class="linenos">1979</span></a>
</span><span id="segmentize_line-1980"><a href="#segmentize_line-1980"><span class="linenos">1980</span></a><span class="sd">    Args:</span>
</span><span id="segmentize_line-1981"><a href="#segmentize_line-1981"><span class="linenos">1981</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="segmentize_line-1982"><a href="#segmentize_line-1982"><span class="linenos">1982</span></a><span class="sd">        segment_length (float): Length of each segment.</span>
</span><span id="segmentize_line-1983"><a href="#segmentize_line-1983"><span class="linenos">1983</span></a>
</span><span id="segmentize_line-1984"><a href="#segmentize_line-1984"><span class="linenos">1984</span></a><span class="sd">    Returns:</span>
</span><span id="segmentize_line-1985"><a href="#segmentize_line-1985"><span class="linenos">1985</span></a><span class="sd">        list[Line]: List of segments.</span>
</span><span id="segmentize_line-1986"><a href="#segmentize_line-1986"><span class="linenos">1986</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="segmentize_line-1987"><a href="#segmentize_line-1987"><span class="linenos">1987</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="segmentize_line-1988"><a href="#segmentize_line-1988"><span class="linenos">1988</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="segmentize_line-1989"><a href="#segmentize_line-1989"><span class="linenos">1989</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="segmentize_line-1990"><a href="#segmentize_line-1990"><span class="linenos">1990</span></a>    <span class="n">increments</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length_</span> <span class="o">/</span> <span class="n">segment_length</span><span class="p">)</span>
</span><span id="segmentize_line-1991"><a href="#segmentize_line-1991"><span class="linenos">1991</span></a>    <span class="n">x_segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">increments</span><span class="p">)</span>
</span><span id="segmentize_line-1992"><a href="#segmentize_line-1992"><span class="linenos">1992</span></a>    <span class="n">y_segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">increments</span><span class="p">)</span>
</span><span id="segmentize_line-1993"><a href="#segmentize_line-1993"><span class="linenos">1993</span></a>
</span><span id="segmentize_line-1994"><a href="#segmentize_line-1994"><span class="linenos">1994</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x_segments</span><span class="p">,</span> <span class="n">y_segments</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of points that would form segments with the given length.</p>

<p>Args:
    line (Line): Input line.
    segment_length (float): Length of each segment.</p>

<p>Returns:
    list[Line]: List of segments.</p>
</div>


                </section>
                <section id="line_angle">
                            <input id="line_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">start_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">end_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="line_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_angle-1997"><a href="#line_angle-1997"><span class="linenos">1997</span></a><span class="k">def</span> <span class="nf">line_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line_angle-1998"><a href="#line_angle-1998"><span class="linenos">1998</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the orientation angle (in radians) of a line given by start and end points.</span>
</span><span id="line_angle-1999"><a href="#line_angle-1999"><span class="linenos">1999</span></a><span class="sd">    Order makes a difference.</span>
</span><span id="line_angle-2000"><a href="#line_angle-2000"><span class="linenos">2000</span></a>
</span><span id="line_angle-2001"><a href="#line_angle-2001"><span class="linenos">2001</span></a><span class="sd">    Args:</span>
</span><span id="line_angle-2002"><a href="#line_angle-2002"><span class="linenos">2002</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="line_angle-2003"><a href="#line_angle-2003"><span class="linenos">2003</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="line_angle-2004"><a href="#line_angle-2004"><span class="linenos">2004</span></a>
</span><span id="line_angle-2005"><a href="#line_angle-2005"><span class="linenos">2005</span></a><span class="sd">    Returns:</span>
</span><span id="line_angle-2006"><a href="#line_angle-2006"><span class="linenos">2006</span></a><span class="sd">        float: Orientation angle of the line in radians.</span>
</span><span id="line_angle-2007"><a href="#line_angle-2007"><span class="linenos">2007</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_angle-2008"><a href="#line_angle-2008"><span class="linenos">2008</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the orientation angle (in radians) of a line given by start and end points.
Order makes a difference.</p>

<p>Args:
    start_point (Point): Start point of the line.
    end_point (Point): End point of the line.</p>

<p>Returns:
    float: Orientation angle of the line in radians.</p>
</div>


                </section>
                <section id="angle">
                            <input id="angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="angle-2010"><a href="#angle-2010"><span class="linenos">2010</span></a><span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="angle-2011"><a href="#angle-2011"><span class="linenos">2011</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle of a line drawn from the given point to the origin in radians.</span>
</span><span id="angle-2012"><a href="#angle-2012"><span class="linenos">2012</span></a>
</span><span id="angle-2013"><a href="#angle-2013"><span class="linenos">2013</span></a><span class="sd">    Args:</span>
</span><span id="angle-2014"><a href="#angle-2014"><span class="linenos">2014</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="angle-2015"><a href="#angle-2015"><span class="linenos">2015</span></a>
</span><span id="angle-2016"><a href="#angle-2016"><span class="linenos">2016</span></a><span class="sd">    Returns:</span>
</span><span id="angle-2017"><a href="#angle-2017"><span class="linenos">2017</span></a><span class="sd">        float: Angle of the point in radians.</span>
</span><span id="angle-2018"><a href="#angle-2018"><span class="linenos">2018</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="angle-2019"><a href="#angle-2019"><span class="linenos">2019</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the angle of a line drawn from the given point to the origin in radians.</p>

<p>Args:
    point (Point): Input point.</p>

<p>Returns:
    float: Angle of the point in radians.</p>
</div>


                </section>
                <section id="inclination_angle">
                            <input id="inclination_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inclination_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">start_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">end_point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="inclination_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#inclination_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="inclination_angle-2022"><a href="#inclination_angle-2022"><span class="linenos">2022</span></a><span class="k">def</span> <span class="nf">inclination_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="inclination_angle-2023"><a href="#inclination_angle-2023"><span class="linenos">2023</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the inclination angle (in radians) of a line given by start and end points.</span>
</span><span id="inclination_angle-2024"><a href="#inclination_angle-2024"><span class="linenos">2024</span></a><span class="sd">    Inclination angle is always between zero and pi.</span>
</span><span id="inclination_angle-2025"><a href="#inclination_angle-2025"><span class="linenos">2025</span></a><span class="sd">    Order makes no difference.</span>
</span><span id="inclination_angle-2026"><a href="#inclination_angle-2026"><span class="linenos">2026</span></a>
</span><span id="inclination_angle-2027"><a href="#inclination_angle-2027"><span class="linenos">2027</span></a><span class="sd">    Args:</span>
</span><span id="inclination_angle-2028"><a href="#inclination_angle-2028"><span class="linenos">2028</span></a><span class="sd">        start_point (Point): Start point of the line.</span>
</span><span id="inclination_angle-2029"><a href="#inclination_angle-2029"><span class="linenos">2029</span></a><span class="sd">        end_point (Point): End point of the line.</span>
</span><span id="inclination_angle-2030"><a href="#inclination_angle-2030"><span class="linenos">2030</span></a>
</span><span id="inclination_angle-2031"><a href="#inclination_angle-2031"><span class="linenos">2031</span></a><span class="sd">    Returns:</span>
</span><span id="inclination_angle-2032"><a href="#inclination_angle-2032"><span class="linenos">2032</span></a><span class="sd">        float: Inclination angle of the line in radians.</span>
</span><span id="inclination_angle-2033"><a href="#inclination_angle-2033"><span class="linenos">2033</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="inclination_angle-2034"><a href="#inclination_angle-2034"><span class="linenos">2034</span></a>    <span class="k">return</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi</span>
</span></pre></div>


            <div class="docstring"><p>Return the inclination angle (in radians) of a line given by start and end points.
Inclination angle is always between zero and pi.
Order makes no difference.</p>

<p>Args:
    start_point (Point): Start point of the line.
    end_point (Point): End point of the line.</p>

<p>Returns:
    float: Inclination angle of the line in radians.</p>
</div>


                </section>
                <section id="line2vector">
                            <input id="line2vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line2vector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="line2vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line2vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line2vector-2037"><a href="#line2vector-2037"><span class="linenos">2037</span></a><span class="k">def</span> <span class="nf">line2vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="line2vector-2038"><a href="#line2vector-2038"><span class="linenos">2038</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector representation of a line</span>
</span><span id="line2vector-2039"><a href="#line2vector-2039"><span class="linenos">2039</span></a>
</span><span id="line2vector-2040"><a href="#line2vector-2040"><span class="linenos">2040</span></a><span class="sd">    Args:</span>
</span><span id="line2vector-2041"><a href="#line2vector-2041"><span class="linenos">2041</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="line2vector-2042"><a href="#line2vector-2042"><span class="linenos">2042</span></a>
</span><span id="line2vector-2043"><a href="#line2vector-2043"><span class="linenos">2043</span></a><span class="sd">    Returns:</span>
</span><span id="line2vector-2044"><a href="#line2vector-2044"><span class="linenos">2044</span></a><span class="sd">        VecType: Vector representation of the line.</span>
</span><span id="line2vector-2045"><a href="#line2vector-2045"><span class="linenos">2045</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line2vector-2046"><a href="#line2vector-2046"><span class="linenos">2046</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line2vector-2047"><a href="#line2vector-2047"><span class="linenos">2047</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="line2vector-2048"><a href="#line2vector-2048"><span class="linenos">2048</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="line2vector-2049"><a href="#line2vector-2049"><span class="linenos">2049</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="line2vector-2050"><a href="#line2vector-2050"><span class="linenos">2050</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the vector representation of a line</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    VecType: Vector representation of the line.</p>
</div>


                </section>
                <section id="line_through_point_and_angle">
                            <input id="line_through_point_and_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_through_point_and_angle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">length_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="line_through_point_and_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_through_point_and_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_through_point_and_angle-2053"><a href="#line_through_point_and_angle-2053"><span class="linenos">2053</span></a><span class="k">def</span> <span class="nf">line_through_point_and_angle</span><span class="p">(</span>
</span><span id="line_through_point_and_angle-2054"><a href="#line_through_point_and_angle-2054"><span class="linenos">2054</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">length_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="line_through_point_and_angle-2055"><a href="#line_through_point_and_angle-2055"><span class="linenos">2055</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="line_through_point_and_angle-2056"><a href="#line_through_point_and_angle-2056"><span class="linenos">2056</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a line through the given point with the given angle and length</span>
</span><span id="line_through_point_and_angle-2057"><a href="#line_through_point_and_angle-2057"><span class="linenos">2057</span></a>
</span><span id="line_through_point_and_angle-2058"><a href="#line_through_point_and_angle-2058"><span class="linenos">2058</span></a><span class="sd">    Args:</span>
</span><span id="line_through_point_and_angle-2059"><a href="#line_through_point_and_angle-2059"><span class="linenos">2059</span></a><span class="sd">        point (Point): Point through which the line passes.</span>
</span><span id="line_through_point_and_angle-2060"><a href="#line_through_point_and_angle-2060"><span class="linenos">2060</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="line_through_point_and_angle-2061"><a href="#line_through_point_and_angle-2061"><span class="linenos">2061</span></a><span class="sd">        length_ (float, optional): Length of the line. Defaults to 100.</span>
</span><span id="line_through_point_and_angle-2062"><a href="#line_through_point_and_angle-2062"><span class="linenos">2062</span></a>
</span><span id="line_through_point_and_angle-2063"><a href="#line_through_point_and_angle-2063"><span class="linenos">2063</span></a><span class="sd">    Returns:</span>
</span><span id="line_through_point_and_angle-2064"><a href="#line_through_point_and_angle-2064"><span class="linenos">2064</span></a><span class="sd">        Line: Line passing through the given point with the given angle and length.</span>
</span><span id="line_through_point_and_angle-2065"><a href="#line_through_point_and_angle-2065"><span class="linenos">2065</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_through_point_and_angle-2066"><a href="#line_through_point_and_angle-2066"><span class="linenos">2066</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="line_through_point_and_angle-2067"><a href="#line_through_point_and_angle-2067"><span class="linenos">2067</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="line_through_point_and_angle-2068"><a href="#line_through_point_and_angle-2068"><span class="linenos">2068</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="line_through_point_and_angle-2069"><a href="#line_through_point_and_angle-2069"><span class="linenos">2069</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Return a line through the given point with the given angle and length</p>

<p>Args:
    point (Point): Point through which the line passes.
    angle (float): Angle of the line in radians.
    length_ (float, optional): Length of the line. Defaults to 100.</p>

<p>Returns:
    Line: Line passing through the given point with the given angle and length.</p>
</div>


                </section>
                <section id="line_vector">
                            <input id="line_vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_vector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="line_vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_vector-2072"><a href="#line_vector-2072"><span class="linenos">2072</span></a><span class="k">def</span> <span class="nf">line_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="line_vector-2073"><a href="#line_vector-2073"><span class="linenos">2073</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector representation of a line.</span>
</span><span id="line_vector-2074"><a href="#line_vector-2074"><span class="linenos">2074</span></a>
</span><span id="line_vector-2075"><a href="#line_vector-2075"><span class="linenos">2075</span></a><span class="sd">    Args:</span>
</span><span id="line_vector-2076"><a href="#line_vector-2076"><span class="linenos">2076</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="line_vector-2077"><a href="#line_vector-2077"><span class="linenos">2077</span></a>
</span><span id="line_vector-2078"><a href="#line_vector-2078"><span class="linenos">2078</span></a><span class="sd">    Returns:</span>
</span><span id="line_vector-2079"><a href="#line_vector-2079"><span class="linenos">2079</span></a><span class="sd">        VecType: Vector representation of the line.</span>
</span><span id="line_vector-2080"><a href="#line_vector-2080"><span class="linenos">2080</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_vector-2081"><a href="#line_vector-2081"><span class="linenos">2081</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line_vector-2082"><a href="#line_vector-2082"><span class="linenos">2082</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="line_vector-2083"><a href="#line_vector-2083"><span class="linenos">2083</span></a>    <span class="k">return</span> <span class="n">Vector2D</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the vector representation of a line.</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    VecType: Vector representation of the line.</p>
</div>


                </section>
                <section id="mid_point">
                            <input id="mid_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mid_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="mid_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#mid_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="mid_point-2086"><a href="#mid_point-2086"><span class="linenos">2086</span></a><span class="k">def</span> <span class="nf">mid_point</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="mid_point-2087"><a href="#mid_point-2087"><span class="linenos">2087</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the mid point of two points.</span>
</span><span id="mid_point-2088"><a href="#mid_point-2088"><span class="linenos">2088</span></a>
</span><span id="mid_point-2089"><a href="#mid_point-2089"><span class="linenos">2089</span></a><span class="sd">    Args:</span>
</span><span id="mid_point-2090"><a href="#mid_point-2090"><span class="linenos">2090</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="mid_point-2091"><a href="#mid_point-2091"><span class="linenos">2091</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="mid_point-2092"><a href="#mid_point-2092"><span class="linenos">2092</span></a>
</span><span id="mid_point-2093"><a href="#mid_point-2093"><span class="linenos">2093</span></a><span class="sd">    Returns:</span>
</span><span id="mid_point-2094"><a href="#mid_point-2094"><span class="linenos">2094</span></a><span class="sd">        Point: Mid point of the two points.</span>
</span><span id="mid_point-2095"><a href="#mid_point-2095"><span class="linenos">2095</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="mid_point-2096"><a href="#mid_point-2096"><span class="linenos">2096</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="mid_point-2097"><a href="#mid_point-2097"><span class="linenos">2097</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="mid_point-2098"><a href="#mid_point-2098"><span class="linenos">2098</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mid point of two points.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.</p>

<p>Returns:
    Point: Mid point of the two points.</p>
</div>


                </section>
                <section id="norm">
                            <input id="norm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">norm</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vec</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="norm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#norm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="norm-2101"><a href="#norm-2101"><span class="linenos">2101</span></a><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">VecType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="norm-2102"><a href="#norm-2102"><span class="linenos">2102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the norm (vector length) of a vector.</span>
</span><span id="norm-2103"><a href="#norm-2103"><span class="linenos">2103</span></a>
</span><span id="norm-2104"><a href="#norm-2104"><span class="linenos">2104</span></a><span class="sd">    Args:</span>
</span><span id="norm-2105"><a href="#norm-2105"><span class="linenos">2105</span></a><span class="sd">        vec (VecType): Input vector.</span>
</span><span id="norm-2106"><a href="#norm-2106"><span class="linenos">2106</span></a>
</span><span id="norm-2107"><a href="#norm-2107"><span class="linenos">2107</span></a><span class="sd">    Returns:</span>
</span><span id="norm-2108"><a href="#norm-2108"><span class="linenos">2108</span></a><span class="sd">        float: Norm of the vector.</span>
</span><span id="norm-2109"><a href="#norm-2109"><span class="linenos">2109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="norm-2110"><a href="#norm-2110"><span class="linenos">2110</span></a>    <span class="k">return</span> <span class="n">hypot</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the norm (vector length) of a vector.</p>

<p>Args:
    vec (VecType): Input vector.</p>

<p>Returns:
    float: Norm of the vector.</p>
</div>


                </section>
                <section id="ndarray_to_xy_list">
                            <input id="ndarray_to_xy_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ndarray_to_xy_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">arr</span><span class="p">:</span> <span class="s2">&quot;&#39;ndarray&#39;&quot;</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ndarray_to_xy_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ndarray_to_xy_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ndarray_to_xy_list-2113"><a href="#ndarray_to_xy_list-2113"><span class="linenos">2113</span></a><span class="k">def</span> <span class="nf">ndarray_to_xy_list</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="ndarray_to_xy_list-2114"><a href="#ndarray_to_xy_list-2114"><span class="linenos">2114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a numpy array to a list of points.</span>
</span><span id="ndarray_to_xy_list-2115"><a href="#ndarray_to_xy_list-2115"><span class="linenos">2115</span></a>
</span><span id="ndarray_to_xy_list-2116"><a href="#ndarray_to_xy_list-2116"><span class="linenos">2116</span></a><span class="sd">    Args:</span>
</span><span id="ndarray_to_xy_list-2117"><a href="#ndarray_to_xy_list-2117"><span class="linenos">2117</span></a><span class="sd">        arr (np.ndarray): Input numpy array.</span>
</span><span id="ndarray_to_xy_list-2118"><a href="#ndarray_to_xy_list-2118"><span class="linenos">2118</span></a>
</span><span id="ndarray_to_xy_list-2119"><a href="#ndarray_to_xy_list-2119"><span class="linenos">2119</span></a><span class="sd">    Returns:</span>
</span><span id="ndarray_to_xy_list-2120"><a href="#ndarray_to_xy_list-2120"><span class="linenos">2120</span></a><span class="sd">        Sequence[Point]: List of points.</span>
</span><span id="ndarray_to_xy_list-2121"><a href="#ndarray_to_xy_list-2121"><span class="linenos">2121</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ndarray_to_xy_list-2122"><a href="#ndarray_to_xy_list-2122"><span class="linenos">2122</span></a>    <span class="k">return</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Convert a numpy array to a list of points.</p>

<p>Args:
    arr (np.ndarray): Input numpy array.</p>

<p>Returns:
    Sequence[Point]: List of points.</p>
</div>


                </section>
                <section id="offset_line">
                            <input id="offset_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="offset_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_line-2125"><a href="#offset_line-2125"><span class="linenos">2125</span></a><span class="k">def</span> <span class="nf">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="offset_line-2126"><a href="#offset_line-2126"><span class="linenos">2126</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an offset line from a given line.</span>
</span><span id="offset_line-2127"><a href="#offset_line-2127"><span class="linenos">2127</span></a>
</span><span id="offset_line-2128"><a href="#offset_line-2128"><span class="linenos">2128</span></a><span class="sd">    Args:</span>
</span><span id="offset_line-2129"><a href="#offset_line-2129"><span class="linenos">2129</span></a><span class="sd">        line (Sequence[Point]): Input line.</span>
</span><span id="offset_line-2130"><a href="#offset_line-2130"><span class="linenos">2130</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="offset_line-2131"><a href="#offset_line-2131"><span class="linenos">2131</span></a>
</span><span id="offset_line-2132"><a href="#offset_line-2132"><span class="linenos">2132</span></a><span class="sd">    Returns:</span>
</span><span id="offset_line-2133"><a href="#offset_line-2133"><span class="linenos">2133</span></a><span class="sd">        Sequence[Point]: Offset line.</span>
</span><span id="offset_line-2134"><a href="#offset_line-2134"><span class="linenos">2134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_line-2135"><a href="#offset_line-2135"><span class="linenos">2135</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="n">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="offset_line-2136"><a href="#offset_line-2136"><span class="linenos">2136</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="offset_line-2137"><a href="#offset_line-2137"><span class="linenos">2137</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="offset_line-2138"><a href="#offset_line-2138"><span class="linenos">2138</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="offset_line-2139"><a href="#offset_line-2139"><span class="linenos">2139</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="offset_line-2140"><a href="#offset_line-2140"><span class="linenos">2140</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">],</span> <span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Return an offset line from a given line.</p>

<p>Args:
    line (Sequence[Point]): Input line.
    offset (float): Offset distance.</p>

<p>Returns:
    Sequence[Point]: Offset line.</p>
</div>


                </section>
                <section id="offset_lines">
                            <input id="offset_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polylines</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="offset_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_lines-2143"><a href="#offset_lines-2143"><span class="linenos">2143</span></a><span class="k">def</span> <span class="nf">offset_lines</span><span class="p">(</span><span class="n">polylines</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="offset_lines-2144"><a href="#offset_lines-2144"><span class="linenos">2144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of offset lines from a list of lines.</span>
</span><span id="offset_lines-2145"><a href="#offset_lines-2145"><span class="linenos">2145</span></a>
</span><span id="offset_lines-2146"><a href="#offset_lines-2146"><span class="linenos">2146</span></a><span class="sd">    Args:</span>
</span><span id="offset_lines-2147"><a href="#offset_lines-2147"><span class="linenos">2147</span></a><span class="sd">        polylines (Sequence[Line]): List of input lines.</span>
</span><span id="offset_lines-2148"><a href="#offset_lines-2148"><span class="linenos">2148</span></a><span class="sd">        offset (float, optional): Offset distance. Defaults to 1.</span>
</span><span id="offset_lines-2149"><a href="#offset_lines-2149"><span class="linenos">2149</span></a>
</span><span id="offset_lines-2150"><a href="#offset_lines-2150"><span class="linenos">2150</span></a><span class="sd">    Returns:</span>
</span><span id="offset_lines-2151"><a href="#offset_lines-2151"><span class="linenos">2151</span></a><span class="sd">        list[Line]: List of offset lines.</span>
</span><span id="offset_lines-2152"><a href="#offset_lines-2152"><span class="linenos">2152</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_lines-2153"><a href="#offset_lines-2153"><span class="linenos">2153</span></a>
</span><span id="offset_lines-2154"><a href="#offset_lines-2154"><span class="linenos">2154</span></a>    <span class="k">def</span> <span class="nf">stitch_</span><span class="p">(</span><span class="n">polyline</span><span class="p">):</span>
</span><span id="offset_lines-2155"><a href="#offset_lines-2155"><span class="linenos">2155</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="offset_lines-2156"><a href="#offset_lines-2156"><span class="linenos">2156</span></a>        <span class="n">line1</span> <span class="o">=</span> <span class="n">polyline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="offset_lines-2157"><a href="#offset_lines-2157"><span class="linenos">2157</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polyline</span><span class="p">):</span>
</span><span id="offset_lines-2158"><a href="#offset_lines-2158"><span class="linenos">2158</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">polyline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="offset_lines-2159"><a href="#offset_lines-2159"><span class="linenos">2159</span></a>                <span class="k">break</span>
</span><span id="offset_lines-2160"><a href="#offset_lines-2160"><span class="linenos">2160</span></a>            <span class="n">line2</span> <span class="o">=</span> <span class="n">polyline</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="offset_lines-2161"><a href="#offset_lines-2161"><span class="linenos">2161</span></a>            <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">stitch_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="offset_lines-2162"><a href="#offset_lines-2162"><span class="linenos">2162</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
</span><span id="offset_lines-2163"><a href="#offset_lines-2163"><span class="linenos">2163</span></a>            <span class="n">line1</span> <span class="o">=</span> <span class="n">line2</span>
</span><span id="offset_lines-2164"><a href="#offset_lines-2164"><span class="linenos">2164</span></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="offset_lines-2165"><a href="#offset_lines-2165"><span class="linenos">2165</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="offset_lines-2166"><a href="#offset_lines-2166"><span class="linenos">2166</span></a>
</span><span id="offset_lines-2167"><a href="#offset_lines-2167"><span class="linenos">2167</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="offset_lines-2168"><a href="#offset_lines-2168"><span class="linenos">2168</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">polylines</span><span class="p">:</span>
</span><span id="offset_lines-2169"><a href="#offset_lines-2169"><span class="linenos">2169</span></a>        <span class="n">poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>
</span><span id="offset_lines-2170"><a href="#offset_lines-2170"><span class="linenos">2170</span></a>    <span class="n">poly</span> <span class="o">=</span> <span class="n">stitch_</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
</span><span id="offset_lines-2171"><a href="#offset_lines-2171"><span class="linenos">2171</span></a>    <span class="k">return</span> <span class="n">poly</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of offset lines from a list of lines.</p>

<p>Args:
    polylines (Sequence[Line]): List of input lines.
    offset (float, optional): Offset distance. Defaults to 1.</p>

<p>Returns:
    list[Line]: List of offset lines.</p>
</div>


                </section>
                <section id="normalize">
                            <input id="normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vec</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="normalize-2174"><a href="#normalize-2174"><span class="linenos">2174</span></a><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">VecType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="normalize-2175"><a href="#normalize-2175"><span class="linenos">2175</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the normalized vector.</span>
</span><span id="normalize-2176"><a href="#normalize-2176"><span class="linenos">2176</span></a>
</span><span id="normalize-2177"><a href="#normalize-2177"><span class="linenos">2177</span></a><span class="sd">    Args:</span>
</span><span id="normalize-2178"><a href="#normalize-2178"><span class="linenos">2178</span></a><span class="sd">        vec (VecType): Input vector.</span>
</span><span id="normalize-2179"><a href="#normalize-2179"><span class="linenos">2179</span></a>
</span><span id="normalize-2180"><a href="#normalize-2180"><span class="linenos">2180</span></a><span class="sd">    Returns:</span>
</span><span id="normalize-2181"><a href="#normalize-2181"><span class="linenos">2181</span></a><span class="sd">        VecType: Normalized vector.</span>
</span><span id="normalize-2182"><a href="#normalize-2182"><span class="linenos">2182</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="normalize-2183"><a href="#normalize-2183"><span class="linenos">2183</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="normalize-2184"><a href="#normalize-2184"><span class="linenos">2184</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the normalized vector.</p>

<p>Args:
    vec (VecType): Input vector.</p>

<p>Returns:
    VecType: Normalized vector.</p>
</div>


                </section>
                <section id="offset_point_on_line">
                            <input id="offset_point_on_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_point_on_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="offset_point_on_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_point_on_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_point_on_line-2187"><a href="#offset_point_on_line-2187"><span class="linenos">2187</span></a><span class="k">def</span> <span class="nf">offset_point_on_line</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="offset_point_on_line-2188"><a href="#offset_point_on_line-2188"><span class="linenos">2188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point on a line that is offset from the given point.</span>
</span><span id="offset_point_on_line-2189"><a href="#offset_point_on_line-2189"><span class="linenos">2189</span></a>
</span><span id="offset_point_on_line-2190"><a href="#offset_point_on_line-2190"><span class="linenos">2190</span></a><span class="sd">    Args:</span>
</span><span id="offset_point_on_line-2191"><a href="#offset_point_on_line-2191"><span class="linenos">2191</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="offset_point_on_line-2192"><a href="#offset_point_on_line-2192"><span class="linenos">2192</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="offset_point_on_line-2193"><a href="#offset_point_on_line-2193"><span class="linenos">2193</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="offset_point_on_line-2194"><a href="#offset_point_on_line-2194"><span class="linenos">2194</span></a>
</span><span id="offset_point_on_line-2195"><a href="#offset_point_on_line-2195"><span class="linenos">2195</span></a><span class="sd">    Returns:</span>
</span><span id="offset_point_on_line-2196"><a href="#offset_point_on_line-2196"><span class="linenos">2196</span></a><span class="sd">        Point: Offset point on the line.</span>
</span><span id="offset_point_on_line-2197"><a href="#offset_point_on_line-2197"><span class="linenos">2197</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_point_on_line-2198"><a href="#offset_point_on_line-2198"><span class="linenos">2198</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="offset_point_on_line-2199"><a href="#offset_point_on_line-2199"><span class="linenos">2199</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="offset_point_on_line-2200"><a href="#offset_point_on_line-2200"><span class="linenos">2200</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="offset_point_on_line-2201"><a href="#offset_point_on_line-2201"><span class="linenos">2201</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="offset_point_on_line-2202"><a href="#offset_point_on_line-2202"><span class="linenos">2202</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="offset_point_on_line-2203"><a href="#offset_point_on_line-2203"><span class="linenos">2203</span></a>    <span class="c1"># normalize the vector</span>
</span><span id="offset_point_on_line-2204"><a href="#offset_point_on_line-2204"><span class="linenos">2204</span></a>    <span class="n">mag</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="offset_point_on_line-2205"><a href="#offset_point_on_line-2205"><span class="linenos">2205</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">mag</span>
</span><span id="offset_point_on_line-2206"><a href="#offset_point_on_line-2206"><span class="linenos">2206</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">mag</span>
</span><span id="offset_point_on_line-2207"><a href="#offset_point_on_line-2207"><span class="linenos">2207</span></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">offset</span>
</span></pre></div>


            <div class="docstring"><p>Return a point on a line that is offset from the given point.</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line.
    offset (float): Offset distance.</p>

<p>Returns:
    Point: Offset point on the line.</p>
</div>


                </section>
                <section id="offset_point">
                            <input id="offset_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>, </span><span class="param"><span class="n">dy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="offset_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_point-2210"><a href="#offset_point-2210"><span class="linenos">2210</span></a><span class="k">def</span> <span class="nf">offset_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="offset_point-2211"><a href="#offset_point-2211"><span class="linenos">2211</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an offset point from a given point.</span>
</span><span id="offset_point-2212"><a href="#offset_point-2212"><span class="linenos">2212</span></a>
</span><span id="offset_point-2213"><a href="#offset_point-2213"><span class="linenos">2213</span></a><span class="sd">    Args:</span>
</span><span id="offset_point-2214"><a href="#offset_point-2214"><span class="linenos">2214</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="offset_point-2215"><a href="#offset_point-2215"><span class="linenos">2215</span></a><span class="sd">        dx (float, optional): Offset distance in x-direction. Defaults to 0.</span>
</span><span id="offset_point-2216"><a href="#offset_point-2216"><span class="linenos">2216</span></a><span class="sd">        dy (float, optional): Offset distance in y-direction. Defaults to 0.</span>
</span><span id="offset_point-2217"><a href="#offset_point-2217"><span class="linenos">2217</span></a>
</span><span id="offset_point-2218"><a href="#offset_point-2218"><span class="linenos">2218</span></a><span class="sd">    Returns:</span>
</span><span id="offset_point-2219"><a href="#offset_point-2219"><span class="linenos">2219</span></a><span class="sd">        Point: Offset point.</span>
</span><span id="offset_point-2220"><a href="#offset_point-2220"><span class="linenos">2220</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_point-2221"><a href="#offset_point-2221"><span class="linenos">2221</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="offset_point-2222"><a href="#offset_point-2222"><span class="linenos">2222</span></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
</span></pre></div>


            <div class="docstring"><p>Return an offset point from a given point.</p>

<p>Args:
    point (Point): Input point.
    dx (float, optional): Offset distance in x-direction. Defaults to 0.
    dy (float, optional): Offset distance in y-direction. Defaults to 0.</p>

<p>Returns:
    Point: Offset point.</p>
</div>


                </section>
                <section id="parallel_line">
                            <input id="parallel_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="parallel_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parallel_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parallel_line-2225"><a href="#parallel_line-2225"><span class="linenos">2225</span></a><span class="k">def</span> <span class="nf">parallel_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="parallel_line-2226"><a href="#parallel_line-2226"><span class="linenos">2226</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a parallel line to the given line that goes through the given point</span>
</span><span id="parallel_line-2227"><a href="#parallel_line-2227"><span class="linenos">2227</span></a>
</span><span id="parallel_line-2228"><a href="#parallel_line-2228"><span class="linenos">2228</span></a><span class="sd">    Args:</span>
</span><span id="parallel_line-2229"><a href="#parallel_line-2229"><span class="linenos">2229</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="parallel_line-2230"><a href="#parallel_line-2230"><span class="linenos">2230</span></a><span class="sd">        point (Point): Point through which the parallel line passes.</span>
</span><span id="parallel_line-2231"><a href="#parallel_line-2231"><span class="linenos">2231</span></a>
</span><span id="parallel_line-2232"><a href="#parallel_line-2232"><span class="linenos">2232</span></a><span class="sd">    Returns:</span>
</span><span id="parallel_line-2233"><a href="#parallel_line-2233"><span class="linenos">2233</span></a><span class="sd">        Line: Parallel line.</span>
</span><span id="parallel_line-2234"><a href="#parallel_line-2234"><span class="linenos">2234</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parallel_line-2235"><a href="#parallel_line-2235"><span class="linenos">2235</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="parallel_line-2236"><a href="#parallel_line-2236"><span class="linenos">2236</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="parallel_line-2237"><a href="#parallel_line-2237"><span class="linenos">2237</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="parallel_line-2238"><a href="#parallel_line-2238"><span class="linenos">2238</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="parallel_line-2239"><a href="#parallel_line-2239"><span class="linenos">2239</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="parallel_line-2240"><a href="#parallel_line-2240"><span class="linenos">2240</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">],</span> <span class="p">[</span><span class="n">x3</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y3</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Return a parallel line to the given line that goes through the given point</p>

<p>Args:
    line (Line): Input line.
    point (Point): Point through which the parallel line passes.</p>

<p>Returns:
    Line: Parallel line.</p>
</div>


                </section>
                <section id="perp_offset_point">
                            <input id="perp_offset_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">perp_offset_point</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="perp_offset_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#perp_offset_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="perp_offset_point-2243"><a href="#perp_offset_point-2243"><span class="linenos">2243</span></a><span class="k">def</span> <span class="nf">perp_offset_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="perp_offset_point-2244"><a href="#perp_offset_point-2244"><span class="linenos">2244</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point that is offset from the given point in the perpendicular direction to the given line.</span>
</span><span id="perp_offset_point-2245"><a href="#perp_offset_point-2245"><span class="linenos">2245</span></a>
</span><span id="perp_offset_point-2246"><a href="#perp_offset_point-2246"><span class="linenos">2246</span></a><span class="sd">    Args:</span>
</span><span id="perp_offset_point-2247"><a href="#perp_offset_point-2247"><span class="linenos">2247</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="perp_offset_point-2248"><a href="#perp_offset_point-2248"><span class="linenos">2248</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="perp_offset_point-2249"><a href="#perp_offset_point-2249"><span class="linenos">2249</span></a><span class="sd">        offset (float): Offset distance.</span>
</span><span id="perp_offset_point-2250"><a href="#perp_offset_point-2250"><span class="linenos">2250</span></a>
</span><span id="perp_offset_point-2251"><a href="#perp_offset_point-2251"><span class="linenos">2251</span></a><span class="sd">    Returns:</span>
</span><span id="perp_offset_point-2252"><a href="#perp_offset_point-2252"><span class="linenos">2252</span></a><span class="sd">        Point: Perpendicular offset point.</span>
</span><span id="perp_offset_point-2253"><a href="#perp_offset_point-2253"><span class="linenos">2253</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="perp_offset_point-2254"><a href="#perp_offset_point-2254"><span class="linenos">2254</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="n">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="perp_offset_point-2255"><a href="#perp_offset_point-2255"><span class="linenos">2255</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="perp_offset_point-2256"><a href="#perp_offset_point-2256"><span class="linenos">2256</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">offset</span>
</span><span id="perp_offset_point-2257"><a href="#perp_offset_point-2257"><span class="linenos">2257</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="perp_offset_point-2258"><a href="#perp_offset_point-2258"><span class="linenos">2258</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return a point that is offset from the given point in the perpendicular direction to the given line.</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line.
    offset (float): Offset distance.</p>

<p>Returns:
    Point: Perpendicular offset point.</p>
</div>


                </section>
                <section id="perp_unit_vector">
                            <input id="perp_unit_vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">perp_unit_vector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="perp_unit_vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#perp_unit_vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="perp_unit_vector-2261"><a href="#perp_unit_vector-2261"><span class="linenos">2261</span></a><span class="k">def</span> <span class="nf">perp_unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="perp_unit_vector-2262"><a href="#perp_unit_vector-2262"><span class="linenos">2262</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the perpendicular unit vector to a line</span>
</span><span id="perp_unit_vector-2263"><a href="#perp_unit_vector-2263"><span class="linenos">2263</span></a>
</span><span id="perp_unit_vector-2264"><a href="#perp_unit_vector-2264"><span class="linenos">2264</span></a><span class="sd">    Args:</span>
</span><span id="perp_unit_vector-2265"><a href="#perp_unit_vector-2265"><span class="linenos">2265</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="perp_unit_vector-2266"><a href="#perp_unit_vector-2266"><span class="linenos">2266</span></a>
</span><span id="perp_unit_vector-2267"><a href="#perp_unit_vector-2267"><span class="linenos">2267</span></a><span class="sd">    Returns:</span>
</span><span id="perp_unit_vector-2268"><a href="#perp_unit_vector-2268"><span class="linenos">2268</span></a><span class="sd">        VecType: Perpendicular unit vector.</span>
</span><span id="perp_unit_vector-2269"><a href="#perp_unit_vector-2269"><span class="linenos">2269</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="perp_unit_vector-2270"><a href="#perp_unit_vector-2270"><span class="linenos">2270</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="perp_unit_vector-2271"><a href="#perp_unit_vector-2271"><span class="linenos">2271</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="perp_unit_vector-2272"><a href="#perp_unit_vector-2272"><span class="linenos">2272</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="perp_unit_vector-2273"><a href="#perp_unit_vector-2273"><span class="linenos">2273</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="perp_unit_vector-2274"><a href="#perp_unit_vector-2274"><span class="linenos">2274</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="perp_unit_vector-2275"><a href="#perp_unit_vector-2275"><span class="linenos">2275</span></a>    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the perpendicular unit vector to a line</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    VecType: Perpendicular unit vector.</p>
</div>


                </section>
                <section id="tfl_by_sides">
                            <input id="tfl_by_sides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tfl_by_sides</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">point2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">side1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">side2</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="tfl_by_sides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#tfl_by_sides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="tfl_by_sides-2278"><a href="#tfl_by_sides-2278"><span class="linenos">2278</span></a><span class="k">def</span> <span class="nf">tfl_by_sides</span><span class="p">(</span><span class="n">point1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">point2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">side1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">side2</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="tfl_by_sides-2279"><a href="#tfl_by_sides-2279"><span class="linenos">2279</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Triangle from line segment and two sides.</span>
</span><span id="tfl_by_sides-2280"><a href="#tfl_by_sides-2280"><span class="linenos">2280</span></a><span class="sd">    Returns the points of the triangle given by the two points and the two sides.</span>
</span><span id="tfl_by_sides-2281"><a href="#tfl_by_sides-2281"><span class="linenos">2281</span></a>
</span><span id="tfl_by_sides-2282"><a href="#tfl_by_sides-2282"><span class="linenos">2282</span></a><span class="sd">        Args:</span>
</span><span id="tfl_by_sides-2283"><a href="#tfl_by_sides-2283"><span class="linenos">2283</span></a><span class="sd">            point1 (Point): First point of the line segment.</span>
</span><span id="tfl_by_sides-2284"><a href="#tfl_by_sides-2284"><span class="linenos">2284</span></a><span class="sd">            point2 (Point): Second point of the line segment.</span>
</span><span id="tfl_by_sides-2285"><a href="#tfl_by_sides-2285"><span class="linenos">2285</span></a><span class="sd">            side1 (float): Length of the first side.</span>
</span><span id="tfl_by_sides-2286"><a href="#tfl_by_sides-2286"><span class="linenos">2286</span></a><span class="sd">            side2 (float): Length of the second side.</span>
</span><span id="tfl_by_sides-2287"><a href="#tfl_by_sides-2287"><span class="linenos">2287</span></a>
</span><span id="tfl_by_sides-2288"><a href="#tfl_by_sides-2288"><span class="linenos">2288</span></a><span class="sd">        Returns:</span>
</span><span id="tfl_by_sides-2289"><a href="#tfl_by_sides-2289"><span class="linenos">2289</span></a><span class="sd">            list[Point]: List of points of the triangle.</span>
</span><span id="tfl_by_sides-2290"><a href="#tfl_by_sides-2290"><span class="linenos">2290</span></a>
</span><span id="tfl_by_sides-2291"><a href="#tfl_by_sides-2291"><span class="linenos">2291</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="tfl_by_sides-2292"><a href="#tfl_by_sides-2292"><span class="linenos">2292</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span>
</span><span id="tfl_by_sides-2293"><a href="#tfl_by_sides-2293"><span class="linenos">2293</span></a>        <span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="tfl_by_sides-2294"><a href="#tfl_by_sides-2294"><span class="linenos">2294</span></a>    <span class="p">)</span>
</span><span id="tfl_by_sides-2295"><a href="#tfl_by_sides-2295"><span class="linenos">2295</span></a>    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="tfl_by_sides-2296"><a href="#tfl_by_sides-2296"><span class="linenos">2296</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! Points are coincident.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2297"><a href="#tfl_by_sides-2297"><span class="linenos">2297</span></a>
</span><span id="tfl_by_sides-2298"><a href="#tfl_by_sides-2298"><span class="linenos">2298</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">+</span> <span class="n">side2</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span>
</span><span id="tfl_by_sides-2299"><a href="#tfl_by_sides-2299"><span class="linenos">2299</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the sides is less than the distance between the points.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2300"><a href="#tfl_by_sides-2300"><span class="linenos">2300</span></a>
</span><span id="tfl_by_sides-2301"><a href="#tfl_by_sides-2301"><span class="linenos">2301</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">side2</span><span class="p">:</span>
</span><span id="tfl_by_sides-2302"><a href="#tfl_by_sides-2302"><span class="linenos">2302</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the first side and the distance between the points is less than the second side.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2303"><a href="#tfl_by_sides-2303"><span class="linenos">2303</span></a>
</span><span id="tfl_by_sides-2304"><a href="#tfl_by_sides-2304"><span class="linenos">2304</span></a>    <span class="k">if</span> <span class="n">side2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">side1</span><span class="p">:</span>
</span><span id="tfl_by_sides-2305"><a href="#tfl_by_sides-2305"><span class="linenos">2305</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! The sum of the second side and the distance between the points is less than the first side.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2306"><a href="#tfl_by_sides-2306"><span class="linenos">2306</span></a>
</span><span id="tfl_by_sides-2307"><a href="#tfl_by_sides-2307"><span class="linenos">2307</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">side2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="tfl_by_sides-2308"><a href="#tfl_by_sides-2308"><span class="linenos">2308</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! One of the sides is zero.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2309"><a href="#tfl_by_sides-2309"><span class="linenos">2309</span></a>
</span><span id="tfl_by_sides-2310"><a href="#tfl_by_sides-2310"><span class="linenos">2310</span></a>    <span class="k">if</span> <span class="n">side1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">side2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="tfl_by_sides-2311"><a href="#tfl_by_sides-2311"><span class="linenos">2311</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error! One of the sides is negative.&quot;</span><span class="p">)</span>
</span><span id="tfl_by_sides-2312"><a href="#tfl_by_sides-2312"><span class="linenos">2312</span></a>
</span><span id="tfl_by_sides-2313"><a href="#tfl_by_sides-2313"><span class="linenos">2313</span></a>    <span class="n">intersections</span> <span class="o">=</span> <span class="n">circle_circle_intersections</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">side1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">side2</span><span class="p">)</span>
</span><span id="tfl_by_sides-2314"><a href="#tfl_by_sides-2314"><span class="linenos">2314</span></a>
</span><span id="tfl_by_sides-2315"><a href="#tfl_by_sides-2315"><span class="linenos">2315</span></a>    <span class="k">return</span> <span class="n">intersections</span>
</span></pre></div>


            <div class="docstring"><p>Triangle from line segment and two sides.
Returns the points of the triangle given by the two points and the two sides.</p>

<pre><code>Args:
    point1 (Point): First point of the line segment.
    point2 (Point): Second point of the line segment.
    side1 (float): Length of the first side.
    side2 (float): Length of the second side.

Returns:
    list[Point]: List of points of the triangle.
</code></pre>
</div>


                </section>
                <section id="point_on_line">
                            <input id="point_on_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_on_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="point_on_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_on_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_on_line-2317"><a href="#point_on_line-2317"><span class="linenos">2317</span></a><span class="k">def</span> <span class="nf">point_on_line</span><span class="p">(</span>
</span><span id="point_on_line-2318"><a href="#point_on_line-2318"><span class="linenos">2318</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="point_on_line-2319"><a href="#point_on_line-2319"><span class="linenos">2319</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="point_on_line-2320"><a href="#point_on_line-2320"><span class="linenos">2320</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given point is on the given line</span>
</span><span id="point_on_line-2321"><a href="#point_on_line-2321"><span class="linenos">2321</span></a>
</span><span id="point_on_line-2322"><a href="#point_on_line-2322"><span class="linenos">2322</span></a><span class="sd">    Args:</span>
</span><span id="point_on_line-2323"><a href="#point_on_line-2323"><span class="linenos">2323</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_on_line-2324"><a href="#point_on_line-2324"><span class="linenos">2324</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="point_on_line-2325"><a href="#point_on_line-2325"><span class="linenos">2325</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="point_on_line-2326"><a href="#point_on_line-2326"><span class="linenos">2326</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="point_on_line-2327"><a href="#point_on_line-2327"><span class="linenos">2327</span></a>
</span><span id="point_on_line-2328"><a href="#point_on_line-2328"><span class="linenos">2328</span></a><span class="sd">    Returns:</span>
</span><span id="point_on_line-2329"><a href="#point_on_line-2329"><span class="linenos">2329</span></a><span class="sd">        bool: True if the point is on the line, False otherwise.</span>
</span><span id="point_on_line-2330"><a href="#point_on_line-2330"><span class="linenos">2330</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_on_line-2331"><a href="#point_on_line-2331"><span class="linenos">2331</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="point_on_line-2332"><a href="#point_on_line-2332"><span class="linenos">2332</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="point_on_line-2333"><a href="#point_on_line-2333"><span class="linenos">2333</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">slope</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">point</span><span class="p">),</span> <span class="n">slope</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the given point is on the given line</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the point is on the line, False otherwise.</p>
</div>


                </section>
                <section id="point_on_line_segment">
                            <input id="point_on_line_segment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_on_line_segment</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="point_on_line_segment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_on_line_segment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_on_line_segment-2336"><a href="#point_on_line_segment-2336"><span class="linenos">2336</span></a><span class="k">def</span> <span class="nf">point_on_line_segment</span><span class="p">(</span>
</span><span id="point_on_line_segment-2337"><a href="#point_on_line_segment-2337"><span class="linenos">2337</span></a>    <span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="point_on_line_segment-2338"><a href="#point_on_line_segment-2338"><span class="linenos">2338</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="point_on_line_segment-2339"><a href="#point_on_line_segment-2339"><span class="linenos">2339</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the given point is on the given line segment</span>
</span><span id="point_on_line_segment-2340"><a href="#point_on_line_segment-2340"><span class="linenos">2340</span></a>
</span><span id="point_on_line_segment-2341"><a href="#point_on_line_segment-2341"><span class="linenos">2341</span></a><span class="sd">    Args:</span>
</span><span id="point_on_line_segment-2342"><a href="#point_on_line_segment-2342"><span class="linenos">2342</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_on_line_segment-2343"><a href="#point_on_line_segment-2343"><span class="linenos">2343</span></a><span class="sd">        line (Line): Input line segment.</span>
</span><span id="point_on_line_segment-2344"><a href="#point_on_line_segment-2344"><span class="linenos">2344</span></a><span class="sd">        rtol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="point_on_line_segment-2345"><a href="#point_on_line_segment-2345"><span class="linenos">2345</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="point_on_line_segment-2346"><a href="#point_on_line_segment-2346"><span class="linenos">2346</span></a>
</span><span id="point_on_line_segment-2347"><a href="#point_on_line_segment-2347"><span class="linenos">2347</span></a><span class="sd">    Returns:</span>
</span><span id="point_on_line_segment-2348"><a href="#point_on_line_segment-2348"><span class="linenos">2348</span></a><span class="sd">        bool: True if the point is on the line segment, False otherwise.</span>
</span><span id="point_on_line_segment-2349"><a href="#point_on_line_segment-2349"><span class="linenos">2349</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_on_line_segment-2350"><a href="#point_on_line_segment-2350"><span class="linenos">2350</span></a>    <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="point_on_line_segment-2351"><a href="#point_on_line_segment-2351"><span class="linenos">2351</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="point_on_line_segment-2352"><a href="#point_on_line_segment-2352"><span class="linenos">2352</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="point_on_line_segment-2353"><a href="#point_on_line_segment-2353"><span class="linenos">2353</span></a>        <span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">+</span> <span class="n">distance</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">point</span><span class="p">)),</span>
</span><span id="point_on_line_segment-2354"><a href="#point_on_line_segment-2354"><span class="linenos">2354</span></a>        <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span>
</span><span id="point_on_line_segment-2355"><a href="#point_on_line_segment-2355"><span class="linenos">2355</span></a>        <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
</span><span id="point_on_line_segment-2356"><a href="#point_on_line_segment-2356"><span class="linenos">2356</span></a>        <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
</span><span id="point_on_line_segment-2357"><a href="#point_on_line_segment-2357"><span class="linenos">2357</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the given point is on the given line segment</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line segment.
    rtol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the point is on the line segment, False otherwise.</p>
</div>


                </section>
                <section id="point_to_line_distance">
                            <input id="point_to_line_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_to_line_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="point_to_line_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_to_line_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_to_line_distance-2360"><a href="#point_to_line_distance-2360"><span class="linenos">2360</span></a><span class="k">def</span> <span class="nf">point_to_line_distance</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="point_to_line_distance-2361"><a href="#point_to_line_distance-2361"><span class="linenos">2361</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the vector from a point to a line</span>
</span><span id="point_to_line_distance-2362"><a href="#point_to_line_distance-2362"><span class="linenos">2362</span></a>
</span><span id="point_to_line_distance-2363"><a href="#point_to_line_distance-2363"><span class="linenos">2363</span></a><span class="sd">    Args:</span>
</span><span id="point_to_line_distance-2364"><a href="#point_to_line_distance-2364"><span class="linenos">2364</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_to_line_distance-2365"><a href="#point_to_line_distance-2365"><span class="linenos">2365</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="point_to_line_distance-2366"><a href="#point_to_line_distance-2366"><span class="linenos">2366</span></a>
</span><span id="point_to_line_distance-2367"><a href="#point_to_line_distance-2367"><span class="linenos">2367</span></a><span class="sd">    Returns:</span>
</span><span id="point_to_line_distance-2368"><a href="#point_to_line_distance-2368"><span class="linenos">2368</span></a><span class="sd">        float: Distance from the point to the line.</span>
</span><span id="point_to_line_distance-2369"><a href="#point_to_line_distance-2369"><span class="linenos">2369</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_to_line_distance-2370"><a href="#point_to_line_distance-2370"><span class="linenos">2370</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="point_to_line_distance-2371"><a href="#point_to_line_distance-2371"><span class="linenos">2371</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="point_to_line_distance-2372"><a href="#point_to_line_distance-2372"><span class="linenos">2372</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="point_to_line_distance-2373"><a href="#point_to_line_distance-2373"><span class="linenos">2373</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="point_to_line_distance-2374"><a href="#point_to_line_distance-2374"><span class="linenos">2374</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="point_to_line_distance-2375"><a href="#point_to_line_distance-2375"><span class="linenos">2375</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">))</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the vector from a point to a line</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line.</p>

<p>Returns:
    float: Distance from the point to the line.</p>
</div>


                </section>
                <section id="point_to_line_seg_distance">
                            <input id="point_to_line_seg_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_to_line_seg_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p</span>, </span><span class="param"><span class="n">lp1</span>, </span><span class="param"><span class="n">lp2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="point_to_line_seg_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_to_line_seg_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_to_line_seg_distance-2378"><a href="#point_to_line_seg_distance-2378"><span class="linenos">2378</span></a><span class="k">def</span> <span class="nf">point_to_line_seg_distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lp1</span><span class="p">,</span> <span class="n">lp2</span><span class="p">):</span>
</span><span id="point_to_line_seg_distance-2379"><a href="#point_to_line_seg_distance-2379"><span class="linenos">2379</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point p and a line segment defined by boundary points</span>
</span><span id="point_to_line_seg_distance-2380"><a href="#point_to_line_seg_distance-2380"><span class="linenos">2380</span></a><span class="sd">    lp1 and lp2, returns the distance between the line segment and the point.</span>
</span><span id="point_to_line_seg_distance-2381"><a href="#point_to_line_seg_distance-2381"><span class="linenos">2381</span></a><span class="sd">    If the point is not located in the perpendicular area between the</span>
</span><span id="point_to_line_seg_distance-2382"><a href="#point_to_line_seg_distance-2382"><span class="linenos">2382</span></a><span class="sd">    boundary points, returns False.</span>
</span><span id="point_to_line_seg_distance-2383"><a href="#point_to_line_seg_distance-2383"><span class="linenos">2383</span></a>
</span><span id="point_to_line_seg_distance-2384"><a href="#point_to_line_seg_distance-2384"><span class="linenos">2384</span></a><span class="sd">    Args:</span>
</span><span id="point_to_line_seg_distance-2385"><a href="#point_to_line_seg_distance-2385"><span class="linenos">2385</span></a><span class="sd">        p (Point): Input point.</span>
</span><span id="point_to_line_seg_distance-2386"><a href="#point_to_line_seg_distance-2386"><span class="linenos">2386</span></a><span class="sd">        lp1 (Point): First boundary point of the line segment.</span>
</span><span id="point_to_line_seg_distance-2387"><a href="#point_to_line_seg_distance-2387"><span class="linenos">2387</span></a><span class="sd">        lp2 (Point): Second boundary point of the line segment.</span>
</span><span id="point_to_line_seg_distance-2388"><a href="#point_to_line_seg_distance-2388"><span class="linenos">2388</span></a>
</span><span id="point_to_line_seg_distance-2389"><a href="#point_to_line_seg_distance-2389"><span class="linenos">2389</span></a><span class="sd">    Returns:</span>
</span><span id="point_to_line_seg_distance-2390"><a href="#point_to_line_seg_distance-2390"><span class="linenos">2390</span></a><span class="sd">        float: Distance between the point and the line segment, or False if the point is not in the perpendicular area.</span>
</span><span id="point_to_line_seg_distance-2391"><a href="#point_to_line_seg_distance-2391"><span class="linenos">2391</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_to_line_seg_distance-2392"><a href="#point_to_line_seg_distance-2392"><span class="linenos">2392</span></a>    <span class="k">if</span> <span class="n">lp1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">lp2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="point_to_line_seg_distance-2393"><a href="#point_to_line_seg_distance-2393"><span class="linenos">2393</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error! Line is ill defined. Start and end points are coincident.&quot;</span>
</span><span id="point_to_line_seg_distance-2394"><a href="#point_to_line_seg_distance-2394"><span class="linenos">2394</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="point_to_line_seg_distance-2395"><a href="#point_to_line_seg_distance-2395"><span class="linenos">2395</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="point_to_line_seg_distance-2396"><a href="#point_to_line_seg_distance-2396"><span class="linenos">2396</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">lp1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="point_to_line_seg_distance-2397"><a href="#point_to_line_seg_distance-2397"><span class="linenos">2397</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">lp2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="point_to_line_seg_distance-2398"><a href="#point_to_line_seg_distance-2398"><span class="linenos">2398</span></a>
</span><span id="point_to_line_seg_distance-2399"><a href="#point_to_line_seg_distance-2399"><span class="linenos">2399</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span> <span class="o">/</span> <span class="n">distance</span><span class="p">(</span><span class="n">lp1</span><span class="p">,</span> <span class="n">lp2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="point_to_line_seg_distance-2400"><a href="#point_to_line_seg_distance-2400"><span class="linenos">2400</span></a>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="point_to_line_seg_distance-2401"><a href="#point_to_line_seg_distance-2401"><span class="linenos">2401</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="point_to_line_seg_distance-2402"><a href="#point_to_line_seg_distance-2402"><span class="linenos">2402</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="point_to_line_seg_distance-2403"><a href="#point_to_line_seg_distance-2403"><span class="linenos">2403</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">distance</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
</span><span id="point_to_line_seg_distance-2404"><a href="#point_to_line_seg_distance-2404"><span class="linenos">2404</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="point_to_line_seg_distance-2405"><a href="#point_to_line_seg_distance-2405"><span class="linenos">2405</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># p is not between lp1 and lp2</span>
</span><span id="point_to_line_seg_distance-2406"><a href="#point_to_line_seg_distance-2406"><span class="linenos">2406</span></a>
</span><span id="point_to_line_seg_distance-2407"><a href="#point_to_line_seg_distance-2407"><span class="linenos">2407</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Given a point p and a line segment defined by boundary points
lp1 and lp2, returns the distance between the line segment and the point.
If the point is not located in the perpendicular area between the
boundary points, returns False.</p>

<p>Args:
    p (Point): Input point.
    lp1 (Point): First boundary point of the line segment.
    lp2 (Point): Second boundary point of the line segment.</p>

<p>Returns:
    float: Distance between the point and the line segment, or False if the point is not in the perpendicular area.</p>
</div>


                </section>
                <section id="rotate_point">
                            <input id="rotate_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_point</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">center</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="rotate_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#rotate_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="rotate_point-3024"><a href="#rotate_point-3024"><span class="linenos">3024</span></a><span class="k">def</span> <span class="nf">rotate_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span><span class="n">Point</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span><span class="n">Point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="rotate_point-3025"><a href="#rotate_point-3025"><span class="linenos">3025</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a point around a center by an angle in radians.</span>
</span><span id="rotate_point-3026"><a href="#rotate_point-3026"><span class="linenos">3026</span></a>
</span><span id="rotate_point-3027"><a href="#rotate_point-3027"><span class="linenos">3027</span></a><span class="sd">    Args:</span>
</span><span id="rotate_point-3028"><a href="#rotate_point-3028"><span class="linenos">3028</span></a><span class="sd">        point (Point): Point to rotate.</span>
</span><span id="rotate_point-3029"><a href="#rotate_point-3029"><span class="linenos">3029</span></a><span class="sd">        angle (float): Angle of rotation in radians.</span>
</span><span id="rotate_point-3030"><a href="#rotate_point-3030"><span class="linenos">3030</span></a><span class="sd">        center (Point): Center of rotation.</span>
</span><span id="rotate_point-3031"><a href="#rotate_point-3031"><span class="linenos">3031</span></a>
</span><span id="rotate_point-3032"><a href="#rotate_point-3032"><span class="linenos">3032</span></a><span class="sd">    Returns:</span>
</span><span id="rotate_point-3033"><a href="#rotate_point-3033"><span class="linenos">3033</span></a><span class="sd">        Point: Rotated point.</span>
</span><span id="rotate_point-3034"><a href="#rotate_point-3034"><span class="linenos">3034</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="rotate_point-3035"><a href="#rotate_point-3035"><span class="linenos">3035</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="rotate_point-3036"><a href="#rotate_point-3036"><span class="linenos">3036</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="rotate_point-3037"><a href="#rotate_point-3037"><span class="linenos">3037</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">cx</span>
</span><span id="rotate_point-3038"><a href="#rotate_point-3038"><span class="linenos">3038</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">cy</span>
</span><span id="rotate_point-3039"><a href="#rotate_point-3039"><span class="linenos">3039</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="rotate_point-3040"><a href="#rotate_point-3040"><span class="linenos">3040</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="rotate_point-3041"><a href="#rotate_point-3041"><span class="linenos">3041</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Rotate a point around a center by an angle in radians.</p>

<p>Args:
    point (Point): Point to rotate.
    angle (float): Angle of rotation in radians.
    center (Point): Center of rotation.</p>

<p>Returns:
    Point: Rotated point.</p>
</div>


                </section>
                <section id="point_to_line_vec">
                            <input id="point_to_line_vec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_to_line_vec</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">unit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="point_to_line_vec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_to_line_vec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_to_line_vec-2423"><a href="#point_to_line_vec-2423"><span class="linenos">2423</span></a><span class="k">def</span> <span class="nf">point_to_line_vec</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="point_to_line_vec-2424"><a href="#point_to_line_vec-2424"><span class="linenos">2424</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the perpendicular vector from a point to a line</span>
</span><span id="point_to_line_vec-2425"><a href="#point_to_line_vec-2425"><span class="linenos">2425</span></a>
</span><span id="point_to_line_vec-2426"><a href="#point_to_line_vec-2426"><span class="linenos">2426</span></a><span class="sd">    Args:</span>
</span><span id="point_to_line_vec-2427"><a href="#point_to_line_vec-2427"><span class="linenos">2427</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_to_line_vec-2428"><a href="#point_to_line_vec-2428"><span class="linenos">2428</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="point_to_line_vec-2429"><a href="#point_to_line_vec-2429"><span class="linenos">2429</span></a><span class="sd">        unit (bool, optional): Whether to return a unit vector. Defaults to False.</span>
</span><span id="point_to_line_vec-2430"><a href="#point_to_line_vec-2430"><span class="linenos">2430</span></a>
</span><span id="point_to_line_vec-2431"><a href="#point_to_line_vec-2431"><span class="linenos">2431</span></a><span class="sd">    Returns:</span>
</span><span id="point_to_line_vec-2432"><a href="#point_to_line_vec-2432"><span class="linenos">2432</span></a><span class="sd">        VecType: Perpendicular vector from the point to the line.</span>
</span><span id="point_to_line_vec-2433"><a href="#point_to_line_vec-2433"><span class="linenos">2433</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_to_line_vec-2434"><a href="#point_to_line_vec-2434"><span class="linenos">2434</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="point_to_line_vec-2435"><a href="#point_to_line_vec-2435"><span class="linenos">2435</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="point_to_line_vec-2436"><a href="#point_to_line_vec-2436"><span class="linenos">2436</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="point_to_line_vec-2437"><a href="#point_to_line_vec-2437"><span class="linenos">2437</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="point_to_line_vec-2438"><a href="#point_to_line_vec-2438"><span class="linenos">2438</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="point_to_line_vec-2439"><a href="#point_to_line_vec-2439"><span class="linenos">2439</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="point_to_line_vec-2440"><a href="#point_to_line_vec-2440"><span class="linenos">2440</span></a>    <span class="n">unit_vec</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span><span id="point_to_line_vec-2441"><a href="#point_to_line_vec-2441"><span class="linenos">2441</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="point_to_line_vec-2442"><a href="#point_to_line_vec-2442"><span class="linenos">2442</span></a>    <span class="k">if</span> <span class="n">unit</span><span class="p">:</span>
</span><span id="point_to_line_vec-2443"><a href="#point_to_line_vec-2443"><span class="linenos">2443</span></a>        <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="point_to_line_vec-2444"><a href="#point_to_line_vec-2444"><span class="linenos">2444</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="point_to_line_vec-2445"><a href="#point_to_line_vec-2445"><span class="linenos">2445</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="point_to_line_vec-2446"><a href="#point_to_line_vec-2446"><span class="linenos">2446</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="point_to_line_vec-2447"><a href="#point_to_line_vec-2447"><span class="linenos">2447</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="point_to_line_vec-2448"><a href="#point_to_line_vec-2448"><span class="linenos">2448</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dist</span><span class="p">,</span> <span class="n">unit_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dist</span><span class="p">]</span>
</span><span id="point_to_line_vec-2449"><a href="#point_to_line_vec-2449"><span class="linenos">2449</span></a>
</span><span id="point_to_line_vec-2450"><a href="#point_to_line_vec-2450"><span class="linenos">2450</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the perpendicular vector from a point to a line</p>

<p>Args:
    point (Point): Input point.
    line (Line): Input line.
    unit (bool, optional): Whether to return a unit vector. Defaults to False.</p>

<p>Returns:
    VecType: Perpendicular vector from the point to the line.</p>
</div>


                </section>
                <section id="polygon_area">
                            <input id="polygon_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>, </span><span class="param"><span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="polygon_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_area-2453"><a href="#polygon_area-2453"><span class="linenos">2453</span></a><span class="k">def</span> <span class="nf">polygon_area</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="polygon_area-2454"><a href="#polygon_area-2454"><span class="linenos">2454</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a polygon.</span>
</span><span id="polygon_area-2455"><a href="#polygon_area-2455"><span class="linenos">2455</span></a>
</span><span id="polygon_area-2456"><a href="#polygon_area-2456"><span class="linenos">2456</span></a><span class="sd">    Args:</span>
</span><span id="polygon_area-2457"><a href="#polygon_area-2457"><span class="linenos">2457</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="polygon_area-2458"><a href="#polygon_area-2458"><span class="linenos">2458</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="polygon_area-2459"><a href="#polygon_area-2459"><span class="linenos">2459</span></a>
</span><span id="polygon_area-2460"><a href="#polygon_area-2460"><span class="linenos">2460</span></a><span class="sd">    Returns:</span>
</span><span id="polygon_area-2461"><a href="#polygon_area-2461"><span class="linenos">2461</span></a><span class="sd">        float: Area of the polygon.</span>
</span><span id="polygon_area-2462"><a href="#polygon_area-2462"><span class="linenos">2462</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_area-2463"><a href="#polygon_area-2463"><span class="linenos">2463</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="polygon_area-2464"><a href="#polygon_area-2464"><span class="linenos">2464</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="polygon_area-2465"><a href="#polygon_area-2465"><span class="linenos">2465</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="polygon_area-2466"><a href="#polygon_area-2466"><span class="linenos">2466</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="polygon_area-2467"><a href="#polygon_area-2467"><span class="linenos">2467</span></a>        <span class="n">polygon</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:])</span>
</span><span id="polygon_area-2468"><a href="#polygon_area-2468"><span class="linenos">2468</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="polygon_area-2469"><a href="#polygon_area-2469"><span class="linenos">2469</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polygon_area-2470"><a href="#polygon_area-2470"><span class="linenos">2470</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="polygon_area-2471"><a href="#polygon_area-2471"><span class="linenos">2471</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="polygon_area-2472"><a href="#polygon_area-2472"><span class="linenos">2472</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="polygon_area-2473"><a href="#polygon_area-2473"><span class="linenos">2473</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="polygon_area-2474"><a href="#polygon_area-2474"><span class="linenos">2474</span></a>
</span><span id="polygon_area-2475"><a href="#polygon_area-2475"><span class="linenos">2475</span></a>    <span class="k">return</span> <span class="n">area_</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the area of a polygon.</p>

<p>Args:
    polygon (Sequence[Point]): List of points representing the polygon.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    float: Area of the polygon.</p>
</div>


                </section>
                <section id="polyline_length">
                            <input id="polyline_length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polyline_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>, </span><span class="param"><span class="n">closed</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="polyline_length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polyline_length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polyline_length-2478"><a href="#polyline_length-2478"><span class="linenos">2478</span></a><span class="k">def</span> <span class="nf">polyline_length</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="polyline_length-2479"><a href="#polyline_length-2479"><span class="linenos">2479</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the perimeter of a polygon.</span>
</span><span id="polyline_length-2480"><a href="#polyline_length-2480"><span class="linenos">2480</span></a>
</span><span id="polyline_length-2481"><a href="#polyline_length-2481"><span class="linenos">2481</span></a><span class="sd">    Args:</span>
</span><span id="polyline_length-2482"><a href="#polyline_length-2482"><span class="linenos">2482</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="polyline_length-2483"><a href="#polyline_length-2483"><span class="linenos">2483</span></a><span class="sd">        closed (bool, optional): Whether the polygon is closed. Defaults to False.</span>
</span><span id="polyline_length-2484"><a href="#polyline_length-2484"><span class="linenos">2484</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="polyline_length-2485"><a href="#polyline_length-2485"><span class="linenos">2485</span></a>
</span><span id="polyline_length-2486"><a href="#polyline_length-2486"><span class="linenos">2486</span></a><span class="sd">    Returns:</span>
</span><span id="polyline_length-2487"><a href="#polyline_length-2487"><span class="linenos">2487</span></a><span class="sd">        float: Perimeter of the polygon.</span>
</span><span id="polyline_length-2488"><a href="#polyline_length-2488"><span class="linenos">2488</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polyline_length-2489"><a href="#polyline_length-2489"><span class="linenos">2489</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="polyline_length-2490"><a href="#polyline_length-2490"><span class="linenos">2490</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="polyline_length-2491"><a href="#polyline_length-2491"><span class="linenos">2491</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="polyline_length-2492"><a href="#polyline_length-2492"><span class="linenos">2492</span></a>    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
</span><span id="polyline_length-2493"><a href="#polyline_length-2493"><span class="linenos">2493</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="polyline_length-2494"><a href="#polyline_length-2494"><span class="linenos">2494</span></a>            <span class="n">polygon</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[:]</span>
</span><span id="polyline_length-2495"><a href="#polyline_length-2495"><span class="linenos">2495</span></a>            <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="polyline_length-2496"><a href="#polyline_length-2496"><span class="linenos">2496</span></a>    <span class="n">perimeter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="polyline_length-2497"><a href="#polyline_length-2497"><span class="linenos">2497</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="polyline_length-2498"><a href="#polyline_length-2498"><span class="linenos">2498</span></a>        <span class="n">perimeter</span> <span class="o">+=</span> <span class="n">distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="polyline_length-2499"><a href="#polyline_length-2499"><span class="linenos">2499</span></a>    <span class="k">return</span> <span class="n">perimeter</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the perimeter of a polygon.</p>

<p>Args:
    polygon (Sequence[Point]): List of points representing the polygon.
    closed (bool, optional): Whether the polygon is closed. Defaults to False.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    float: Perimeter of the polygon.</p>
</div>


                </section>
                <section id="right_handed">
                            <input id="right_handed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">right_handed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>, </span><span class="param"><span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="right_handed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#right_handed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="right_handed-2502"><a href="#right_handed-2502"><span class="linenos">2502</span></a><span class="k">def</span> <span class="nf">right_handed</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">dist_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="right_handed-2503"><a href="#right_handed-2503"><span class="linenos">2503</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;If polygon is counter-clockwise, return True</span>
</span><span id="right_handed-2504"><a href="#right_handed-2504"><span class="linenos">2504</span></a>
</span><span id="right_handed-2505"><a href="#right_handed-2505"><span class="linenos">2505</span></a><span class="sd">    Args:</span>
</span><span id="right_handed-2506"><a href="#right_handed-2506"><span class="linenos">2506</span></a><span class="sd">        polygon (Sequence[Point]): List of points representing the polygon.</span>
</span><span id="right_handed-2507"><a href="#right_handed-2507"><span class="linenos">2507</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="right_handed-2508"><a href="#right_handed-2508"><span class="linenos">2508</span></a>
</span><span id="right_handed-2509"><a href="#right_handed-2509"><span class="linenos">2509</span></a><span class="sd">    Returns:</span>
</span><span id="right_handed-2510"><a href="#right_handed-2510"><span class="linenos">2510</span></a><span class="sd">        bool: True if the polygon is counter-clockwise, False otherwise.</span>
</span><span id="right_handed-2511"><a href="#right_handed-2511"><span class="linenos">2511</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="right_handed-2512"><a href="#right_handed-2512"><span class="linenos">2512</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="right_handed-2513"><a href="#right_handed-2513"><span class="linenos">2513</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="right_handed-2514"><a href="#right_handed-2514"><span class="linenos">2514</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="right_handed-2515"><a href="#right_handed-2515"><span class="linenos">2515</span></a>    <span class="n">added_point</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="right_handed-2516"><a href="#right_handed-2516"><span class="linenos">2516</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="right_handed-2517"><a href="#right_handed-2517"><span class="linenos">2517</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="right_handed-2518"><a href="#right_handed-2518"><span class="linenos">2518</span></a>        <span class="n">added_point</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="right_handed-2519"><a href="#right_handed-2519"><span class="linenos">2519</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="right_handed-2520"><a href="#right_handed-2520"><span class="linenos">2520</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="right_handed-2521"><a href="#right_handed-2521"><span class="linenos">2521</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="right_handed-2522"><a href="#right_handed-2522"><span class="linenos">2522</span></a>        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="right_handed-2523"><a href="#right_handed-2523"><span class="linenos">2523</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="right_handed-2524"><a href="#right_handed-2524"><span class="linenos">2524</span></a>    <span class="k">if</span> <span class="n">added_point</span><span class="p">:</span>
</span><span id="right_handed-2525"><a href="#right_handed-2525"><span class="linenos">2525</span></a>        <span class="n">polygon</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="right_handed-2526"><a href="#right_handed-2526"><span class="linenos">2526</span></a>    <span class="k">return</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>If polygon is counter-clockwise, return True</p>

<p>Args:
    polygon (Sequence[Point]): List of points representing the polygon.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the polygon is counter-clockwise, False otherwise.</p>
</div>


                </section>
                <section id="radius2side_len">
                            <input id="radius2side_len-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">radius2side_len</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">radius</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="radius2side_len-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#radius2side_len"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="radius2side_len-2529"><a href="#radius2side_len-2529"><span class="linenos">2529</span></a><span class="k">def</span> <span class="nf">radius2side_len</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="radius2side_len-2530"><a href="#radius2side_len-2530"><span class="linenos">2530</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a radius and the number of sides, return the side length</span>
</span><span id="radius2side_len-2531"><a href="#radius2side_len-2531"><span class="linenos">2531</span></a><span class="sd">    of an n-sided regular polygon with the given radius</span>
</span><span id="radius2side_len-2532"><a href="#radius2side_len-2532"><span class="linenos">2532</span></a>
</span><span id="radius2side_len-2533"><a href="#radius2side_len-2533"><span class="linenos">2533</span></a><span class="sd">    Args:</span>
</span><span id="radius2side_len-2534"><a href="#radius2side_len-2534"><span class="linenos">2534</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="radius2side_len-2535"><a href="#radius2side_len-2535"><span class="linenos">2535</span></a><span class="sd">        radius (float): Radius of the polygon.</span>
</span><span id="radius2side_len-2536"><a href="#radius2side_len-2536"><span class="linenos">2536</span></a>
</span><span id="radius2side_len-2537"><a href="#radius2side_len-2537"><span class="linenos">2537</span></a><span class="sd">    Returns:</span>
</span><span id="radius2side_len-2538"><a href="#radius2side_len-2538"><span class="linenos">2538</span></a><span class="sd">        float: Side length of the polygon.</span>
</span><span id="radius2side_len-2539"><a href="#radius2side_len-2539"><span class="linenos">2539</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="radius2side_len-2540"><a href="#radius2side_len-2540"><span class="linenos">2540</span></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given a radius and the number of sides, return the side length
of an n-sided regular polygon with the given radius</p>

<p>Args:
    n (int): Number of sides.
    radius (float): Radius of the polygon.</p>

<p>Returns:
    float: Side length of the polygon.</p>
</div>


                </section>
                <section id="tokenize_svg_path">
                            <input id="tokenize_svg_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tokenize_svg_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">path</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="tokenize_svg_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#tokenize_svg_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="tokenize_svg_path-2543"><a href="#tokenize_svg_path-2543"><span class="linenos">2543</span></a><span class="k">def</span> <span class="nf">tokenize_svg_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="tokenize_svg_path-2544"><a href="#tokenize_svg_path-2544"><span class="linenos">2544</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tokenize an SVG path string.</span>
</span><span id="tokenize_svg_path-2545"><a href="#tokenize_svg_path-2545"><span class="linenos">2545</span></a>
</span><span id="tokenize_svg_path-2546"><a href="#tokenize_svg_path-2546"><span class="linenos">2546</span></a><span class="sd">    Args:</span>
</span><span id="tokenize_svg_path-2547"><a href="#tokenize_svg_path-2547"><span class="linenos">2547</span></a><span class="sd">        path (str): SVG path string.</span>
</span><span id="tokenize_svg_path-2548"><a href="#tokenize_svg_path-2548"><span class="linenos">2548</span></a>
</span><span id="tokenize_svg_path-2549"><a href="#tokenize_svg_path-2549"><span class="linenos">2549</span></a><span class="sd">    Returns:</span>
</span><span id="tokenize_svg_path-2550"><a href="#tokenize_svg_path-2550"><span class="linenos">2550</span></a><span class="sd">        list[str]: List of tokens.</span>
</span><span id="tokenize_svg_path-2551"><a href="#tokenize_svg_path-2551"><span class="linenos">2551</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="tokenize_svg_path-2552"><a href="#tokenize_svg_path-2552"><span class="linenos">2552</span></a>    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-zA-Z]|[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Tokenize an SVG path string.</p>

<p>Args:
    path (str): SVG path string.</p>

<p>Returns:
    list[str]: List of tokens.</p>
</div>


                </section>
                <section id="law_of_cosines">
                            <input id="law_of_cosines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">law_of_cosines</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="law_of_cosines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#law_of_cosines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="law_of_cosines-2555"><a href="#law_of_cosines-2555"><span class="linenos">2555</span></a><span class="k">def</span> <span class="nf">law_of_cosines</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="law_of_cosines-2556"><a href="#law_of_cosines-2556"><span class="linenos">2556</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle of a triangle given the three sides.</span>
</span><span id="law_of_cosines-2557"><a href="#law_of_cosines-2557"><span class="linenos">2557</span></a><span class="sd">    Returns the angle of A in radians. A is the angle between</span>
</span><span id="law_of_cosines-2558"><a href="#law_of_cosines-2558"><span class="linenos">2558</span></a><span class="sd">    sides b and c.</span>
</span><span id="law_of_cosines-2559"><a href="#law_of_cosines-2559"><span class="linenos">2559</span></a><span class="sd">    cos(A) = (b^2 + c^2 - a^2) / (2 * b * c)</span>
</span><span id="law_of_cosines-2560"><a href="#law_of_cosines-2560"><span class="linenos">2560</span></a>
</span><span id="law_of_cosines-2561"><a href="#law_of_cosines-2561"><span class="linenos">2561</span></a><span class="sd">    Args:</span>
</span><span id="law_of_cosines-2562"><a href="#law_of_cosines-2562"><span class="linenos">2562</span></a><span class="sd">        a (float): Length of side a.</span>
</span><span id="law_of_cosines-2563"><a href="#law_of_cosines-2563"><span class="linenos">2563</span></a><span class="sd">        b (float): Length of side b.</span>
</span><span id="law_of_cosines-2564"><a href="#law_of_cosines-2564"><span class="linenos">2564</span></a><span class="sd">        c (float): Length of side c.</span>
</span><span id="law_of_cosines-2565"><a href="#law_of_cosines-2565"><span class="linenos">2565</span></a>
</span><span id="law_of_cosines-2566"><a href="#law_of_cosines-2566"><span class="linenos">2566</span></a><span class="sd">    Returns:</span>
</span><span id="law_of_cosines-2567"><a href="#law_of_cosines-2567"><span class="linenos">2567</span></a><span class="sd">        float: Angle of A in radians.</span>
</span><span id="law_of_cosines-2568"><a href="#law_of_cosines-2568"><span class="linenos">2568</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="law_of_cosines-2569"><a href="#law_of_cosines-2569"><span class="linenos">2569</span></a>    <span class="k">return</span> <span class="n">acos</span><span class="p">((</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return the angle of a triangle given the three sides.
Returns the angle of A in radians. A is the angle between
sides b and c.
cos(A) = (b^2 + c^2 - a^2) / (2 * b * c)</p>

<p>Args:
    a (float): Length of side a.
    b (float): Length of side b.
    c (float): Length of side c.</p>

<p>Returns:
    float: Angle of A in radians.</p>
</div>


                </section>
                <section id="segmentize_catmull_rom">
                            <input id="segmentize_catmull_rom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">segmentize_catmull_rom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">d</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="segmentize_catmull_rom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#segmentize_catmull_rom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="segmentize_catmull_rom-2572"><a href="#segmentize_catmull_rom-2572"><span class="linenos">2572</span></a><span class="k">def</span> <span class="nf">segmentize_catmull_rom</span><span class="p">(</span>
</span><span id="segmentize_catmull_rom-2573"><a href="#segmentize_catmull_rom-2573"><span class="linenos">2573</span></a>    <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="segmentize_catmull_rom-2574"><a href="#segmentize_catmull_rom-2574"><span class="linenos">2574</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="segmentize_catmull_rom-2575"><a href="#segmentize_catmull_rom-2575"><span class="linenos">2575</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;a and b are the control points and c and d are</span>
</span><span id="segmentize_catmull_rom-2576"><a href="#segmentize_catmull_rom-2576"><span class="linenos">2576</span></a><span class="sd">    start and end points respectively,</span>
</span><span id="segmentize_catmull_rom-2577"><a href="#segmentize_catmull_rom-2577"><span class="linenos">2577</span></a><span class="sd">    n is the number of segments to generate.</span>
</span><span id="segmentize_catmull_rom-2578"><a href="#segmentize_catmull_rom-2578"><span class="linenos">2578</span></a>
</span><span id="segmentize_catmull_rom-2579"><a href="#segmentize_catmull_rom-2579"><span class="linenos">2579</span></a><span class="sd">    Args:</span>
</span><span id="segmentize_catmull_rom-2580"><a href="#segmentize_catmull_rom-2580"><span class="linenos">2580</span></a><span class="sd">        a (float): First control point.</span>
</span><span id="segmentize_catmull_rom-2581"><a href="#segmentize_catmull_rom-2581"><span class="linenos">2581</span></a><span class="sd">        b (float): Second control point.</span>
</span><span id="segmentize_catmull_rom-2582"><a href="#segmentize_catmull_rom-2582"><span class="linenos">2582</span></a><span class="sd">        c (float): Start point.</span>
</span><span id="segmentize_catmull_rom-2583"><a href="#segmentize_catmull_rom-2583"><span class="linenos">2583</span></a><span class="sd">        d (float): End point.</span>
</span><span id="segmentize_catmull_rom-2584"><a href="#segmentize_catmull_rom-2584"><span class="linenos">2584</span></a><span class="sd">        n (int, optional): Number of segments to generate. Defaults to 100.</span>
</span><span id="segmentize_catmull_rom-2585"><a href="#segmentize_catmull_rom-2585"><span class="linenos">2585</span></a>
</span><span id="segmentize_catmull_rom-2586"><a href="#segmentize_catmull_rom-2586"><span class="linenos">2586</span></a><span class="sd">    Returns:</span>
</span><span id="segmentize_catmull_rom-2587"><a href="#segmentize_catmull_rom-2587"><span class="linenos">2587</span></a><span class="sd">        Sequence[float]: List of points representing the segments.</span>
</span><span id="segmentize_catmull_rom-2588"><a href="#segmentize_catmull_rom-2588"><span class="linenos">2588</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="segmentize_catmull_rom-2589"><a href="#segmentize_catmull_rom-2589"><span class="linenos">2589</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="segmentize_catmull_rom-2590"><a href="#segmentize_catmull_rom-2590"><span class="linenos">2590</span></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="segmentize_catmull_rom-2591"><a href="#segmentize_catmull_rom-2591"><span class="linenos">2591</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="segmentize_catmull_rom-2592"><a href="#segmentize_catmull_rom-2592"><span class="linenos">2592</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="segmentize_catmull_rom-2593"><a href="#segmentize_catmull_rom-2593"><span class="linenos">2593</span></a>
</span><span id="segmentize_catmull_rom-2594"><a href="#segmentize_catmull_rom-2594"><span class="linenos">2594</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="segmentize_catmull_rom-2595"><a href="#segmentize_catmull_rom-2595"><span class="linenos">2595</span></a>    <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="segmentize_catmull_rom-2596"><a href="#segmentize_catmull_rom-2596"><span class="linenos">2596</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="segmentize_catmull_rom-2597"><a href="#segmentize_catmull_rom-2597"><span class="linenos">2597</span></a>    <span class="n">term1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="segmentize_catmull_rom-2598"><a href="#segmentize_catmull_rom-2598"><span class="linenos">2598</span></a>    <span class="n">term2</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="segmentize_catmull_rom-2599"><a href="#segmentize_catmull_rom-2599"><span class="linenos">2599</span></a>    <span class="n">term3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">d</span>
</span><span id="segmentize_catmull_rom-2600"><a href="#segmentize_catmull_rom-2600"><span class="linenos">2600</span></a>    <span class="n">term4</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
</span><span id="segmentize_catmull_rom-2601"><a href="#segmentize_catmull_rom-2601"><span class="linenos">2601</span></a>
</span><span id="segmentize_catmull_rom-2602"><a href="#segmentize_catmull_rom-2602"><span class="linenos">2602</span></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="segmentize_catmull_rom-2603"><a href="#segmentize_catmull_rom-2603"><span class="linenos">2603</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">term3</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">term4</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</span><span id="segmentize_catmull_rom-2604"><a href="#segmentize_catmull_rom-2604"><span class="linenos">2604</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="segmentize_catmull_rom-2605"><a href="#segmentize_catmull_rom-2605"><span class="linenos">2605</span></a>        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
</span><span id="segmentize_catmull_rom-2606"><a href="#segmentize_catmull_rom-2606"><span class="linenos">2606</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>a and b are the control points and c and d are
start and end points respectively,
n is the number of segments to generate.</p>

<p>Args:
    a (float): First control point.
    b (float): Second control point.
    c (float): Start point.
    d (float): End point.
    n (int, optional): Number of segments to generate. Defaults to 100.</p>

<p>Returns:
    Sequence[float]: List of points representing the segments.</p>
</div>


                </section>
                <section id="side_len_to_radius">
                            <input id="side_len_to_radius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">side_len_to_radius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">side_len</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="side_len_to_radius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#side_len_to_radius"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="side_len_to_radius-2609"><a href="#side_len_to_radius-2609"><span class="linenos">2609</span></a><span class="k">def</span> <span class="nf">side_len_to_radius</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">side_len</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="side_len_to_radius-2610"><a href="#side_len_to_radius-2610"><span class="linenos">2610</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a side length and the number of sides, return the radius</span>
</span><span id="side_len_to_radius-2611"><a href="#side_len_to_radius-2611"><span class="linenos">2611</span></a><span class="sd">    of an n-sided regular polygon with the given side_len length</span>
</span><span id="side_len_to_radius-2612"><a href="#side_len_to_radius-2612"><span class="linenos">2612</span></a>
</span><span id="side_len_to_radius-2613"><a href="#side_len_to_radius-2613"><span class="linenos">2613</span></a><span class="sd">    Args:</span>
</span><span id="side_len_to_radius-2614"><a href="#side_len_to_radius-2614"><span class="linenos">2614</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="side_len_to_radius-2615"><a href="#side_len_to_radius-2615"><span class="linenos">2615</span></a><span class="sd">        side_len (float): Side length of the polygon.</span>
</span><span id="side_len_to_radius-2616"><a href="#side_len_to_radius-2616"><span class="linenos">2616</span></a>
</span><span id="side_len_to_radius-2617"><a href="#side_len_to_radius-2617"><span class="linenos">2617</span></a><span class="sd">    Returns:</span>
</span><span id="side_len_to_radius-2618"><a href="#side_len_to_radius-2618"><span class="linenos">2618</span></a><span class="sd">        float: Radius of the polygon.</span>
</span><span id="side_len_to_radius-2619"><a href="#side_len_to_radius-2619"><span class="linenos">2619</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="side_len_to_radius-2620"><a href="#side_len_to_radius-2620"><span class="linenos">2620</span></a>    <span class="k">return</span> <span class="n">side_len</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Given a side length and the number of sides, return the radius
of an n-sided regular polygon with the given side_len length</p>

<p>Args:
    n (int): Number of sides.
    side_len (float): Side length of the polygon.</p>

<p>Returns:
    float: Radius of the polygon.</p>
</div>


                </section>
                <section id="translate_line">
                            <input id="translate_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">translate_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">dy</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="translate_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#translate_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="translate_line-2623"><a href="#translate_line-2623"><span class="linenos">2623</span></a><span class="k">def</span> <span class="nf">translate_line</span><span class="p">(</span><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="translate_line-2624"><a href="#translate_line-2624"><span class="linenos">2624</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a translated line by dx and dy</span>
</span><span id="translate_line-2625"><a href="#translate_line-2625"><span class="linenos">2625</span></a>
</span><span id="translate_line-2626"><a href="#translate_line-2626"><span class="linenos">2626</span></a><span class="sd">    Args:</span>
</span><span id="translate_line-2627"><a href="#translate_line-2627"><span class="linenos">2627</span></a><span class="sd">        dx (float): Translation distance in x-direction.</span>
</span><span id="translate_line-2628"><a href="#translate_line-2628"><span class="linenos">2628</span></a><span class="sd">        dy (float): Translation distance in y-direction.</span>
</span><span id="translate_line-2629"><a href="#translate_line-2629"><span class="linenos">2629</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="translate_line-2630"><a href="#translate_line-2630"><span class="linenos">2630</span></a>
</span><span id="translate_line-2631"><a href="#translate_line-2631"><span class="linenos">2631</span></a><span class="sd">    Returns:</span>
</span><span id="translate_line-2632"><a href="#translate_line-2632"><span class="linenos">2632</span></a><span class="sd">        Line: Translated line.</span>
</span><span id="translate_line-2633"><a href="#translate_line-2633"><span class="linenos">2633</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="translate_line-2634"><a href="#translate_line-2634"><span class="linenos">2634</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="translate_line-2635"><a href="#translate_line-2635"><span class="linenos">2635</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="translate_line-2636"><a href="#translate_line-2636"><span class="linenos">2636</span></a>    <span class="k">return</span> <span class="p">[[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">],</span> <span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Return a translated line by dx and dy</p>

<p>Args:
    dx (float): Translation distance in x-direction.
    dy (float): Translation distance in y-direction.
    line (Line): Input line.</p>

<p>Returns:
    Line: Translated line.</p>
</div>


                </section>
                <section id="trim_line">
                            <input id="trim_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trim_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">line2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="trim_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#trim_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="trim_line-2639"><a href="#trim_line-2639"><span class="linenos">2639</span></a><span class="k">def</span> <span class="nf">trim_line</span><span class="p">(</span><span class="n">line1</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">line2</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="trim_line-2640"><a href="#trim_line-2640"><span class="linenos">2640</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Trim line1 to the intersection of line1 and line2.</span>
</span><span id="trim_line-2641"><a href="#trim_line-2641"><span class="linenos">2641</span></a><span class="sd">    Extend it if necessary.</span>
</span><span id="trim_line-2642"><a href="#trim_line-2642"><span class="linenos">2642</span></a>
</span><span id="trim_line-2643"><a href="#trim_line-2643"><span class="linenos">2643</span></a><span class="sd">    Args:</span>
</span><span id="trim_line-2644"><a href="#trim_line-2644"><span class="linenos">2644</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="trim_line-2645"><a href="#trim_line-2645"><span class="linenos">2645</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="trim_line-2646"><a href="#trim_line-2646"><span class="linenos">2646</span></a>
</span><span id="trim_line-2647"><a href="#trim_line-2647"><span class="linenos">2647</span></a><span class="sd">    Returns:</span>
</span><span id="trim_line-2648"><a href="#trim_line-2648"><span class="linenos">2648</span></a><span class="sd">        Line: Trimmed line.</span>
</span><span id="trim_line-2649"><a href="#trim_line-2649"><span class="linenos">2649</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="trim_line-2650"><a href="#trim_line-2650"><span class="linenos">2650</span></a>    <span class="n">intersection_</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="trim_line-2651"><a href="#trim_line-2651"><span class="linenos">2651</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intersection_</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Trim line1 to the intersection of line1 and line2.
Extend it if necessary.</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.</p>

<p>Returns:
    Line: Trimmed line.</p>
</div>


                </section>
                <section id="unit_vector">
                            <input id="unit_vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unit_vector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="unit_vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#unit_vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="unit_vector-2654"><a href="#unit_vector-2654"><span class="linenos">2654</span></a><span class="k">def</span> <span class="nf">unit_vector</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="unit_vector-2655"><a href="#unit_vector-2655"><span class="linenos">2655</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the unit vector of a line</span>
</span><span id="unit_vector-2656"><a href="#unit_vector-2656"><span class="linenos">2656</span></a>
</span><span id="unit_vector-2657"><a href="#unit_vector-2657"><span class="linenos">2657</span></a><span class="sd">    Args:</span>
</span><span id="unit_vector-2658"><a href="#unit_vector-2658"><span class="linenos">2658</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="unit_vector-2659"><a href="#unit_vector-2659"><span class="linenos">2659</span></a>
</span><span id="unit_vector-2660"><a href="#unit_vector-2660"><span class="linenos">2660</span></a><span class="sd">    Returns:</span>
</span><span id="unit_vector-2661"><a href="#unit_vector-2661"><span class="linenos">2661</span></a><span class="sd">        VecType: Unit vector of the line.</span>
</span><span id="unit_vector-2662"><a href="#unit_vector-2662"><span class="linenos">2662</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="unit_vector-2663"><a href="#unit_vector-2663"><span class="linenos">2663</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="unit_vector-2664"><a href="#unit_vector-2664"><span class="linenos">2664</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="unit_vector-2665"><a href="#unit_vector-2665"><span class="linenos">2665</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="unit_vector-2666"><a href="#unit_vector-2666"><span class="linenos">2666</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="unit_vector-2667"><a href="#unit_vector-2667"><span class="linenos">2667</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the unit vector of a line</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    VecType: Unit vector of the line.</p>
</div>


                </section>
                <section id="unit_vector_">
                            <input id="unit_vector_-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unit_vector_</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="unit_vector_-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#unit_vector_"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="unit_vector_-2670"><a href="#unit_vector_-2670"><span class="linenos">2670</span></a><span class="k">def</span> <span class="nf">unit_vector_</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">VecType</span><span class="p">]:</span>
</span><span id="unit_vector_-2671"><a href="#unit_vector_-2671"><span class="linenos">2671</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cartesian unit vector of a line</span>
</span><span id="unit_vector_-2672"><a href="#unit_vector_-2672"><span class="linenos">2672</span></a><span class="sd">    with the given line&#39;s start and end points</span>
</span><span id="unit_vector_-2673"><a href="#unit_vector_-2673"><span class="linenos">2673</span></a>
</span><span id="unit_vector_-2674"><a href="#unit_vector_-2674"><span class="linenos">2674</span></a><span class="sd">    Args:</span>
</span><span id="unit_vector_-2675"><a href="#unit_vector_-2675"><span class="linenos">2675</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="unit_vector_-2676"><a href="#unit_vector_-2676"><span class="linenos">2676</span></a>
</span><span id="unit_vector_-2677"><a href="#unit_vector_-2677"><span class="linenos">2677</span></a><span class="sd">    Returns:</span>
</span><span id="unit_vector_-2678"><a href="#unit_vector_-2678"><span class="linenos">2678</span></a><span class="sd">        Sequence[VecType]: Cartesian unit vector of the line.</span>
</span><span id="unit_vector_-2679"><a href="#unit_vector_-2679"><span class="linenos">2679</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="unit_vector_-2680"><a href="#unit_vector_-2680"><span class="linenos">2680</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="unit_vector_-2681"><a href="#unit_vector_-2681"><span class="linenos">2681</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="unit_vector_-2682"><a href="#unit_vector_-2682"><span class="linenos">2682</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="unit_vector_-2683"><a href="#unit_vector_-2683"><span class="linenos">2683</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="unit_vector_-2684"><a href="#unit_vector_-2684"><span class="linenos">2684</span></a>    <span class="n">norm_</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="unit_vector_-2685"><a href="#unit_vector_-2685"><span class="linenos">2685</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">,</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">norm_</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the cartesian unit vector of a line
with the given line's start and end points</p>

<p>Args:
    line (Line): Input line.</p>

<p>Returns:
    Sequence[VecType]: Cartesian unit vector of the line.</p>
</div>


                </section>
                <section id="vec_along_line">
                            <input id="vec_along_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vec_along_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>, </span><span class="param"><span class="n">magnitude</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="vec_along_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#vec_along_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="vec_along_line-2688"><a href="#vec_along_line-2688"><span class="linenos">2688</span></a><span class="k">def</span> <span class="nf">vec_along_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="vec_along_line-2689"><a href="#vec_along_line-2689"><span class="linenos">2689</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a vector along a line with the given magnitude.</span>
</span><span id="vec_along_line-2690"><a href="#vec_along_line-2690"><span class="linenos">2690</span></a>
</span><span id="vec_along_line-2691"><a href="#vec_along_line-2691"><span class="linenos">2691</span></a><span class="sd">    Args:</span>
</span><span id="vec_along_line-2692"><a href="#vec_along_line-2692"><span class="linenos">2692</span></a><span class="sd">        line (Line): Input line.</span>
</span><span id="vec_along_line-2693"><a href="#vec_along_line-2693"><span class="linenos">2693</span></a><span class="sd">        magnitude (float): Magnitude of the vector.</span>
</span><span id="vec_along_line-2694"><a href="#vec_along_line-2694"><span class="linenos">2694</span></a>
</span><span id="vec_along_line-2695"><a href="#vec_along_line-2695"><span class="linenos">2695</span></a><span class="sd">    Returns:</span>
</span><span id="vec_along_line-2696"><a href="#vec_along_line-2696"><span class="linenos">2696</span></a><span class="sd">        VecType: Vector along the line with the given magnitude.</span>
</span><span id="vec_along_line-2697"><a href="#vec_along_line-2697"><span class="linenos">2697</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="vec_along_line-2698"><a href="#vec_along_line-2698"><span class="linenos">2698</span></a>    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="n">axis_x</span><span class="p">:</span>
</span><span id="vec_along_line-2699"><a href="#vec_along_line-2699"><span class="linenos">2699</span></a>        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="vec_along_line-2700"><a href="#vec_along_line-2700"><span class="linenos">2700</span></a>    <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="n">axis_y</span><span class="p">:</span>
</span><span id="vec_along_line-2701"><a href="#vec_along_line-2701"><span class="linenos">2701</span></a>        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">magnitude</span>
</span><span id="vec_along_line-2702"><a href="#vec_along_line-2702"><span class="linenos">2702</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="vec_along_line-2703"><a href="#vec_along_line-2703"><span class="linenos">2703</span></a>        <span class="c1"># line is (p1, p2)</span>
</span><span id="vec_along_line-2704"><a href="#vec_along_line-2704"><span class="linenos">2704</span></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
</span><span id="vec_along_line-2705"><a href="#vec_along_line-2705"><span class="linenos">2705</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="vec_along_line-2706"><a href="#vec_along_line-2706"><span class="linenos">2706</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="vec_along_line-2707"><a href="#vec_along_line-2707"><span class="linenos">2707</span></a>    <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
</span></pre></div>


            <div class="docstring"><p>Return a vector along a line with the given magnitude.</p>

<p>Args:
    line (Line): Input line.
    magnitude (float): Magnitude of the vector.</p>

<p>Returns:
    VecType: Vector along the line with the given magnitude.</p>
</div>


                </section>
                <section id="vec_dir_angle">
                            <input id="vec_dir_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vec_dir_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vec</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="vec_dir_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#vec_dir_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="vec_dir_angle-2710"><a href="#vec_dir_angle-2710"><span class="linenos">2710</span></a><span class="k">def</span> <span class="nf">vec_dir_angle</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="vec_dir_angle-2711"><a href="#vec_dir_angle-2711"><span class="linenos">2711</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the direction angle of a vector</span>
</span><span id="vec_dir_angle-2712"><a href="#vec_dir_angle-2712"><span class="linenos">2712</span></a>
</span><span id="vec_dir_angle-2713"><a href="#vec_dir_angle-2713"><span class="linenos">2713</span></a><span class="sd">    Args:</span>
</span><span id="vec_dir_angle-2714"><a href="#vec_dir_angle-2714"><span class="linenos">2714</span></a><span class="sd">        vec (Sequence[float]): Input vector.</span>
</span><span id="vec_dir_angle-2715"><a href="#vec_dir_angle-2715"><span class="linenos">2715</span></a>
</span><span id="vec_dir_angle-2716"><a href="#vec_dir_angle-2716"><span class="linenos">2716</span></a><span class="sd">    Returns:</span>
</span><span id="vec_dir_angle-2717"><a href="#vec_dir_angle-2717"><span class="linenos">2717</span></a><span class="sd">        float: Direction angle of the vector.</span>
</span><span id="vec_dir_angle-2718"><a href="#vec_dir_angle-2718"><span class="linenos">2718</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="vec_dir_angle-2719"><a href="#vec_dir_angle-2719"><span class="linenos">2719</span></a>    <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the direction angle of a vector</p>

<p>Args:
    vec (Sequence[float]): Input vector.</p>

<p>Returns:
    float: Direction angle of the vector.</p>
</div>


                </section>
                <section id="cross_product_sense">
                            <input id="cross_product_sense-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cross_product_sense</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="cross_product_sense-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cross_product_sense"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cross_product_sense-2722"><a href="#cross_product_sense-2722"><span class="linenos">2722</span></a><span class="k">def</span> <span class="nf">cross_product_sense</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="cross_product_sense-2723"><a href="#cross_product_sense-2723"><span class="linenos">2723</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cross product sense of vectors a and b.</span>
</span><span id="cross_product_sense-2724"><a href="#cross_product_sense-2724"><span class="linenos">2724</span></a>
</span><span id="cross_product_sense-2725"><a href="#cross_product_sense-2725"><span class="linenos">2725</span></a><span class="sd">    Args:</span>
</span><span id="cross_product_sense-2726"><a href="#cross_product_sense-2726"><span class="linenos">2726</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="cross_product_sense-2727"><a href="#cross_product_sense-2727"><span class="linenos">2727</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="cross_product_sense-2728"><a href="#cross_product_sense-2728"><span class="linenos">2728</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="cross_product_sense-2729"><a href="#cross_product_sense-2729"><span class="linenos">2729</span></a>
</span><span id="cross_product_sense-2730"><a href="#cross_product_sense-2730"><span class="linenos">2730</span></a><span class="sd">    Returns:</span>
</span><span id="cross_product_sense-2731"><a href="#cross_product_sense-2731"><span class="linenos">2731</span></a><span class="sd">        int: Cross product sense.</span>
</span><span id="cross_product_sense-2732"><a href="#cross_product_sense-2732"><span class="linenos">2732</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cross_product_sense-2733"><a href="#cross_product_sense-2733"><span class="linenos">2733</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">cross_product2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="cross_product_sense-2734"><a href="#cross_product_sense-2734"><span class="linenos">2734</span></a>    <span class="k">if</span> <span class="n">length_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="cross_product_sense-2735"><a href="#cross_product_sense-2735"><span class="linenos">2735</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="cross_product_sense-2736"><a href="#cross_product_sense-2736"><span class="linenos">2736</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="cross_product_sense-2737"><a href="#cross_product_sense-2737"><span class="linenos">2737</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="cross_product_sense-2738"><a href="#cross_product_sense-2738"><span class="linenos">2738</span></a>
</span><span id="cross_product_sense-2739"><a href="#cross_product_sense-2739"><span class="linenos">2739</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the cross product sense of vectors a and b.</p>

<p>Args:
    a (Point): First point.
    b (Point): Second point.
    c (Point): Third point.</p>

<p>Returns:
    int: Cross product sense.</p>
</div>


                </section>
                <section id="right_turn">
                            <input id="right_turn-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">right_turn</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span>, </span><span class="param"><span class="n">p3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="right_turn-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#right_turn"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="right_turn-2752"><a href="#right_turn-2752"><span class="linenos">2752</span></a><span class="k">def</span> <span class="nf">right_turn</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="right_turn-2753"><a href="#right_turn-2753"><span class="linenos">2753</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if p1, p2, p3 make a right turn.</span>
</span><span id="right_turn-2754"><a href="#right_turn-2754"><span class="linenos">2754</span></a>
</span><span id="right_turn-2755"><a href="#right_turn-2755"><span class="linenos">2755</span></a><span class="sd">    Args:</span>
</span><span id="right_turn-2756"><a href="#right_turn-2756"><span class="linenos">2756</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="right_turn-2757"><a href="#right_turn-2757"><span class="linenos">2757</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="right_turn-2758"><a href="#right_turn-2758"><span class="linenos">2758</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="right_turn-2759"><a href="#right_turn-2759"><span class="linenos">2759</span></a>
</span><span id="right_turn-2760"><a href="#right_turn-2760"><span class="linenos">2760</span></a><span class="sd">    Returns:</span>
</span><span id="right_turn-2761"><a href="#right_turn-2761"><span class="linenos">2761</span></a><span class="sd">        bool: True if the points make a right turn, False otherwise.</span>
</span><span id="right_turn-2762"><a href="#right_turn-2762"><span class="linenos">2762</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="right_turn-2763"><a href="#right_turn-2763"><span class="linenos">2763</span></a>    <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Return True if p1, p2, p3 make a right turn.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.
    p3 (Point): Third point.</p>

<p>Returns:
    bool: True if the points make a right turn, False otherwise.</p>
</div>


                </section>
                <section id="left_turn">
                            <input id="left_turn-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">left_turn</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span>, </span><span class="param"><span class="n">p3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="left_turn-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#left_turn"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="left_turn-2766"><a href="#left_turn-2766"><span class="linenos">2766</span></a><span class="k">def</span> <span class="nf">left_turn</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="left_turn-2767"><a href="#left_turn-2767"><span class="linenos">2767</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if p1, p2, p3 make a left turn.</span>
</span><span id="left_turn-2768"><a href="#left_turn-2768"><span class="linenos">2768</span></a>
</span><span id="left_turn-2769"><a href="#left_turn-2769"><span class="linenos">2769</span></a><span class="sd">    Args:</span>
</span><span id="left_turn-2770"><a href="#left_turn-2770"><span class="linenos">2770</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="left_turn-2771"><a href="#left_turn-2771"><span class="linenos">2771</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="left_turn-2772"><a href="#left_turn-2772"><span class="linenos">2772</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="left_turn-2773"><a href="#left_turn-2773"><span class="linenos">2773</span></a>
</span><span id="left_turn-2774"><a href="#left_turn-2774"><span class="linenos">2774</span></a><span class="sd">    Returns:</span>
</span><span id="left_turn-2775"><a href="#left_turn-2775"><span class="linenos">2775</span></a><span class="sd">        bool: True if the points make a left turn, False otherwise.</span>
</span><span id="left_turn-2776"><a href="#left_turn-2776"><span class="linenos">2776</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="left_turn-2777"><a href="#left_turn-2777"><span class="linenos">2777</span></a>    <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Return True if p1, p2, p3 make a left turn.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.
    p3 (Point): Third point.</p>

<p>Returns:
    bool: True if the points make a left turn, False otherwise.</p>
</div>


                </section>
                <section id="cross">
                            <input id="cross-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cross</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span>, </span><span class="param"><span class="n">p3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="cross-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cross"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cross-2780"><a href="#cross-2780"><span class="linenos">2780</span></a><span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
</span><span id="cross-2781"><a href="#cross-2781"><span class="linenos">2781</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cross product of vectors p1p2 and p1p3.</span>
</span><span id="cross-2782"><a href="#cross-2782"><span class="linenos">2782</span></a>
</span><span id="cross-2783"><a href="#cross-2783"><span class="linenos">2783</span></a><span class="sd">    Args:</span>
</span><span id="cross-2784"><a href="#cross-2784"><span class="linenos">2784</span></a><span class="sd">        p1 (Point): First point.</span>
</span><span id="cross-2785"><a href="#cross-2785"><span class="linenos">2785</span></a><span class="sd">        p2 (Point): Second point.</span>
</span><span id="cross-2786"><a href="#cross-2786"><span class="linenos">2786</span></a><span class="sd">        p3 (Point): Third point.</span>
</span><span id="cross-2787"><a href="#cross-2787"><span class="linenos">2787</span></a>
</span><span id="cross-2788"><a href="#cross-2788"><span class="linenos">2788</span></a><span class="sd">    Returns:</span>
</span><span id="cross-2789"><a href="#cross-2789"><span class="linenos">2789</span></a><span class="sd">        float: Cross product of the vectors.</span>
</span><span id="cross-2790"><a href="#cross-2790"><span class="linenos">2790</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cross-2791"><a href="#cross-2791"><span class="linenos">2791</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="cross-2792"><a href="#cross-2792"><span class="linenos">2792</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="cross-2793"><a href="#cross-2793"><span class="linenos">2793</span></a>    <span class="k">return</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span></pre></div>


            <div class="docstring"><p>Return the cross product of vectors p1p2 and p1p3.</p>

<p>Args:
    p1 (Point): First point.
    p2 (Point): Second point.
    p3 (Point): Third point.</p>

<p>Returns:
    float: Cross product of the vectors.</p>
</div>


                </section>
                <section id="tri_to_cart">
                            <input id="tri_to_cart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tri_to_cart</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="tri_to_cart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#tri_to_cart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="tri_to_cart-2796"><a href="#tri_to_cart-2796"><span class="linenos">2796</span></a><span class="k">def</span> <span class="nf">tri_to_cart</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="tri_to_cart-2797"><a href="#tri_to_cart-2797"><span class="linenos">2797</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="tri_to_cart-2798"><a href="#tri_to_cart-2798"><span class="linenos">2798</span></a><span class="sd">    Convert a list of points from triangular to cartesian coordinates.</span>
</span><span id="tri_to_cart-2799"><a href="#tri_to_cart-2799"><span class="linenos">2799</span></a>
</span><span id="tri_to_cart-2800"><a href="#tri_to_cart-2800"><span class="linenos">2800</span></a><span class="sd">    Args:</span>
</span><span id="tri_to_cart-2801"><a href="#tri_to_cart-2801"><span class="linenos">2801</span></a><span class="sd">        points (list[Point]): List of points in triangular coordinates.</span>
</span><span id="tri_to_cart-2802"><a href="#tri_to_cart-2802"><span class="linenos">2802</span></a>
</span><span id="tri_to_cart-2803"><a href="#tri_to_cart-2803"><span class="linenos">2803</span></a><span class="sd">    Returns:</span>
</span><span id="tri_to_cart-2804"><a href="#tri_to_cart-2804"><span class="linenos">2804</span></a><span class="sd">        np.ndarray: List of points in cartesian coordinates.</span>
</span><span id="tri_to_cart-2805"><a href="#tri_to_cart-2805"><span class="linenos">2805</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="tri_to_cart-2806"><a href="#tri_to_cart-2806"><span class="linenos">2806</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="tri_to_cart-2807"><a href="#tri_to_cart-2807"><span class="linenos">2807</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="tri_to_cart-2808"><a href="#tri_to_cart-2808"><span class="linenos">2808</span></a>    <span class="n">convert</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])</span>
</span><span id="tri_to_cart-2809"><a href="#tri_to_cart-2809"><span class="linenos">2809</span></a>
</span><span id="tri_to_cart-2810"><a href="#tri_to_cart-2810"><span class="linenos">2810</span></a>    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">@</span> <span class="n">convert</span>
</span></pre></div>


            <div class="docstring"><p>Convert a list of points from triangular to cartesian coordinates.</p>

<p>Args:
    points (list[Point]): List of points in triangular coordinates.</p>

<p>Returns:
    np.ndarray: List of points in cartesian coordinates.</p>
</div>


                </section>
                <section id="cart_to_tri">
                            <input id="cart_to_tri-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cart_to_tri</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="cart_to_tri-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cart_to_tri"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cart_to_tri-2813"><a href="#cart_to_tri-2813"><span class="linenos">2813</span></a><span class="k">def</span> <span class="nf">cart_to_tri</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="cart_to_tri-2814"><a href="#cart_to_tri-2814"><span class="linenos">2814</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="cart_to_tri-2815"><a href="#cart_to_tri-2815"><span class="linenos">2815</span></a><span class="sd">    Convert a list of points from cartesian to triangular coordinates.</span>
</span><span id="cart_to_tri-2816"><a href="#cart_to_tri-2816"><span class="linenos">2816</span></a>
</span><span id="cart_to_tri-2817"><a href="#cart_to_tri-2817"><span class="linenos">2817</span></a><span class="sd">    Args:</span>
</span><span id="cart_to_tri-2818"><a href="#cart_to_tri-2818"><span class="linenos">2818</span></a><span class="sd">        points (list[Point]): List of points in cartesian coordinates.</span>
</span><span id="cart_to_tri-2819"><a href="#cart_to_tri-2819"><span class="linenos">2819</span></a>
</span><span id="cart_to_tri-2820"><a href="#cart_to_tri-2820"><span class="linenos">2820</span></a><span class="sd">    Returns:</span>
</span><span id="cart_to_tri-2821"><a href="#cart_to_tri-2821"><span class="linenos">2821</span></a><span class="sd">        np.ndarray: List of points in triangular coordinates.</span>
</span><span id="cart_to_tri-2822"><a href="#cart_to_tri-2822"><span class="linenos">2822</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cart_to_tri-2823"><a href="#cart_to_tri-2823"><span class="linenos">2823</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="cart_to_tri-2824"><a href="#cart_to_tri-2824"><span class="linenos">2824</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="cart_to_tri-2825"><a href="#cart_to_tri-2825"><span class="linenos">2825</span></a>    <span class="n">convert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">]))</span>
</span><span id="cart_to_tri-2826"><a href="#cart_to_tri-2826"><span class="linenos">2826</span></a>
</span><span id="cart_to_tri-2827"><a href="#cart_to_tri-2827"><span class="linenos">2827</span></a>    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">@</span> <span class="n">convert</span>
</span></pre></div>


            <div class="docstring"><p>Convert a list of points from cartesian to triangular coordinates.</p>

<p>Args:
    points (list[Point]): List of points in cartesian coordinates.</p>

<p>Returns:
    np.ndarray: List of points in triangular coordinates.</p>
</div>


                </section>
                <section id="convex_hull">
                            <input id="convex_hull-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">convex_hull</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="convex_hull-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#convex_hull"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="convex_hull-2830"><a href="#convex_hull-2830"><span class="linenos">2830</span></a><span class="k">def</span> <span class="nf">convex_hull</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="convex_hull-2831"><a href="#convex_hull-2831"><span class="linenos">2831</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the convex hull of a set of 2D points.</span>
</span><span id="convex_hull-2832"><a href="#convex_hull-2832"><span class="linenos">2832</span></a>
</span><span id="convex_hull-2833"><a href="#convex_hull-2833"><span class="linenos">2833</span></a><span class="sd">    Args:</span>
</span><span id="convex_hull-2834"><a href="#convex_hull-2834"><span class="linenos">2834</span></a><span class="sd">        points (list[Point]): List of 2D points.</span>
</span><span id="convex_hull-2835"><a href="#convex_hull-2835"><span class="linenos">2835</span></a>
</span><span id="convex_hull-2836"><a href="#convex_hull-2836"><span class="linenos">2836</span></a><span class="sd">    Returns:</span>
</span><span id="convex_hull-2837"><a href="#convex_hull-2837"><span class="linenos">2837</span></a><span class="sd">        list[Point]: Convex hull of the points.</span>
</span><span id="convex_hull-2838"><a href="#convex_hull-2838"><span class="linenos">2838</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="convex_hull-2839"><a href="#convex_hull-2839"><span class="linenos">2839</span></a>    <span class="c1"># From http://en.wikibooks.org/wiki/Algorithm__implementation/Geometry/</span>
</span><span id="convex_hull-2840"><a href="#convex_hull-2840"><span class="linenos">2840</span></a>    <span class="c1"># Convex_hull/Monotone_chain</span>
</span><span id="convex_hull-2841"><a href="#convex_hull-2841"><span class="linenos">2841</span></a>    <span class="c1"># Sort points lexicographically (tuples are compared lexicographically).</span>
</span><span id="convex_hull-2842"><a href="#convex_hull-2842"><span class="linenos">2842</span></a>    <span class="c1"># Remove duplicates to detect the case we have just one unique point.</span>
</span><span id="convex_hull-2843"><a href="#convex_hull-2843"><span class="linenos">2843</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="convex_hull-2844"><a href="#convex_hull-2844"><span class="linenos">2844</span></a>    <span class="c1"># Boring case: no points or a single point, possibly repeated multiple times.</span>
</span><span id="convex_hull-2845"><a href="#convex_hull-2845"><span class="linenos">2845</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="convex_hull-2846"><a href="#convex_hull-2846"><span class="linenos">2846</span></a>        <span class="k">return</span> <span class="n">points</span>
</span><span id="convex_hull-2847"><a href="#convex_hull-2847"><span class="linenos">2847</span></a>
</span><span id="convex_hull-2848"><a href="#convex_hull-2848"><span class="linenos">2848</span></a>    <span class="c1"># 2D cross product of OA and OB vectors, i.e. z-component of their 3D cross</span>
</span><span id="convex_hull-2849"><a href="#convex_hull-2849"><span class="linenos">2849</span></a>    <span class="c1"># product.</span>
</span><span id="convex_hull-2850"><a href="#convex_hull-2850"><span class="linenos">2850</span></a>    <span class="c1"># Return a positive value, if OAB makes a counter-clockwise turn,</span>
</span><span id="convex_hull-2851"><a href="#convex_hull-2851"><span class="linenos">2851</span></a>    <span class="c1"># negative for clockwise turn, and zero if the points are collinear.</span>
</span><span id="convex_hull-2852"><a href="#convex_hull-2852"><span class="linenos">2852</span></a>    <span class="k">def</span> <span class="nf">cross_</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="convex_hull-2853"><a href="#convex_hull-2853"><span class="linenos">2853</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="convex_hull-2854"><a href="#convex_hull-2854"><span class="linenos">2854</span></a>
</span><span id="convex_hull-2855"><a href="#convex_hull-2855"><span class="linenos">2855</span></a>    <span class="c1"># Build lower hull</span>
</span><span id="convex_hull-2856"><a href="#convex_hull-2856"><span class="linenos">2856</span></a>    <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="convex_hull-2857"><a href="#convex_hull-2857"><span class="linenos">2857</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="convex_hull-2858"><a href="#convex_hull-2858"><span class="linenos">2858</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross_</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="convex_hull-2859"><a href="#convex_hull-2859"><span class="linenos">2859</span></a>            <span class="n">lower</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="convex_hull-2860"><a href="#convex_hull-2860"><span class="linenos">2860</span></a>        <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="convex_hull-2861"><a href="#convex_hull-2861"><span class="linenos">2861</span></a>    <span class="c1"># Build upper hull</span>
</span><span id="convex_hull-2862"><a href="#convex_hull-2862"><span class="linenos">2862</span></a>    <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="convex_hull-2863"><a href="#convex_hull-2863"><span class="linenos">2863</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="convex_hull-2864"><a href="#convex_hull-2864"><span class="linenos">2864</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross_</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="convex_hull-2865"><a href="#convex_hull-2865"><span class="linenos">2865</span></a>            <span class="n">upper</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="convex_hull-2866"><a href="#convex_hull-2866"><span class="linenos">2866</span></a>        <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="convex_hull-2867"><a href="#convex_hull-2867"><span class="linenos">2867</span></a>    <span class="c1"># Concatenation of the lower and upper hulls gives the convex hull.</span>
</span><span id="convex_hull-2868"><a href="#convex_hull-2868"><span class="linenos">2868</span></a>    <span class="c1"># Last point of each list is omitted because it is repeated at the beginning</span>
</span><span id="convex_hull-2869"><a href="#convex_hull-2869"><span class="linenos">2869</span></a>    <span class="c1"># of the other list.</span>
</span><span id="convex_hull-2870"><a href="#convex_hull-2870"><span class="linenos">2870</span></a>    <span class="k">return</span> <span class="n">lower</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">upper</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the convex hull of a set of 2D points.</p>

<p>Args:
    points (list[Point]): List of 2D points.</p>

<p>Returns:
    list[Point]: Convex hull of the points.</p>
</div>


                </section>
                <section id="connected_pairs">
                            <input id="connected_pairs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connected_pairs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">items</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="connected_pairs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#connected_pairs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="connected_pairs-2873"><a href="#connected_pairs-2873"><span class="linenos">2873</span></a><span class="k">def</span> <span class="nf">connected_pairs</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
</span><span id="connected_pairs-2874"><a href="#connected_pairs-2874"><span class="linenos">2874</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of connected pair tuples corresponding to the items.</span>
</span><span id="connected_pairs-2875"><a href="#connected_pairs-2875"><span class="linenos">2875</span></a><span class="sd">    [a, b, c] -&gt; [(a, b), (b, c)]</span>
</span><span id="connected_pairs-2876"><a href="#connected_pairs-2876"><span class="linenos">2876</span></a>
</span><span id="connected_pairs-2877"><a href="#connected_pairs-2877"><span class="linenos">2877</span></a><span class="sd">    Args:</span>
</span><span id="connected_pairs-2878"><a href="#connected_pairs-2878"><span class="linenos">2878</span></a><span class="sd">        items (list): List of items.</span>
</span><span id="connected_pairs-2879"><a href="#connected_pairs-2879"><span class="linenos">2879</span></a>
</span><span id="connected_pairs-2880"><a href="#connected_pairs-2880"><span class="linenos">2880</span></a><span class="sd">    Returns:</span>
</span><span id="connected_pairs-2881"><a href="#connected_pairs-2881"><span class="linenos">2881</span></a><span class="sd">        list[tuple]: List of connected pair tuples.</span>
</span><span id="connected_pairs-2882"><a href="#connected_pairs-2882"><span class="linenos">2882</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="connected_pairs-2883"><a href="#connected_pairs-2883"><span class="linenos">2883</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of connected pair tuples corresponding to the items.
[a, b, c] -> [(a, b), (b, c)]</p>

<p>Args:
    items (list): List of items.</p>

<p>Returns:
    list[tuple]: List of connected pair tuples.</p>
</div>


                </section>
                <section id="flat_points">
                            <input id="flat_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flat_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">connected_segments</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="flat_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#flat_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="flat_points-2886"><a href="#flat_points-2886"><span class="linenos">2886</span></a><span class="k">def</span> <span class="nf">flat_points</span><span class="p">(</span><span class="n">connected_segments</span><span class="p">):</span>
</span><span id="flat_points-2887"><a href="#flat_points-2887"><span class="linenos">2887</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of points from a list of connected pairs of points.</span>
</span><span id="flat_points-2888"><a href="#flat_points-2888"><span class="linenos">2888</span></a>
</span><span id="flat_points-2889"><a href="#flat_points-2889"><span class="linenos">2889</span></a><span class="sd">    Args:</span>
</span><span id="flat_points-2890"><a href="#flat_points-2890"><span class="linenos">2890</span></a><span class="sd">        connected_segments (list[tuple]): List of connected pairs of points.</span>
</span><span id="flat_points-2891"><a href="#flat_points-2891"><span class="linenos">2891</span></a>
</span><span id="flat_points-2892"><a href="#flat_points-2892"><span class="linenos">2892</span></a><span class="sd">    Returns:</span>
</span><span id="flat_points-2893"><a href="#flat_points-2893"><span class="linenos">2893</span></a><span class="sd">        list[Point]: List of points.</span>
</span><span id="flat_points-2894"><a href="#flat_points-2894"><span class="linenos">2894</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="flat_points-2895"><a href="#flat_points-2895"><span class="linenos">2895</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">connected_segments</span><span class="p">]</span>
</span><span id="flat_points-2896"><a href="#flat_points-2896"><span class="linenos">2896</span></a>    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connected_segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="flat_points-2897"><a href="#flat_points-2897"><span class="linenos">2897</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of points from a list of connected pairs of points.</p>

<p>Args:
    connected_segments (list[tuple]): List of connected pairs of points.</p>

<p>Returns:
    list[Point]: List of points.</p>
</div>


                </section>
                <section id="point_in_quad">
                            <input id="point_in_quad-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_in_quad</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">quad</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="point_in_quad-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_in_quad"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_in_quad-2900"><a href="#point_in_quad-2900"><span class="linenos">2900</span></a><span class="k">def</span> <span class="nf">point_in_quad</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">quad</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="point_in_quad-2901"><a href="#point_in_quad-2901"><span class="linenos">2901</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the point is inside the quad.</span>
</span><span id="point_in_quad-2902"><a href="#point_in_quad-2902"><span class="linenos">2902</span></a>
</span><span id="point_in_quad-2903"><a href="#point_in_quad-2903"><span class="linenos">2903</span></a><span class="sd">    Args:</span>
</span><span id="point_in_quad-2904"><a href="#point_in_quad-2904"><span class="linenos">2904</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_in_quad-2905"><a href="#point_in_quad-2905"><span class="linenos">2905</span></a><span class="sd">        quad (list[Point]): List of points representing the quad.</span>
</span><span id="point_in_quad-2906"><a href="#point_in_quad-2906"><span class="linenos">2906</span></a>
</span><span id="point_in_quad-2907"><a href="#point_in_quad-2907"><span class="linenos">2907</span></a><span class="sd">    Returns:</span>
</span><span id="point_in_quad-2908"><a href="#point_in_quad-2908"><span class="linenos">2908</span></a><span class="sd">        bool: True if the point is inside the quad, False otherwise.</span>
</span><span id="point_in_quad-2909"><a href="#point_in_quad-2909"><span class="linenos">2909</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_in_quad-2910"><a href="#point_in_quad-2910"><span class="linenos">2910</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="point_in_quad-2911"><a href="#point_in_quad-2911"><span class="linenos">2911</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="point_in_quad-2912"><a href="#point_in_quad-2912"><span class="linenos">2912</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="point_in_quad-2913"><a href="#point_in_quad-2913"><span class="linenos">2913</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="point_in_quad-2914"><a href="#point_in_quad-2914"><span class="linenos">2914</span></a>    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">quad</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="point_in_quad-2915"><a href="#point_in_quad-2915"><span class="linenos">2915</span></a>    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">]</span>
</span><span id="point_in_quad-2916"><a href="#point_in_quad-2916"><span class="linenos">2916</span></a>    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">]</span>
</span><span id="point_in_quad-2917"><a href="#point_in_quad-2917"><span class="linenos">2917</span></a>    <span class="n">min_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="point_in_quad-2918"><a href="#point_in_quad-2918"><span class="linenos">2918</span></a>    <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="point_in_quad-2919"><a href="#point_in_quad-2919"><span class="linenos">2919</span></a>    <span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="point_in_quad-2920"><a href="#point_in_quad-2920"><span class="linenos">2920</span></a>    <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="point_in_quad-2921"><a href="#point_in_quad-2921"><span class="linenos">2921</span></a>    <span class="k">return</span> <span class="n">min_x</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">max_x</span> <span class="ow">and</span> <span class="n">min_y</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">max_y</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the point is inside the quad.</p>

<p>Args:
    point (Point): Input point.
    quad (list[Point]): List of points representing the quad.</p>

<p>Returns:
    bool: True if the point is inside the quad, False otherwise.</p>
</div>


                </section>
                <section id="get_polygons">
                            <input id="get_polygons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_polygons</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">nested_points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">n_round_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="get_polygons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_polygons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_polygons-2924"><a href="#get_polygons-2924"><span class="linenos">2924</span></a><span class="k">def</span> <span class="nf">get_polygons</span><span class="p">(</span>
</span><span id="get_polygons-2925"><a href="#get_polygons-2925"><span class="linenos">2925</span></a>    <span class="n">nested_points</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">n_round_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="get_polygons-2926"><a href="#get_polygons-2926"><span class="linenos">2926</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="get_polygons-2927"><a href="#get_polygons-2927"><span class="linenos">2927</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert points to clean polygons. Points are vertices of polygons.</span>
</span><span id="get_polygons-2928"><a href="#get_polygons-2928"><span class="linenos">2928</span></a>
</span><span id="get_polygons-2929"><a href="#get_polygons-2929"><span class="linenos">2929</span></a><span class="sd">    Args:</span>
</span><span id="get_polygons-2930"><a href="#get_polygons-2930"><span class="linenos">2930</span></a><span class="sd">        nested_points (Sequence[Point]): List of nested points.</span>
</span><span id="get_polygons-2931"><a href="#get_polygons-2931"><span class="linenos">2931</span></a><span class="sd">        n_round_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="get_polygons-2932"><a href="#get_polygons-2932"><span class="linenos">2932</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="get_polygons-2933"><a href="#get_polygons-2933"><span class="linenos">2933</span></a>
</span><span id="get_polygons-2934"><a href="#get_polygons-2934"><span class="linenos">2934</span></a><span class="sd">    Returns:</span>
</span><span id="get_polygons-2935"><a href="#get_polygons-2935"><span class="linenos">2935</span></a><span class="sd">        list: List of clean polygons.</span>
</span><span id="get_polygons-2936"><a href="#get_polygons-2936"><span class="linenos">2936</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_polygons-2937"><a href="#get_polygons-2937"><span class="linenos">2937</span></a>    <span class="k">if</span> <span class="n">dist_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_polygons-2938"><a href="#get_polygons-2938"><span class="linenos">2938</span></a>        <span class="n">dist_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">]</span>
</span><span id="get_polygons-2939"><a href="#get_polygons-2939"><span class="linenos">2939</span></a>    <span class="kn">from</span> <span class="nn">..graph</span> <span class="kn">import</span> <span class="n">get_cycles</span>
</span><span id="get_polygons-2940"><a href="#get_polygons-2940"><span class="linenos">2940</span></a>
</span><span id="get_polygons-2941"><a href="#get_polygons-2941"><span class="linenos">2941</span></a>    <span class="n">nested_rounded_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2942"><a href="#get_polygons-2942"><span class="linenos">2942</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_points</span><span class="p">:</span>
</span><span id="get_polygons-2943"><a href="#get_polygons-2943"><span class="linenos">2943</span></a>        <span class="n">rounded_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2944"><a href="#get_polygons-2944"><span class="linenos">2944</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="get_polygons-2945"><a href="#get_polygons-2945"><span class="linenos">2945</span></a>            <span class="n">rounded_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">around</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">n_round_digits</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="get_polygons-2946"><a href="#get_polygons-2946"><span class="linenos">2946</span></a>            <span class="n">rounded_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rounded_point</span><span class="p">))</span>
</span><span id="get_polygons-2947"><a href="#get_polygons-2947"><span class="linenos">2947</span></a>        <span class="n">nested_rounded_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rounded_points</span><span class="p">)</span>
</span><span id="get_polygons-2948"><a href="#get_polygons-2948"><span class="linenos">2948</span></a>
</span><span id="get_polygons-2949"><a href="#get_polygons-2949"><span class="linenos">2949</span></a>    <span class="n">s_points</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="get_polygons-2950"><a href="#get_polygons-2950"><span class="linenos">2950</span></a>    <span class="n">d_id__point</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="get_polygons-2951"><a href="#get_polygons-2951"><span class="linenos">2951</span></a>    <span class="n">d_point__id</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="get_polygons-2952"><a href="#get_polygons-2952"><span class="linenos">2952</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_rounded_points</span><span class="p">:</span>
</span><span id="get_polygons-2953"><a href="#get_polygons-2953"><span class="linenos">2953</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="get_polygons-2954"><a href="#get_polygons-2954"><span class="linenos">2954</span></a>            <span class="n">s_points</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="get_polygons-2955"><a href="#get_polygons-2955"><span class="linenos">2955</span></a>
</span><span id="get_polygons-2956"><a href="#get_polygons-2956"><span class="linenos">2956</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fs_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s_points</span><span class="p">):</span>
</span><span id="get_polygons-2957"><a href="#get_polygons-2957"><span class="linenos">2957</span></a>        <span class="n">d_id__point</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fs_point</span>  <span class="c1"># we need a bidirectional dictionary</span>
</span><span id="get_polygons-2958"><a href="#get_polygons-2958"><span class="linenos">2958</span></a>        <span class="n">d_point__id</span><span class="p">[</span><span class="n">fs_point</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="get_polygons-2959"><a href="#get_polygons-2959"><span class="linenos">2959</span></a>
</span><span id="get_polygons-2960"><a href="#get_polygons-2960"><span class="linenos">2960</span></a>    <span class="n">nested_point_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2961"><a href="#get_polygons-2961"><span class="linenos">2961</span></a>    <span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">nested_rounded_points</span><span class="p">:</span>
</span><span id="get_polygons-2962"><a href="#get_polygons-2962"><span class="linenos">2962</span></a>        <span class="n">point_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2963"><a href="#get_polygons-2963"><span class="linenos">2963</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
</span><span id="get_polygons-2964"><a href="#get_polygons-2964"><span class="linenos">2964</span></a>            <span class="n">point_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_point__id</span><span class="p">[</span><span class="n">point</span><span class="p">])</span>
</span><span id="get_polygons-2965"><a href="#get_polygons-2965"><span class="linenos">2965</span></a>        <span class="n">nested_point_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point_ids</span><span class="p">)</span>
</span><span id="get_polygons-2966"><a href="#get_polygons-2966"><span class="linenos">2966</span></a>
</span><span id="get_polygons-2967"><a href="#get_polygons-2967"><span class="linenos">2967</span></a>    <span class="n">graph_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2968"><a href="#get_polygons-2968"><span class="linenos">2968</span></a>    <span class="k">for</span> <span class="n">point_ids</span> <span class="ow">in</span> <span class="n">nested_point_ids</span><span class="p">:</span>
</span><span id="get_polygons-2969"><a href="#get_polygons-2969"><span class="linenos">2969</span></a>        <span class="n">graph_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">connected_pairs</span><span class="p">(</span><span class="n">point_ids</span><span class="p">))</span>
</span><span id="get_polygons-2970"><a href="#get_polygons-2970"><span class="linenos">2970</span></a>    <span class="n">polygons</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_polygons-2971"><a href="#get_polygons-2971"><span class="linenos">2971</span></a>    <span class="n">graph_edges</span> <span class="o">=</span> <span class="n">sanitize_graph_edges</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="get_polygons-2972"><a href="#get_polygons-2972"><span class="linenos">2972</span></a>    <span class="n">cycles</span> <span class="o">=</span> <span class="n">get_cycles</span><span class="p">(</span><span class="n">graph_edges</span><span class="p">)</span>
</span><span id="get_polygons-2973"><a href="#get_polygons-2973"><span class="linenos">2973</span></a>    <span class="k">if</span> <span class="n">cycles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_polygons-2974"><a href="#get_polygons-2974"><span class="linenos">2974</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="get_polygons-2975"><a href="#get_polygons-2975"><span class="linenos">2975</span></a>    <span class="k">for</span> <span class="n">cycle_</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
</span><span id="get_polygons-2976"><a href="#get_polygons-2976"><span class="linenos">2976</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="n">cycle_</span>
</span><span id="get_polygons-2977"><a href="#get_polygons-2977"><span class="linenos">2977</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_id__point</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
</span><span id="get_polygons-2978"><a href="#get_polygons-2978"><span class="linenos">2978</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">fix_degen_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dist_tol</span><span class="o">=</span><span class="n">dist_tol</span><span class="p">)</span>
</span><span id="get_polygons-2979"><a href="#get_polygons-2979"><span class="linenos">2979</span></a>        <span class="n">polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="get_polygons-2980"><a href="#get_polygons-2980"><span class="linenos">2980</span></a>
</span><span id="get_polygons-2981"><a href="#get_polygons-2981"><span class="linenos">2981</span></a>    <span class="k">return</span> <span class="n">polygons</span>
</span></pre></div>


            <div class="docstring"><p>Convert points to clean polygons. Points are vertices of polygons.</p>

<p>Args:
    nested_points (Sequence[Point]): List of nested points.
    n_round_digits (int, optional): Number of decimal places to round to. Defaults to 2.
    dist_tol (float, optional): Distance tolerance. Defaults to None.</p>

<p>Returns:
    list: List of clean polygons.</p>
</div>


                </section>
                <section id="offset_point_from_start">
                            <input id="offset_point_from_start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_point_from_start</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span>, </span><span class="param"><span class="n">offset</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="offset_point_from_start-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#offset_point_from_start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="offset_point_from_start-2984"><a href="#offset_point_from_start-2984"><span class="linenos">2984</span></a><span class="k">def</span> <span class="nf">offset_point_from_start</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
</span><span id="offset_point_from_start-2985"><a href="#offset_point_from_start-2985"><span class="linenos">2985</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;p1, p2: points on a line</span>
</span><span id="offset_point_from_start-2986"><a href="#offset_point_from_start-2986"><span class="linenos">2986</span></a><span class="sd">    offset: distance from p1</span>
</span><span id="offset_point_from_start-2987"><a href="#offset_point_from_start-2987"><span class="linenos">2987</span></a><span class="sd">    return the point on the line at the given offset</span>
</span><span id="offset_point_from_start-2988"><a href="#offset_point_from_start-2988"><span class="linenos">2988</span></a>
</span><span id="offset_point_from_start-2989"><a href="#offset_point_from_start-2989"><span class="linenos">2989</span></a><span class="sd">    Args:</span>
</span><span id="offset_point_from_start-2990"><a href="#offset_point_from_start-2990"><span class="linenos">2990</span></a><span class="sd">        p1 (Point): First point on the line.</span>
</span><span id="offset_point_from_start-2991"><a href="#offset_point_from_start-2991"><span class="linenos">2991</span></a><span class="sd">        p2 (Point): Second point on the line.</span>
</span><span id="offset_point_from_start-2992"><a href="#offset_point_from_start-2992"><span class="linenos">2992</span></a><span class="sd">        offset (float): Distance from p1.</span>
</span><span id="offset_point_from_start-2993"><a href="#offset_point_from_start-2993"><span class="linenos">2993</span></a>
</span><span id="offset_point_from_start-2994"><a href="#offset_point_from_start-2994"><span class="linenos">2994</span></a><span class="sd">    Returns:</span>
</span><span id="offset_point_from_start-2995"><a href="#offset_point_from_start-2995"><span class="linenos">2995</span></a><span class="sd">        Point: Point on the line at the given offset.</span>
</span><span id="offset_point_from_start-2996"><a href="#offset_point_from_start-2996"><span class="linenos">2996</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="offset_point_from_start-2997"><a href="#offset_point_from_start-2997"><span class="linenos">2997</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="offset_point_from_start-2998"><a href="#offset_point_from_start-2998"><span class="linenos">2998</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
</span><span id="offset_point_from_start-2999"><a href="#offset_point_from_start-2999"><span class="linenos">2999</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="offset_point_from_start-3000"><a href="#offset_point_from_start-3000"><span class="linenos">3000</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="offset_point_from_start-3001"><a href="#offset_point_from_start-3001"><span class="linenos">3001</span></a>    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="offset_point_from_start-3002"><a href="#offset_point_from_start-3002"><span class="linenos">3002</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">p1</span>
</span><span id="offset_point_from_start-3003"><a href="#offset_point_from_start-3003"><span class="linenos">3003</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="offset_point_from_start-3004"><a href="#offset_point_from_start-3004"><span class="linenos">3004</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
</span><span id="offset_point_from_start-3005"><a href="#offset_point_from_start-3005"><span class="linenos">3005</span></a>
</span><span id="offset_point_from_start-3006"><a href="#offset_point_from_start-3006"><span class="linenos">3006</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>p1, p2: points on a line
offset: distance from p1
return the point on the line at the given offset</p>

<p>Args:
    p1 (Point): First point on the line.
    p2 (Point): Second point on the line.
    offset (float): Distance from p1.</p>

<p>Returns:
    Point: Point on the line at the given offset.</p>
</div>


                </section>
                <section id="angle_between_two_lines">
                            <input id="angle_between_two_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_between_two_lines</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line1</span>, </span><span class="param"><span class="n">line2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="angle_between_two_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#angle_between_two_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="angle_between_two_lines-3009"><a href="#angle_between_two_lines-3009"><span class="linenos">3009</span></a><span class="k">def</span> <span class="nf">angle_between_two_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
</span><span id="angle_between_two_lines-3010"><a href="#angle_between_two_lines-3010"><span class="linenos">3010</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the angle between two lines in radians.</span>
</span><span id="angle_between_two_lines-3011"><a href="#angle_between_two_lines-3011"><span class="linenos">3011</span></a>
</span><span id="angle_between_two_lines-3012"><a href="#angle_between_two_lines-3012"><span class="linenos">3012</span></a><span class="sd">    Args:</span>
</span><span id="angle_between_two_lines-3013"><a href="#angle_between_two_lines-3013"><span class="linenos">3013</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="angle_between_two_lines-3014"><a href="#angle_between_two_lines-3014"><span class="linenos">3014</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="angle_between_two_lines-3015"><a href="#angle_between_two_lines-3015"><span class="linenos">3015</span></a>
</span><span id="angle_between_two_lines-3016"><a href="#angle_between_two_lines-3016"><span class="linenos">3016</span></a><span class="sd">    Returns:</span>
</span><span id="angle_between_two_lines-3017"><a href="#angle_between_two_lines-3017"><span class="linenos">3017</span></a><span class="sd">        float: Angle between the two lines in radians.</span>
</span><span id="angle_between_two_lines-3018"><a href="#angle_between_two_lines-3018"><span class="linenos">3018</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="angle_between_two_lines-3019"><a href="#angle_between_two_lines-3019"><span class="linenos">3019</span></a>    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line1</span><span class="p">)</span>
</span><span id="angle_between_two_lines-3020"><a href="#angle_between_two_lines-3020"><span class="linenos">3020</span></a>    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="o">*</span><span class="n">line2</span><span class="p">)</span>
</span><span id="angle_between_two_lines-3021"><a href="#angle_between_two_lines-3021"><span class="linenos">3021</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">alpha1</span> <span class="o">-</span> <span class="n">alpha2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the angle between two lines in radians.</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.</p>

<p>Returns:
    float: Angle between the two lines in radians.</p>
</div>


                </section>
                <section id="circle_tangent_to2lines">
                            <input id="circle_tangent_to2lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_tangent_to2lines</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">line1</span>, </span><span class="param"><span class="n">line2</span>, </span><span class="param"><span class="n">intersection_</span>, </span><span class="param"><span class="n">radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_tangent_to2lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_tangent_to2lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_tangent_to2lines-3044"><a href="#circle_tangent_to2lines-3044"><span class="linenos">3044</span></a><span class="k">def</span> <span class="nf">circle_tangent_to2lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="circle_tangent_to2lines-3045"><a href="#circle_tangent_to2lines-3045"><span class="linenos">3045</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given two lines, their intersection point and a radius,</span>
</span><span id="circle_tangent_to2lines-3046"><a href="#circle_tangent_to2lines-3046"><span class="linenos">3046</span></a><span class="sd">    return the center of the circle tangent to both lines and</span>
</span><span id="circle_tangent_to2lines-3047"><a href="#circle_tangent_to2lines-3047"><span class="linenos">3047</span></a><span class="sd">    with the given radius.</span>
</span><span id="circle_tangent_to2lines-3048"><a href="#circle_tangent_to2lines-3048"><span class="linenos">3048</span></a>
</span><span id="circle_tangent_to2lines-3049"><a href="#circle_tangent_to2lines-3049"><span class="linenos">3049</span></a><span class="sd">    Args:</span>
</span><span id="circle_tangent_to2lines-3050"><a href="#circle_tangent_to2lines-3050"><span class="linenos">3050</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="circle_tangent_to2lines-3051"><a href="#circle_tangent_to2lines-3051"><span class="linenos">3051</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="circle_tangent_to2lines-3052"><a href="#circle_tangent_to2lines-3052"><span class="linenos">3052</span></a><span class="sd">        intersection_ (Point): Intersection point of the lines.</span>
</span><span id="circle_tangent_to2lines-3053"><a href="#circle_tangent_to2lines-3053"><span class="linenos">3053</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="circle_tangent_to2lines-3054"><a href="#circle_tangent_to2lines-3054"><span class="linenos">3054</span></a>
</span><span id="circle_tangent_to2lines-3055"><a href="#circle_tangent_to2lines-3055"><span class="linenos">3055</span></a><span class="sd">    Returns:</span>
</span><span id="circle_tangent_to2lines-3056"><a href="#circle_tangent_to2lines-3056"><span class="linenos">3056</span></a><span class="sd">        tuple: Center of the circle, start and end points of the tangent lines.</span>
</span><span id="circle_tangent_to2lines-3057"><a href="#circle_tangent_to2lines-3057"><span class="linenos">3057</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_tangent_to2lines-3058"><a href="#circle_tangent_to2lines-3058"><span class="linenos">3058</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle_between_two_lines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
</span><span id="circle_tangent_to2lines-3059"><a href="#circle_tangent_to2lines-3059"><span class="linenos">3059</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="circle_tangent_to2lines-3060"><a href="#circle_tangent_to2lines-3060"><span class="linenos">3060</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">line1</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="circle_tangent_to2lines-3061"><a href="#circle_tangent_to2lines-3061"><span class="linenos">3061</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">rotate_point</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">intersection_</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="circle_tangent_to2lines-3062"><a href="#circle_tangent_to2lines-3062"><span class="linenos">3062</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">intersection_</span><span class="p">,</span> <span class="n">line2</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="circle_tangent_to2lines-3063"><a href="#circle_tangent_to2lines-3063"><span class="linenos">3063</span></a>
</span><span id="circle_tangent_to2lines-3064"><a href="#circle_tangent_to2lines-3064"><span class="linenos">3064</span></a>    <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span>
</span></pre></div>


            <div class="docstring"><p>Given two lines, their intersection point and a radius,
return the center of the circle tangent to both lines and
with the given radius.</p>

<p>Args:
    line1 (Line): First line.
    line2 (Line): Second line.
    intersection_ (Point): Intersection point of the lines.
    radius (float): Radius of the circle.</p>

<p>Returns:
    tuple: Center of the circle, start and end points of the tangent lines.</p>
</div>


                </section>
                <section id="triangle_area">
                            <input id="triangle_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">triangle_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">b</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">c</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="triangle_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#triangle_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="triangle_area-3067"><a href="#triangle_area-3067"><span class="linenos">3067</span></a><span class="k">def</span> <span class="nf">triangle_area</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="triangle_area-3068"><a href="#triangle_area-3068"><span class="linenos">3068</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="triangle_area-3069"><a href="#triangle_area-3069"><span class="linenos">3069</span></a><span class="sd">    Given side lengths a, b and c, return the area of the triangle.</span>
</span><span id="triangle_area-3070"><a href="#triangle_area-3070"><span class="linenos">3070</span></a>
</span><span id="triangle_area-3071"><a href="#triangle_area-3071"><span class="linenos">3071</span></a><span class="sd">    Args:</span>
</span><span id="triangle_area-3072"><a href="#triangle_area-3072"><span class="linenos">3072</span></a><span class="sd">        a (float): Length of side a.</span>
</span><span id="triangle_area-3073"><a href="#triangle_area-3073"><span class="linenos">3073</span></a><span class="sd">        b (float): Length of side b.</span>
</span><span id="triangle_area-3074"><a href="#triangle_area-3074"><span class="linenos">3074</span></a><span class="sd">        c (float): Length of side c.</span>
</span><span id="triangle_area-3075"><a href="#triangle_area-3075"><span class="linenos">3075</span></a>
</span><span id="triangle_area-3076"><a href="#triangle_area-3076"><span class="linenos">3076</span></a><span class="sd">    Returns:</span>
</span><span id="triangle_area-3077"><a href="#triangle_area-3077"><span class="linenos">3077</span></a><span class="sd">        float: Area of the triangle.</span>
</span><span id="triangle_area-3078"><a href="#triangle_area-3078"><span class="linenos">3078</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="triangle_area-3079"><a href="#triangle_area-3079"><span class="linenos">3079</span></a>    <span class="n">a_b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span><span id="triangle_area-3080"><a href="#triangle_area-3080"><span class="linenos">3080</span></a>    <span class="k">return</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="p">(</span><span class="n">a_b</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="p">(</span><span class="n">a_b</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">4</span>
</span></pre></div>


            <div class="docstring"><p>Given side lengths a, b and c, return the area of the triangle.</p>

<p>Args:
    a (float): Length of side a.
    b (float): Length of side b.
    c (float): Length of side c.</p>

<p>Returns:
    float: Area of the triangle.</p>
</div>


                </section>
                <section id="round_point">
                            <input id="round_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">round_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="round_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#round_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="round_point-3083"><a href="#round_point-3083"><span class="linenos">3083</span></a><span class="k">def</span> <span class="nf">round_point</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="round_point-3084"><a href="#round_point-3084"><span class="linenos">3084</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="round_point-3085"><a href="#round_point-3085"><span class="linenos">3085</span></a><span class="sd">    Round a point (x, y) to a given precision.</span>
</span><span id="round_point-3086"><a href="#round_point-3086"><span class="linenos">3086</span></a>
</span><span id="round_point-3087"><a href="#round_point-3087"><span class="linenos">3087</span></a><span class="sd">    Args:</span>
</span><span id="round_point-3088"><a href="#round_point-3088"><span class="linenos">3088</span></a><span class="sd">        point (list[float]): Input point.</span>
</span><span id="round_point-3089"><a href="#round_point-3089"><span class="linenos">3089</span></a><span class="sd">        n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="round_point-3090"><a href="#round_point-3090"><span class="linenos">3090</span></a>
</span><span id="round_point-3091"><a href="#round_point-3091"><span class="linenos">3091</span></a><span class="sd">    Returns:</span>
</span><span id="round_point-3092"><a href="#round_point-3092"><span class="linenos">3092</span></a><span class="sd">        list[float]: Rounded point.</span>
</span><span id="round_point-3093"><a href="#round_point-3093"><span class="linenos">3093</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="round_point-3094"><a href="#round_point-3094"><span class="linenos">3094</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="round_point-3095"><a href="#round_point-3095"><span class="linenos">3095</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="round_point-3096"><a href="#round_point-3096"><span class="linenos">3096</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="round_point-3097"><a href="#round_point-3097"><span class="linenos">3097</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Round a point (x, y) to a given precision.</p>

<p>Args:
    point (list[float]): Input point.
    n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</p>

<p>Returns:
    list[float]: Rounded point.</p>
</div>


                </section>
                <section id="round_segment">
                            <input id="round_segment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">round_segment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">segment</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>, </span><span class="param"><span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="round_segment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#round_segment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="round_segment-3100"><a href="#round_segment-3100"><span class="linenos">3100</span></a><span class="k">def</span> <span class="nf">round_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="round_segment-3101"><a href="#round_segment-3101"><span class="linenos">3101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Round a segment to a given precision.</span>
</span><span id="round_segment-3102"><a href="#round_segment-3102"><span class="linenos">3102</span></a>
</span><span id="round_segment-3103"><a href="#round_segment-3103"><span class="linenos">3103</span></a><span class="sd">    Args:</span>
</span><span id="round_segment-3104"><a href="#round_segment-3104"><span class="linenos">3104</span></a><span class="sd">        segment (Sequence[Point]): Input segment.</span>
</span><span id="round_segment-3105"><a href="#round_segment-3105"><span class="linenos">3105</span></a><span class="sd">        n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</span>
</span><span id="round_segment-3106"><a href="#round_segment-3106"><span class="linenos">3106</span></a>
</span><span id="round_segment-3107"><a href="#round_segment-3107"><span class="linenos">3107</span></a><span class="sd">    Returns:</span>
</span><span id="round_segment-3108"><a href="#round_segment-3108"><span class="linenos">3108</span></a><span class="sd">        Sequence[Point]: Rounded segment.</span>
</span><span id="round_segment-3109"><a href="#round_segment-3109"><span class="linenos">3109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="round_segment-3110"><a href="#round_segment-3110"><span class="linenos">3110</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="round_segment-3111"><a href="#round_segment-3111"><span class="linenos">3111</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">round_point</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_digits</span><span class="p">)</span>
</span><span id="round_segment-3112"><a href="#round_segment-3112"><span class="linenos">3112</span></a>
</span><span id="round_segment-3113"><a href="#round_segment-3113"><span class="linenos">3113</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Round a segment to a given precision.</p>

<p>Args:
    segment (Sequence[Point]): Input segment.
    n_digits (int, optional): Number of decimal places to round to. Defaults to 2.</p>

<p>Returns:
    Sequence[Point]: Rounded segment.</p>
</div>


                </section>
                <section id="get_polygon_grid_point">
                            <input id="get_polygon_grid_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_polygon_grid_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">line1</span>, </span><span class="param"><span class="n">line2</span>, </span><span class="param"><span class="n">circumradius</span><span class="o">=</span><span class="mi">100</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_polygon_grid_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_polygon_grid_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_polygon_grid_point-3116"><a href="#get_polygon_grid_point-3116"><span class="linenos">3116</span></a><span class="k">def</span> <span class="nf">get_polygon_grid_point</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">circumradius</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="get_polygon_grid_point-3117"><a href="#get_polygon_grid_point-3117"><span class="linenos">3117</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;See chapter ??? for explanation of this function.</span>
</span><span id="get_polygon_grid_point-3118"><a href="#get_polygon_grid_point-3118"><span class="linenos">3118</span></a>
</span><span id="get_polygon_grid_point-3119"><a href="#get_polygon_grid_point-3119"><span class="linenos">3119</span></a><span class="sd">    Args:</span>
</span><span id="get_polygon_grid_point-3120"><a href="#get_polygon_grid_point-3120"><span class="linenos">3120</span></a><span class="sd">        n (int): Number of sides.</span>
</span><span id="get_polygon_grid_point-3121"><a href="#get_polygon_grid_point-3121"><span class="linenos">3121</span></a><span class="sd">        line1 (Line): First line.</span>
</span><span id="get_polygon_grid_point-3122"><a href="#get_polygon_grid_point-3122"><span class="linenos">3122</span></a><span class="sd">        line2 (Line): Second line.</span>
</span><span id="get_polygon_grid_point-3123"><a href="#get_polygon_grid_point-3123"><span class="linenos">3123</span></a><span class="sd">        circumradius (float, optional): Circumradius of the polygon. Defaults to 100.</span>
</span><span id="get_polygon_grid_point-3124"><a href="#get_polygon_grid_point-3124"><span class="linenos">3124</span></a>
</span><span id="get_polygon_grid_point-3125"><a href="#get_polygon_grid_point-3125"><span class="linenos">3125</span></a><span class="sd">    Returns:</span>
</span><span id="get_polygon_grid_point-3126"><a href="#get_polygon_grid_point-3126"><span class="linenos">3126</span></a><span class="sd">        Point: Grid point of the polygon.</span>
</span><span id="get_polygon_grid_point-3127"><a href="#get_polygon_grid_point-3127"><span class="linenos">3127</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_polygon_grid_point-3128"><a href="#get_polygon_grid_point-3128"><span class="linenos">3128</span></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">circumradius</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># side length</span>
</span><span id="get_polygon_grid_point-3129"><a href="#get_polygon_grid_point-3129"><span class="linenos">3129</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">reg_poly_points</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="get_polygon_grid_point-3130"><a href="#get_polygon_grid_point-3130"><span class="linenos">3130</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="get_polygon_grid_point-3131"><a href="#get_polygon_grid_point-3131"><span class="linenos">3131</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="get_polygon_grid_point-3132"><a href="#get_polygon_grid_point-3132"><span class="linenos">3132</span></a>    <span class="n">p3</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="get_polygon_grid_point-3133"><a href="#get_polygon_grid_point-3133"><span class="linenos">3133</span></a>    <span class="n">p4</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="get_polygon_grid_point-3134"><a href="#get_polygon_grid_point-3134"><span class="linenos">3134</span></a>
</span><span id="get_polygon_grid_point-3135"><a href="#get_polygon_grid_point-3135"><span class="linenos">3135</span></a>    <span class="k">return</span> <span class="n">intersection</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>See chapter ??? for explanation of this function.</p>

<p>Args:
    n (int): Number of sides.
    line1 (Line): First line.
    line2 (Line): Second line.
    circumradius (float, optional): Circumradius of the polygon. Defaults to 100.</p>

<p>Returns:
    Point: Grid point of the polygon.</p>
</div>


                </section>
                <section id="congruent_polygons">
                            <input id="congruent_polygons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">congruent_polygons</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">polygon1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">polygon2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">area_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">side_length_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">angle_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="congruent_polygons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#congruent_polygons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="congruent_polygons-3138"><a href="#congruent_polygons-3138"><span class="linenos">3138</span></a><span class="k">def</span> <span class="nf">congruent_polygons</span><span class="p">(</span>
</span><span id="congruent_polygons-3139"><a href="#congruent_polygons-3139"><span class="linenos">3139</span></a>    <span class="n">polygon1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="congruent_polygons-3140"><a href="#congruent_polygons-3140"><span class="linenos">3140</span></a>    <span class="n">polygon2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">],</span>
</span><span id="congruent_polygons-3141"><a href="#congruent_polygons-3141"><span class="linenos">3141</span></a>    <span class="n">dist_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="congruent_polygons-3142"><a href="#congruent_polygons-3142"><span class="linenos">3142</span></a>    <span class="n">area_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="congruent_polygons-3143"><a href="#congruent_polygons-3143"><span class="linenos">3143</span></a>    <span class="n">side_length_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="congruent_polygons-3144"><a href="#congruent_polygons-3144"><span class="linenos">3144</span></a>    <span class="n">angle_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="congruent_polygons-3145"><a href="#congruent_polygons-3145"><span class="linenos">3145</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="congruent_polygons-3146"><a href="#congruent_polygons-3146"><span class="linenos">3146</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="congruent_polygons-3147"><a href="#congruent_polygons-3147"><span class="linenos">3147</span></a><span class="sd">    Return True if two polygons are congruent.</span>
</span><span id="congruent_polygons-3148"><a href="#congruent_polygons-3148"><span class="linenos">3148</span></a><span class="sd">    They can be translated, rotated and/or reflected.</span>
</span><span id="congruent_polygons-3149"><a href="#congruent_polygons-3149"><span class="linenos">3149</span></a>
</span><span id="congruent_polygons-3150"><a href="#congruent_polygons-3150"><span class="linenos">3150</span></a><span class="sd">    Args:</span>
</span><span id="congruent_polygons-3151"><a href="#congruent_polygons-3151"><span class="linenos">3151</span></a><span class="sd">        polygon1 (list[Point]): First polygon.</span>
</span><span id="congruent_polygons-3152"><a href="#congruent_polygons-3152"><span class="linenos">3152</span></a><span class="sd">        polygon2 (list[Point]): Second polygon.</span>
</span><span id="congruent_polygons-3153"><a href="#congruent_polygons-3153"><span class="linenos">3153</span></a><span class="sd">        dist_tol (float, optional): Distance tolerance. Defaults to None.</span>
</span><span id="congruent_polygons-3154"><a href="#congruent_polygons-3154"><span class="linenos">3154</span></a><span class="sd">        area_tol (float, optional): Area tolerance. Defaults to None.</span>
</span><span id="congruent_polygons-3155"><a href="#congruent_polygons-3155"><span class="linenos">3155</span></a><span class="sd">        side_length_tol (float, optional): Side length tolerance. Defaults to None.</span>
</span><span id="congruent_polygons-3156"><a href="#congruent_polygons-3156"><span class="linenos">3156</span></a><span class="sd">        angle_tol (float, optional): Angle tolerance. Defaults to None.</span>
</span><span id="congruent_polygons-3157"><a href="#congruent_polygons-3157"><span class="linenos">3157</span></a>
</span><span id="congruent_polygons-3158"><a href="#congruent_polygons-3158"><span class="linenos">3158</span></a><span class="sd">    Returns:</span>
</span><span id="congruent_polygons-3159"><a href="#congruent_polygons-3159"><span class="linenos">3159</span></a><span class="sd">        bool: True if the polygons are congruent, False otherwise.</span>
</span><span id="congruent_polygons-3160"><a href="#congruent_polygons-3160"><span class="linenos">3160</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="congruent_polygons-3161"><a href="#congruent_polygons-3161"><span class="linenos">3161</span></a>    <span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_tol</span><span class="p">,</span> <span class="n">angle_tol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="congruent_polygons-3162"><a href="#congruent_polygons-3162"><span class="linenos">3162</span></a>        <span class="p">[</span><span class="s2">&quot;dist_tol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;angle_rtol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">dist_tol</span><span class="p">,</span> <span class="n">area_tol</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">]</span>
</span><span id="congruent_polygons-3163"><a href="#congruent_polygons-3163"><span class="linenos">3163</span></a>    <span class="p">)</span>
</span><span id="congruent_polygons-3164"><a href="#congruent_polygons-3164"><span class="linenos">3164</span></a>    <span class="k">if</span> <span class="n">side_length_tol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="congruent_polygons-3165"><a href="#congruent_polygons-3165"><span class="linenos">3165</span></a>        <span class="n">side_length_tol</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span>
</span><span id="congruent_polygons-3166"><a href="#congruent_polygons-3166"><span class="linenos">3166</span></a>    <span class="n">dist_tol2</span> <span class="o">=</span> <span class="n">dist_tol</span> <span class="o">*</span> <span class="n">dist_tol</span>
</span><span id="congruent_polygons-3167"><a href="#congruent_polygons-3167"><span class="linenos">3167</span></a>    <span class="n">poly1</span> <span class="o">=</span> <span class="n">polygon1</span>
</span><span id="congruent_polygons-3168"><a href="#congruent_polygons-3168"><span class="linenos">3168</span></a>    <span class="n">poly2</span> <span class="o">=</span> <span class="n">polygon2</span>
</span><span id="congruent_polygons-3169"><a href="#congruent_polygons-3169"><span class="linenos">3169</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="congruent_polygons-3170"><a href="#congruent_polygons-3170"><span class="linenos">3170</span></a>        <span class="n">poly1</span> <span class="o">=</span> <span class="n">poly1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="congruent_polygons-3171"><a href="#congruent_polygons-3171"><span class="linenos">3171</span></a>    <span class="k">if</span> <span class="n">close_points2</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dist2</span><span class="o">=</span><span class="n">dist_tol2</span><span class="p">):</span>
</span><span id="congruent_polygons-3172"><a href="#congruent_polygons-3172"><span class="linenos">3172</span></a>        <span class="n">poly2</span> <span class="o">=</span> <span class="n">poly2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="congruent_polygons-3173"><a href="#congruent_polygons-3173"><span class="linenos">3173</span></a>    <span class="n">len_poly1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="congruent_polygons-3174"><a href="#congruent_polygons-3174"><span class="linenos">3174</span></a>    <span class="n">len_poly2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="congruent_polygons-3175"><a href="#congruent_polygons-3175"><span class="linenos">3175</span></a>    <span class="k">if</span> <span class="n">len_poly1</span> <span class="o">!=</span> <span class="n">len_poly2</span><span class="p">:</span>
</span><span id="congruent_polygons-3176"><a href="#congruent_polygons-3176"><span class="linenos">3176</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="congruent_polygons-3177"><a href="#congruent_polygons-3177"><span class="linenos">3177</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="congruent_polygons-3178"><a href="#congruent_polygons-3178"><span class="linenos">3178</span></a>        <span class="nb">abs</span><span class="p">(</span><span class="n">polygon_area</span><span class="p">(</span><span class="n">poly1</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">polygon_area</span><span class="p">(</span><span class="n">poly2</span><span class="p">)),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">area_tol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">area_tol</span>
</span><span id="congruent_polygons-3179"><a href="#congruent_polygons-3179"><span class="linenos">3179</span></a>    <span class="p">):</span>
</span><span id="congruent_polygons-3180"><a href="#congruent_polygons-3180"><span class="linenos">3180</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="congruent_polygons-3181"><a href="#congruent_polygons-3181"><span class="linenos">3181</span></a>
</span><span id="congruent_polygons-3182"><a href="#congruent_polygons-3182"><span class="linenos">3182</span></a>    <span class="n">side_lengths1</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance</span><span class="p">(</span><span class="n">poly1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_poly1</span><span class="p">)]</span>
</span><span id="congruent_polygons-3183"><a href="#congruent_polygons-3183"><span class="linenos">3183</span></a>    <span class="n">side_lengths2</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance</span><span class="p">(</span><span class="n">poly2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_poly2</span><span class="p">)]</span>
</span><span id="congruent_polygons-3184"><a href="#congruent_polygons-3184"><span class="linenos">3184</span></a>    <span class="n">check1</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">side_lengths1</span><span class="p">,</span> <span class="n">side_lengths2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">side_length_tol</span><span class="p">)</span>
</span><span id="congruent_polygons-3185"><a href="#congruent_polygons-3185"><span class="linenos">3185</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">check1</span><span class="p">:</span>
</span><span id="congruent_polygons-3186"><a href="#congruent_polygons-3186"><span class="linenos">3186</span></a>        <span class="n">check_reverse</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span>
</span><span id="congruent_polygons-3187"><a href="#congruent_polygons-3187"><span class="linenos">3187</span></a>            <span class="n">side_lengths1</span><span class="p">,</span> <span class="n">side_lengths2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="n">side_length_tol</span>
</span><span id="congruent_polygons-3188"><a href="#congruent_polygons-3188"><span class="linenos">3188</span></a>        <span class="p">)</span>
</span><span id="congruent_polygons-3189"><a href="#congruent_polygons-3189"><span class="linenos">3189</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">check1</span> <span class="ow">or</span> <span class="n">check_reverse</span><span class="p">):</span>
</span><span id="congruent_polygons-3190"><a href="#congruent_polygons-3190"><span class="linenos">3190</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="congruent_polygons-3191"><a href="#congruent_polygons-3191"><span class="linenos">3191</span></a>
</span><span id="congruent_polygons-3192"><a href="#congruent_polygons-3192"><span class="linenos">3192</span></a>    <span class="n">angles1</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span>
</span><span id="congruent_polygons-3193"><a href="#congruent_polygons-3193"><span class="linenos">3193</span></a>    <span class="n">angles2</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="congruent_polygons-3194"><a href="#congruent_polygons-3194"><span class="linenos">3194</span></a>    <span class="n">check1</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">angles1</span><span class="p">,</span> <span class="n">angles2</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">)</span>
</span><span id="congruent_polygons-3195"><a href="#congruent_polygons-3195"><span class="linenos">3195</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">check1</span><span class="p">:</span>
</span><span id="congruent_polygons-3196"><a href="#congruent_polygons-3196"><span class="linenos">3196</span></a>        <span class="n">poly2</span> <span class="o">=</span> <span class="n">poly2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="congruent_polygons-3197"><a href="#congruent_polygons-3197"><span class="linenos">3197</span></a>        <span class="n">angles2</span> <span class="o">=</span> <span class="n">polygon_internal_angles</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</span><span id="congruent_polygons-3198"><a href="#congruent_polygons-3198"><span class="linenos">3198</span></a>        <span class="n">check_reverse</span> <span class="o">=</span> <span class="n">equal_cycles</span><span class="p">(</span><span class="n">angles1</span><span class="p">,</span> <span class="n">angles2</span><span class="p">,</span> <span class="n">angle_tol</span><span class="p">)</span>
</span><span id="congruent_polygons-3199"><a href="#congruent_polygons-3199"><span class="linenos">3199</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">check1</span> <span class="ow">or</span> <span class="n">check_reverse</span><span class="p">):</span>
</span><span id="congruent_polygons-3200"><a href="#congruent_polygons-3200"><span class="linenos">3200</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="congruent_polygons-3201"><a href="#congruent_polygons-3201"><span class="linenos">3201</span></a>
</span><span id="congruent_polygons-3202"><a href="#congruent_polygons-3202"><span class="linenos">3202</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Return True if two polygons are congruent.
They can be translated, rotated and/or reflected.</p>

<p>Args:
    polygon1 (list[Point]): First polygon.
    polygon2 (list[Point]): Second polygon.
    dist_tol (float, optional): Distance tolerance. Defaults to None.
    area_tol (float, optional): Area tolerance. Defaults to None.
    side_length_tol (float, optional): Side length tolerance. Defaults to None.
    angle_tol (float, optional): Angle tolerance. Defaults to None.</p>

<p>Returns:
    bool: True if the polygons are congruent, False otherwise.</p>
</div>


                </section>
                <section id="positive_angle">
                            <input id="positive_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">positive_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle</span>, </span><span class="param"><span class="n">radians</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">tol</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="positive_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#positive_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="positive_angle-3205"><a href="#positive_angle-3205"><span class="linenos">3205</span></a><span class="k">def</span> <span class="nf">positive_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">radians</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="positive_angle-3206"><a href="#positive_angle-3206"><span class="linenos">3206</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the positive angle in radians or degrees.</span>
</span><span id="positive_angle-3207"><a href="#positive_angle-3207"><span class="linenos">3207</span></a>
</span><span id="positive_angle-3208"><a href="#positive_angle-3208"><span class="linenos">3208</span></a><span class="sd">    Args:</span>
</span><span id="positive_angle-3209"><a href="#positive_angle-3209"><span class="linenos">3209</span></a><span class="sd">        angle (float): Input angle.</span>
</span><span id="positive_angle-3210"><a href="#positive_angle-3210"><span class="linenos">3210</span></a><span class="sd">        radians (bool, optional): Whether the angle is in radians. Defaults to True.</span>
</span><span id="positive_angle-3211"><a href="#positive_angle-3211"><span class="linenos">3211</span></a><span class="sd">        tol (float, optional): Relative tolerance. Defaults to None.</span>
</span><span id="positive_angle-3212"><a href="#positive_angle-3212"><span class="linenos">3212</span></a><span class="sd">        atol (float, optional): Absolute tolerance. Defaults to None.</span>
</span><span id="positive_angle-3213"><a href="#positive_angle-3213"><span class="linenos">3213</span></a>
</span><span id="positive_angle-3214"><a href="#positive_angle-3214"><span class="linenos">3214</span></a><span class="sd">    Returns:</span>
</span><span id="positive_angle-3215"><a href="#positive_angle-3215"><span class="linenos">3215</span></a><span class="sd">        float: Positive angle.</span>
</span><span id="positive_angle-3216"><a href="#positive_angle-3216"><span class="linenos">3216</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="positive_angle-3217"><a href="#positive_angle-3217"><span class="linenos">3217</span></a>    <span class="n">tol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">([</span><span class="s2">&quot;tol&quot;</span><span class="p">,</span> <span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">tol</span><span class="p">,</span> <span class="n">atol</span><span class="p">])</span>
</span><span id="positive_angle-3218"><a href="#positive_angle-3218"><span class="linenos">3218</span></a>    <span class="k">if</span> <span class="n">radians</span><span class="p">:</span>
</span><span id="positive_angle-3219"><a href="#positive_angle-3219"><span class="linenos">3219</span></a>        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="positive_angle-3220"><a href="#positive_angle-3220"><span class="linenos">3220</span></a>            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="positive_angle-3221"><a href="#positive_angle-3221"><span class="linenos">3221</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="positive_angle-3222"><a href="#positive_angle-3222"><span class="linenos">3222</span></a>        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="positive_angle-3223"><a href="#positive_angle-3223"><span class="linenos">3223</span></a>            <span class="n">angle</span> <span class="o">+=</span> <span class="mi">360</span>
</span><span id="positive_angle-3224"><a href="#positive_angle-3224"><span class="linenos">3224</span></a>
</span><span id="positive_angle-3225"><a href="#positive_angle-3225"><span class="linenos">3225</span></a>    <span class="k">return</span> <span class="n">angle</span>
</span></pre></div>


            <div class="docstring"><p>Return the positive angle in radians or degrees.</p>

<p>Args:
    angle (float): Input angle.
    radians (bool, optional): Whether the angle is in radians. Defaults to True.
    tol (float, optional): Relative tolerance. Defaults to None.
    atol (float, optional): Absolute tolerance. Defaults to None.</p>

<p>Returns:
    float: Positive angle.</p>
</div>


                </section>
                <section id="polygon_internal_angles">
                            <input id="polygon_internal_angles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_internal_angles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="polygon_internal_angles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_internal_angles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_internal_angles-3228"><a href="#polygon_internal_angles-3228"><span class="linenos">3228</span></a><span class="k">def</span> <span class="nf">polygon_internal_angles</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="polygon_internal_angles-3229"><a href="#polygon_internal_angles-3229"><span class="linenos">3229</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the internal angles of a polygon.</span>
</span><span id="polygon_internal_angles-3230"><a href="#polygon_internal_angles-3230"><span class="linenos">3230</span></a>
</span><span id="polygon_internal_angles-3231"><a href="#polygon_internal_angles-3231"><span class="linenos">3231</span></a><span class="sd">    Args:</span>
</span><span id="polygon_internal_angles-3232"><a href="#polygon_internal_angles-3232"><span class="linenos">3232</span></a><span class="sd">        polygon (list[Point]): List of points representing the polygon.</span>
</span><span id="polygon_internal_angles-3233"><a href="#polygon_internal_angles-3233"><span class="linenos">3233</span></a>
</span><span id="polygon_internal_angles-3234"><a href="#polygon_internal_angles-3234"><span class="linenos">3234</span></a><span class="sd">    Returns:</span>
</span><span id="polygon_internal_angles-3235"><a href="#polygon_internal_angles-3235"><span class="linenos">3235</span></a><span class="sd">        list[float]: List of internal angles of the polygon.</span>
</span><span id="polygon_internal_angles-3236"><a href="#polygon_internal_angles-3236"><span class="linenos">3236</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_internal_angles-3237"><a href="#polygon_internal_angles-3237"><span class="linenos">3237</span></a>    <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="polygon_internal_angles-3238"><a href="#polygon_internal_angles-3238"><span class="linenos">3238</span></a>    <span class="n">len_polygon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="polygon_internal_angles-3239"><a href="#polygon_internal_angles-3239"><span class="linenos">3239</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polygon</span><span class="p">):</span>
</span><span id="polygon_internal_angles-3240"><a href="#polygon_internal_angles-3240"><span class="linenos">3240</span></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="polygon_internal_angles-3241"><a href="#polygon_internal_angles-3241"><span class="linenos">3241</span></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">pnt</span>
</span><span id="polygon_internal_angles-3242"><a href="#polygon_internal_angles-3242"><span class="linenos">3242</span></a>        <span class="n">p3</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">len_polygon</span><span class="p">]</span>
</span><span id="polygon_internal_angles-3243"><a href="#polygon_internal_angles-3243"><span class="linenos">3243</span></a>        <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">))</span>
</span><span id="polygon_internal_angles-3244"><a href="#polygon_internal_angles-3244"><span class="linenos">3244</span></a>
</span><span id="polygon_internal_angles-3245"><a href="#polygon_internal_angles-3245"><span class="linenos">3245</span></a>    <span class="k">return</span> <span class="n">angles</span>
</span></pre></div>


            <div class="docstring"><p>Return the internal angles of a polygon.</p>

<p>Args:
    polygon (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    list[float]: List of internal angles of the polygon.</p>
</div>


                </section>
                <section id="bisector_line">
                            <input id="bisector_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bisector_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">c</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="bisector_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bisector_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bisector_line-3248"><a href="#bisector_line-3248"><span class="linenos">3248</span></a><span class="k">def</span> <span class="nf">bisector_line</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="bisector_line-3249"><a href="#bisector_line-3249"><span class="linenos">3249</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bisector_line-3250"><a href="#bisector_line-3250"><span class="linenos">3250</span></a><span class="sd">    Given three points that form two lines [a, b] and [b, c]</span>
</span><span id="bisector_line-3251"><a href="#bisector_line-3251"><span class="linenos">3251</span></a><span class="sd">    return the bisector line between them.</span>
</span><span id="bisector_line-3252"><a href="#bisector_line-3252"><span class="linenos">3252</span></a>
</span><span id="bisector_line-3253"><a href="#bisector_line-3253"><span class="linenos">3253</span></a><span class="sd">    Args:</span>
</span><span id="bisector_line-3254"><a href="#bisector_line-3254"><span class="linenos">3254</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="bisector_line-3255"><a href="#bisector_line-3255"><span class="linenos">3255</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="bisector_line-3256"><a href="#bisector_line-3256"><span class="linenos">3256</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="bisector_line-3257"><a href="#bisector_line-3257"><span class="linenos">3257</span></a>
</span><span id="bisector_line-3258"><a href="#bisector_line-3258"><span class="linenos">3258</span></a><span class="sd">    Returns:</span>
</span><span id="bisector_line-3259"><a href="#bisector_line-3259"><span class="linenos">3259</span></a><span class="sd">        Line: Bisector line.</span>
</span><span id="bisector_line-3260"><a href="#bisector_line-3260"><span class="linenos">3260</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bisector_line-3261"><a href="#bisector_line-3261"><span class="linenos">3261</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">mid_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="bisector_line-3262"><a href="#bisector_line-3262"><span class="linenos">3262</span></a>
</span><span id="bisector_line-3263"><a href="#bisector_line-3263"><span class="linenos">3263</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Given three points that form two lines [a, b] and [b, c]
return the bisector line between them.</p>

<p>Args:
    a (Point): First point.
    b (Point): Second point.
    c (Point): Third point.</p>

<p>Returns:
    Line: Bisector line.</p>
</div>


                </section>
                <section id="between">
                            <input id="between-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">between</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="between-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#between"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="between-3266"><a href="#between-3266"><span class="linenos">3266</span></a><span class="k">def</span> <span class="nf">between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="between-3267"><a href="#between-3267"><span class="linenos">3267</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if c is between a and b.</span>
</span><span id="between-3268"><a href="#between-3268"><span class="linenos">3268</span></a>
</span><span id="between-3269"><a href="#between-3269"><span class="linenos">3269</span></a><span class="sd">    Args:</span>
</span><span id="between-3270"><a href="#between-3270"><span class="linenos">3270</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="between-3271"><a href="#between-3271"><span class="linenos">3271</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="between-3272"><a href="#between-3272"><span class="linenos">3272</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="between-3273"><a href="#between-3273"><span class="linenos">3273</span></a>
</span><span id="between-3274"><a href="#between-3274"><span class="linenos">3274</span></a><span class="sd">    Returns:</span>
</span><span id="between-3275"><a href="#between-3275"><span class="linenos">3275</span></a><span class="sd">        bool: True if c is between a and b, False otherwise.</span>
</span><span id="between-3276"><a href="#between-3276"><span class="linenos">3276</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="between-3277"><a href="#between-3277"><span class="linenos">3277</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="between-3278"><a href="#between-3278"><span class="linenos">3278</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="between-3279"><a href="#between-3279"><span class="linenos">3279</span></a>    <span class="k">elif</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="between-3280"><a href="#between-3280"><span class="linenos">3280</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="between-3281"><a href="#between-3281"><span class="linenos">3281</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="between-3282"><a href="#between-3282"><span class="linenos">3282</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="between-3283"><a href="#between-3283"><span class="linenos">3283</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return True if c is between a and b.</p>

<p>Args:
    a (Point): First point.
    b (Point): Second point.
    c (Point): Third point.</p>

<p>Returns:
    bool: True if c is between a and b, False otherwise.</p>
</div>


                </section>
                <section id="collinear">
                            <input id="collinear-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collinear</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="collinear-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#collinear"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="collinear-3286"><a href="#collinear-3286"><span class="linenos">3286</span></a><span class="k">def</span> <span class="nf">collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">area_rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">area_atol</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="collinear-3287"><a href="#collinear-3287"><span class="linenos">3287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if a, b, and c are collinear.</span>
</span><span id="collinear-3288"><a href="#collinear-3288"><span class="linenos">3288</span></a>
</span><span id="collinear-3289"><a href="#collinear-3289"><span class="linenos">3289</span></a><span class="sd">    Args:</span>
</span><span id="collinear-3290"><a href="#collinear-3290"><span class="linenos">3290</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="collinear-3291"><a href="#collinear-3291"><span class="linenos">3291</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="collinear-3292"><a href="#collinear-3292"><span class="linenos">3292</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="collinear-3293"><a href="#collinear-3293"><span class="linenos">3293</span></a><span class="sd">        area_rtol (float, optional): Relative tolerance for area. Defaults to None.</span>
</span><span id="collinear-3294"><a href="#collinear-3294"><span class="linenos">3294</span></a><span class="sd">        area_atol (float, optional): Absolute tolerance for area. Defaults to None.</span>
</span><span id="collinear-3295"><a href="#collinear-3295"><span class="linenos">3295</span></a>
</span><span id="collinear-3296"><a href="#collinear-3296"><span class="linenos">3296</span></a><span class="sd">    Returns:</span>
</span><span id="collinear-3297"><a href="#collinear-3297"><span class="linenos">3297</span></a><span class="sd">        bool: True if the points are collinear, False otherwise.</span>
</span><span id="collinear-3298"><a href="#collinear-3298"><span class="linenos">3298</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="collinear-3299"><a href="#collinear-3299"><span class="linenos">3299</span></a>    <span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span> <span class="o">=</span> <span class="n">get_defaults</span><span class="p">(</span>
</span><span id="collinear-3300"><a href="#collinear-3300"><span class="linenos">3300</span></a>        <span class="p">[</span><span class="s2">&quot;area_rtol&quot;</span><span class="p">,</span> <span class="s2">&quot;area_atol&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">area_atol</span><span class="p">]</span>
</span><span id="collinear-3301"><a href="#collinear-3301"><span class="linenos">3301</span></a>    <span class="p">)</span>
</span><span id="collinear-3302"><a href="#collinear-3302"><span class="linenos">3302</span></a>    <span class="k">return</span> <span class="n">isclose</span><span class="p">(</span><span class="n">area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">area_rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">area_atol</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if a, b, and c are collinear.</p>

<p>Args:
    a (Point): First point.
    b (Point): Second point.
    c (Point): Third point.
    area_rtol (float, optional): Relative tolerance for area. Defaults to None.
    area_atol (float, optional): Absolute tolerance for area. Defaults to None.</p>

<p>Returns:
    bool: True if the points are collinear, False otherwise.</p>
</div>


                </section>
                <section id="polar_to_cartesian">
                            <input id="polar_to_cartesian-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polar_to_cartesian</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">r</span>, </span><span class="param"><span class="n">theta</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="polar_to_cartesian-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polar_to_cartesian"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polar_to_cartesian-3305"><a href="#polar_to_cartesian-3305"><span class="linenos">3305</span></a><span class="k">def</span> <span class="nf">polar_to_cartesian</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
</span><span id="polar_to_cartesian-3306"><a href="#polar_to_cartesian-3306"><span class="linenos">3306</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert polar coordinates to cartesian coordinates.</span>
</span><span id="polar_to_cartesian-3307"><a href="#polar_to_cartesian-3307"><span class="linenos">3307</span></a>
</span><span id="polar_to_cartesian-3308"><a href="#polar_to_cartesian-3308"><span class="linenos">3308</span></a><span class="sd">    Args:</span>
</span><span id="polar_to_cartesian-3309"><a href="#polar_to_cartesian-3309"><span class="linenos">3309</span></a><span class="sd">        r (float): Radius.</span>
</span><span id="polar_to_cartesian-3310"><a href="#polar_to_cartesian-3310"><span class="linenos">3310</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="polar_to_cartesian-3311"><a href="#polar_to_cartesian-3311"><span class="linenos">3311</span></a>
</span><span id="polar_to_cartesian-3312"><a href="#polar_to_cartesian-3312"><span class="linenos">3312</span></a><span class="sd">    Returns:</span>
</span><span id="polar_to_cartesian-3313"><a href="#polar_to_cartesian-3313"><span class="linenos">3313</span></a><span class="sd">        Point: Cartesian coordinates.</span>
</span><span id="polar_to_cartesian-3314"><a href="#polar_to_cartesian-3314"><span class="linenos">3314</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polar_to_cartesian-3315"><a href="#polar_to_cartesian-3315"><span class="linenos">3315</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Convert polar coordinates to cartesian coordinates.</p>

<p>Args:
    r (float): Radius.
    theta (float): Angle in radians.</p>

<p>Returns:
    Point: Cartesian coordinates.</p>
</div>


                </section>
                <section id="cartesian_to_polar">
                            <input id="cartesian_to_polar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cartesian_to_polar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="cartesian_to_polar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cartesian_to_polar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cartesian_to_polar-3318"><a href="#cartesian_to_polar-3318"><span class="linenos">3318</span></a><span class="k">def</span> <span class="nf">cartesian_to_polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="cartesian_to_polar-3319"><a href="#cartesian_to_polar-3319"><span class="linenos">3319</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert cartesian coordinates to polar coordinates.</span>
</span><span id="cartesian_to_polar-3320"><a href="#cartesian_to_polar-3320"><span class="linenos">3320</span></a>
</span><span id="cartesian_to_polar-3321"><a href="#cartesian_to_polar-3321"><span class="linenos">3321</span></a><span class="sd">    Args:</span>
</span><span id="cartesian_to_polar-3322"><a href="#cartesian_to_polar-3322"><span class="linenos">3322</span></a><span class="sd">        x (float): x-coordinate.</span>
</span><span id="cartesian_to_polar-3323"><a href="#cartesian_to_polar-3323"><span class="linenos">3323</span></a><span class="sd">        y (float): y-coordinate.</span>
</span><span id="cartesian_to_polar-3324"><a href="#cartesian_to_polar-3324"><span class="linenos">3324</span></a>
</span><span id="cartesian_to_polar-3325"><a href="#cartesian_to_polar-3325"><span class="linenos">3325</span></a><span class="sd">    Returns:</span>
</span><span id="cartesian_to_polar-3326"><a href="#cartesian_to_polar-3326"><span class="linenos">3326</span></a><span class="sd">        tuple: Polar coordinates (r, theta).</span>
</span><span id="cartesian_to_polar-3327"><a href="#cartesian_to_polar-3327"><span class="linenos">3327</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cartesian_to_polar-3328"><a href="#cartesian_to_polar-3328"><span class="linenos">3328</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">hypot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="cartesian_to_polar-3329"><a href="#cartesian_to_polar-3329"><span class="linenos">3329</span></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">positive_angle</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span><span id="cartesian_to_polar-3330"><a href="#cartesian_to_polar-3330"><span class="linenos">3330</span></a>    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">theta</span>
</span></pre></div>


            <div class="docstring"><p>Convert cartesian coordinates to polar coordinates.</p>

<p>Args:
    x (float): x-coordinate.
    y (float): y-coordinate.</p>

<p>Returns:
    tuple: Polar coordinates (r, theta).</p>
</div>


                </section>
                <section id="fillet">
                            <input id="fillet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fillet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">c</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">radius</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="fillet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fillet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fillet-3333"><a href="#fillet-3333"><span class="linenos">3333</span></a><span class="k">def</span> <span class="nf">fillet</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Line</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">Point</span><span class="p">]:</span>
</span><span id="fillet-3334"><a href="#fillet-3334"><span class="linenos">3334</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="fillet-3335"><a href="#fillet-3335"><span class="linenos">3335</span></a><span class="sd">    Given three points that form two lines [a, b] and [b, c]</span>
</span><span id="fillet-3336"><a href="#fillet-3336"><span class="linenos">3336</span></a><span class="sd">    return the clipped lines [a, d], [e, c], center point</span>
</span><span id="fillet-3337"><a href="#fillet-3337"><span class="linenos">3337</span></a><span class="sd">    of the radius circle (tangent to both lines), and the arc</span>
</span><span id="fillet-3338"><a href="#fillet-3338"><span class="linenos">3338</span></a><span class="sd">    angle of the formed fillet.</span>
</span><span id="fillet-3339"><a href="#fillet-3339"><span class="linenos">3339</span></a>
</span><span id="fillet-3340"><a href="#fillet-3340"><span class="linenos">3340</span></a><span class="sd">    Args:</span>
</span><span id="fillet-3341"><a href="#fillet-3341"><span class="linenos">3341</span></a><span class="sd">        a (Point): First point.</span>
</span><span id="fillet-3342"><a href="#fillet-3342"><span class="linenos">3342</span></a><span class="sd">        b (Point): Second point.</span>
</span><span id="fillet-3343"><a href="#fillet-3343"><span class="linenos">3343</span></a><span class="sd">        c (Point): Third point.</span>
</span><span id="fillet-3344"><a href="#fillet-3344"><span class="linenos">3344</span></a><span class="sd">        radius (float): Radius of the fillet.</span>
</span><span id="fillet-3345"><a href="#fillet-3345"><span class="linenos">3345</span></a>
</span><span id="fillet-3346"><a href="#fillet-3346"><span class="linenos">3346</span></a><span class="sd">    Returns:</span>
</span><span id="fillet-3347"><a href="#fillet-3347"><span class="linenos">3347</span></a><span class="sd">        tuple: Clipped lines [a, d], [e, c], center point of the radius circle, and the arc angle.</span>
</span><span id="fillet-3348"><a href="#fillet-3348"><span class="linenos">3348</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="fillet-3349"><a href="#fillet-3349"><span class="linenos">3349</span></a>    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="fillet-3350"><a href="#fillet-3350"><span class="linenos">3350</span></a>    <span class="n">sin_alpha2</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha2</span><span class="p">)</span>
</span><span id="fillet-3351"><a href="#fillet-3351"><span class="linenos">3351</span></a>    <span class="n">cos_alpha2</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha2</span><span class="p">)</span>
</span><span id="fillet-3352"><a href="#fillet-3352"><span class="linenos">3352</span></a>    <span class="n">clip_length</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">cos_alpha2</span> <span class="o">/</span> <span class="n">sin_alpha2</span>
</span><span id="fillet-3353"><a href="#fillet-3353"><span class="linenos">3353</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">clip_length</span><span class="p">)</span>
</span><span id="fillet-3354"><a href="#fillet-3354"><span class="linenos">3354</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">clip_length</span><span class="p">)</span>
</span><span id="fillet-3355"><a href="#fillet-3355"><span class="linenos">3355</span></a>    <span class="n">mp</span> <span class="o">=</span> <span class="n">mid_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>  <span class="c1"># [b, mp] is the bisector line</span>
</span><span id="fillet-3356"><a href="#fillet-3356"><span class="linenos">3356</span></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">offset_point_from_start</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">sin_alpha2</span><span class="p">)</span>
</span><span id="fillet-3357"><a href="#fillet-3357"><span class="linenos">3357</span></a>    <span class="n">arc_angle</span> <span class="o">=</span> <span class="n">angle_between_lines2</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="fillet-3358"><a href="#fillet-3358"><span class="linenos">3358</span></a>
</span><span id="fillet-3359"><a href="#fillet-3359"><span class="linenos">3359</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">c</span><span class="p">],</span> <span class="n">center</span><span class="p">,</span> <span class="n">arc_angle</span>
</span></pre></div>


            <div class="docstring"><p>Given three points that form two lines [a, b] and [b, c]
return the clipped lines [a, d], [e, c], center point
of the radius circle (tangent to both lines), and the arc
angle of the formed fillet.</p>

<p>Args:
    a (Point): First point.
    b (Point): Second point.
    c (Point): Third point.
    radius (float): Radius of the fillet.</p>

<p>Returns:
    tuple: Clipped lines [a, d], [e, c], center point of the radius circle, and the arc angle.</p>
</div>


                </section>
                <section id="line_by_point_angle_length">
                            <input id="line_by_point_angle_length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">line_by_point_angle_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span>, </span><span class="param"><span class="n">angle</span>, </span><span class="param"><span class="n">length_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="line_by_point_angle_length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#line_by_point_angle_length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="line_by_point_angle_length-3362"><a href="#line_by_point_angle_length-3362"><span class="linenos">3362</span></a><span class="k">def</span> <span class="nf">line_by_point_angle_length</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">length_</span><span class="p">):</span>
</span><span id="line_by_point_angle_length-3363"><a href="#line_by_point_angle_length-3363"><span class="linenos">3363</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line_by_point_angle_length-3364"><a href="#line_by_point_angle_length-3364"><span class="linenos">3364</span></a><span class="sd">    Given a point, an angle, and a length, return the line</span>
</span><span id="line_by_point_angle_length-3365"><a href="#line_by_point_angle_length-3365"><span class="linenos">3365</span></a><span class="sd">    that starts at the point and has the given angle and length.</span>
</span><span id="line_by_point_angle_length-3366"><a href="#line_by_point_angle_length-3366"><span class="linenos">3366</span></a>
</span><span id="line_by_point_angle_length-3367"><a href="#line_by_point_angle_length-3367"><span class="linenos">3367</span></a><span class="sd">    Args:</span>
</span><span id="line_by_point_angle_length-3368"><a href="#line_by_point_angle_length-3368"><span class="linenos">3368</span></a><span class="sd">        point (Point): Start point of the line.</span>
</span><span id="line_by_point_angle_length-3369"><a href="#line_by_point_angle_length-3369"><span class="linenos">3369</span></a><span class="sd">        angle (float): Angle of the line in radians.</span>
</span><span id="line_by_point_angle_length-3370"><a href="#line_by_point_angle_length-3370"><span class="linenos">3370</span></a><span class="sd">        length_ (float): Length of the line.</span>
</span><span id="line_by_point_angle_length-3371"><a href="#line_by_point_angle_length-3371"><span class="linenos">3371</span></a>
</span><span id="line_by_point_angle_length-3372"><a href="#line_by_point_angle_length-3372"><span class="linenos">3372</span></a><span class="sd">    Returns:</span>
</span><span id="line_by_point_angle_length-3373"><a href="#line_by_point_angle_length-3373"><span class="linenos">3373</span></a><span class="sd">        Line: Line with the given angle and length.</span>
</span><span id="line_by_point_angle_length-3374"><a href="#line_by_point_angle_length-3374"><span class="linenos">3374</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line_by_point_angle_length-3375"><a href="#line_by_point_angle_length-3375"><span class="linenos">3375</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="line_by_point_angle_length-3376"><a href="#line_by_point_angle_length-3376"><span class="linenos">3376</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="line_by_point_angle_length-3377"><a href="#line_by_point_angle_length-3377"><span class="linenos">3377</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="line_by_point_angle_length-3378"><a href="#line_by_point_angle_length-3378"><span class="linenos">3378</span></a>
</span><span id="line_by_point_angle_length-3379"><a href="#line_by_point_angle_length-3379"><span class="linenos">3379</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Given a point, an angle, and a length, return the line
that starts at the point and has the given angle and length.</p>

<p>Args:
    point (Point): Start point of the line.
    angle (float): Angle of the line in radians.
    length_ (float): Length of the line.</p>

<p>Returns:
    Line: Line with the given angle and length.</p>
</div>


                </section>
                <section id="surface_normal">
                            <input id="surface_normal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">surface_normal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">p1</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">p2</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">p3</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="surface_normal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#surface_normal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="surface_normal-3382"><a href="#surface_normal-3382"><span class="linenos">3382</span></a><span class="k">def</span> <span class="nf">surface_normal</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">p3</span><span class="p">:</span> <span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecType</span><span class="p">:</span>
</span><span id="surface_normal-3383"><a href="#surface_normal-3383"><span class="linenos">3383</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="surface_normal-3384"><a href="#surface_normal-3384"><span class="linenos">3384</span></a><span class="sd">    Calculates the surface normal of a triangle given its vertices.</span>
</span><span id="surface_normal-3385"><a href="#surface_normal-3385"><span class="linenos">3385</span></a>
</span><span id="surface_normal-3386"><a href="#surface_normal-3386"><span class="linenos">3386</span></a><span class="sd">    Args:</span>
</span><span id="surface_normal-3387"><a href="#surface_normal-3387"><span class="linenos">3387</span></a><span class="sd">        p1 (Point): First vertex.</span>
</span><span id="surface_normal-3388"><a href="#surface_normal-3388"><span class="linenos">3388</span></a><span class="sd">        p2 (Point): Second vertex.</span>
</span><span id="surface_normal-3389"><a href="#surface_normal-3389"><span class="linenos">3389</span></a><span class="sd">        p3 (Point): Third vertex.</span>
</span><span id="surface_normal-3390"><a href="#surface_normal-3390"><span class="linenos">3390</span></a>
</span><span id="surface_normal-3391"><a href="#surface_normal-3391"><span class="linenos">3391</span></a><span class="sd">    Returns:</span>
</span><span id="surface_normal-3392"><a href="#surface_normal-3392"><span class="linenos">3392</span></a><span class="sd">        VecType: Surface normal vector.</span>
</span><span id="surface_normal-3393"><a href="#surface_normal-3393"><span class="linenos">3393</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="surface_normal-3394"><a href="#surface_normal-3394"><span class="linenos">3394</span></a>    <span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span><span id="surface_normal-3395"><a href="#surface_normal-3395"><span class="linenos">3395</span></a>    <span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</span><span id="surface_normal-3396"><a href="#surface_normal-3396"><span class="linenos">3396</span></a>    <span class="n">v3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
</span><span id="surface_normal-3397"><a href="#surface_normal-3397"><span class="linenos">3397</span></a>    <span class="c1"># Create two vectors from the vertices</span>
</span><span id="surface_normal-3398"><a href="#surface_normal-3398"><span class="linenos">3398</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">-</span> <span class="n">v1</span>
</span><span id="surface_normal-3399"><a href="#surface_normal-3399"><span class="linenos">3399</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="n">v1</span>
</span><span id="surface_normal-3400"><a href="#surface_normal-3400"><span class="linenos">3400</span></a>
</span><span id="surface_normal-3401"><a href="#surface_normal-3401"><span class="linenos">3401</span></a>    <span class="c1"># Calculate the cross product of the two vectors</span>
</span><span id="surface_normal-3402"><a href="#surface_normal-3402"><span class="linenos">3402</span></a>    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="surface_normal-3403"><a href="#surface_normal-3403"><span class="linenos">3403</span></a>
</span><span id="surface_normal-3404"><a href="#surface_normal-3404"><span class="linenos">3404</span></a>    <span class="c1"># Normalize the vector to get a unit normal vector</span>
</span><span id="surface_normal-3405"><a href="#surface_normal-3405"><span class="linenos">3405</span></a>    <span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
</span><span id="surface_normal-3406"><a href="#surface_normal-3406"><span class="linenos">3406</span></a>
</span><span id="surface_normal-3407"><a href="#surface_normal-3407"><span class="linenos">3407</span></a>    <span class="k">return</span> <span class="n">normal</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the surface normal of a triangle given its vertices.</p>

<p>Args:
    p1 (Point): First vertex.
    p2 (Point): Second vertex.
    p3 (Point): Third vertex.</p>

<p>Returns:
    VecType: Surface normal vector.</p>
</div>


                </section>
                <section id="normal">
                            <input id="normal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point1</span>, </span><span class="param"><span class="n">point2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="normal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#normal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="normal-3410"><a href="#normal-3410"><span class="linenos">3410</span></a><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">):</span>
</span><span id="normal-3411"><a href="#normal-3411"><span class="linenos">3411</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the normal vector of a line.</span>
</span><span id="normal-3412"><a href="#normal-3412"><span class="linenos">3412</span></a>
</span><span id="normal-3413"><a href="#normal-3413"><span class="linenos">3413</span></a><span class="sd">    Args:</span>
</span><span id="normal-3414"><a href="#normal-3414"><span class="linenos">3414</span></a><span class="sd">        point1 (Point): First point of the line.</span>
</span><span id="normal-3415"><a href="#normal-3415"><span class="linenos">3415</span></a><span class="sd">        point2 (Point): Second point of the line.</span>
</span><span id="normal-3416"><a href="#normal-3416"><span class="linenos">3416</span></a>
</span><span id="normal-3417"><a href="#normal-3417"><span class="linenos">3417</span></a><span class="sd">    Returns:</span>
</span><span id="normal-3418"><a href="#normal-3418"><span class="linenos">3418</span></a><span class="sd">        VecType: Normal vector of the line.</span>
</span><span id="normal-3419"><a href="#normal-3419"><span class="linenos">3419</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="normal-3420"><a href="#normal-3420"><span class="linenos">3420</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point1</span>
</span><span id="normal-3421"><a href="#normal-3421"><span class="linenos">3421</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">point2</span>
</span><span id="normal-3422"><a href="#normal-3422"><span class="linenos">3422</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="normal-3423"><a href="#normal-3423"><span class="linenos">3423</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="normal-3424"><a href="#normal-3424"><span class="linenos">3424</span></a>    <span class="n">norm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="normal-3425"><a href="#normal-3425"><span class="linenos">3425</span></a>    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">dy</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">norm</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the normal vector of a line.</p>

<p>Args:
    point1 (Point): First point of the line.
    point2 (Point): Second point of the line.</p>

<p>Returns:
    VecType: Normal vector of the line.</p>
</div>


                </section>
                <section id="area">
                            <input id="area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="area-3428"><a href="#area-3428"><span class="linenos">3428</span></a><span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="area-3429"><a href="#area-3429"><span class="linenos">3429</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the area of a triangle given its vertices.</span>
</span><span id="area-3430"><a href="#area-3430"><span class="linenos">3430</span></a>
</span><span id="area-3431"><a href="#area-3431"><span class="linenos">3431</span></a><span class="sd">    Args:</span>
</span><span id="area-3432"><a href="#area-3432"><span class="linenos">3432</span></a><span class="sd">        a (Point): First vertex.</span>
</span><span id="area-3433"><a href="#area-3433"><span class="linenos">3433</span></a><span class="sd">        b (Point): Second vertex.</span>
</span><span id="area-3434"><a href="#area-3434"><span class="linenos">3434</span></a><span class="sd">        c (Point): Third vertex.</span>
</span><span id="area-3435"><a href="#area-3435"><span class="linenos">3435</span></a>
</span><span id="area-3436"><a href="#area-3436"><span class="linenos">3436</span></a><span class="sd">    Returns:</span>
</span><span id="area-3437"><a href="#area-3437"><span class="linenos">3437</span></a><span class="sd">        float: Area of the triangle.</span>
</span><span id="area-3438"><a href="#area-3438"><span class="linenos">3438</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="area-3439"><a href="#area-3439"><span class="linenos">3439</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the area of a triangle given its vertices.</p>

<p>Args:
    a (Point): First vertex.
    b (Point): Second vertex.
    c (Point): Third vertex.</p>

<p>Returns:
    float: Area of the triangle.</p>
</div>


                </section>
                <section id="calc_area">
                            <input id="calc_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="calc_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#calc_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="calc_area-3442"><a href="#calc_area-3442"><span class="linenos">3442</span></a><span class="k">def</span> <span class="nf">calc_area</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="calc_area-3443"><a href="#calc_area-3443"><span class="linenos">3443</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a simple polygon (given by a list of its vertices).</span>
</span><span id="calc_area-3444"><a href="#calc_area-3444"><span class="linenos">3444</span></a>
</span><span id="calc_area-3445"><a href="#calc_area-3445"><span class="linenos">3445</span></a><span class="sd">    Args:</span>
</span><span id="calc_area-3446"><a href="#calc_area-3446"><span class="linenos">3446</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="calc_area-3447"><a href="#calc_area-3447"><span class="linenos">3447</span></a>
</span><span id="calc_area-3448"><a href="#calc_area-3448"><span class="linenos">3448</span></a><span class="sd">    Returns:</span>
</span><span id="calc_area-3449"><a href="#calc_area-3449"><span class="linenos">3449</span></a><span class="sd">        tuple: Area of the polygon and whether it is clockwise.</span>
</span><span id="calc_area-3450"><a href="#calc_area-3450"><span class="linenos">3450</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="calc_area-3451"><a href="#calc_area-3451"><span class="linenos">3451</span></a>    <span class="n">area_</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="calc_area-3452"><a href="#calc_area-3452"><span class="linenos">3452</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="calc_area-3453"><a href="#calc_area-3453"><span class="linenos">3453</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="calc_area-3454"><a href="#calc_area-3454"><span class="linenos">3454</span></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="calc_area-3455"><a href="#calc_area-3455"><span class="linenos">3455</span></a>        <span class="n">vnext</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_points</span><span class="p">]</span>
</span><span id="calc_area-3456"><a href="#calc_area-3456"><span class="linenos">3456</span></a>        <span class="n">area_</span> <span class="o">+=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">vnext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vnext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="calc_area-3457"><a href="#calc_area-3457"><span class="linenos">3457</span></a>    <span class="n">clockwise</span> <span class="o">=</span> <span class="n">area_</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="calc_area-3458"><a href="#calc_area-3458"><span class="linenos">3458</span></a>
</span><span id="calc_area-3459"><a href="#calc_area-3459"><span class="linenos">3459</span></a>    <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">area_</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">clockwise</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the area of a simple polygon (given by a list of its vertices).</p>

<p>Args:
    points (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    tuple: Area of the polygon and whether it is clockwise.</p>
</div>


                </section>
                <section id="remove_bad_points">
                            <input id="remove_bad_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_bad_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="remove_bad_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_bad_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_bad_points-3462"><a href="#remove_bad_points-3462"><span class="linenos">3462</span></a><span class="k">def</span> <span class="nf">remove_bad_points</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="remove_bad_points-3463"><a href="#remove_bad_points-3463"><span class="linenos">3463</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove redundant and collinear points from a list of points.</span>
</span><span id="remove_bad_points-3464"><a href="#remove_bad_points-3464"><span class="linenos">3464</span></a>
</span><span id="remove_bad_points-3465"><a href="#remove_bad_points-3465"><span class="linenos">3465</span></a><span class="sd">    Args:</span>
</span><span id="remove_bad_points-3466"><a href="#remove_bad_points-3466"><span class="linenos">3466</span></a><span class="sd">        points (list[Point]): List of points.</span>
</span><span id="remove_bad_points-3467"><a href="#remove_bad_points-3467"><span class="linenos">3467</span></a>
</span><span id="remove_bad_points-3468"><a href="#remove_bad_points-3468"><span class="linenos">3468</span></a><span class="sd">    Returns:</span>
</span><span id="remove_bad_points-3469"><a href="#remove_bad_points-3469"><span class="linenos">3469</span></a><span class="sd">        list[Point]: List of points with redundant and collinear points removed.</span>
</span><span id="remove_bad_points-3470"><a href="#remove_bad_points-3470"><span class="linenos">3470</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="remove_bad_points-3471"><a href="#remove_bad_points-3471"><span class="linenos">3471</span></a>    <span class="n">EPSILON</span> <span class="o">=</span> <span class="mf">1e-16</span>
</span><span id="remove_bad_points-3472"><a href="#remove_bad_points-3472"><span class="linenos">3472</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="remove_bad_points-3473"><a href="#remove_bad_points-3473"><span class="linenos">3473</span></a>    <span class="c1"># check for redundant points</span>
</span><span id="remove_bad_points-3474"><a href="#remove_bad_points-3474"><span class="linenos">3474</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">[:]):</span>
</span><span id="remove_bad_points-3475"><a href="#remove_bad_points-3475"><span class="linenos">3475</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="remove_bad_points-3476"><a href="#remove_bad_points-3476"><span class="linenos">3476</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>  <span class="c1"># then remove the redundant point</span>
</span><span id="remove_bad_points-3477"><a href="#remove_bad_points-3477"><span class="linenos">3477</span></a>                <span class="c1"># maybe we should display a warning message here indicating</span>
</span><span id="remove_bad_points-3478"><a href="#remove_bad_points-3478"><span class="linenos">3478</span></a>                <span class="c1"># that redundant point is removed!!!</span>
</span><span id="remove_bad_points-3479"><a href="#remove_bad_points-3479"><span class="linenos">3479</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="remove_bad_points-3480"><a href="#remove_bad_points-3480"><span class="linenos">3480</span></a>
</span><span id="remove_bad_points-3481"><a href="#remove_bad_points-3481"><span class="linenos">3481</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="remove_bad_points-3482"><a href="#remove_bad_points-3482"><span class="linenos">3482</span></a>    <span class="c1"># check for three consecutive points on a line</span>
</span><span id="remove_bad_points-3483"><a href="#remove_bad_points-3483"><span class="linenos">3483</span></a>    <span class="n">lin_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="remove_bad_points-3484"><a href="#remove_bad_points-3484"><span class="linenos">3484</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="remove_bad_points-3485"><a href="#remove_bad_points-3485"><span class="linenos">3485</span></a>        <span class="k">if</span> <span class="n">EPSILON</span> <span class="o">&gt;</span> <span class="n">calc_area</span><span class="p">([</span><span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">EPSILON</span><span class="p">:</span>
</span><span id="remove_bad_points-3486"><a href="#remove_bad_points-3486"><span class="linenos">3486</span></a>            <span class="n">lin_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="remove_bad_points-3487"><a href="#remove_bad_points-3487"><span class="linenos">3487</span></a>
</span><span id="remove_bad_points-3488"><a href="#remove_bad_points-3488"><span class="linenos">3488</span></a>    <span class="k">if</span> <span class="n">EPSILON</span> <span class="o">&gt;</span> <span class="n">calc_area</span><span class="p">([</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">EPSILON</span><span class="p">:</span>
</span><span id="remove_bad_points-3489"><a href="#remove_bad_points-3489"><span class="linenos">3489</span></a>        <span class="n">lin_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="remove_bad_points-3490"><a href="#remove_bad_points-3490"><span class="linenos">3490</span></a>
</span><span id="remove_bad_points-3491"><a href="#remove_bad_points-3491"><span class="linenos">3491</span></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">lin_points</span><span class="p">:</span>
</span><span id="remove_bad_points-3492"><a href="#remove_bad_points-3492"><span class="linenos">3492</span></a>        <span class="c1"># maybe we should display a warning message here indicating that linear</span>
</span><span id="remove_bad_points-3493"><a href="#remove_bad_points-3493"><span class="linenos">3493</span></a>        <span class="c1"># point is removed!!!</span>
</span><span id="remove_bad_points-3494"><a href="#remove_bad_points-3494"><span class="linenos">3494</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="remove_bad_points-3495"><a href="#remove_bad_points-3495"><span class="linenos">3495</span></a>
</span><span id="remove_bad_points-3496"><a href="#remove_bad_points-3496"><span class="linenos">3496</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>Remove redundant and collinear points from a list of points.</p>

<p>Args:
    points (list[Point]): List of points.</p>

<p>Returns:
    list[Point]: List of points with redundant and collinear points removed.</p>
</div>


                </section>
                <section id="is_convex">
                            <input id="is_convex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_convex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="is_convex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_convex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_convex-3499"><a href="#is_convex-3499"><span class="linenos">3499</span></a><span class="k">def</span> <span class="nf">is_convex</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="is_convex-3500"><a href="#is_convex-3500"><span class="linenos">3500</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the polygon is convex.</span>
</span><span id="is_convex-3501"><a href="#is_convex-3501"><span class="linenos">3501</span></a>
</span><span id="is_convex-3502"><a href="#is_convex-3502"><span class="linenos">3502</span></a><span class="sd">    Args:</span>
</span><span id="is_convex-3503"><a href="#is_convex-3503"><span class="linenos">3503</span></a><span class="sd">        points (list[Point]): List of points representing the polygon.</span>
</span><span id="is_convex-3504"><a href="#is_convex-3504"><span class="linenos">3504</span></a>
</span><span id="is_convex-3505"><a href="#is_convex-3505"><span class="linenos">3505</span></a><span class="sd">    Returns:</span>
</span><span id="is_convex-3506"><a href="#is_convex-3506"><span class="linenos">3506</span></a><span class="sd">        bool: True if the polygon is convex, False otherwise.</span>
</span><span id="is_convex-3507"><a href="#is_convex-3507"><span class="linenos">3507</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_convex-3508"><a href="#is_convex-3508"><span class="linenos">3508</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">remove_bad_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="is_convex-3509"><a href="#is_convex-3509"><span class="linenos">3509</span></a>    <span class="n">n_checks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="is_convex-3510"><a href="#is_convex-3510"><span class="linenos">3510</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">points</span> <span class="o">+</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="is_convex-3511"><a href="#is_convex-3511"><span class="linenos">3511</span></a>    <span class="n">senses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="is_convex-3512"><a href="#is_convex-3512"><span class="linenos">3512</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_checks</span><span class="p">):</span>
</span><span id="is_convex-3513"><a href="#is_convex-3513"><span class="linenos">3513</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_checks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="is_convex-3514"><a href="#is_convex-3514"><span class="linenos">3514</span></a>            <span class="n">senses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_product_sense</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="is_convex-3515"><a href="#is_convex-3515"><span class="linenos">3515</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="is_convex-3516"><a href="#is_convex-3516"><span class="linenos">3516</span></a>            <span class="n">senses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_product_sense</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]))</span>
</span><span id="is_convex-3517"><a href="#is_convex-3517"><span class="linenos">3517</span></a>    <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
</span><span id="is_convex-3518"><a href="#is_convex-3518"><span class="linenos">3518</span></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the polygon is convex.</p>

<p>Args:
    points (list[Point]): List of points representing the polygon.</p>

<p>Returns:
    bool: True if the polygon is convex, False otherwise.</p>
</div>


                </section>
                <section id="set_vertices">
                            <input id="set_vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_vertices</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="set_vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_vertices-3521"><a href="#set_vertices-3521"><span class="linenos">3521</span></a><span class="k">def</span> <span class="nf">set_vertices</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="set_vertices-3522"><a href="#set_vertices-3522"><span class="linenos">3522</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the next and previous vertices of a list of vertices.</span>
</span><span id="set_vertices-3523"><a href="#set_vertices-3523"><span class="linenos">3523</span></a>
</span><span id="set_vertices-3524"><a href="#set_vertices-3524"><span class="linenos">3524</span></a><span class="sd">    Args:</span>
</span><span id="set_vertices-3525"><a href="#set_vertices-3525"><span class="linenos">3525</span></a><span class="sd">        points (list[Vertex]): List of vertices.</span>
</span><span id="set_vertices-3526"><a href="#set_vertices-3526"><span class="linenos">3526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_vertices-3527"><a href="#set_vertices-3527"><span class="linenos">3527</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="set_vertices-3528"><a href="#set_vertices-3528"><span class="linenos">3528</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">[:])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="set_vertices-3529"><a href="#set_vertices-3529"><span class="linenos">3529</span></a>    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="set_vertices-3530"><a href="#set_vertices-3530"><span class="linenos">3530</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="set_vertices-3531"><a href="#set_vertices-3531"><span class="linenos">3531</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="set_vertices-3532"><a href="#set_vertices-3532"><span class="linenos">3532</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="set_vertices-3533"><a href="#set_vertices-3533"><span class="linenos">3533</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="set_vertices-3534"><a href="#set_vertices-3534"><span class="linenos">3534</span></a>        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="set_vertices-3535"><a href="#set_vertices-3535"><span class="linenos">3535</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="set_vertices-3536"><a href="#set_vertices-3536"><span class="linenos">3536</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="set_vertices-3537"><a href="#set_vertices-3537"><span class="linenos">3537</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="set_vertices-3538"><a href="#set_vertices-3538"><span class="linenos">3538</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="set_vertices-3539"><a href="#set_vertices-3539"><span class="linenos">3539</span></a>            <span class="n">p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="set_vertices-3540"><a href="#set_vertices-3540"><span class="linenos">3540</span></a>        <span class="n">p</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">cross_product_sense</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">prev</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">next</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the next and previous vertices of a list of vertices.</p>

<p>Args:
    points (list[Vertex]): List of vertices.</p>
</div>


                </section>
                <section id="circle_circle_intersections">
                            <input id="circle_circle_intersections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_circle_intersections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point1</span>, </span><span class="param"><span class="n">radius1</span>, </span><span class="param"><span class="n">point2</span>, </span><span class="param"><span class="n">radius2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_circle_intersections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_circle_intersections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_circle_intersections-3543"><a href="#circle_circle_intersections-3543"><span class="linenos">3543</span></a><span class="k">def</span> <span class="nf">circle_circle_intersections</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">radius1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">radius2</span><span class="p">):</span>
</span><span id="circle_circle_intersections-3544"><a href="#circle_circle_intersections-3544"><span class="linenos">3544</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of two circles.</span>
</span><span id="circle_circle_intersections-3545"><a href="#circle_circle_intersections-3545"><span class="linenos">3545</span></a>
</span><span id="circle_circle_intersections-3546"><a href="#circle_circle_intersections-3546"><span class="linenos">3546</span></a><span class="sd">    Args:</span>
</span><span id="circle_circle_intersections-3547"><a href="#circle_circle_intersections-3547"><span class="linenos">3547</span></a><span class="sd">        point1 (Point): Center of the first circle.</span>
</span><span id="circle_circle_intersections-3548"><a href="#circle_circle_intersections-3548"><span class="linenos">3548</span></a><span class="sd">        radius1 (float): Radius of the first circle.</span>
</span><span id="circle_circle_intersections-3549"><a href="#circle_circle_intersections-3549"><span class="linenos">3549</span></a><span class="sd">        point2 (Point): Center of the second circle.</span>
</span><span id="circle_circle_intersections-3550"><a href="#circle_circle_intersections-3550"><span class="linenos">3550</span></a><span class="sd">        radius2 (float): Radius of the second circle.</span>
</span><span id="circle_circle_intersections-3551"><a href="#circle_circle_intersections-3551"><span class="linenos">3551</span></a>
</span><span id="circle_circle_intersections-3552"><a href="#circle_circle_intersections-3552"><span class="linenos">3552</span></a><span class="sd">    Returns:</span>
</span><span id="circle_circle_intersections-3553"><a href="#circle_circle_intersections-3553"><span class="linenos">3553</span></a><span class="sd">        tuple: Intersection points of the two circles.</span>
</span><span id="circle_circle_intersections-3554"><a href="#circle_circle_intersections-3554"><span class="linenos">3554</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_circle_intersections-3555"><a href="#circle_circle_intersections-3555"><span class="linenos">3555</span></a>    <span class="c1"># taken from https://stackoverflow.com/questions/55816902/finding-the-</span>
</span><span id="circle_circle_intersections-3556"><a href="#circle_circle_intersections-3556"><span class="linenos">3556</span></a>    <span class="c1"># intersection-of-two-circles</span>
</span><span id="circle_circle_intersections-3557"><a href="#circle_circle_intersections-3557"><span class="linenos">3557</span></a>    <span class="c1"># circle 1: (x0, y0), radius r0</span>
</span><span id="circle_circle_intersections-3558"><a href="#circle_circle_intersections-3558"><span class="linenos">3558</span></a>    <span class="c1"># circle 2: (x1, y1), radius r1</span>
</span><span id="circle_circle_intersections-3559"><a href="#circle_circle_intersections-3559"><span class="linenos">3559</span></a>
</span><span id="circle_circle_intersections-3560"><a href="#circle_circle_intersections-3560"><span class="linenos">3560</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">point1</span>
</span><span id="circle_circle_intersections-3561"><a href="#circle_circle_intersections-3561"><span class="linenos">3561</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">point2</span>
</span><span id="circle_circle_intersections-3562"><a href="#circle_circle_intersections-3562"><span class="linenos">3562</span></a>    <span class="n">r0</span> <span class="o">=</span> <span class="n">radius1</span>
</span><span id="circle_circle_intersections-3563"><a href="#circle_circle_intersections-3563"><span class="linenos">3563</span></a>    <span class="n">r1</span> <span class="o">=</span> <span class="n">radius2</span>
</span><span id="circle_circle_intersections-3564"><a href="#circle_circle_intersections-3564"><span class="linenos">3564</span></a>
</span><span id="circle_circle_intersections-3565"><a href="#circle_circle_intersections-3565"><span class="linenos">3565</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="circle_circle_intersections-3566"><a href="#circle_circle_intersections-3566"><span class="linenos">3566</span></a>
</span><span id="circle_circle_intersections-3567"><a href="#circle_circle_intersections-3567"><span class="linenos">3567</span></a>    <span class="c1"># non intersecting</span>
</span><span id="circle_circle_intersections-3568"><a href="#circle_circle_intersections-3568"><span class="linenos">3568</span></a>    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">r1</span><span class="p">:</span>
</span><span id="circle_circle_intersections-3569"><a href="#circle_circle_intersections-3569"><span class="linenos">3569</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="circle_circle_intersections-3570"><a href="#circle_circle_intersections-3570"><span class="linenos">3570</span></a>    <span class="c1"># One circle within other</span>
</span><span id="circle_circle_intersections-3571"><a href="#circle_circle_intersections-3571"><span class="linenos">3571</span></a>    <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r0</span> <span class="o">-</span> <span class="n">r1</span><span class="p">):</span>
</span><span id="circle_circle_intersections-3572"><a href="#circle_circle_intersections-3572"><span class="linenos">3572</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="circle_circle_intersections-3573"><a href="#circle_circle_intersections-3573"><span class="linenos">3573</span></a>    <span class="c1"># coincident circles</span>
</span><span id="circle_circle_intersections-3574"><a href="#circle_circle_intersections-3574"><span class="linenos">3574</span></a>    <span class="k">elif</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r0</span> <span class="o">==</span> <span class="n">r1</span><span class="p">:</span>
</span><span id="circle_circle_intersections-3575"><a href="#circle_circle_intersections-3575"><span class="linenos">3575</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="circle_circle_intersections-3576"><a href="#circle_circle_intersections-3576"><span class="linenos">3576</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="circle_circle_intersections-3577"><a href="#circle_circle_intersections-3577"><span class="linenos">3577</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
</span><span id="circle_circle_intersections-3578"><a href="#circle_circle_intersections-3578"><span class="linenos">3578</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="circle_circle_intersections-3579"><a href="#circle_circle_intersections-3579"><span class="linenos">3579</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3580"><a href="#circle_circle_intersections-3580"><span class="linenos">3580</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3581"><a href="#circle_circle_intersections-3581"><span class="linenos">3581</span></a>        <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3582"><a href="#circle_circle_intersections-3582"><span class="linenos">3582</span></a>        <span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3583"><a href="#circle_circle_intersections-3583"><span class="linenos">3583</span></a>        <span class="n">x4</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3584"><a href="#circle_circle_intersections-3584"><span class="linenos">3584</span></a>        <span class="n">y4</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>
</span><span id="circle_circle_intersections-3585"><a href="#circle_circle_intersections-3585"><span class="linenos">3585</span></a>
</span><span id="circle_circle_intersections-3586"><a href="#circle_circle_intersections-3586"><span class="linenos">3586</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">),</span> <span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">))</span>
</span><span id="circle_circle_intersections-3587"><a href="#circle_circle_intersections-3587"><span class="linenos">3587</span></a>
</span><span id="circle_circle_intersections-3588"><a href="#circle_circle_intersections-3588"><span class="linenos">3588</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection points of two circles.</p>

<p>Args:
    point1 (Point): Center of the first circle.
    radius1 (float): Radius of the first circle.
    point2 (Point): Center of the second circle.
    radius2 (float): Radius of the second circle.</p>

<p>Returns:
    tuple: Intersection points of the two circles.</p>
</div>


                </section>
                <section id="circle_segment_intersection">
                            <input id="circle_segment_intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_segment_intersection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">circle</span>, </span><span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_segment_intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_segment_intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_segment_intersection-3591"><a href="#circle_segment_intersection-3591"><span class="linenos">3591</span></a><span class="k">def</span> <span class="nf">circle_segment_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
</span><span id="circle_segment_intersection-3592"><a href="#circle_segment_intersection-3592"><span class="linenos">3592</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the circle and the line segment intersect.</span>
</span><span id="circle_segment_intersection-3593"><a href="#circle_segment_intersection-3593"><span class="linenos">3593</span></a>
</span><span id="circle_segment_intersection-3594"><a href="#circle_segment_intersection-3594"><span class="linenos">3594</span></a><span class="sd">    Args:</span>
</span><span id="circle_segment_intersection-3595"><a href="#circle_segment_intersection-3595"><span class="linenos">3595</span></a><span class="sd">        circle (Circle): Input circle.</span>
</span><span id="circle_segment_intersection-3596"><a href="#circle_segment_intersection-3596"><span class="linenos">3596</span></a><span class="sd">        p1 (Point): First point of the line segment.</span>
</span><span id="circle_segment_intersection-3597"><a href="#circle_segment_intersection-3597"><span class="linenos">3597</span></a><span class="sd">        p2 (Point): Second point of the line segment.</span>
</span><span id="circle_segment_intersection-3598"><a href="#circle_segment_intersection-3598"><span class="linenos">3598</span></a>
</span><span id="circle_segment_intersection-3599"><a href="#circle_segment_intersection-3599"><span class="linenos">3599</span></a><span class="sd">    Returns:</span>
</span><span id="circle_segment_intersection-3600"><a href="#circle_segment_intersection-3600"><span class="linenos">3600</span></a><span class="sd">        bool: True if the circle and the line segment intersect, False otherwise.</span>
</span><span id="circle_segment_intersection-3601"><a href="#circle_segment_intersection-3601"><span class="linenos">3601</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_segment_intersection-3602"><a href="#circle_segment_intersection-3602"><span class="linenos">3602</span></a>    <span class="c1"># if line seg and circle intersects returns true, false otherwise</span>
</span><span id="circle_segment_intersection-3603"><a href="#circle_segment_intersection-3603"><span class="linenos">3603</span></a>    <span class="c1"># c: circle</span>
</span><span id="circle_segment_intersection-3604"><a href="#circle_segment_intersection-3604"><span class="linenos">3604</span></a>    <span class="c1"># p1 and p2 are the endpoints of the line segment</span>
</span><span id="circle_segment_intersection-3605"><a href="#circle_segment_intersection-3605"><span class="linenos">3605</span></a>
</span><span id="circle_segment_intersection-3606"><a href="#circle_segment_intersection-3606"><span class="linenos">3606</span></a>    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_segment_intersection-3607"><a href="#circle_segment_intersection-3607"><span class="linenos">3607</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_segment_intersection-3608"><a href="#circle_segment_intersection-3608"><span class="linenos">3608</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_segment_intersection-3609"><a href="#circle_segment_intersection-3609"><span class="linenos">3609</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="circle_segment_intersection-3610"><a href="#circle_segment_intersection-3610"><span class="linenos">3610</span></a>        <span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span>
</span><span id="circle_segment_intersection-3611"><a href="#circle_segment_intersection-3611"><span class="linenos">3611</span></a>        <span class="ow">or</span> <span class="n">distance</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span>
</span><span id="circle_segment_intersection-3612"><a href="#circle_segment_intersection-3612"><span class="linenos">3612</span></a>    <span class="p">):</span>
</span><span id="circle_segment_intersection-3613"><a href="#circle_segment_intersection-3613"><span class="linenos">3613</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="circle_segment_intersection-3614"><a href="#circle_segment_intersection-3614"><span class="linenos">3614</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="p">((</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="circle_segment_intersection-3615"><a href="#circle_segment_intersection-3615"><span class="linenos">3615</span></a>        <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="circle_segment_intersection-3616"><a href="#circle_segment_intersection-3616"><span class="linenos">3616</span></a>    <span class="p">)</span>
</span><span id="circle_segment_intersection-3617"><a href="#circle_segment_intersection-3617"><span class="linenos">3617</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="circle_segment_intersection-3618"><a href="#circle_segment_intersection-3618"><span class="linenos">3618</span></a>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="circle_segment_intersection-3619"><a href="#circle_segment_intersection-3619"><span class="linenos">3619</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="circle_segment_intersection-3620"><a href="#circle_segment_intersection-3620"><span class="linenos">3620</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="circle_segment_intersection-3621"><a href="#circle_segment_intersection-3621"><span class="linenos">3621</span></a>        <span class="k">if</span> <span class="n">distance</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">circle</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span><span class="p">:</span>
</span><span id="circle_segment_intersection-3622"><a href="#circle_segment_intersection-3622"><span class="linenos">3622</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="circle_segment_intersection-3623"><a href="#circle_segment_intersection-3623"><span class="linenos">3623</span></a>
</span><span id="circle_segment_intersection-3624"><a href="#circle_segment_intersection-3624"><span class="linenos">3624</span></a>    <span class="k">return</span> <span class="n">res</span>  <span class="c1"># p is not between lp1 and lp2</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the circle and the line segment intersect.</p>

<p>Args:
    circle (Circle): Input circle.
    p1 (Point): First point of the line segment.
    p2 (Point): Second point of the line segment.</p>

<p>Returns:
    bool: True if the circle and the line segment intersect, False otherwise.</p>
</div>


                </section>
                <section id="r_polar">
                            <input id="r_polar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">r_polar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">theta</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="r_polar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#r_polar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="r_polar-3627"><a href="#r_polar-3627"><span class="linenos">3627</span></a><span class="k">def</span> <span class="nf">r_polar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
</span><span id="r_polar-3628"><a href="#r_polar-3628"><span class="linenos">3628</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the radius (distance between the center and the intersection point)</span>
</span><span id="r_polar-3629"><a href="#r_polar-3629"><span class="linenos">3629</span></a><span class="sd">    of the ellipse at the given angle.</span>
</span><span id="r_polar-3630"><a href="#r_polar-3630"><span class="linenos">3630</span></a>
</span><span id="r_polar-3631"><a href="#r_polar-3631"><span class="linenos">3631</span></a><span class="sd">    Args:</span>
</span><span id="r_polar-3632"><a href="#r_polar-3632"><span class="linenos">3632</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="r_polar-3633"><a href="#r_polar-3633"><span class="linenos">3633</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="r_polar-3634"><a href="#r_polar-3634"><span class="linenos">3634</span></a><span class="sd">        theta (float): Angle in radians.</span>
</span><span id="r_polar-3635"><a href="#r_polar-3635"><span class="linenos">3635</span></a>
</span><span id="r_polar-3636"><a href="#r_polar-3636"><span class="linenos">3636</span></a><span class="sd">    Returns:</span>
</span><span id="r_polar-3637"><a href="#r_polar-3637"><span class="linenos">3637</span></a><span class="sd">        float: Radius of the ellipse at the given angle.</span>
</span><span id="r_polar-3638"><a href="#r_polar-3638"><span class="linenos">3638</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="r_polar-3639"><a href="#r_polar-3639"><span class="linenos">3639</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the radius (distance between the center and the intersection point)
of the ellipse at the given angle.</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    theta (float): Angle in radians.</p>

<p>Returns:
    float: Radius of the ellipse at the given angle.</p>
</div>


                </section>
                <section id="ellipse_line_intersection">
                            <input id="ellipse_line_intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ellipse_line_intersection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">point</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ellipse_line_intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ellipse_line_intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ellipse_line_intersection-3642"><a href="#ellipse_line_intersection-3642"><span class="linenos">3642</span></a><span class="k">def</span> <span class="nf">ellipse_line_intersection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
</span><span id="ellipse_line_intersection-3643"><a href="#ellipse_line_intersection-3643"><span class="linenos">3643</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of an ellipse and a line segment</span>
</span><span id="ellipse_line_intersection-3644"><a href="#ellipse_line_intersection-3644"><span class="linenos">3644</span></a><span class="sd">    connecting the given point to the ellipse center at (0, 0).</span>
</span><span id="ellipse_line_intersection-3645"><a href="#ellipse_line_intersection-3645"><span class="linenos">3645</span></a>
</span><span id="ellipse_line_intersection-3646"><a href="#ellipse_line_intersection-3646"><span class="linenos">3646</span></a><span class="sd">    Args:</span>
</span><span id="ellipse_line_intersection-3647"><a href="#ellipse_line_intersection-3647"><span class="linenos">3647</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="ellipse_line_intersection-3648"><a href="#ellipse_line_intersection-3648"><span class="linenos">3648</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="ellipse_line_intersection-3649"><a href="#ellipse_line_intersection-3649"><span class="linenos">3649</span></a><span class="sd">        point (Point): Point on the line segment.</span>
</span><span id="ellipse_line_intersection-3650"><a href="#ellipse_line_intersection-3650"><span class="linenos">3650</span></a>
</span><span id="ellipse_line_intersection-3651"><a href="#ellipse_line_intersection-3651"><span class="linenos">3651</span></a><span class="sd">    Returns:</span>
</span><span id="ellipse_line_intersection-3652"><a href="#ellipse_line_intersection-3652"><span class="linenos">3652</span></a><span class="sd">        list[Point]: Intersection points of the ellipse and the line segment.</span>
</span><span id="ellipse_line_intersection-3653"><a href="#ellipse_line_intersection-3653"><span class="linenos">3653</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ellipse_line_intersection-3654"><a href="#ellipse_line_intersection-3654"><span class="linenos">3654</span></a>    <span class="c1"># adapted from http://mathworld.wolfram.com/Ellipse-LineIntersection.html</span>
</span><span id="ellipse_line_intersection-3655"><a href="#ellipse_line_intersection-3655"><span class="linenos">3655</span></a>    <span class="c1"># a, b is the ellipse width/2 and height/2 and (x_0, y_0) is the point</span>
</span><span id="ellipse_line_intersection-3656"><a href="#ellipse_line_intersection-3656"><span class="linenos">3656</span></a>
</span><span id="ellipse_line_intersection-3657"><a href="#ellipse_line_intersection-3657"><span class="linenos">3657</span></a>    <span class="n">x_0</span><span class="p">,</span> <span class="n">y_0</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="ellipse_line_intersection-3658"><a href="#ellipse_line_intersection-3658"><span class="linenos">3658</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">x_0</span>
</span><span id="ellipse_line_intersection-3659"><a href="#ellipse_line_intersection-3659"><span class="linenos">3659</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">y_0</span>
</span><span id="ellipse_line_intersection-3660"><a href="#ellipse_line_intersection-3660"><span class="linenos">3660</span></a>
</span><span id="ellipse_line_intersection-3661"><a href="#ellipse_line_intersection-3661"><span class="linenos">3661</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection points of an ellipse and a line segment
connecting the given point to the ellipse center at (0, 0).</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    point (Point): Point on the line segment.</p>

<p>Returns:
    list[Point]: Intersection points of the ellipse and the line segment.</p>
</div>


                </section>
                <section id="ellipse_tangent">
                            <input id="ellipse_tangent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ellipse_tangent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ellipse_tangent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ellipse_tangent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ellipse_tangent-3664"><a href="#ellipse_tangent-3664"><span class="linenos">3664</span></a><span class="k">def</span> <span class="nf">ellipse_tangent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
</span><span id="ellipse_tangent-3665"><a href="#ellipse_tangent-3665"><span class="linenos">3665</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the slope of the tangent line to an ellipse at the point (x, y).</span>
</span><span id="ellipse_tangent-3666"><a href="#ellipse_tangent-3666"><span class="linenos">3666</span></a><span class="sd">    If point is not on the ellipse, return False.</span>
</span><span id="ellipse_tangent-3667"><a href="#ellipse_tangent-3667"><span class="linenos">3667</span></a>
</span><span id="ellipse_tangent-3668"><a href="#ellipse_tangent-3668"><span class="linenos">3668</span></a><span class="sd">    Args:</span>
</span><span id="ellipse_tangent-3669"><a href="#ellipse_tangent-3669"><span class="linenos">3669</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="ellipse_tangent-3670"><a href="#ellipse_tangent-3670"><span class="linenos">3670</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="ellipse_tangent-3671"><a href="#ellipse_tangent-3671"><span class="linenos">3671</span></a><span class="sd">        x (float): x-coordinate of the point.</span>
</span><span id="ellipse_tangent-3672"><a href="#ellipse_tangent-3672"><span class="linenos">3672</span></a><span class="sd">        y (float): y-coordinate of the point.</span>
</span><span id="ellipse_tangent-3673"><a href="#ellipse_tangent-3673"><span class="linenos">3673</span></a><span class="sd">        tol (float, optional): Tolerance. Defaults to 0.001.</span>
</span><span id="ellipse_tangent-3674"><a href="#ellipse_tangent-3674"><span class="linenos">3674</span></a>
</span><span id="ellipse_tangent-3675"><a href="#ellipse_tangent-3675"><span class="linenos">3675</span></a><span class="sd">    Returns:</span>
</span><span id="ellipse_tangent-3676"><a href="#ellipse_tangent-3676"><span class="linenos">3676</span></a><span class="sd">        float: Slope of the tangent line, or False if the point is not on the ellipse.</span>
</span><span id="ellipse_tangent-3677"><a href="#ellipse_tangent-3677"><span class="linenos">3677</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ellipse_tangent-3678"><a href="#ellipse_tangent-3678"><span class="linenos">3678</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
</span><span id="ellipse_tangent-3679"><a href="#ellipse_tangent-3679"><span class="linenos">3679</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ellipse_tangent-3680"><a href="#ellipse_tangent-3680"><span class="linenos">3680</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="ellipse_tangent-3681"><a href="#ellipse_tangent-3681"><span class="linenos">3681</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ellipse_tangent-3682"><a href="#ellipse_tangent-3682"><span class="linenos">3682</span></a>
</span><span id="ellipse_tangent-3683"><a href="#ellipse_tangent-3683"><span class="linenos">3683</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the slope of the tangent line to an ellipse at the point (x, y).
If point is not on the ellipse, return False.</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    x (float): x-coordinate of the point.
    y (float): y-coordinate of the point.
    tol (float, optional): Tolerance. Defaults to 0.001.</p>

<p>Returns:
    float: Slope of the tangent line, or False if the point is not on the ellipse.</p>
</div>


                </section>
                <section id="elliptic_arclength">
                            <input id="elliptic_arclength-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">elliptic_arclength</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t_0</span>, </span><span class="param"><span class="n">t_1</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="elliptic_arclength-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#elliptic_arclength"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="elliptic_arclength-3686"><a href="#elliptic_arclength-3686"><span class="linenos">3686</span></a><span class="k">def</span> <span class="nf">elliptic_arclength</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="elliptic_arclength-3687"><a href="#elliptic_arclength-3687"><span class="linenos">3687</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the arclength of an ellipse between the given parametric angles.</span>
</span><span id="elliptic_arclength-3688"><a href="#elliptic_arclength-3688"><span class="linenos">3688</span></a><span class="sd">    The ellipse has semi-major axis a and semi-minor axis b.</span>
</span><span id="elliptic_arclength-3689"><a href="#elliptic_arclength-3689"><span class="linenos">3689</span></a>
</span><span id="elliptic_arclength-3690"><a href="#elliptic_arclength-3690"><span class="linenos">3690</span></a><span class="sd">    Args:</span>
</span><span id="elliptic_arclength-3691"><a href="#elliptic_arclength-3691"><span class="linenos">3691</span></a><span class="sd">        t_0 (float): Start parametric angle in radians.</span>
</span><span id="elliptic_arclength-3692"><a href="#elliptic_arclength-3692"><span class="linenos">3692</span></a><span class="sd">        t_1 (float): End parametric angle in radians.</span>
</span><span id="elliptic_arclength-3693"><a href="#elliptic_arclength-3693"><span class="linenos">3693</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="elliptic_arclength-3694"><a href="#elliptic_arclength-3694"><span class="linenos">3694</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="elliptic_arclength-3695"><a href="#elliptic_arclength-3695"><span class="linenos">3695</span></a>
</span><span id="elliptic_arclength-3696"><a href="#elliptic_arclength-3696"><span class="linenos">3696</span></a><span class="sd">    Returns:</span>
</span><span id="elliptic_arclength-3697"><a href="#elliptic_arclength-3697"><span class="linenos">3697</span></a><span class="sd">        float: Arclength of the ellipse between the given parametric angles.</span>
</span><span id="elliptic_arclength-3698"><a href="#elliptic_arclength-3698"><span class="linenos">3698</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="elliptic_arclength-3699"><a href="#elliptic_arclength-3699"><span class="linenos">3699</span></a>    <span class="c1"># from: https://www.johndcook.com/blog/2022/11/02/elliptic-arc-length/</span>
</span><span id="elliptic_arclength-3700"><a href="#elliptic_arclength-3700"><span class="linenos">3700</span></a>    <span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">ellipeinc</span> <span class="c1"># this takes too long to import!!!</span>
</span><span id="elliptic_arclength-3701"><a href="#elliptic_arclength-3701"><span class="linenos">3701</span></a>    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="elliptic_arclength-3702"><a href="#elliptic_arclength-3702"><span class="linenos">3702</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="elliptic_arclength-3703"><a href="#elliptic_arclength-3703"><span class="linenos">3703</span></a>    <span class="n">t0</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="elliptic_arclength-3704"><a href="#elliptic_arclength-3704"><span class="linenos">3704</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the arclength of an ellipse between the given parametric angles.
The ellipse has semi-major axis a and semi-minor axis b.</p>

<p>Args:
    t_0 (float): Start parametric angle in radians.
    t_1 (float): End parametric angle in radians.
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.</p>

<p>Returns:
    float: Arclength of the ellipse between the given parametric angles.</p>
</div>


                </section>
                <section id="central_to_parametric_angle">
                            <input id="central_to_parametric_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">central_to_parametric_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">phi</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="central_to_parametric_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#central_to_parametric_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="central_to_parametric_angle-3707"><a href="#central_to_parametric_angle-3707"><span class="linenos">3707</span></a><span class="k">def</span> <span class="nf">central_to_parametric_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
</span><span id="central_to_parametric_angle-3708"><a href="#central_to_parametric_angle-3708"><span class="linenos">3708</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="central_to_parametric_angle-3709"><a href="#central_to_parametric_angle-3709"><span class="linenos">3709</span></a><span class="sd">    Converts a central angle to a parametric angle on an ellipse.</span>
</span><span id="central_to_parametric_angle-3710"><a href="#central_to_parametric_angle-3710"><span class="linenos">3710</span></a>
</span><span id="central_to_parametric_angle-3711"><a href="#central_to_parametric_angle-3711"><span class="linenos">3711</span></a><span class="sd">    Args:</span>
</span><span id="central_to_parametric_angle-3712"><a href="#central_to_parametric_angle-3712"><span class="linenos">3712</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="central_to_parametric_angle-3713"><a href="#central_to_parametric_angle-3713"><span class="linenos">3713</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="central_to_parametric_angle-3714"><a href="#central_to_parametric_angle-3714"><span class="linenos">3714</span></a><span class="sd">        phi (float): Central angle in radians.</span>
</span><span id="central_to_parametric_angle-3715"><a href="#central_to_parametric_angle-3715"><span class="linenos">3715</span></a>
</span><span id="central_to_parametric_angle-3716"><a href="#central_to_parametric_angle-3716"><span class="linenos">3716</span></a><span class="sd">    Returns:</span>
</span><span id="central_to_parametric_angle-3717"><a href="#central_to_parametric_angle-3717"><span class="linenos">3717</span></a><span class="sd">        float: Parametric angle in radians.</span>
</span><span id="central_to_parametric_angle-3718"><a href="#central_to_parametric_angle-3718"><span class="linenos">3718</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="central_to_parametric_angle-3719"><a href="#central_to_parametric_angle-3719"><span class="linenos">3719</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
</span><span id="central_to_parametric_angle-3720"><a href="#central_to_parametric_angle-3720"><span class="linenos">3720</span></a>    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="central_to_parametric_angle-3721"><a href="#central_to_parametric_angle-3721"><span class="linenos">3721</span></a>        <span class="n">t</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="central_to_parametric_angle-3722"><a href="#central_to_parametric_angle-3722"><span class="linenos">3722</span></a>
</span><span id="central_to_parametric_angle-3723"><a href="#central_to_parametric_angle-3723"><span class="linenos">3723</span></a>    <span class="k">return</span> <span class="n">t</span>
</span></pre></div>


            <div class="docstring"><p>Converts a central angle to a parametric angle on an ellipse.</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    phi (float): Central angle in radians.</p>

<p>Returns:
    float: Parametric angle in radians.</p>
</div>


                </section>
                <section id="parametric_to_central_angle">
                            <input id="parametric_to_central_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parametric_to_central_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">t</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="parametric_to_central_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parametric_to_central_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parametric_to_central_angle-3726"><a href="#parametric_to_central_angle-3726"><span class="linenos">3726</span></a><span class="k">def</span> <span class="nf">parametric_to_central_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="parametric_to_central_angle-3727"><a href="#parametric_to_central_angle-3727"><span class="linenos">3727</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="parametric_to_central_angle-3728"><a href="#parametric_to_central_angle-3728"><span class="linenos">3728</span></a><span class="sd">    Converts a parametric angle on an ellipse to a central angle.</span>
</span><span id="parametric_to_central_angle-3729"><a href="#parametric_to_central_angle-3729"><span class="linenos">3729</span></a>
</span><span id="parametric_to_central_angle-3730"><a href="#parametric_to_central_angle-3730"><span class="linenos">3730</span></a><span class="sd">    Args:</span>
</span><span id="parametric_to_central_angle-3731"><a href="#parametric_to_central_angle-3731"><span class="linenos">3731</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="parametric_to_central_angle-3732"><a href="#parametric_to_central_angle-3732"><span class="linenos">3732</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="parametric_to_central_angle-3733"><a href="#parametric_to_central_angle-3733"><span class="linenos">3733</span></a><span class="sd">        t (float): Parametric angle in radians.</span>
</span><span id="parametric_to_central_angle-3734"><a href="#parametric_to_central_angle-3734"><span class="linenos">3734</span></a>
</span><span id="parametric_to_central_angle-3735"><a href="#parametric_to_central_angle-3735"><span class="linenos">3735</span></a><span class="sd">    Returns:</span>
</span><span id="parametric_to_central_angle-3736"><a href="#parametric_to_central_angle-3736"><span class="linenos">3736</span></a><span class="sd">        float: Central angle in radians.</span>
</span><span id="parametric_to_central_angle-3737"><a href="#parametric_to_central_angle-3737"><span class="linenos">3737</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parametric_to_central_angle-3738"><a href="#parametric_to_central_angle-3738"><span class="linenos">3738</span></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</span><span id="parametric_to_central_angle-3739"><a href="#parametric_to_central_angle-3739"><span class="linenos">3739</span></a>    <span class="k">if</span> <span class="n">phi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="parametric_to_central_angle-3740"><a href="#parametric_to_central_angle-3740"><span class="linenos">3740</span></a>        <span class="n">phi</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
</span><span id="parametric_to_central_angle-3741"><a href="#parametric_to_central_angle-3741"><span class="linenos">3741</span></a>
</span><span id="parametric_to_central_angle-3742"><a href="#parametric_to_central_angle-3742"><span class="linenos">3742</span></a>    <span class="k">return</span> <span class="n">phi</span>
</span></pre></div>


            <div class="docstring"><p>Converts a parametric angle on an ellipse to a central angle.</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    t (float): Parametric angle in radians.</p>

<p>Returns:
    float: Central angle in radians.</p>
</div>


                </section>
                <section id="ellipse_points">
                            <input id="ellipse_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ellipse_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">n_points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ellipse_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ellipse_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ellipse_points-3745"><a href="#ellipse_points-3745"><span class="linenos">3745</span></a><span class="k">def</span> <span class="nf">ellipse_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n_points</span><span class="p">):</span>
</span><span id="ellipse_points-3746"><a href="#ellipse_points-3746"><span class="linenos">3746</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate points on an ellipse.</span>
</span><span id="ellipse_points-3747"><a href="#ellipse_points-3747"><span class="linenos">3747</span></a>
</span><span id="ellipse_points-3748"><a href="#ellipse_points-3748"><span class="linenos">3748</span></a><span class="sd">    Args:</span>
</span><span id="ellipse_points-3749"><a href="#ellipse_points-3749"><span class="linenos">3749</span></a><span class="sd">        center (tuple): (x, y) coordinates of the ellipse center.</span>
</span><span id="ellipse_points-3750"><a href="#ellipse_points-3750"><span class="linenos">3750</span></a><span class="sd">        a (float): Length of the semi-major axis.</span>
</span><span id="ellipse_points-3751"><a href="#ellipse_points-3751"><span class="linenos">3751</span></a><span class="sd">        b (float): Length of the semi-minor axis.</span>
</span><span id="ellipse_points-3752"><a href="#ellipse_points-3752"><span class="linenos">3752</span></a><span class="sd">        n_points (int): Number of points to generate.</span>
</span><span id="ellipse_points-3753"><a href="#ellipse_points-3753"><span class="linenos">3753</span></a>
</span><span id="ellipse_points-3754"><a href="#ellipse_points-3754"><span class="linenos">3754</span></a><span class="sd">    Returns:</span>
</span><span id="ellipse_points-3755"><a href="#ellipse_points-3755"><span class="linenos">3755</span></a><span class="sd">        np.ndarray: Array of (x, y) coordinates of the ellipse points.</span>
</span><span id="ellipse_points-3756"><a href="#ellipse_points-3756"><span class="linenos">3756</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ellipse_points-3757"><a href="#ellipse_points-3757"><span class="linenos">3757</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
</span><span id="ellipse_points-3758"><a href="#ellipse_points-3758"><span class="linenos">3758</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="ellipse_points-3759"><a href="#ellipse_points-3759"><span class="linenos">3759</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="ellipse_points-3760"><a href="#ellipse_points-3760"><span class="linenos">3760</span></a>
</span><span id="ellipse_points-3761"><a href="#ellipse_points-3761"><span class="linenos">3761</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Generate points on an ellipse.</p>

<p>Args:
    center (tuple): (x, y) coordinates of the ellipse center.
    a (float): Length of the semi-major axis.
    b (float): Length of the semi-minor axis.
    n_points (int): Number of points to generate.</p>

<p>Returns:
    np.ndarray: Array of (x, y) coordinates of the ellipse points.</p>
</div>


                </section>
                <section id="ellipse_point">
                            <input id="ellipse_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ellipse_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">angle</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ellipse_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ellipse_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ellipse_point-3764"><a href="#ellipse_point-3764"><span class="linenos">3764</span></a><span class="k">def</span> <span class="nf">ellipse_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
</span><span id="ellipse_point-3765"><a href="#ellipse_point-3765"><span class="linenos">3765</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a point on an ellipse with the given a=width/2, b=height/2, and angle.</span>
</span><span id="ellipse_point-3766"><a href="#ellipse_point-3766"><span class="linenos">3766</span></a>
</span><span id="ellipse_point-3767"><a href="#ellipse_point-3767"><span class="linenos">3767</span></a><span class="sd">    Args:</span>
</span><span id="ellipse_point-3768"><a href="#ellipse_point-3768"><span class="linenos">3768</span></a><span class="sd">        a (float): Semi-major axis of the ellipse.</span>
</span><span id="ellipse_point-3769"><a href="#ellipse_point-3769"><span class="linenos">3769</span></a><span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
</span><span id="ellipse_point-3770"><a href="#ellipse_point-3770"><span class="linenos">3770</span></a><span class="sd">        angle (float): Angle in radians.</span>
</span><span id="ellipse_point-3771"><a href="#ellipse_point-3771"><span class="linenos">3771</span></a>
</span><span id="ellipse_point-3772"><a href="#ellipse_point-3772"><span class="linenos">3772</span></a><span class="sd">    Returns:</span>
</span><span id="ellipse_point-3773"><a href="#ellipse_point-3773"><span class="linenos">3773</span></a><span class="sd">        Point: Point on the ellipse.</span>
</span><span id="ellipse_point-3774"><a href="#ellipse_point-3774"><span class="linenos">3774</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ellipse_point-3775"><a href="#ellipse_point-3775"><span class="linenos">3775</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">r_polar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="ellipse_point-3776"><a href="#ellipse_point-3776"><span class="linenos">3776</span></a>
</span><span id="ellipse_point-3777"><a href="#ellipse_point-3777"><span class="linenos">3777</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return a point on an ellipse with the given a=width/2, b=height/2, and angle.</p>

<p>Args:
    a (float): Semi-major axis of the ellipse.
    b (float): Semi-minor axis of the ellipse.
    angle (float): Angle in radians.</p>

<p>Returns:
    Point: Point on the ellipse.</p>
</div>


                </section>
                <section id="circle_line_intersection">
                            <input id="circle_line_intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_line_intersection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">p1</span>, </span><span class="param"><span class="n">p2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_line_intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_line_intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_line_intersection-3780"><a href="#circle_line_intersection-3780"><span class="linenos">3780</span></a><span class="k">def</span> <span class="nf">circle_line_intersection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
</span><span id="circle_line_intersection-3781"><a href="#circle_line_intersection-3781"><span class="linenos">3781</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the intersection points of a circle and a line segment.</span>
</span><span id="circle_line_intersection-3782"><a href="#circle_line_intersection-3782"><span class="linenos">3782</span></a>
</span><span id="circle_line_intersection-3783"><a href="#circle_line_intersection-3783"><span class="linenos">3783</span></a><span class="sd">    Args:</span>
</span><span id="circle_line_intersection-3784"><a href="#circle_line_intersection-3784"><span class="linenos">3784</span></a><span class="sd">        c (Circle): Input circle.</span>
</span><span id="circle_line_intersection-3785"><a href="#circle_line_intersection-3785"><span class="linenos">3785</span></a><span class="sd">        p1 (Point): First point of the line segment.</span>
</span><span id="circle_line_intersection-3786"><a href="#circle_line_intersection-3786"><span class="linenos">3786</span></a><span class="sd">        p2 (Point): Second point of the line segment.</span>
</span><span id="circle_line_intersection-3787"><a href="#circle_line_intersection-3787"><span class="linenos">3787</span></a>
</span><span id="circle_line_intersection-3788"><a href="#circle_line_intersection-3788"><span class="linenos">3788</span></a><span class="sd">    Returns:</span>
</span><span id="circle_line_intersection-3789"><a href="#circle_line_intersection-3789"><span class="linenos">3789</span></a><span class="sd">        tuple: Intersection points of the circle and the line segment.</span>
</span><span id="circle_line_intersection-3790"><a href="#circle_line_intersection-3790"><span class="linenos">3790</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_line_intersection-3791"><a href="#circle_line_intersection-3791"><span class="linenos">3791</span></a>
</span><span id="circle_line_intersection-3792"><a href="#circle_line_intersection-3792"><span class="linenos">3792</span></a>    <span class="c1"># adapted from http://mathworld.wolfram.com/Circle-LineIntersection.html</span>
</span><span id="circle_line_intersection-3793"><a href="#circle_line_intersection-3793"><span class="linenos">3793</span></a>    <span class="c1"># c is the circle and p1 and p2 are the line points</span>
</span><span id="circle_line_intersection-3794"><a href="#circle_line_intersection-3794"><span class="linenos">3794</span></a>    <span class="k">def</span> <span class="nf">sgn</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
</span><span id="circle_line_intersection-3795"><a href="#circle_line_intersection-3795"><span class="linenos">3795</span></a>        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="circle_line_intersection-3796"><a href="#circle_line_intersection-3796"><span class="linenos">3796</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="circle_line_intersection-3797"><a href="#circle_line_intersection-3797"><span class="linenos">3797</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="circle_line_intersection-3798"><a href="#circle_line_intersection-3798"><span class="linenos">3798</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="circle_line_intersection-3799"><a href="#circle_line_intersection-3799"><span class="linenos">3799</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="circle_line_intersection-3800"><a href="#circle_line_intersection-3800"><span class="linenos">3800</span></a>
</span><span id="circle_line_intersection-3801"><a href="#circle_line_intersection-3801"><span class="linenos">3801</span></a>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_line_intersection-3802"><a href="#circle_line_intersection-3802"><span class="linenos">3802</span></a>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_line_intersection-3803"><a href="#circle_line_intersection-3803"><span class="linenos">3803</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">radius</span>
</span><span id="circle_line_intersection-3804"><a href="#circle_line_intersection-3804"><span class="linenos">3804</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_line_intersection-3805"><a href="#circle_line_intersection-3805"><span class="linenos">3805</span></a>
</span><span id="circle_line_intersection-3806"><a href="#circle_line_intersection-3806"><span class="linenos">3806</span></a>    <span class="n">x1</span> <span class="o">-=</span> <span class="n">x</span>
</span><span id="circle_line_intersection-3807"><a href="#circle_line_intersection-3807"><span class="linenos">3807</span></a>    <span class="n">x2</span> <span class="o">-=</span> <span class="n">x</span>
</span><span id="circle_line_intersection-3808"><a href="#circle_line_intersection-3808"><span class="linenos">3808</span></a>    <span class="n">y1</span> <span class="o">-=</span> <span class="n">y</span>
</span><span id="circle_line_intersection-3809"><a href="#circle_line_intersection-3809"><span class="linenos">3809</span></a>    <span class="n">y2</span> <span class="o">-=</span> <span class="n">y</span>
</span><span id="circle_line_intersection-3810"><a href="#circle_line_intersection-3810"><span class="linenos">3810</span></a>
</span><span id="circle_line_intersection-3811"><a href="#circle_line_intersection-3811"><span class="linenos">3811</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
</span><span id="circle_line_intersection-3812"><a href="#circle_line_intersection-3812"><span class="linenos">3812</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
</span><span id="circle_line_intersection-3813"><a href="#circle_line_intersection-3813"><span class="linenos">3813</span></a>    <span class="n">dr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="circle_line_intersection-3814"><a href="#circle_line_intersection-3814"><span class="linenos">3814</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>
</span><span id="circle_line_intersection-3815"><a href="#circle_line_intersection-3815"><span class="linenos">3815</span></a>    <span class="n">d2</span> <span class="o">=</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span>
</span><span id="circle_line_intersection-3816"><a href="#circle_line_intersection-3816"><span class="linenos">3816</span></a>    <span class="n">r2</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
</span><span id="circle_line_intersection-3817"><a href="#circle_line_intersection-3817"><span class="linenos">3817</span></a>    <span class="n">dr2</span> <span class="o">=</span> <span class="n">dr</span><span class="o">**</span><span class="mi">2</span>
</span><span id="circle_line_intersection-3818"><a href="#circle_line_intersection-3818"><span class="linenos">3818</span></a>
</span><span id="circle_line_intersection-3819"><a href="#circle_line_intersection-3819"><span class="linenos">3819</span></a>    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">dr2</span> <span class="o">-</span> <span class="n">d2</span>
</span><span id="circle_line_intersection-3820"><a href="#circle_line_intersection-3820"><span class="linenos">3820</span></a>
</span><span id="circle_line_intersection-3821"><a href="#circle_line_intersection-3821"><span class="linenos">3821</span></a>    <span class="k">if</span> <span class="n">discriminant</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="circle_line_intersection-3822"><a href="#circle_line_intersection-3822"><span class="linenos">3822</span></a>        <span class="n">ddy</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dy</span>
</span><span id="circle_line_intersection-3823"><a href="#circle_line_intersection-3823"><span class="linenos">3823</span></a>        <span class="n">ddx</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dx</span>
</span><span id="circle_line_intersection-3824"><a href="#circle_line_intersection-3824"><span class="linenos">3824</span></a>        <span class="n">sqrterm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r2</span> <span class="o">*</span> <span class="n">dr2</span> <span class="o">-</span> <span class="n">d2</span><span class="p">)</span>
</span><span id="circle_line_intersection-3825"><a href="#circle_line_intersection-3825"><span class="linenos">3825</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">sgn</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sqrterm</span>
</span><span id="circle_line_intersection-3826"><a href="#circle_line_intersection-3826"><span class="linenos">3826</span></a>
</span><span id="circle_line_intersection-3827"><a href="#circle_line_intersection-3827"><span class="linenos">3827</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">ddy</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="circle_line_intersection-3828"><a href="#circle_line_intersection-3828"><span class="linenos">3828</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ddx</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrterm</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="circle_line_intersection-3829"><a href="#circle_line_intersection-3829"><span class="linenos">3829</span></a>        <span class="k">if</span> <span class="n">discriminant</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="circle_line_intersection-3830"><a href="#circle_line_intersection-3830"><span class="linenos">3830</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="circle_line_intersection-3831"><a href="#circle_line_intersection-3831"><span class="linenos">3831</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="circle_line_intersection-3832"><a href="#circle_line_intersection-3832"><span class="linenos">3832</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">ddy</span> <span class="o">-</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="circle_line_intersection-3833"><a href="#circle_line_intersection-3833"><span class="linenos">3833</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ddx</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrterm</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span>
</span><span id="circle_line_intersection-3834"><a href="#circle_line_intersection-3834"><span class="linenos">3834</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
</span><span id="circle_line_intersection-3835"><a href="#circle_line_intersection-3835"><span class="linenos">3835</span></a>
</span><span id="circle_line_intersection-3836"><a href="#circle_line_intersection-3836"><span class="linenos">3836</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="circle_line_intersection-3837"><a href="#circle_line_intersection-3837"><span class="linenos">3837</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="circle_line_intersection-3838"><a href="#circle_line_intersection-3838"><span class="linenos">3838</span></a>
</span><span id="circle_line_intersection-3839"><a href="#circle_line_intersection-3839"><span class="linenos">3839</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the intersection points of a circle and a line segment.</p>

<p>Args:
    c (Circle): Input circle.
    p1 (Point): First point of the line segment.
    p2 (Point): Second point of the line segment.</p>

<p>Returns:
    tuple: Intersection points of the circle and the line segment.</p>
</div>


                </section>
                <section id="circle_poly_intersection">
                            <input id="circle_poly_intersection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_poly_intersection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">circle</span>, </span><span class="param"><span class="n">polygon</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_poly_intersection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_poly_intersection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_poly_intersection-3842"><a href="#circle_poly_intersection-3842"><span class="linenos">3842</span></a><span class="k">def</span> <span class="nf">circle_poly_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
</span><span id="circle_poly_intersection-3843"><a href="#circle_poly_intersection-3843"><span class="linenos">3843</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the circle and the polygon intersect.</span>
</span><span id="circle_poly_intersection-3844"><a href="#circle_poly_intersection-3844"><span class="linenos">3844</span></a>
</span><span id="circle_poly_intersection-3845"><a href="#circle_poly_intersection-3845"><span class="linenos">3845</span></a><span class="sd">    Args:</span>
</span><span id="circle_poly_intersection-3846"><a href="#circle_poly_intersection-3846"><span class="linenos">3846</span></a><span class="sd">        circle (Circle): Input circle.</span>
</span><span id="circle_poly_intersection-3847"><a href="#circle_poly_intersection-3847"><span class="linenos">3847</span></a><span class="sd">        polygon (Polygon): Input polygon.</span>
</span><span id="circle_poly_intersection-3848"><a href="#circle_poly_intersection-3848"><span class="linenos">3848</span></a>
</span><span id="circle_poly_intersection-3849"><a href="#circle_poly_intersection-3849"><span class="linenos">3849</span></a><span class="sd">    Returns:</span>
</span><span id="circle_poly_intersection-3850"><a href="#circle_poly_intersection-3850"><span class="linenos">3850</span></a><span class="sd">        bool: True if the circle and the polygon intersect, False otherwise.</span>
</span><span id="circle_poly_intersection-3851"><a href="#circle_poly_intersection-3851"><span class="linenos">3851</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_poly_intersection-3852"><a href="#circle_poly_intersection-3852"><span class="linenos">3852</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="circle_poly_intersection-3853"><a href="#circle_poly_intersection-3853"><span class="linenos">3853</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="circle_poly_intersection-3854"><a href="#circle_poly_intersection-3854"><span class="linenos">3854</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="circle_poly_intersection-3855"><a href="#circle_poly_intersection-3855"><span class="linenos">3855</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="circle_poly_intersection-3856"><a href="#circle_poly_intersection-3856"><span class="linenos">3856</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="circle_poly_intersection-3857"><a href="#circle_poly_intersection-3857"><span class="linenos">3857</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="circle_poly_intersection-3858"><a href="#circle_poly_intersection-3858"><span class="linenos">3858</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="circle_poly_intersection-3859"><a href="#circle_poly_intersection-3859"><span class="linenos">3859</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="circle_poly_intersection-3860"><a href="#circle_poly_intersection-3860"><span class="linenos">3860</span></a>        <span class="k">if</span> <span class="n">circle_segment_intersection</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)):</span>
</span><span id="circle_poly_intersection-3861"><a href="#circle_poly_intersection-3861"><span class="linenos">3861</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="circle_poly_intersection-3862"><a href="#circle_poly_intersection-3862"><span class="linenos">3862</span></a>            <span class="k">break</span>
</span><span id="circle_poly_intersection-3863"><a href="#circle_poly_intersection-3863"><span class="linenos">3863</span></a>    <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the circle and the polygon intersect.</p>

<p>Args:
    circle (Circle): Input circle.
    polygon (Polygon): Input polygon.</p>

<p>Returns:
    bool: True if the circle and the polygon intersect, False otherwise.</p>
</div>


                </section>
                <section id="point_to_circle_distance">
                            <input id="point_to_circle_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_to_circle_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span>, </span><span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="point_to_circle_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#point_to_circle_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="point_to_circle_distance-3866"><a href="#point_to_circle_distance-3866"><span class="linenos">3866</span></a><span class="k">def</span> <span class="nf">point_to_circle_distance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
</span><span id="point_to_circle_distance-3867"><a href="#point_to_circle_distance-3867"><span class="linenos">3867</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point, center point, and radius, returns distance</span>
</span><span id="point_to_circle_distance-3868"><a href="#point_to_circle_distance-3868"><span class="linenos">3868</span></a><span class="sd">    between the given point and the circle</span>
</span><span id="point_to_circle_distance-3869"><a href="#point_to_circle_distance-3869"><span class="linenos">3869</span></a>
</span><span id="point_to_circle_distance-3870"><a href="#point_to_circle_distance-3870"><span class="linenos">3870</span></a><span class="sd">    Args:</span>
</span><span id="point_to_circle_distance-3871"><a href="#point_to_circle_distance-3871"><span class="linenos">3871</span></a><span class="sd">        point (Point): Input point.</span>
</span><span id="point_to_circle_distance-3872"><a href="#point_to_circle_distance-3872"><span class="linenos">3872</span></a><span class="sd">        center (Point): Center of the circle.</span>
</span><span id="point_to_circle_distance-3873"><a href="#point_to_circle_distance-3873"><span class="linenos">3873</span></a><span class="sd">        radius (float): Radius of the circle.</span>
</span><span id="point_to_circle_distance-3874"><a href="#point_to_circle_distance-3874"><span class="linenos">3874</span></a>
</span><span id="point_to_circle_distance-3875"><a href="#point_to_circle_distance-3875"><span class="linenos">3875</span></a><span class="sd">    Returns:</span>
</span><span id="point_to_circle_distance-3876"><a href="#point_to_circle_distance-3876"><span class="linenos">3876</span></a><span class="sd">        float: Distance between the point and the circle.</span>
</span><span id="point_to_circle_distance-3877"><a href="#point_to_circle_distance-3877"><span class="linenos">3877</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="point_to_circle_distance-3878"><a href="#point_to_circle_distance-3878"><span class="linenos">3878</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">-</span> <span class="n">radius</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given a point, center point, and radius, returns distance
between the given point and the circle</p>

<p>Args:
    point (Point): Input point.
    center (Point): Center of the circle.
    radius (float): Radius of the circle.</p>

<p>Returns:
    float: Distance between the point and the circle.</p>
</div>


                </section>
                <section id="get_interior_points">
                            <input id="get_interior_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_interior_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">start</span>, </span><span class="param"><span class="n">end</span>, </span><span class="param"><span class="n">n_points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_interior_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_interior_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_interior_points-3881"><a href="#get_interior_points-3881"><span class="linenos">3881</span></a><span class="k">def</span> <span class="nf">get_interior_points</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">n_points</span><span class="p">):</span>
</span><span id="get_interior_points-3882"><a href="#get_interior_points-3882"><span class="linenos">3882</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given start and end points and number of interior points</span>
</span><span id="get_interior_points-3883"><a href="#get_interior_points-3883"><span class="linenos">3883</span></a><span class="sd">    returns the positions of the interior points</span>
</span><span id="get_interior_points-3884"><a href="#get_interior_points-3884"><span class="linenos">3884</span></a>
</span><span id="get_interior_points-3885"><a href="#get_interior_points-3885"><span class="linenos">3885</span></a><span class="sd">    Args:</span>
</span><span id="get_interior_points-3886"><a href="#get_interior_points-3886"><span class="linenos">3886</span></a><span class="sd">        start (Point): Start point.</span>
</span><span id="get_interior_points-3887"><a href="#get_interior_points-3887"><span class="linenos">3887</span></a><span class="sd">        end (Point): End point.</span>
</span><span id="get_interior_points-3888"><a href="#get_interior_points-3888"><span class="linenos">3888</span></a><span class="sd">        n_points (int): Number of interior points.</span>
</span><span id="get_interior_points-3889"><a href="#get_interior_points-3889"><span class="linenos">3889</span></a>
</span><span id="get_interior_points-3890"><a href="#get_interior_points-3890"><span class="linenos">3890</span></a><span class="sd">    Returns:</span>
</span><span id="get_interior_points-3891"><a href="#get_interior_points-3891"><span class="linenos">3891</span></a><span class="sd">        list[Point]: List of interior points.</span>
</span><span id="get_interior_points-3892"><a href="#get_interior_points-3892"><span class="linenos">3892</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_interior_points-3893"><a href="#get_interior_points-3893"><span class="linenos">3893</span></a>    <span class="n">rot_angle</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="get_interior_points-3894"><a href="#get_interior_points-3894"><span class="linenos">3894</span></a>    <span class="n">length_</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="get_interior_points-3895"><a href="#get_interior_points-3895"><span class="linenos">3895</span></a>    <span class="n">seg_length</span> <span class="o">=</span> <span class="n">length_</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="get_interior_points-3896"><a href="#get_interior_points-3896"><span class="linenos">3896</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_interior_points-3897"><a href="#get_interior_points-3897"><span class="linenos">3897</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
</span><span id="get_interior_points-3898"><a href="#get_interior_points-3898"><span class="linenos">3898</span></a>        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_interior_points-3899"><a href="#get_interior_points-3899"><span class="linenos">3899</span></a>            <span class="n">rotate_point</span><span class="p">([</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seg_length</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">start</span><span class="p">,</span> <span class="n">rot_angle</span><span class="p">)</span>
</span><span id="get_interior_points-3900"><a href="#get_interior_points-3900"><span class="linenos">3900</span></a>        <span class="p">)</span>
</span><span id="get_interior_points-3901"><a href="#get_interior_points-3901"><span class="linenos">3901</span></a>    <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>Given start and end points and number of interior points
returns the positions of the interior points</p>

<p>Args:
    start (Point): Start point.
    end (Point): End point.
    n_points (int): Number of interior points.</p>

<p>Returns:
    list[Point]: List of interior points.</p>
</div>


                </section>
                <section id="circle_3point">
                            <input id="circle_3point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_3point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point1</span>, </span><span class="param"><span class="n">point2</span>, </span><span class="param"><span class="n">point3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="circle_3point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#circle_3point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="circle_3point-3904"><a href="#circle_3point-3904"><span class="linenos">3904</span></a><span class="k">def</span> <span class="nf">circle_3point</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">):</span>
</span><span id="circle_3point-3905"><a href="#circle_3point-3905"><span class="linenos">3905</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given three points, returns the center point and radius</span>
</span><span id="circle_3point-3906"><a href="#circle_3point-3906"><span class="linenos">3906</span></a>
</span><span id="circle_3point-3907"><a href="#circle_3point-3907"><span class="linenos">3907</span></a><span class="sd">    Args:</span>
</span><span id="circle_3point-3908"><a href="#circle_3point-3908"><span class="linenos">3908</span></a><span class="sd">        point1 (Point): First point.</span>
</span><span id="circle_3point-3909"><a href="#circle_3point-3909"><span class="linenos">3909</span></a><span class="sd">        point2 (Point): Second point.</span>
</span><span id="circle_3point-3910"><a href="#circle_3point-3910"><span class="linenos">3910</span></a><span class="sd">        point3 (Point): Third point.</span>
</span><span id="circle_3point-3911"><a href="#circle_3point-3911"><span class="linenos">3911</span></a>
</span><span id="circle_3point-3912"><a href="#circle_3point-3912"><span class="linenos">3912</span></a><span class="sd">    Returns:</span>
</span><span id="circle_3point-3913"><a href="#circle_3point-3913"><span class="linenos">3913</span></a><span class="sd">        tuple: Center point and radius of the circle.</span>
</span><span id="circle_3point-3914"><a href="#circle_3point-3914"><span class="linenos">3914</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="circle_3point-3915"><a href="#circle_3point-3915"><span class="linenos">3915</span></a>    <span class="n">ax</span><span class="p">,</span> <span class="n">ay</span> <span class="o">=</span> <span class="n">point1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_3point-3916"><a href="#circle_3point-3916"><span class="linenos">3916</span></a>    <span class="n">bx</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">point2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_3point-3917"><a href="#circle_3point-3917"><span class="linenos">3917</span></a>    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">point3</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="circle_3point-3918"><a href="#circle_3point-3918"><span class="linenos">3918</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">bx</span> <span class="o">-</span> <span class="n">ax</span>
</span><span id="circle_3point-3919"><a href="#circle_3point-3919"><span class="linenos">3919</span></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">by</span> <span class="o">-</span> <span class="n">ay</span>
</span><span id="circle_3point-3920"><a href="#circle_3point-3920"><span class="linenos">3920</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">ax</span>
</span><span id="circle_3point-3921"><a href="#circle_3point-3921"><span class="linenos">3921</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">-</span> <span class="n">ay</span>
</span><span id="circle_3point-3922"><a href="#circle_3point-3922"><span class="linenos">3922</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">ax</span> <span class="o">+</span> <span class="n">bx</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">ay</span> <span class="o">+</span> <span class="n">by</span><span class="p">)</span>
</span><span id="circle_3point-3923"><a href="#circle_3point-3923"><span class="linenos">3923</span></a>    <span class="n">f</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">ax</span> <span class="o">+</span> <span class="n">cx</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">ay</span> <span class="o">+</span> <span class="n">cy</span><span class="p">)</span>
</span><span id="circle_3point-3924"><a href="#circle_3point-3924"><span class="linenos">3924</span></a>    <span class="n">g</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">by</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">bx</span><span class="p">))</span>
</span><span id="circle_3point-3925"><a href="#circle_3point-3925"><span class="linenos">3925</span></a>    <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="circle_3point-3926"><a href="#circle_3point-3926"><span class="linenos">3926</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Points are collinear!&quot;</span><span class="p">)</span>
</span><span id="circle_3point-3927"><a href="#circle_3point-3927"><span class="linenos">3927</span></a>
</span><span id="circle_3point-3928"><a href="#circle_3point-3928"><span class="linenos">3928</span></a>    <span class="n">px</span> <span class="o">=</span> <span class="p">((</span><span class="n">d</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">f</span><span class="p">))</span> <span class="o">/</span> <span class="n">g</span>
</span><span id="circle_3point-3929"><a href="#circle_3point-3929"><span class="linenos">3929</span></a>    <span class="n">py</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">e</span><span class="p">))</span> <span class="o">/</span> <span class="n">g</span>
</span><span id="circle_3point-3930"><a href="#circle_3point-3930"><span class="linenos">3930</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="n">ax</span> <span class="o">-</span> <span class="n">px</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ay</span> <span class="o">-</span> <span class="n">py</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="circle_3point-3931"><a href="#circle_3point-3931"><span class="linenos">3931</span></a>    <span class="k">return</span> <span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given three points, returns the center point and radius</p>

<p>Args:
    point1 (Point): First point.
    point2 (Point): Second point.
    point3 (Point): Third point.</p>

<p>Returns:
    tuple: Center point and radius of the circle.</p>
</div>


                </section>
                <section id="project_point_on_line">
                            <input id="project_point_on_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">project_point_on_line</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="project_point_on_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#project_point_on_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="project_point_on_line-3934"><a href="#project_point_on_line-3934"><span class="linenos">3934</span></a><span class="k">def</span> <span class="nf">project_point_on_line</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Vertex</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Edge</span><span class="p">):</span>
</span><span id="project_point_on_line-3935"><a href="#project_point_on_line-3935"><span class="linenos">3935</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a point and a line, returns the projection of the point on the line</span>
</span><span id="project_point_on_line-3936"><a href="#project_point_on_line-3936"><span class="linenos">3936</span></a>
</span><span id="project_point_on_line-3937"><a href="#project_point_on_line-3937"><span class="linenos">3937</span></a><span class="sd">    Args:</span>
</span><span id="project_point_on_line-3938"><a href="#project_point_on_line-3938"><span class="linenos">3938</span></a><span class="sd">        point (Vertex): Input point.</span>
</span><span id="project_point_on_line-3939"><a href="#project_point_on_line-3939"><span class="linenos">3939</span></a><span class="sd">        line (Edge): Input line.</span>
</span><span id="project_point_on_line-3940"><a href="#project_point_on_line-3940"><span class="linenos">3940</span></a>
</span><span id="project_point_on_line-3941"><a href="#project_point_on_line-3941"><span class="linenos">3941</span></a><span class="sd">    Returns:</span>
</span><span id="project_point_on_line-3942"><a href="#project_point_on_line-3942"><span class="linenos">3942</span></a><span class="sd">        Vertex: Projection of the point on the line.</span>
</span><span id="project_point_on_line-3943"><a href="#project_point_on_line-3943"><span class="linenos">3943</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="project_point_on_line-3944"><a href="#project_point_on_line-3944"><span class="linenos">3944</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="project_point_on_line-3945"><a href="#project_point_on_line-3945"><span class="linenos">3945</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="project_point_on_line-3946"><a href="#project_point_on_line-3946"><span class="linenos">3946</span></a>
</span><span id="project_point_on_line-3947"><a href="#project_point_on_line-3947"><span class="linenos">3947</span></a>    <span class="n">av</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">a</span>
</span><span id="project_point_on_line-3948"><a href="#project_point_on_line-3948"><span class="linenos">3948</span></a>    <span class="n">ab</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span>
</span><span id="project_point_on_line-3949"><a href="#project_point_on_line-3949"><span class="linenos">3949</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">av</span> <span class="o">*</span> <span class="n">ab</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ab</span> <span class="o">*</span> <span class="n">ab</span><span class="p">)</span>
</span><span id="project_point_on_line-3950"><a href="#project_point_on_line-3950"><span class="linenos">3950</span></a>    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="project_point_on_line-3951"><a href="#project_point_on_line-3951"><span class="linenos">3951</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="project_point_on_line-3952"><a href="#project_point_on_line-3952"><span class="linenos">3952</span></a>    <span class="k">elif</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span><span id="project_point_on_line-3953"><a href="#project_point_on_line-3953"><span class="linenos">3953</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="project_point_on_line-3954"><a href="#project_point_on_line-3954"><span class="linenos">3954</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">ab</span> <span class="o">*</span> <span class="n">t</span>
</span></pre></div>


            <div class="docstring"><p>Given a point and a line, returns the projection of the point on the line</p>

<p>Args:
    point (Vertex): Input point.
    line (Edge): Input line.</p>

<p>Returns:
    Vertex: Projection of the point on the line.</p>
</div>


                </section>
                <section id="Vertex">
                            <input id="Vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Vertex</span><wbr>(<span class="base">builtins.list</span>):

                <label class="view-source-button" for="Vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex-3957"><a href="#Vertex-3957"><span class="linenos">3957</span></a><span class="k">class</span> <span class="nc">Vertex</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Vertex-3958"><a href="#Vertex-3958"><span class="linenos">3958</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A 3D vertex.&quot;&quot;&quot;</span>
</span><span id="Vertex-3959"><a href="#Vertex-3959"><span class="linenos">3959</span></a>
</span><span id="Vertex-3960"><a href="#Vertex-3960"><span class="linenos">3960</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Vertex-3961"><a href="#Vertex-3961"><span class="linenos">3961</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Vertex-3962"><a href="#Vertex-3962"><span class="linenos">3962</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="Vertex-3963"><a href="#Vertex-3963"><span class="linenos">3963</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
</span><span id="Vertex-3964"><a href="#Vertex-3964"><span class="linenos">3964</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">VERTEX</span>
</span><span id="Vertex-3965"><a href="#Vertex-3965"><span class="linenos">3965</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Vertex-3966"><a href="#Vertex-3966"><span class="linenos">3966</span></a>
</span><span id="Vertex-3967"><a href="#Vertex-3967"><span class="linenos">3967</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-3968"><a href="#Vertex-3968"><span class="linenos">3968</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Vertex-3969"><a href="#Vertex-3969"><span class="linenos">3969</span></a>
</span><span id="Vertex-3970"><a href="#Vertex-3970"><span class="linenos">3970</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex-3971"><a href="#Vertex-3971"><span class="linenos">3971</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Vertex-3972"><a href="#Vertex-3972"><span class="linenos">3972</span></a>
</span><span id="Vertex-3973"><a href="#Vertex-3973"><span class="linenos">3973</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-3974"><a href="#Vertex-3974"><span class="linenos">3974</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="Vertex-3975"><a href="#Vertex-3975"><span class="linenos">3975</span></a>
</span><span id="Vertex-3976"><a href="#Vertex-3976"><span class="linenos">3976</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex-3977"><a href="#Vertex-3977"><span class="linenos">3977</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="Vertex-3978"><a href="#Vertex-3978"><span class="linenos">3978</span></a>
</span><span id="Vertex-3979"><a href="#Vertex-3979"><span class="linenos">3979</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex-3980"><a href="#Vertex-3980"><span class="linenos">3980</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="Vertex-3981"><a href="#Vertex-3981"><span class="linenos">3981</span></a>
</span><span id="Vertex-3982"><a href="#Vertex-3982"><span class="linenos">3982</span></a>    <span class="nd">@property</span>
</span><span id="Vertex-3983"><a href="#Vertex-3983"><span class="linenos">3983</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-3984"><a href="#Vertex-3984"><span class="linenos">3984</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the coordinates as a tuple.&quot;&quot;&quot;</span>
</span><span id="Vertex-3985"><a href="#Vertex-3985"><span class="linenos">3985</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="Vertex-3986"><a href="#Vertex-3986"><span class="linenos">3986</span></a>
</span><span id="Vertex-3987"><a href="#Vertex-3987"><span class="linenos">3987</span></a>    <span class="nd">@property</span>
</span><span id="Vertex-3988"><a href="#Vertex-3988"><span class="linenos">3988</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-3989"><a href="#Vertex-3989"><span class="linenos">3989</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="Vertex-3990"><a href="#Vertex-3990"><span class="linenos">3990</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Vertex-3991"><a href="#Vertex-3991"><span class="linenos">3991</span></a>
</span><span id="Vertex-3992"><a href="#Vertex-3992"><span class="linenos">3992</span></a>    <span class="k">def</span> <span class="nf">v_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-3993"><a href="#Vertex-3993"><span class="linenos">3993</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertex as a tuple.&quot;&quot;&quot;</span>
</span><span id="Vertex-3994"><a href="#Vertex-3994"><span class="linenos">3994</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span><span id="Vertex-3995"><a href="#Vertex-3995"><span class="linenos">3995</span></a>
</span><span id="Vertex-3996"><a href="#Vertex-3996"><span class="linenos">3996</span></a>    <span class="k">def</span> <span class="nf">below</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex-3997"><a href="#Vertex-3997"><span class="linenos">3997</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="Vertex-3998"><a href="#Vertex-3998"><span class="linenos">3998</span></a>
</span><span id="Vertex-3999"><a href="#Vertex-3999"><span class="linenos">3999</span></a><span class="sd">        Args:</span>
</span><span id="Vertex-4000"><a href="#Vertex-4000"><span class="linenos">4000</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="Vertex-4001"><a href="#Vertex-4001"><span class="linenos">4001</span></a>
</span><span id="Vertex-4002"><a href="#Vertex-4002"><span class="linenos">4002</span></a><span class="sd">        Returns:</span>
</span><span id="Vertex-4003"><a href="#Vertex-4003"><span class="linenos">4003</span></a><span class="sd">            bool: True if this vertex is below the other vertex, False otherwise.</span>
</span><span id="Vertex-4004"><a href="#Vertex-4004"><span class="linenos">4004</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Vertex-4005"><a href="#Vertex-4005"><span class="linenos">4005</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Vertex-4006"><a href="#Vertex-4006"><span class="linenos">4006</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex-4007"><a href="#Vertex-4007"><span class="linenos">4007</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-4008"><a href="#Vertex-4008"><span class="linenos">4008</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex-4009"><a href="#Vertex-4009"><span class="linenos">4009</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="Vertex-4010"><a href="#Vertex-4010"><span class="linenos">4010</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-4011"><a href="#Vertex-4011"><span class="linenos">4011</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Vertex-4012"><a href="#Vertex-4012"><span class="linenos">4012</span></a>
</span><span id="Vertex-4013"><a href="#Vertex-4013"><span class="linenos">4013</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex-4014"><a href="#Vertex-4014"><span class="linenos">4014</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="Vertex-4015"><a href="#Vertex-4015"><span class="linenos">4015</span></a>
</span><span id="Vertex-4016"><a href="#Vertex-4016"><span class="linenos">4016</span></a><span class="sd">        Args:</span>
</span><span id="Vertex-4017"><a href="#Vertex-4017"><span class="linenos">4017</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="Vertex-4018"><a href="#Vertex-4018"><span class="linenos">4018</span></a>
</span><span id="Vertex-4019"><a href="#Vertex-4019"><span class="linenos">4019</span></a><span class="sd">        Returns:</span>
</span><span id="Vertex-4020"><a href="#Vertex-4020"><span class="linenos">4020</span></a><span class="sd">            bool: True if this vertex is above the other vertex, False otherwise.</span>
</span><span id="Vertex-4021"><a href="#Vertex-4021"><span class="linenos">4021</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Vertex-4022"><a href="#Vertex-4022"><span class="linenos">4022</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex-4023"><a href="#Vertex-4023"><span class="linenos">4023</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-4024"><a href="#Vertex-4024"><span class="linenos">4024</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="Vertex-4025"><a href="#Vertex-4025"><span class="linenos">4025</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-4026"><a href="#Vertex-4026"><span class="linenos">4026</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Vertex-4027"><a href="#Vertex-4027"><span class="linenos">4027</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Vertex-4028"><a href="#Vertex-4028"><span class="linenos">4028</span></a>
</span><span id="Vertex-4029"><a href="#Vertex-4029"><span class="linenos">4029</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>A 3D vertex.</p>
</div>


                            <div id="Vertex.__init__" class="classattr">
                                        <input id="Vertex.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">z</span><span class="o">=</span><span class="mi">0</span></span>)</span>

                <label class="view-source-button" for="Vertex.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.__init__-3960"><a href="#Vertex.__init__-3960"><span class="linenos">3960</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Vertex.__init__-3961"><a href="#Vertex.__init__-3961"><span class="linenos">3961</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Vertex.__init__-3962"><a href="#Vertex.__init__-3962"><span class="linenos">3962</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="Vertex.__init__-3963"><a href="#Vertex.__init__-3963"><span class="linenos">3963</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
</span><span id="Vertex.__init__-3964"><a href="#Vertex.__init__-3964"><span class="linenos">3964</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">VERTEX</span>
</span><span id="Vertex.__init__-3965"><a href="#Vertex.__init__-3965"><span class="linenos">3965</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Vertex.x" class="classattr">
                                <div class="attr variable">
            <span class="name">x</span>

        
    </div>
    <a class="headerlink" href="#Vertex.x"></a>
    
    

                            </div>
                            <div id="Vertex.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span>

        
    </div>
    <a class="headerlink" href="#Vertex.y"></a>
    
    

                            </div>
                            <div id="Vertex.z" class="classattr">
                                <div class="attr variable">
            <span class="name">z</span>

        
    </div>
    <a class="headerlink" href="#Vertex.z"></a>
    
    

                            </div>
                            <div id="Vertex.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span>

        
    </div>
    <a class="headerlink" href="#Vertex.type"></a>
    
    

                            </div>
                            <div id="Vertex.copy" class="classattr">
                                        <input id="Vertex.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.copy-3973"><a href="#Vertex.copy-3973"><span class="linenos">3973</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex.copy-3974"><a href="#Vertex.copy-3974"><span class="linenos">3974</span></a>        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a shallow copy of the list.</p>
</div>


                            </div>
                            <div id="Vertex.coords" class="classattr">
                                        <input id="Vertex.coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">coords</span>

                <label class="view-source-button" for="Vertex.coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.coords-3982"><a href="#Vertex.coords-3982"><span class="linenos">3982</span></a>    <span class="nd">@property</span>
</span><span id="Vertex.coords-3983"><a href="#Vertex.coords-3983"><span class="linenos">3983</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex.coords-3984"><a href="#Vertex.coords-3984"><span class="linenos">3984</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the coordinates as a tuple.&quot;&quot;&quot;</span>
</span><span id="Vertex.coords-3985"><a href="#Vertex.coords-3985"><span class="linenos">3985</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the coordinates as a tuple.</p>
</div>


                            </div>
                            <div id="Vertex.array" class="classattr">
                                        <input id="Vertex.array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">array</span>

                <label class="view-source-button" for="Vertex.array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.array-3987"><a href="#Vertex.array-3987"><span class="linenos">3987</span></a>    <span class="nd">@property</span>
</span><span id="Vertex.array-3988"><a href="#Vertex.array-3988"><span class="linenos">3988</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex.array-3989"><a href="#Vertex.array-3989"><span class="linenos">3989</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="Vertex.array-3990"><a href="#Vertex.array-3990"><span class="linenos">3990</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Homogeneous coordinates as a numpy array.</p>
</div>


                            </div>
                            <div id="Vertex.v_tuple" class="classattr">
                                        <input id="Vertex.v_tuple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">v_tuple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.v_tuple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.v_tuple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.v_tuple-3992"><a href="#Vertex.v_tuple-3992"><span class="linenos">3992</span></a>    <span class="k">def</span> <span class="nf">v_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex.v_tuple-3993"><a href="#Vertex.v_tuple-3993"><span class="linenos">3993</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertex as a tuple.&quot;&quot;&quot;</span>
</span><span id="Vertex.v_tuple-3994"><a href="#Vertex.v_tuple-3994"><span class="linenos">3994</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the vertex as a tuple.</p>
</div>


                            </div>
                            <div id="Vertex.below" class="classattr">
                                        <input id="Vertex.below-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">below</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.below-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.below"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.below-3996"><a href="#Vertex.below-3996"><span class="linenos">3996</span></a>    <span class="k">def</span> <span class="nf">below</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex.below-3997"><a href="#Vertex.below-3997"><span class="linenos">3997</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="Vertex.below-3998"><a href="#Vertex.below-3998"><span class="linenos">3998</span></a>
</span><span id="Vertex.below-3999"><a href="#Vertex.below-3999"><span class="linenos">3999</span></a><span class="sd">        Args:</span>
</span><span id="Vertex.below-4000"><a href="#Vertex.below-4000"><span class="linenos">4000</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="Vertex.below-4001"><a href="#Vertex.below-4001"><span class="linenos">4001</span></a>
</span><span id="Vertex.below-4002"><a href="#Vertex.below-4002"><span class="linenos">4002</span></a><span class="sd">        Returns:</span>
</span><span id="Vertex.below-4003"><a href="#Vertex.below-4003"><span class="linenos">4003</span></a><span class="sd">            bool: True if this vertex is below the other vertex, False otherwise.</span>
</span><span id="Vertex.below-4004"><a href="#Vertex.below-4004"><span class="linenos">4004</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Vertex.below-4005"><a href="#Vertex.below-4005"><span class="linenos">4005</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Vertex.below-4006"><a href="#Vertex.below-4006"><span class="linenos">4006</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex.below-4007"><a href="#Vertex.below-4007"><span class="linenos">4007</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex.below-4008"><a href="#Vertex.below-4008"><span class="linenos">4008</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex.below-4009"><a href="#Vertex.below-4009"><span class="linenos">4009</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="Vertex.below-4010"><a href="#Vertex.below-4010"><span class="linenos">4010</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex.below-4011"><a href="#Vertex.below-4011"><span class="linenos">4011</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>This is for 2D points only</p>

<p>Args:
    other (Vertex): Other vertex.</p>

<p>Returns:
    bool: True if this vertex is below the other vertex, False otherwise.</p>
</div>


                            </div>
                            <div id="Vertex.above" class="classattr">
                                        <input id="Vertex.above-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">above</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.above-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.above"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.above-4013"><a href="#Vertex.above-4013"><span class="linenos">4013</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Vertex.above-4014"><a href="#Vertex.above-4014"><span class="linenos">4014</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This is for 2D points only</span>
</span><span id="Vertex.above-4015"><a href="#Vertex.above-4015"><span class="linenos">4015</span></a>
</span><span id="Vertex.above-4016"><a href="#Vertex.above-4016"><span class="linenos">4016</span></a><span class="sd">        Args:</span>
</span><span id="Vertex.above-4017"><a href="#Vertex.above-4017"><span class="linenos">4017</span></a><span class="sd">            other (Vertex): Other vertex.</span>
</span><span id="Vertex.above-4018"><a href="#Vertex.above-4018"><span class="linenos">4018</span></a>
</span><span id="Vertex.above-4019"><a href="#Vertex.above-4019"><span class="linenos">4019</span></a><span class="sd">        Returns:</span>
</span><span id="Vertex.above-4020"><a href="#Vertex.above-4020"><span class="linenos">4020</span></a><span class="sd">            bool: True if this vertex is above the other vertex, False otherwise.</span>
</span><span id="Vertex.above-4021"><a href="#Vertex.above-4021"><span class="linenos">4021</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Vertex.above-4022"><a href="#Vertex.above-4022"><span class="linenos">4022</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
</span><span id="Vertex.above-4023"><a href="#Vertex.above-4023"><span class="linenos">4023</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex.above-4024"><a href="#Vertex.above-4024"><span class="linenos">4024</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
</span><span id="Vertex.above-4025"><a href="#Vertex.above-4025"><span class="linenos">4025</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex.above-4026"><a href="#Vertex.above-4026"><span class="linenos">4026</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Vertex.above-4027"><a href="#Vertex.above-4027"><span class="linenos">4027</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Vertex.above-4028"><a href="#Vertex.above-4028"><span class="linenos">4028</span></a>
</span><span id="Vertex.above-4029"><a href="#Vertex.above-4029"><span class="linenos">4029</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>This is for 2D points only</p>

<p>Args:
    other (Vertex): Other vertex.</p>

<p>Returns:
    bool: True if this vertex is above the other vertex, False otherwise.</p>
</div>


                            </div>
                </section>
                <section id="Edge">
                            <input id="Edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Edge</span>:

                <label class="view-source-button" for="Edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge-4032"><a href="#Edge-4032"><span class="linenos">4032</span></a><span class="k">class</span> <span class="nc">Edge</span><span class="p">:</span>
</span><span id="Edge-4033"><a href="#Edge-4033"><span class="linenos">4033</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A 2D edge.&quot;&quot;&quot;</span>
</span><span id="Edge-4034"><a href="#Edge-4034"><span class="linenos">4034</span></a>
</span><span id="Edge-4035"><a href="#Edge-4035"><span class="linenos">4035</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Edge-4036"><a href="#Edge-4036"><span class="linenos">4036</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">start_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">],</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">]</span>
</span><span id="Edge-4037"><a href="#Edge-4037"><span class="linenos">4037</span></a>    <span class="p">):</span>
</span><span id="Edge-4038"><a href="#Edge-4038"><span class="linenos">4038</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="Edge-4039"><a href="#Edge-4039"><span class="linenos">4039</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">start_point</span><span class="p">)</span>
</span><span id="Edge-4040"><a href="#Edge-4040"><span class="linenos">4040</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="Edge-4041"><a href="#Edge-4041"><span class="linenos">4041</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">start_point</span>
</span><span id="Edge-4042"><a href="#Edge-4042"><span class="linenos">4042</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-4043"><a href="#Edge-4043"><span class="linenos">4043</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Start point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="Edge-4044"><a href="#Edge-4044"><span class="linenos">4044</span></a>
</span><span id="Edge-4045"><a href="#Edge-4045"><span class="linenos">4045</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="Edge-4046"><a href="#Edge-4046"><span class="linenos">4046</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">end_point</span><span class="p">)</span>
</span><span id="Edge-4047"><a href="#Edge-4047"><span class="linenos">4047</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="Edge-4048"><a href="#Edge-4048"><span class="linenos">4048</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">end_point</span>
</span><span id="Edge-4049"><a href="#Edge-4049"><span class="linenos">4049</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-4050"><a href="#Edge-4050"><span class="linenos">4050</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;End point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="Edge-4051"><a href="#Edge-4051"><span class="linenos">4051</span></a>
</span><span id="Edge-4052"><a href="#Edge-4052"><span class="linenos">4052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="Edge-4053"><a href="#Edge-4053"><span class="linenos">4053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="Edge-4054"><a href="#Edge-4054"><span class="linenos">4054</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">EDGE</span>
</span><span id="Edge-4055"><a href="#Edge-4055"><span class="linenos">4055</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Edge-4056"><a href="#Edge-4056"><span class="linenos">4056</span></a>
</span><span id="Edge-4057"><a href="#Edge-4057"><span class="linenos">4057</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4058"><a href="#Edge-4058"><span class="linenos">4058</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Edge-4059"><a href="#Edge-4059"><span class="linenos">4059</span></a>
</span><span id="Edge-4060"><a href="#Edge-4060"><span class="linenos">4060</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4061"><a href="#Edge-4061"><span class="linenos">4061</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Edge-4062"><a href="#Edge-4062"><span class="linenos">4062</span></a>
</span><span id="Edge-4063"><a href="#Edge-4063"><span class="linenos">4063</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Edge-4064"><a href="#Edge-4064"><span class="linenos">4064</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span>
</span><span id="Edge-4065"><a href="#Edge-4065"><span class="linenos">4065</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span>
</span><span id="Edge-4066"><a href="#Edge-4066"><span class="linenos">4066</span></a>
</span><span id="Edge-4067"><a href="#Edge-4067"><span class="linenos">4067</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Edge-4068"><a href="#Edge-4068"><span class="linenos">4068</span></a>            <span class="n">isclose</span><span class="p">(</span>
</span><span id="Edge-4069"><a href="#Edge-4069"><span class="linenos">4069</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="Edge-4070"><a href="#Edge-4070"><span class="linenos">4070</span></a>            <span class="p">)</span>
</span><span id="Edge-4071"><a href="#Edge-4071"><span class="linenos">4071</span></a>            <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="Edge-4072"><a href="#Edge-4072"><span class="linenos">4072</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="Edge-4073"><a href="#Edge-4073"><span class="linenos">4073</span></a>            <span class="p">)</span>
</span><span id="Edge-4074"><a href="#Edge-4074"><span class="linenos">4074</span></a>        <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="Edge-4075"><a href="#Edge-4075"><span class="linenos">4075</span></a>            <span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">])</span>
</span><span id="Edge-4076"><a href="#Edge-4076"><span class="linenos">4076</span></a>            <span class="ow">and</span> <span class="n">isclose</span><span class="p">(</span>
</span><span id="Edge-4077"><a href="#Edge-4077"><span class="linenos">4077</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;atol&quot;</span><span class="p">]</span>
</span><span id="Edge-4078"><a href="#Edge-4078"><span class="linenos">4078</span></a>            <span class="p">)</span>
</span><span id="Edge-4079"><a href="#Edge-4079"><span class="linenos">4079</span></a>        <span class="p">)</span>
</span><span id="Edge-4080"><a href="#Edge-4080"><span class="linenos">4080</span></a>
</span><span id="Edge-4081"><a href="#Edge-4081"><span class="linenos">4081</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscript</span><span class="p">):</span>
</span><span id="Edge-4082"><a href="#Edge-4082"><span class="linenos">4082</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Edge-4083"><a href="#Edge-4083"><span class="linenos">4083</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="Edge-4084"><a href="#Edge-4084"><span class="linenos">4084</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">stop</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">step</span><span class="p">]</span>
</span><span id="Edge-4085"><a href="#Edge-4085"><span class="linenos">4085</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Edge-4086"><a href="#Edge-4086"><span class="linenos">4086</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span>
</span><span id="Edge-4087"><a href="#Edge-4087"><span class="linenos">4087</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-4088"><a href="#Edge-4088"><span class="linenos">4088</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid subscript.&quot;</span><span class="p">)</span>
</span><span id="Edge-4089"><a href="#Edge-4089"><span class="linenos">4089</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Edge-4090"><a href="#Edge-4090"><span class="linenos">4090</span></a>
</span><span id="Edge-4091"><a href="#Edge-4091"><span class="linenos">4091</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscript</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="Edge-4092"><a href="#Edge-4092"><span class="linenos">4092</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Edge-4093"><a href="#Edge-4093"><span class="linenos">4093</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="Edge-4094"><a href="#Edge-4094"><span class="linenos">4094</span></a>            <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">stop</span> <span class="p">:</span> <span class="n">subscript</span><span class="o">.</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Edge-4095"><a href="#Edge-4095"><span class="linenos">4095</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-4096"><a href="#Edge-4096"><span class="linenos">4096</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="Edge-4097"><a href="#Edge-4097"><span class="linenos">4097</span></a>            <span class="n">vertices</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Edge-4098"><a href="#Edge-4098"><span class="linenos">4098</span></a>
</span><span id="Edge-4099"><a href="#Edge-4099"><span class="linenos">4099</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4100"><a href="#Edge-4100"><span class="linenos">4100</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4101"><a href="#Edge-4101"><span class="linenos">4101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line slope. The slope of the line passing through the start and end points.&quot;&quot;&quot;</span>
</span><span id="Edge-4102"><a href="#Edge-4102"><span class="linenos">4102</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span><span id="Edge-4103"><a href="#Edge-4103"><span class="linenos">4103</span></a>
</span><span id="Edge-4104"><a href="#Edge-4104"><span class="linenos">4104</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4105"><a href="#Edge-4105"><span class="linenos">4105</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4106"><a href="#Edge-4106"><span class="linenos">4106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line angle. Angle between the line and the x-axis.&quot;&quot;&quot;</span>
</span><span id="Edge-4107"><a href="#Edge-4107"><span class="linenos">4107</span></a>        <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span><span id="Edge-4108"><a href="#Edge-4108"><span class="linenos">4108</span></a>
</span><span id="Edge-4109"><a href="#Edge-4109"><span class="linenos">4109</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4110"><a href="#Edge-4110"><span class="linenos">4110</span></a>    <span class="k">def</span> <span class="nf">inclination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4111"><a href="#Edge-4111"><span class="linenos">4111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inclination angle. Angle between the line and the x-axis converted to</span>
</span><span id="Edge-4112"><a href="#Edge-4112"><span class="linenos">4112</span></a><span class="sd">        a value between zero and pi.&quot;&quot;&quot;</span>
</span><span id="Edge-4113"><a href="#Edge-4113"><span class="linenos">4113</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">%</span> <span class="n">pi</span>
</span><span id="Edge-4114"><a href="#Edge-4114"><span class="linenos">4114</span></a>
</span><span id="Edge-4115"><a href="#Edge-4115"><span class="linenos">4115</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4116"><a href="#Edge-4116"><span class="linenos">4116</span></a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4117"><a href="#Edge-4117"><span class="linenos">4117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Length of the line segment.&quot;&quot;&quot;</span>
</span><span id="Edge-4118"><a href="#Edge-4118"><span class="linenos">4118</span></a>        <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Edge-4119"><a href="#Edge-4119"><span class="linenos">4119</span></a>
</span><span id="Edge-4120"><a href="#Edge-4120"><span class="linenos">4120</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4121"><a href="#Edge-4121"><span class="linenos">4121</span></a>    <span class="k">def</span> <span class="nf">x1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4122"><a href="#Edge-4122"><span class="linenos">4122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="Edge-4123"><a href="#Edge-4123"><span class="linenos">4123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">x</span>
</span><span id="Edge-4124"><a href="#Edge-4124"><span class="linenos">4124</span></a>
</span><span id="Edge-4125"><a href="#Edge-4125"><span class="linenos">4125</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4126"><a href="#Edge-4126"><span class="linenos">4126</span></a>    <span class="k">def</span> <span class="nf">y1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4127"><a href="#Edge-4127"><span class="linenos">4127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="Edge-4128"><a href="#Edge-4128"><span class="linenos">4128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">y</span>
</span><span id="Edge-4129"><a href="#Edge-4129"><span class="linenos">4129</span></a>
</span><span id="Edge-4130"><a href="#Edge-4130"><span class="linenos">4130</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4131"><a href="#Edge-4131"><span class="linenos">4131</span></a>    <span class="k">def</span> <span class="nf">x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4132"><a href="#Edge-4132"><span class="linenos">4132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="Edge-4133"><a href="#Edge-4133"><span class="linenos">4133</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">x</span>
</span><span id="Edge-4134"><a href="#Edge-4134"><span class="linenos">4134</span></a>
</span><span id="Edge-4135"><a href="#Edge-4135"><span class="linenos">4135</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4136"><a href="#Edge-4136"><span class="linenos">4136</span></a>    <span class="k">def</span> <span class="nf">y2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4137"><a href="#Edge-4137"><span class="linenos">4137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="Edge-4138"><a href="#Edge-4138"><span class="linenos">4138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">y</span>
</span><span id="Edge-4139"><a href="#Edge-4139"><span class="linenos">4139</span></a>
</span><span id="Edge-4140"><a href="#Edge-4140"><span class="linenos">4140</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4141"><a href="#Edge-4141"><span class="linenos">4141</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4142"><a href="#Edge-4142"><span class="linenos">4142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end&quot;&quot;&quot;</span>
</span><span id="Edge-4143"><a href="#Edge-4143"><span class="linenos">4143</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">]</span>
</span><span id="Edge-4144"><a href="#Edge-4144"><span class="linenos">4144</span></a>
</span><span id="Edge-4145"><a href="#Edge-4145"><span class="linenos">4145</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4146"><a href="#Edge-4146"><span class="linenos">4146</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4147"><a href="#Edge-4147"><span class="linenos">4147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end vertices.&quot;&quot;&quot;</span>
</span><span id="Edge-4148"><a href="#Edge-4148"><span class="linenos">4148</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span><span id="Edge-4149"><a href="#Edge-4149"><span class="linenos">4149</span></a>
</span><span id="Edge-4150"><a href="#Edge-4150"><span class="linenos">4150</span></a>    <span class="nd">@property</span>
</span><span id="Edge-4151"><a href="#Edge-4151"><span class="linenos">4151</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge-4152"><a href="#Edge-4152"><span class="linenos">4152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="Edge-4153"><a href="#Edge-4153"><span class="linenos">4153</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">array</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>A 2D edge.</p>
</div>


                            <div id="Edge.__init__" class="classattr">
                                        <input id="Edge.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Edge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">end_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="Edge.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.__init__-4035"><a href="#Edge.__init__-4035"><span class="linenos">4035</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Edge.__init__-4036"><a href="#Edge.__init__-4036"><span class="linenos">4036</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">start_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">],</span> <span class="n">end_point</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">]</span>
</span><span id="Edge.__init__-4037"><a href="#Edge.__init__-4037"><span class="linenos">4037</span></a>    <span class="p">):</span>
</span><span id="Edge.__init__-4038"><a href="#Edge.__init__-4038"><span class="linenos">4038</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="Edge.__init__-4039"><a href="#Edge.__init__-4039"><span class="linenos">4039</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">start_point</span><span class="p">)</span>
</span><span id="Edge.__init__-4040"><a href="#Edge.__init__-4040"><span class="linenos">4040</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="Edge.__init__-4041"><a href="#Edge.__init__-4041"><span class="linenos">4041</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">start_point</span>
</span><span id="Edge.__init__-4042"><a href="#Edge.__init__-4042"><span class="linenos">4042</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge.__init__-4043"><a href="#Edge.__init__-4043"><span class="linenos">4043</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Start point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="Edge.__init__-4044"><a href="#Edge.__init__-4044"><span class="linenos">4044</span></a>
</span><span id="Edge.__init__-4045"><a href="#Edge.__init__-4045"><span class="linenos">4045</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="Edge.__init__-4046"><a href="#Edge.__init__-4046"><span class="linenos">4046</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">end_point</span><span class="p">)</span>
</span><span id="Edge.__init__-4047"><a href="#Edge.__init__-4047"><span class="linenos">4047</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_point</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="Edge.__init__-4048"><a href="#Edge.__init__-4048"><span class="linenos">4048</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="n">end_point</span>
</span><span id="Edge.__init__-4049"><a href="#Edge.__init__-4049"><span class="linenos">4049</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Edge.__init__-4050"><a href="#Edge.__init__-4050"><span class="linenos">4050</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;End point should be a Point or Vertex instance.&quot;</span><span class="p">)</span>
</span><span id="Edge.__init__-4051"><a href="#Edge.__init__-4051"><span class="linenos">4051</span></a>
</span><span id="Edge.__init__-4052"><a href="#Edge.__init__-4052"><span class="linenos">4052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
</span><span id="Edge.__init__-4053"><a href="#Edge.__init__-4053"><span class="linenos">4053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
</span><span id="Edge.__init__-4054"><a href="#Edge.__init__-4054"><span class="linenos">4054</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">EDGE</span>
</span><span id="Edge.__init__-4055"><a href="#Edge.__init__-4055"><span class="linenos">4055</span></a>        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graphics_object</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Edge.start" class="classattr">
                                <div class="attr variable">
            <span class="name">start</span>

        
    </div>
    <a class="headerlink" href="#Edge.start"></a>
    
    

                            </div>
                            <div id="Edge.end" class="classattr">
                                <div class="attr variable">
            <span class="name">end</span>

        
    </div>
    <a class="headerlink" href="#Edge.end"></a>
    
    

                            </div>
                            <div id="Edge.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span>

        
    </div>
    <a class="headerlink" href="#Edge.type"></a>
    
    

                            </div>
                            <div id="Edge.slope" class="classattr">
                                        <input id="Edge.slope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">slope</span>

                <label class="view-source-button" for="Edge.slope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.slope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.slope-4099"><a href="#Edge.slope-4099"><span class="linenos">4099</span></a>    <span class="nd">@property</span>
</span><span id="Edge.slope-4100"><a href="#Edge.slope-4100"><span class="linenos">4100</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.slope-4101"><a href="#Edge.slope-4101"><span class="linenos">4101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line slope. The slope of the line passing through the start and end points.&quot;&quot;&quot;</span>
</span><span id="Edge.slope-4102"><a href="#Edge.slope-4102"><span class="linenos">4102</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Line slope. The slope of the line passing through the start and end points.</p>
</div>


                            </div>
                            <div id="Edge.angle" class="classattr">
                                        <input id="Edge.angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">angle</span>

                <label class="view-source-button" for="Edge.angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.angle-4104"><a href="#Edge.angle-4104"><span class="linenos">4104</span></a>    <span class="nd">@property</span>
</span><span id="Edge.angle-4105"><a href="#Edge.angle-4105"><span class="linenos">4105</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.angle-4106"><a href="#Edge.angle-4106"><span class="linenos">4106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line angle. Angle between the line and the x-axis.&quot;&quot;&quot;</span>
</span><span id="Edge.angle-4107"><a href="#Edge.angle-4107"><span class="linenos">4107</span></a>        <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Line angle. Angle between the line and the x-axis.</p>
</div>


                            </div>
                            <div id="Edge.inclination" class="classattr">
                                        <input id="Edge.inclination-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">inclination</span>

                <label class="view-source-button" for="Edge.inclination-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.inclination"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.inclination-4109"><a href="#Edge.inclination-4109"><span class="linenos">4109</span></a>    <span class="nd">@property</span>
</span><span id="Edge.inclination-4110"><a href="#Edge.inclination-4110"><span class="linenos">4110</span></a>    <span class="k">def</span> <span class="nf">inclination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.inclination-4111"><a href="#Edge.inclination-4111"><span class="linenos">4111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inclination angle. Angle between the line and the x-axis converted to</span>
</span><span id="Edge.inclination-4112"><a href="#Edge.inclination-4112"><span class="linenos">4112</span></a><span class="sd">        a value between zero and pi.&quot;&quot;&quot;</span>
</span><span id="Edge.inclination-4113"><a href="#Edge.inclination-4113"><span class="linenos">4113</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">%</span> <span class="n">pi</span>
</span></pre></div>


            <div class="docstring"><p>Inclination angle. Angle between the line and the x-axis converted to
a value between zero and pi.</p>
</div>


                            </div>
                            <div id="Edge.length" class="classattr">
                                        <input id="Edge.length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">length</span>

                <label class="view-source-button" for="Edge.length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.length-4115"><a href="#Edge.length-4115"><span class="linenos">4115</span></a>    <span class="nd">@property</span>
</span><span id="Edge.length-4116"><a href="#Edge.length-4116"><span class="linenos">4116</span></a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.length-4117"><a href="#Edge.length-4117"><span class="linenos">4117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Length of the line segment.&quot;&quot;&quot;</span>
</span><span id="Edge.length-4118"><a href="#Edge.length-4118"><span class="linenos">4118</span></a>        <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Length of the line segment.</p>
</div>


                            </div>
                            <div id="Edge.x1" class="classattr">
                                        <input id="Edge.x1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x1</span>

                <label class="view-source-button" for="Edge.x1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.x1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.x1-4120"><a href="#Edge.x1-4120"><span class="linenos">4120</span></a>    <span class="nd">@property</span>
</span><span id="Edge.x1-4121"><a href="#Edge.x1-4121"><span class="linenos">4121</span></a>    <span class="k">def</span> <span class="nf">x1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.x1-4122"><a href="#Edge.x1-4122"><span class="linenos">4122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="Edge.x1-4123"><a href="#Edge.x1-4123"><span class="linenos">4123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>x-coordinate of the start point.</p>
</div>


                            </div>
                            <div id="Edge.y1" class="classattr">
                                        <input id="Edge.y1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y1</span>

                <label class="view-source-button" for="Edge.y1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.y1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.y1-4125"><a href="#Edge.y1-4125"><span class="linenos">4125</span></a>    <span class="nd">@property</span>
</span><span id="Edge.y1-4126"><a href="#Edge.y1-4126"><span class="linenos">4126</span></a>    <span class="k">def</span> <span class="nf">y1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.y1-4127"><a href="#Edge.y1-4127"><span class="linenos">4127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the start point.&quot;&quot;&quot;</span>
</span><span id="Edge.y1-4128"><a href="#Edge.y1-4128"><span class="linenos">4128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>y-coordinate of the start point.</p>
</div>


                            </div>
                            <div id="Edge.x2" class="classattr">
                                        <input id="Edge.x2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x2</span>

                <label class="view-source-button" for="Edge.x2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.x2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.x2-4130"><a href="#Edge.x2-4130"><span class="linenos">4130</span></a>    <span class="nd">@property</span>
</span><span id="Edge.x2-4131"><a href="#Edge.x2-4131"><span class="linenos">4131</span></a>    <span class="k">def</span> <span class="nf">x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.x2-4132"><a href="#Edge.x2-4132"><span class="linenos">4132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;x-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="Edge.x2-4133"><a href="#Edge.x2-4133"><span class="linenos">4133</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>x-coordinate of the end point.</p>
</div>


                            </div>
                            <div id="Edge.y2" class="classattr">
                                        <input id="Edge.y2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y2</span>

                <label class="view-source-button" for="Edge.y2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.y2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.y2-4135"><a href="#Edge.y2-4135"><span class="linenos">4135</span></a>    <span class="nd">@property</span>
</span><span id="Edge.y2-4136"><a href="#Edge.y2-4136"><span class="linenos">4136</span></a>    <span class="k">def</span> <span class="nf">y2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.y2-4137"><a href="#Edge.y2-4137"><span class="linenos">4137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;y-coordinate of the end point.&quot;&quot;&quot;</span>
</span><span id="Edge.y2-4138"><a href="#Edge.y2-4138"><span class="linenos">4138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>y-coordinate of the end point.</p>
</div>


                            </div>
                            <div id="Edge.points" class="classattr">
                                        <input id="Edge.points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">points</span>

                <label class="view-source-button" for="Edge.points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.points-4140"><a href="#Edge.points-4140"><span class="linenos">4140</span></a>    <span class="nd">@property</span>
</span><span id="Edge.points-4141"><a href="#Edge.points-4141"><span class="linenos">4141</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.points-4142"><a href="#Edge.points-4142"><span class="linenos">4142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end&quot;&quot;&quot;</span>
</span><span id="Edge.points-4143"><a href="#Edge.points-4143"><span class="linenos">4143</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">point</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Start and end</p>
</div>


                            </div>
                            <div id="Edge.vertices" class="classattr">
                                        <input id="Edge.vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vertices</span>

                <label class="view-source-button" for="Edge.vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.vertices-4145"><a href="#Edge.vertices-4145"><span class="linenos">4145</span></a>    <span class="nd">@property</span>
</span><span id="Edge.vertices-4146"><a href="#Edge.vertices-4146"><span class="linenos">4146</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.vertices-4147"><a href="#Edge.vertices-4147"><span class="linenos">4147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end vertices.&quot;&quot;&quot;</span>
</span><span id="Edge.vertices-4148"><a href="#Edge.vertices-4148"><span class="linenos">4148</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Start and end vertices.</p>
</div>


                            </div>
                            <div id="Edge.array" class="classattr">
                                        <input id="Edge.array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">array</span>

                <label class="view-source-button" for="Edge.array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.array-4150"><a href="#Edge.array-4150"><span class="linenos">4150</span></a>    <span class="nd">@property</span>
</span><span id="Edge.array-4151"><a href="#Edge.array-4151"><span class="linenos">4151</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Edge.array-4152"><a href="#Edge.array-4152"><span class="linenos">4152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Homogeneous coordinates as a numpy array.&quot;&quot;&quot;</span>
</span><span id="Edge.array-4153"><a href="#Edge.array-4153"><span class="linenos">4153</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">array</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Homogeneous coordinates as a numpy array.</p>
</div>


                            </div>
                </section>
                <section id="rotate_point_3D">
                            <input id="rotate_point_3D-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_point_3D</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="rotate_point_3D-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#rotate_point_3D"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="rotate_point_3D-4156"><a href="#rotate_point_3D-4156"><span class="linenos">4156</span></a><span class="k">def</span> <span class="nf">rotate_point_3D</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="rotate_point_3D-4157"><a href="#rotate_point_3D-4157"><span class="linenos">4157</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a 2d point (out of paper) about a 2d line by the given angle.</span>
</span><span id="rotate_point_3D-4158"><a href="#rotate_point_3D-4158"><span class="linenos">4158</span></a><span class="sd">    This is used for animating mirror reflections.</span>
</span><span id="rotate_point_3D-4159"><a href="#rotate_point_3D-4159"><span class="linenos">4159</span></a><span class="sd">     Args:</span>
</span><span id="rotate_point_3D-4160"><a href="#rotate_point_3D-4160"><span class="linenos">4160</span></a><span class="sd">         point (Point): Point to rotate.</span>
</span><span id="rotate_point_3D-4161"><a href="#rotate_point_3D-4161"><span class="linenos">4161</span></a><span class="sd">         line (Line): Line to rotate about.</span>
</span><span id="rotate_point_3D-4162"><a href="#rotate_point_3D-4162"><span class="linenos">4162</span></a><span class="sd">         angle (float): Angle of rotation in radians.</span>
</span><span id="rotate_point_3D-4163"><a href="#rotate_point_3D-4163"><span class="linenos">4163</span></a>
</span><span id="rotate_point_3D-4164"><a href="#rotate_point_3D-4164"><span class="linenos">4164</span></a><span class="sd">     Returns:</span>
</span><span id="rotate_point_3D-4165"><a href="#rotate_point_3D-4165"><span class="linenos">4165</span></a><span class="sd">         Point: Rotated point.</span>
</span><span id="rotate_point_3D-4166"><a href="#rotate_point_3D-4166"><span class="linenos">4166</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="rotate_point_3D-4167"><a href="#rotate_point_3D-4167"><span class="linenos">4167</span></a>    <span class="kn">from</span> <span class="nn">..graphics.affine</span> <span class="kn">import</span> <span class="n">rotation_matrix</span><span class="p">,</span> <span class="n">translation_matrix</span>
</span><span id="rotate_point_3D-4168"><a href="#rotate_point_3D-4168"><span class="linenos">4168</span></a>
</span><span id="rotate_point_3D-4169"><a href="#rotate_point_3D-4169"><span class="linenos">4169</span></a>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span>
</span><span id="rotate_point_3D-4170"><a href="#rotate_point_3D-4170"><span class="linenos">4170</span></a>    <span class="n">line_angle_</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="rotate_point_3D-4171"><a href="#rotate_point_3D-4171"><span class="linenos">4171</span></a>    <span class="n">translation</span> <span class="o">=</span> <span class="n">translation_matrix</span><span class="p">(</span><span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="rotate_point_3D-4172"><a href="#rotate_point_3D-4172"><span class="linenos">4172</span></a>    <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="o">-</span><span class="n">line_angle_</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="rotate_point_3D-4173"><a href="#rotate_point_3D-4173"><span class="linenos">4173</span></a>    <span class="n">xform</span> <span class="o">=</span> <span class="n">translation</span> <span class="o">@</span> <span class="n">rotation</span>
</span><span id="rotate_point_3D-4174"><a href="#rotate_point_3D-4174"><span class="linenos">4174</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="rotate_point_3D-4175"><a href="#rotate_point_3D-4175"><span class="linenos">4175</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">xform</span>
</span><span id="rotate_point_3D-4176"><a href="#rotate_point_3D-4176"><span class="linenos">4176</span></a>
</span><span id="rotate_point_3D-4177"><a href="#rotate_point_3D-4177"><span class="linenos">4177</span></a>    <span class="n">y</span> <span class="o">*=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="rotate_point_3D-4178"><a href="#rotate_point_3D-4178"><span class="linenos">4178</span></a>
</span><span id="rotate_point_3D-4179"><a href="#rotate_point_3D-4179"><span class="linenos">4179</span></a>    <span class="n">inv_translation</span> <span class="o">=</span> <span class="n">translation_matrix</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="rotate_point_3D-4180"><a href="#rotate_point_3D-4180"><span class="linenos">4180</span></a>    <span class="n">inv_rotation</span> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="n">line_angle_</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="rotate_point_3D-4181"><a href="#rotate_point_3D-4181"><span class="linenos">4181</span></a>    <span class="n">inv_xform</span> <span class="o">=</span> <span class="n">inv_rotation</span> <span class="o">@</span> <span class="n">inv_translation</span>
</span><span id="rotate_point_3D-4182"><a href="#rotate_point_3D-4182"><span class="linenos">4182</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">inv_xform</span>
</span><span id="rotate_point_3D-4183"><a href="#rotate_point_3D-4183"><span class="linenos">4183</span></a>
</span><span id="rotate_point_3D-4184"><a href="#rotate_point_3D-4184"><span class="linenos">4184</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Rotate a 2d point (out of paper) about a 2d line by the given angle.
This is used for animating mirror reflections.
 Args:
     point (Point): Point to rotate.
     line (Line): Line to rotate about.
     angle (float): Angle of rotation in radians.</p>

<p>Returns:
     Point: Rotated point.</p>
</div>


                </section>
                <section id="rotate_line_3D">
                            <input id="rotate_line_3D-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_line_3D</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">line</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">about</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="rotate_line_3D-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#rotate_line_3D"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="rotate_line_3D-4187"><a href="#rotate_line_3D-4187"><span class="linenos">4187</span></a><span class="k">def</span> <span class="nf">rotate_line_3D</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">about</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="rotate_line_3D-4188"><a href="#rotate_line_3D-4188"><span class="linenos">4188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate a 3d line about a 3d line by the given angle</span>
</span><span id="rotate_line_3D-4189"><a href="#rotate_line_3D-4189"><span class="linenos">4189</span></a>
</span><span id="rotate_line_3D-4190"><a href="#rotate_line_3D-4190"><span class="linenos">4190</span></a><span class="sd">    Args:</span>
</span><span id="rotate_line_3D-4191"><a href="#rotate_line_3D-4191"><span class="linenos">4191</span></a><span class="sd">        line (Line): Line to rotate.</span>
</span><span id="rotate_line_3D-4192"><a href="#rotate_line_3D-4192"><span class="linenos">4192</span></a><span class="sd">        about (Line): Line to rotate about.</span>
</span><span id="rotate_line_3D-4193"><a href="#rotate_line_3D-4193"><span class="linenos">4193</span></a><span class="sd">        angle (float): Angle of rotation in radians.</span>
</span><span id="rotate_line_3D-4194"><a href="#rotate_line_3D-4194"><span class="linenos">4194</span></a>
</span><span id="rotate_line_3D-4195"><a href="#rotate_line_3D-4195"><span class="linenos">4195</span></a><span class="sd">    Returns:</span>
</span><span id="rotate_line_3D-4196"><a href="#rotate_line_3D-4196"><span class="linenos">4196</span></a><span class="sd">        Line: Rotated line.</span>
</span><span id="rotate_line_3D-4197"><a href="#rotate_line_3D-4197"><span class="linenos">4197</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="rotate_line_3D-4198"><a href="#rotate_line_3D-4198"><span class="linenos">4198</span></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">rotate_point_3D</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">about</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="rotate_line_3D-4199"><a href="#rotate_line_3D-4199"><span class="linenos">4199</span></a>    <span class="n">p2</span> <span class="o">=</span> <span class="n">rotate_point_3D</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">about</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="rotate_line_3D-4200"><a href="#rotate_line_3D-4200"><span class="linenos">4200</span></a>
</span><span id="rotate_line_3D-4201"><a href="#rotate_line_3D-4201"><span class="linenos">4201</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Rotate a 3d line about a 3d line by the given angle</p>

<p>Args:
    line (Line): Line to rotate.
    about (Line): Line to rotate about.
    angle (float): Angle of rotation in radians.</p>

<p>Returns:
    Line: Rotated line.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>